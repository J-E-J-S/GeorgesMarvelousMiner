<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">5860066</article-id><article-id pub-id-type="pmid">28472230</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btx293</article-id><article-id pub-id-type="publisher-id">btx293</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Notes</subject><subj-group subj-group-type="category-toc-heading"><subject>Genome Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>OMSim: a simulator for optical map data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Miclotte</surname><given-names>Giles</given-names></name><xref ref-type="aff" rid="btx293-aff1">1</xref><xref ref-type="aff" rid="btx293-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Plaisance</surname><given-names>St&#x000e9;phane</given-names></name><xref ref-type="aff" rid="btx293-aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Rombauts</surname><given-names>Stephane</given-names></name><xref ref-type="aff" rid="btx293-aff2">2</xref><xref ref-type="aff" rid="btx293-aff4">4</xref><xref ref-type="aff" rid="btx293-aff5">5</xref></contrib><contrib contrib-type="author"><name><surname>Van de Peer</surname><given-names>Yves</given-names></name><xref ref-type="aff" rid="btx293-aff2">2</xref><xref ref-type="aff" rid="btx293-aff4">4</xref><xref ref-type="aff" rid="btx293-aff5">5</xref><xref ref-type="aff" rid="btx293-aff6">6</xref></contrib><contrib contrib-type="author"><name><surname>Audenaert</surname><given-names>Pieter</given-names></name><xref ref-type="aff" rid="btx293-aff1">1</xref><xref ref-type="aff" rid="btx293-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Fostier</surname><given-names>Jan</given-names></name><xref ref-type="aff" rid="btx293-aff1">1</xref><xref ref-type="aff" rid="btx293-aff2">2</xref><xref ref-type="corresp" rid="btx293-cor1"/><!--<email>jan.fostier@ugent.be</email>--></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name><surname>Hancock</surname><given-names>John</given-names></name><role>Associate Editor</role></contrib></contrib-group><aff id="btx293-aff1"><label>1</label>Department of Information Technology, IDLab, Ghent University&#x02013;IMEC, Ghent, Belgium</aff><aff id="btx293-aff2"><label>2</label>Bioinformatics Institute Ghent, Ghent University, Ghent, Belgium</aff><aff id="btx293-aff3"><label>3</label>Nucleomics Core, VIB, Leuven, Belgium</aff><aff id="btx293-aff4"><label>4</label>Center for Plant Systems Biology, VIB, Ghent, Belgium</aff><aff id="btx293-aff5"><label>5</label>Department of Plant Biotechnology and Bioinformatics, Ghent University, Ghent, Belgium</aff><aff id="btx293-aff6"><label>6</label>Department of Genetics, Genome Research Institute, University of Pretoria, Pretoria, South Africa</aff><author-notes><corresp id="btx293-cor1">To whom correspondence should be addressed. Email: <email>jan.fostier@ugent.be</email></corresp></author-notes><pub-date pub-type="ppub"><day>01</day><month>9</month><year>2017</year></pub-date><pub-date pub-type="epub" iso-8601-date="2017-05-03"><day>03</day><month>5</month><year>2017</year></pub-date><pub-date pub-type="pmc-release"><day>03</day><month>5</month><year>2017</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>33</volume><issue>17</issue><fpage>2740</fpage><lpage>2742</lpage><history><date date-type="received"><day>21</day><month>2</month><year>2017</year></date><date date-type="rev-recd"><day>13</day><month>4</month><year>2017</year></date><date date-type="accepted"><day>02</day><month>5</month><year>2017</year></date></history><permissions><copyright-statement>&#x000a9; The Author 2017. Published by Oxford University Press.</copyright-statement><copyright-year>2017</copyright-year><license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="cc-by-nc"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p></license></permissions><self-uri xlink:href="btx293.pdf"/><abstract><title>Abstract</title><sec id="SA1"><title>Motivation</title><p>The Bionano Genomics platform allows for the optical detection of short sequence patterns in very long DNA molecules (up to 2.5&#x02009;Mbp). Molecules with overlapping patterns can be assembled to generate a consensus optical map of the entire genome. In turn, these optical maps can be used to validate or improve de novo genome assembly projects or to detect large-scale structural variation in genomes. Simulated optical map data can assist in the development and benchmarking of tools that operate on those data, such as alignment and assembly software. Additionally, it can help to optimize the experimental setup for a genome of interest. Such a simulator is currently not available.</p></sec><sec id="SA2"><title>Results</title><p>We have developed a simulator, OMSim, that produces synthetic optical map data that mimics real Bionano Genomics data. These simulated data have been tested for compatibility with the Bionano Genomics Irys software system and the Irys-scaffolding scripts. OMSim is capable of handling very large genomes (over 30 Gbp) with high throughput and low memory requirements.</p></sec><sec id="SA3"><title>Availability and implementation</title><p>The Python simulation tool and a cross-platform graphical user interface are available as open source software under the GNU GPL v2 license (<ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.intec.ugent.be/omsim">http://www.bioinformatics.intec.ugent.be/omsim</ext-link>).</p></sec><sec id="SA4"><title>Supplementary information</title><p>
<xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p></sec></abstract><funding-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">FWO</named-content><named-content content-type="funder-identifier">10.13039/501100003130</named-content></funding-source><award-id>G0C3914N</award-id></award-group></funding-group><counts><page-count count="3"/></counts></article-meta></front><body><sec><title>1 Introduction</title><p>The Bionano Genomics platform is able to visualize occurrences of specific, short sequence motifs (e.g. 7&#x02009;bp) along very long stretches of linearized DNA molecules (up to 2.5&#x02009;Mbp), thus forming a unique, sequence-specific pattern per molecule, sometimes referred to as a &#x02018;barcode&#x02019;. By using those signature patterns, the molecules can be assembled in a complete consensus genome map. This view of the genome can be used to validate or improve de novo genome assembly, by providing a scaffold on which the contigs can be anchored (<xref rid="btx293-B8" ref-type="bibr">Shi <italic>et al.</italic>, 2016</xref>), or to detect large-scale structural variation in genomes (<xref rid="btx293-B4" ref-type="bibr">Mak <italic>et al.</italic>, 2015</xref>).</p><p>Bionano Genomics optical map data is generated in several steps. First, DNA molecules of up to 2.5&#x02009;Mbp are labeled using nicking restriction endonucleases, cutting one strand of the DNA near specific recognition nucleotide sequences. At these nicking sites fluorescent nucleotides are introduced into the DNA to highlight the position where the DNA motif occurs. The labeled DNA is then linearized using nanochannel arrays and imaged, such that the fluorescent labels along each molecule can be detected. For each DNA molecule, its size as well as the positions of the labels on the molecule are estimated and stored in BNX format. These data can be visualized as beads on a cord, and assembling these into optical consensus maps involves the alignment of the molecules such that the label positions match. The Irys Software System (<ext-link ext-link-type="uri" xlink:href="http://bionanogenomics.com/wp-content/uploads/2015/01/datasheet-web.pdf">http://bionanogenomics.com/wp-content/uploads/2015/01/datasheet-web.pdf</ext-link>) and the Irys-scaffolding scripts (<xref rid="btx293-B7" ref-type="bibr">Shelton <italic>et al.</italic>, 2015</xref>) can be used to automate this procedure.</p><p>We developed OMSim to generate synthetic optical map data. This serves two purposes. First, OMSim can assist in the development and benchmarking of tools that operate on Bionano Genomics optical map data such as alignment and assembly software. Simulated optical map data were used to this end in (<xref rid="btx293-B5" ref-type="bibr">Muggli <italic>et al.</italic>, 2014</xref>, <xref rid="btx293-B6" ref-type="bibr">2015</xref>; <xref rid="btx293-B3" ref-type="bibr">Li <italic>et al.</italic>, 2016</xref>; <xref rid="btx293-B2" ref-type="bibr">Leung <italic>et al.</italic>, 2017</xref>), but the simulation tools were not publicly available and only took into account a limited subset of the noise factors present in real data. Second, OMSim can assist in designing the optimal experimental setup: given a genome of interest, OMSim-generated data can help to select the right nicking enzyme or combinations thereof, to identify local label-depleted areas with low information content, to evaluate the distribution of nicking sites, to identify fragile sites due to nearby occurring labels, etc. This information can then be used to optimize the parameters of an Irys run, to ultimately generate an optimal amount of useful real data. A concrete example of this assistance in experimental design is the simulation of data corresponding to a structurally altered genome and evaluating the ability of the Bionano platform to identify the structural variations. The use of simulated data for this second application significantly improves upon the use of nicker software, e.g. BioNano Genomics Knickers, which provide overal statistics on label density based on a reference genome analysis. These global statistics provide only limited insights in the problem at hand, while simulated data allows to actually test the performance of the assembly or variant detection.</p><p>OMSim simulates the Bionano Genomics process using statistical models for which the parameters were derived from real data (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> data S1 for the parameter description), and generates output in BNX format. It is implemented in Python, and relies on the Scipy library to sample from the required distributions. A graphical user interface has been developed to facilitate the setup of the simulation process. OMSim requires a reference assembly as the ground truth for the simulation. Each map is simulated from a single contig, hence the contiguity of the reference assembly limits the lengths of the simulated optical maps, i.e. it is impossible to simulate an optical map that is longer than the contig from which it is simulated.</p></sec><sec><title>2 Methods and results</title><p>OMSim was designed to accurately mimic all sources of variation that occur in the Bionano Genomics data. First, false positive and false negative labels are taken into account, where labels are either erroneously placed or not placed. Second, there is the occurrence of fragile sites, where labels that occur very close to each other cause systematic breaks in the molecules. Third, each molecule has a stretch factor, which quantifies how the migration of the DNA molecule through a nanochannel causes the molecule to stretch or shrink. Fourth, there is some additional variability in the position of the labels due to local stretching. Fifth, due to the limited optical resolution, nearby labels may appear as one label in the image. Finally, also due to the optical resolution, there is the possibility of chimeric maps, which occur when distinct molecules are close together in a nanochannel such that they appear as a single molecule in the image.</p><p>The OMSim process consists of two steps. First, the locations of the sequence recognition sites in the genome are indexed using the computationally efficient Knuth-Morris-Pratt algorithm (<xref rid="btx293-B1" ref-type="bibr">Knuth <italic>et al.</italic>, 1977</xref>). This index can be reused for future runs. Second, using this index, OMSim simulates the actual optical map data. Molecule lengths are generated from a negative binomial distribution and for each molecule a start location is uniformly chosen on the provided reference genome. Then, labels and noise are introduced in each molecule. False positive (resp. negative) labels are uniformly distributed along the molecules (resp. labels). The molecules are broken at fragile sites, based on the proximity of neighbouring labels. Stretch factor variations are normally distributed. Labels that occur close together are collapsed into a single label. After simulating the molecules, chimeras are introduced by concatenating molecules.</p><p>Optical map data was simulated from the human genome reference Hg19, and anchored using the Bionano Genomics RefAligner. The resulting alignments were compared to the alignments of real data from NA24385 (Ashkenazim Trio son, public data from <ext-link ext-link-type="uri" xlink:href="http://bionanogenomics.com/science/public-datasets/">http://bionanogenomics.com/science/public-datasets/</ext-link>). A portion of these alignments and the coverage and the size distribution of both simulated maps and real maps are shown in <xref ref-type="fig" rid="btx293-F1">Figure 1</xref>. This figure shows that the simulated data can be aligned to the reference, that similarly as in real data missing labels are present due to false positives or collapsing labels, and that the size distributions of the simulated and real data are nearly identical. A peak memory usage of 478&#x02009;MB was measured while indexing the human reference Hg19 and simulating optical map data from this index. Peak memory usage depends on the number of nicking sites in the reference. The indexing run time is linear in the size of the reference, while the simulation run time is linear in the size of the output. In our tests for genomes with sizes ranging from 4&#x02009;Mbp up to 30 Gbp, this corresponds to a throughput of 30&#x02009;Mbp per minute for indexing and 12.5 Gbp per minute for the actual simulation. Loading the index in subsequent runs took less than 30&#x02009;seconds for all data sets. From these results we conclude that OMSim efficiently simulates data that resemble the real Bionano Genomics data.
</p><fig id="btx293-F1" orientation="portrait" position="float"><label>Fig. 1</label><caption><p>(<bold>A</bold>) Alignments of real and simulated data on a section of chromosome 10 of the human genome. The alignments were obtained with the Bionano Genomics RefAligner. The tracks from top to bottom are: (1) the consensus map, (2) real optical maps from data set NA24385 and (3) optical maps simulated with OMSim. Markers on each track correspond to the anchored labels. Only a fraction of the actual coverage is shown. (<bold>B</bold>) Comparison of the label coverage in 100 bins along chromosome 10 in Hg19, for both simulated and real data. (<bold>C</bold>) Comparison of the size distribution of simulated and real data over the entire genome. Molecules shorter than 150&#x02009;kbp were filtered out </p></caption><graphic xlink:href="btx293f1"/></fig></sec><sec><title>Funding</title><p>This work was supported by The Research Foundation&#x02013;Flanders (FWO) [G0C3914N].</p><p>
<italic>Conflict of Interest</italic>: none declared.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="sup1"><label>Supplementary Data</label><media xlink:href="btx293_omsim-supplementary.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ref-list><title>References</title><ref id="btx293-B1"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Knuth</surname><given-names>D.</given-names></name></person-group>
<etal>et al</etal> (<year>1977</year>) 
<article-title>Fast pattern matching in strings</article-title>. <source>SIAM J. Comput</source>., <volume>6</volume>, <fpage>323</fpage>&#x02013;<lpage>350</lpage>.</mixed-citation></ref><ref id="btx293-B2"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Leung</surname><given-names>A.K.-Y.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Omblast: alignment tool for optical mapping using a seed-and-extend approach</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>311.</fpage><pub-id pub-id-type="pmid">28172448</pub-id></mixed-citation></ref><ref id="btx293-B3"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) <source>Towards a More Accurate Error Model for BioNano Optical Maps</source>. 
<publisher-name>Springer International Publishing</publisher-name>, 
<publisher-loc>Cham</publisher-loc>, pp. <fpage>67</fpage>&#x02013;<lpage>79</lpage>.</mixed-citation></ref><ref id="btx293-B4"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Mak</surname><given-names>A.C.Y.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Genome-wide structural variation detection by genome mapping on nanochannel arrays</article-title>. <source>Genetics</source>, <volume>202</volume>, <fpage>351</fpage>&#x02013;<lpage>362</lpage>.<pub-id pub-id-type="pmid">26510793</pub-id></mixed-citation></ref><ref id="btx293-B5"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Muggli</surname><given-names>M.D.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) <source>Efficient Indexed Alignment of Contigs to Optical Maps</source>. 
<publisher-name>Springer Berlin Heidelberg</publisher-name>, 
<publisher-loc>Berlin, Heidelberg</publisher-loc>, pp. <fpage>68</fpage>&#x02013;<lpage>81</lpage>.</mixed-citation></ref><ref id="btx293-B6"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Muggli</surname><given-names>M.D.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Misassembly detection using paired-end sequence reads and optical mapping data</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>i80.</fpage><pub-id pub-id-type="pmid">26072512</pub-id></mixed-citation></ref><ref id="btx293-B7"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Shelton</surname><given-names>J.M.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Tools and pipelines for bionano data: molecule assembly pipeline and fasta super scaffolding tool</article-title>. <source>BMC Genom</source>., <volume>16</volume>, <fpage>1</fpage>&#x02013;<lpage>16</lpage>.</mixed-citation></ref><ref id="btx293-B8"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Shi</surname><given-names>L.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Long-read sequencing and de novo assembly of a Chinese genome</article-title>. <source>Nat. Commun</source>., <volume>7</volume>, <fpage>12065</fpage>.<pub-id pub-id-type="pmid">27356984</pub-id></mixed-citation></ref></ref-list></back></article>