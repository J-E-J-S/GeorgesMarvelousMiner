<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id><journal-title-group><journal-title>BMC Genomics</journal-title></journal-title-group><issn pub-type="epub">1471-2164</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6101073</article-id><article-id pub-id-type="pmid">30367575</article-id><article-id pub-id-type="publisher-id">4922</article-id><article-id pub-id-type="doi">10.1186/s12864-018-4922-4</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>Single cell RNA-seq data clustering using TF-IDF based methods</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Moussa</surname><given-names>Marmar</given-names></name><address><email>marmar.moussa@uconn.edu</email></address><xref ref-type="aff" rid="Aff1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>M&#x00103;ndoiu</surname><given-names>Ion I.</given-names></name><address><email>ion.mandoiu@uconn.edu</email></address><xref ref-type="aff" rid="Aff1"/></contrib><aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0860 4915</institution-id><institution-id institution-id-type="GRID">grid.63054.34</institution-id><institution>University of Connecticut, </institution></institution-wrap>Storrs, 06269 CT USA </aff></contrib-group><pub-date pub-type="epub"><day>13</day><month>8</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>13</day><month>8</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>19</volume><issue>Suppl 6</issue><issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. The Supplement Editors declare that they have no competing interests.</issue-sponsor><elocation-id>569</elocation-id><permissions><copyright-statement>&#x000a9; The Author(s) 2018</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p>Single cell transcriptomics is critical for understanding cellular heterogeneity and identification of novel cell types. Leveraging the recent advances in single cell RNA sequencing (scRNA-Seq) technology requires novel unsupervised clustering algorithms that are robust to high levels of technical and biological noise and scale to datasets of millions of cells.</p></sec><sec><title>Results</title><p>We present novel computational approaches for clustering scRNA-seq data based on the Term Frequency - Inverse Document Frequency (TF-IDF) transformation that has been successfully used in the field of text analysis.</p></sec><sec><title>Conclusions</title><p>Empirical experimental results show that TF-IDF methods consistently outperform commonly used scRNA-Seq clustering approaches.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Single cell RNA-Seq</kwd><kwd>Clustering</kwd><kwd>TF-IDF</kwd></kwd-group><conference><conf-name>13th International Symposium on Bioinformatics Research and Applications (ISBRA 2017)</conf-name><conf-loc>Honolulu, Hawaii, USA</conf-loc><conf-date>30 May - 2 June 2017</conf-date></conference><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p>The recent advances in single cell RNA sequencing (scRNA-Seq) technologies promise to unveil novel cell types and uncover subtle regulatory processes that are undetectable by analyzing bulk samples. Currently, droplet-based technologies such as the Chromium Megacell commercialized by 10x Genomics can quickly and inexpensively generate scRNA-Seq expression profiles for up to millions of cells. Indeed, a dataset recently made public by 10x Genomics is comprised of 1.3 million mouse brain cells. However, the sequencing depth of each cell in such datasets is typically very low, resulting in many missing gene expression levels (the above 10x dataset has a mean of only 23,185 reads per cell, with a median of only 1927 genes detected per cell). The large amounts of data and high levels of noise render many unsupervised clustering methods developed for bulk gene expression data [<xref ref-type="bibr" rid="CR1">1</xref>] unusable, prompting the development of a new generation of clustering tools.</p><p>In this paper, we propose several computational approaches for clustering scRNA-Seq data based on the <italic>Term Frequency - Inverse Document Frequency (TF-IDF)</italic> transformation commonly used for text/document analysis. Empirical evaluation on simulated and real cell mixtures of FACS sorted cells with different levels of complexity suggests that the TF-IDF methods consistently outperform existing scRNA-Seq clustering methods. In the Methods section we detail several commonly used scRNA-Seq clustering methods, provide background on the TF-IDF transformation and its proposed application to scRNA-Seq data clustering, and describe the experimental setup and accuracy metrics used in our empirical assessment. In the Results section we present the results of a comprehensive evaluation comparing the accuracy of the proposed TF-IDF based methods with that of existing methods on cell mixtures with both simulated and real proportions. Finally, in the Conclusions section we outline directions for future work.</p></sec><sec id="Sec2"><title>Methods</title><p>We did a preliminary assessment of twelve previously proposed methods for clustering scRNA-Seq data, and selected for the final assessment nine methods that had consistently high accuracy as described in the Results section. Our assessment also did a preliminary analysis of twenty four methods based on the TF-IDF transformation, out of which we selected nineteen methods for inclusion in the final comparison. A summary of the compared methods is given in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>. We next describe the common data processing employed for all methods, then give details of individual methods.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Compared scRNA-Seq clustering methods. *For Seurat, QC and gene selection were carried out as suggested in [<xref ref-type="bibr" rid="CR4">4</xref>]</p></caption><graphic xlink:href="12864_2018_4922_Fig1_HTML" id="MO1"/></fig></p><p>Synthetic datasets comprised of two to seven cell types mixed in different proportions were generated as described below using 3<sup>&#x02032;</sup>-end scRNA-Seq data generated using the 10x Genomics platform from FACS sorted immune cells [<xref ref-type="bibr" rid="CR2">2</xref>]. For experiments on these mixtures all methods take as input the raw <italic>Unique Molecular Identifier (UMI)</italic> counts generated using 10x Genomics&#x02019; CellRanger pipeline for each gene and cell as described in [<xref ref-type="bibr" rid="CR2">2</xref>]. Using UMI counts rather than read counts reduces bias introduced by PCR amplification in scRNA-Seq protocols. For all 10x Genomics datasets we first filtered the cells based on the number of detected genes and the total UMI count per cell [<xref ref-type="bibr" rid="CR3">3</xref>]. We also removed outliers based on the median-absolute-deviation (MAD) of cell distances from the centroid of the corresponding cell type. We also performed basic gene quality control by applying a cutoff on the minimum total UMI count per gene across all cells and removing outliers based on MAD. For Seurat [<xref ref-type="bibr" rid="CR4">4</xref>], the cell and gene quality control was performed as recommended by the authors and described below.</p><p>A second test dataset consisted of scRNA-seq data generated using the Smart-seq2 protocol from seven types of pancreatic cells [<xref ref-type="bibr" rid="CR5">5</xref>]. For this dataset clustering was performed twice, once using <italic>Reads Per Kilobase per Million (RPKM)</italic> estimates and once using raw read counts reported in [<xref ref-type="bibr" rid="CR5">5</xref>]. No cell QC was performed for this set. The same gene QC as described above for 10x UMI data was performed; again for Seurat, the recommended defaults for gene quality control and selection were applied.</p><p>For all methods, we determine an &#x02018;optimal&#x02019; number of clusters using the gap statistic approach introduced in [<xref ref-type="bibr" rid="CR6">6</xref>]. Briefly, the optimal number of clusters is selected as argmax<sub><italic>k</italic></sub>Gap<sub><italic>n</italic></sub>(<italic>k</italic>), where the gap statistic for clustering <italic>n</italic> points into <italic>k</italic> clusters is given by 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{Gap}_{n}(k) = E_{n}^{*}\{\log W_{k}\} - \log W_{k},  $$ \end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mtext>Gap</mml:mtext></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup><mml:mo>{</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12864_2018_4922_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p><p>i.e., the difference between the logarithm of the normalized sum <italic>W</italic><sub><italic>k</italic></sub> of pairwise distances in the <italic>k</italic> clusters and its expectation under a null reference distribution generated by Monte Carlo sampling. The gap statistic analysis was independently performed for each transformation applied to the data (log-transform, PCA, tSNE, TF-IDF, etc.) as the gap statistics, and hence the optimal number of clusters, are sensitive to these transformations (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>). The gap statistic based estimate was used to directly specify the number of clusters for all methods except <italic>Seurat, Seurat_SNN</italic> and graph-based clustering algorithms, which determine the number of clusters internally.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Clockwise from top left: gap statistics for log-transformed, log-transformed PCA, tSNE, and TF-IDF transformed and binarized expression levels of a 7:1 mixture of regulatory_t and naive_t cells. The x-axis gives the number of clusters K and the y-axis gives the gap statistic in (<xref rid="Equ1" ref-type="">1</xref>)</p></caption><graphic xlink:href="12864_2018_4922_Fig2_HTML" id="MO2"/></fig></p><p>When the number of clusters determined by <italic>Seurat_SNN</italic> and graph-based clustering algorithms was lower than the gap statistic estimate additional partitioning steps were performed as described below to enforce a minimum number of clusters.</p><sec id="Sec3"><title>Existing scRNA-Seq clustering methods</title><p>We included in our comparison several commonly used methods. First, we included two methods from the Seurat package [<xref ref-type="bibr" rid="CR4">4</xref>], one based on K-means and one based on graph clustering. Following the Granatum pipeline [<xref ref-type="bibr" rid="CR7">7</xref>], we included K-means and hierarchical clustering with Euclidean and Pearson distances based on a 2-dimensional projection of the data using the <italic>t-distributed Stochastic Neighbor Embedding (tSNE)</italic> transformation [<xref ref-type="bibr" rid="CR8">8</xref>]. Also from Granatum, we tested K-means using the log2(x+1) transformed data. Using the log2(x+1) transform of the data followed by PCA, we tested a Gaussian mixture model (GMM) based algorithm, a K-means algorithm similar to that implemented in the CellRanger pipeline distributed by 10x Genomics [<xref ref-type="bibr" rid="CR9">9</xref>], as well as spherical K-means and hierarchical clustering algorithms, again with both Euclidean and Pearson correlation distances. Finally, similar to the graph-based algorithms implemented in the latest version of the CellRanger pipeline [<xref ref-type="bibr" rid="CR9">9</xref>], we tested the graph-based Louvain clustering algorithm [<xref ref-type="bibr" rid="CR10">10</xref>] with Euclidean distance over log2(x+1) transformed data. Details on individual methods are as follows.</p><sec id="Sec4"><title>Seurat, Seurat_SNN</title><p>To test Seurat, we followed the guided clustering workflow recommended in the tutorial at [<xref ref-type="bibr" rid="CR11">11</xref>] by first applying the recommended cell quality filtering based on the number of detected genes, minimum 200 per cell, and percentage of reads from mitochondrial genes. Then, as recommended by Seurat&#x02019;s authors, we &#x02018;regressed out&#x02019; uninteresting sources of variation such as technical noise and batch effects. As suggested in [<xref ref-type="bibr" rid="CR12">12</xref>], regressing out these effects improves downstream dimensionality reduction and clustering. We then used Seurat&#x02019;s MeanVarPlot() with its default values to identify genes that are outliers on the &#x02018;mean variability plot&#x02019; as recommended by Seurat&#x02019;s authors. After selecting highly variable genes and performing PCA analysis, we used Seurat&#x02019;s DOKMeans() function which performs K-means clustering on both genes and cells; we refer to this method as <italic>Seurat</italic> in the Results section. We also used the FindClusters() function which uses the top principal components and identifies clusters of cells by a shared nearest neighbor (SNN) modularity optimization based clustering algorithm that first calculates k-nearest neighbors and constructs the SNN graph, then optimizes the modularity function to determine clusters; this method is referred to as <italic>Seurat_SNN</italic>.</p></sec><sec id="Sec5"><title>Gaussian mixture model based clustering (Log_PCA_GMM)</title><p>We used the mclust R package [<xref ref-type="bibr" rid="CR13">13</xref>] to perform clustering by fitting a finite Gaussian Mixture Model (GMM) using expectation-maximization. We first performed Principal Component Analysis (PCA) of the log2(x+1) transformed UMI count matrix and ran mclust on the top 10 principal components.</p></sec><sec id="Sec6"><title>K-means clustering variants (Log_Kmeans, Log_PCA_Kmeans, tSNE_Kmeans)</title><p>K-means clustering [<xref ref-type="bibr" rid="CR14">14</xref>] aims to partition <italic>n</italic> points (cells in our case) into <italic>k</italic> clusters such that the total intra-cluster variance is minimized. Motivated by the similar clustering option provided in the Granatum pipeline from [<xref ref-type="bibr" rid="CR7">7</xref>] we included in the comparison a K-means variant (called <italic>Log_Kmeans</italic>) that takes as input the log2(x+1) transformed UMI counts. We also followed an approach similar to that adopted in the CellRanger pipeline distributed by 10x Genomics [<xref ref-type="bibr" rid="CR9">9</xref>], referred to as <italic>Log_PCA_Kmeans</italic>, in which the PCA is run on the log2(x+1) transformed UMI counts and K-means clustering is performed on the first 10 principal components. Finally, and again motivated by the Granatum pipeline from [<xref ref-type="bibr" rid="CR7">7</xref>], we included a K-means variant run on the 2-dimensional tSNE transformation of the data (<italic>tSNE_Kmeans</italic>).</p></sec><sec id="Sec7"><title>Spherical K-means with log transform and PCA (Log_PCA_sKmeans)</title><p>In this method we used the spherical K-means algorithm [<xref ref-type="bibr" rid="CR15">15</xref>] to cluster the log2(x+1) and PCA transformed data. Instead of Euclidean distance, spherical K-means employs the <italic>cosine dissimilarity</italic>, 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ 1-\cos(\theta) =1 - {\frac {\sum\limits_{i=1}^{n}{A_{i}B_{i}}}{{\sqrt {\sum\limits_{i=1}^{n}{A_{i}^{2}}}}{\sqrt {\sum\limits_{i=1}^{n}{B_{i}^{2}}}}}}  $$ \end{document}</tex-math><mml:math id="M4"><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mo>cos</mml:mo><mml:mo>(</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12864_2018_4922_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p><p>based on the angle between two feature vectors <italic>A</italic> and <italic>B</italic>, which has been shown to be more robust to large differences in total vector weights. We added this method here as we wanted to compare its performance with the spherical K-means applied to TF-IDF transformed data described in next subsection.</p></sec><sec id="Sec8"><title>Hierarchical clustering variants (Log_PCA_HC_E, Log_PCA_HC_P, tSNE_HC_E, tSNE_HC_P)</title><p>Agglomerative hierarchical clustering is a &#x0201c;bottom up&#x0201d; approach: each observation starts in its own cluster, and pairs of clusters are iteratively merged based on inter-cluster distances. Ward&#x02019;s method [<xref ref-type="bibr" rid="CR16">16</xref>] was used as linkage criterion. We included in the comparison four variants of hierarchical clustering, in which the algorithm was run using Euclidean and Pearson correlation distances on either the first 10 principal components of the log2(x+1) UMI counts (methods referred to as <italic>Log_PCA_HC_E</italic> and <italic>Log_PCA_HC_P</italic>, respectively), or on the 2-dimensional tSNE transformation of the data as in [<xref ref-type="bibr" rid="CR7">7</xref>] (<italic>tSNE_HC_E</italic> and <italic>tSNE_HC_P</italic>).</p></sec><sec id="Sec9"><title>Graph based Louvain clustering algorithm (Log_Louvain_E)</title><p>We also included in our comparison a graph-based Louvain clustering algorithm similar to that provided by the current version of the CellRanger pipeline distributed by 10x Genomics [<xref ref-type="bibr" rid="CR9">9</xref>]. This method takes as input the log2(x+1) transformed UMI counts and builds a graph by connecting pairs of cells with Euclidean pairwise distance above a certain threshold. For our experiments we scaled the distance values to the range 0 to 1 and set a cutoff of 0.01 to build a rather dense but weighted graph. We then apply the Louvain for modularity optimization [<xref ref-type="bibr" rid="CR10">10</xref>] as implemented in igraph R [<xref ref-type="bibr" rid="CR17">17</xref>] package to identify communities (clusters) of cells.</p><p>Different from our method, the CellRanger pipeline implements Louvain modularity optimization on a sparse nearest-neighbor graph, where each cell is linked to its k nearest Euclidean neighbors, where k is set to scale logarithmically with the number of cells. CellRanger&#x02019;s implementation also includes an additional cluster-merging step which consists of hierarchical clustering on the cluster-medoids in PCA space followed by merging of sibling clusters with no differentially expressed genes at an FDR of 0.05; such a step was not included in our implementation.</p></sec></sec><sec id="Sec10"><title>TF-IDF scoring</title><p>TF-IDF, which stands for <italic>Term Frequency times Inverse Document Frequency</italic>, is a data transformation and a scoring scheme typically used in text analyses for measuring whether or not and how concentrated into relatively few documents the occurrences of a given word are [<xref ref-type="bibr" rid="CR18">18</xref>]. Given a collection of <italic>N</italic> documents, let <italic>f</italic><sub><italic>ij</italic></sub> be the number of occurrences of word <italic>i</italic> in document <italic>j</italic>. The <italic>term frequency</italic> of word <italic>i</italic> in document <italic>j</italic>, denoted by <italic>TF</italic><sub><italic>ij</italic></sub>, is defined as 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ TF_{ij} = f_{ij} / \max_{k} f_{kj}  $$ \end{document}</tex-math><mml:math id="M6"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">kj</mml:mtext></mml:mrow></mml:msub></mml:math><graphic xlink:href="12864_2018_4922_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p><p>Here, the term frequency of word <italic>i</italic> in document <italic>j</italic> is the number of occurrences normalized by dividing it by the maximum number of occurrences of any word in the same document, sometimes this is done after excluding stop words. The normalization is needed to make it possible to compare term frequencies for documents of different lengths. After normalization, the most frequent word in a document always gets a term frequency value of 1, while other words get fractional values as their respective term frequencies. The <italic>Inverse Document Frequency</italic> of word <italic>i</italic> is defined as 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ IDF_{i} = \log_{2} (N/n_{i}).  $$ \end{document}</tex-math><mml:math id="M8"><mml:mtext mathvariant="italic">ID</mml:mtext><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12864_2018_4922_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p><p>where <italic>n</italic><sub><italic>i</italic></sub> denotes the number documents that contain word <italic>i</italic> among the <italic>N</italic> documents in the collection. Finally, the <italic>TF-IDF score</italic> for word <italic>i</italic> in document <italic>j</italic> is defined to be <italic>TF</italic><sub><italic>ij</italic></sub>&#x000d7;<italic>IDF</italic><sub><italic>i</italic></sub>. Words with the highest TF-IDF score in a document are often the terms that best characterize the topic of that document.</p><p>To apply TF-IDF scores for scRNA-Seq data we consider the cells to be analogous to documents; in this analogy, genes correspond to words and UMI counts replace word counts. The TF-IDF scores can then be computed from UMI counts using Eqs. (<xref rid="Equ3" ref-type="">3</xref>) and (<xref rid="Equ4" ref-type="">4</xref>). Similar to document analysis, the genes with highest TF-IDF scores in a cell are expected to provide most information about the cell&#x02019;s type.</p><p>We explored two different approaches of using TF-IDF scores for scRNA-Seq clustering. In first approach TF-IDF scores were used to select a subset of the most informative genes that were then used for performing clustering. In the second approach all genes are used for clustering but the gene expression data was first binarized based on a TF-IDF cutoff. Each of these data transformations were combined with a number of clustering algorithms, as detailed in the following two subsections.</p></sec><sec id="Sec11"><title>scRNA-Seq clustering based on TF-IDF gene selection</title><p>We tested two alternatives methods for TF-IDF based gene selection: using the genes with highest TF-IDF average and using the genes with highest variability in TF-IDF values.</p><p>In the first method, referred to as <italic>Top</italic>, we fitted a 2-mixture GMM model to the distribution of TF-IDF gene averages using mclust, and selected the genes assigned to the mixture component with highest mean. In case this resulted in a list of more than 3000 genes, we retained only the top 3000 genes when ranking the genes based on the number cells in which they are detected.</p><p>In the second method, referred to as <italic>Var</italic>, we identified genes with high TF-IDF variability by analyzing the relationship between the coefficient of variation (CV) and average expression levels as described in [<xref ref-type="bibr" rid="CR19">19</xref>]. We first computed for each gene the sample TF-IDF mean and coefficient of variation <italic>CV</italic>, which is a standardized measure of dispersion. We then fitted a regression line for the observed pairs of mean/<italic>CV</italic> values (plotted on log-log scale in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>). Finally, we computed for each gene the difference between the observed <italic>CV</italic> and the <italic>CV</italic> expected for the observed mean based on the regression line, and retained for clustering analysis only the top 30% of the genes ranked by this difference (shown in yellow in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Highly variable genes for a 1:1 mixture of b_cells and cd14_monocytes</p></caption><graphic xlink:href="12864_2018_4922_Fig3_HTML" id="MO3"/></fig></p><p>After applying the TF-IDF transform to the UMI count matrix and performing gene selection using the above two methods, clustering was performed using one of the following algorithms: <italic>Gaussian mixture model based clustering (TF-IDF_Top_GMM, TF-IDF_Var_GMM).</italic> The expectation-maximization clustering algorithm implemented in the mclust R package [<xref ref-type="bibr" rid="CR13">13</xref>] was applied to the TF-IDF scores of genes selected using the <italic>Top</italic>, respectively <italic>Var</italic> methods. <italic>K-means (TF-IDF_Top_Kmeans, TF-IDF_Var_Kmeans).</italic> Similarly, we applied K-means clustering to the TF-IDF scores of genes selected using either <italic>Top</italic> or <italic>Var</italic>. <italic>Spherical K-means (TF-IDF_Top_sKmeans, TF-IDF_Var_sKmeans).</italic> We also used the spherical K-means algorithm [<xref ref-type="bibr" rid="CR15">15</xref>] on TF-IDF scores of genes selected using <italic>Top</italic>, respectively <italic>Var</italic>. <italic>Hierarchical clustering (TF-IDF_Top_HC_E, TF-IDF_Top_HC_P, TF-IDF_Top_HC_C, TF-IDF_Var_HC_E, TF-IDF_Var_HC_P, TF-IDF_Var_HC_C).</italic> Finally, we performed hierarchical clustering with Ward aggregation on the TF-IDF scores of selected genes using Euclidean, Pearson correlation, as well as cosine distance (<xref rid="Equ2" ref-type="">2</xref>) &#x02013; the latter metric was included as it is often employed in conjunction with TF-IDF for text analysis [<xref ref-type="bibr" rid="CR20">20</xref>].</p></sec><sec id="Sec12"><title>scRNA-Seq clustering using TF-IDF based binarization</title><p>The distribution of mean TF-IDF scores of the genes (plotted for a mix of 1,000 memory and 1,000 regulatory T cells in the left panel of Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>) typically exhibits a long tail. The genes with very high mean TF-IDF scores are potentially the most informative in identifying the underlying cell types. The final group of TF-IDF based methods uses this intuition by binarizing the gene expression data. We first selected a suitable TF-IDF cutoff and then, for each cell, we set the <italic>expression signature</italic> of all genes with a TF-IDF above the cutoff to 1, and all remaining signatures to 0. Cells sharing the same type are expected to have highly similar 0/1 expression signature vectors. By setting to 1 only the &#x02018;informative&#x02019; genes in each cell we aim to remove unnecessary noise and achieve better clustering accuracy. Although the choice of TF-IDF cutoff can affect the clustering accuracy, as shown in the right side of Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>) for a sample cell mixture, near maximum accuracy is achieved by using a cutoff value equal to 0.1 &#x000d7; the mean of the per-cell non-zero TF-IDF values. All experimental results presented in the Results section are based on this cutoff.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Left: Distribution of TF-IDF gene averages for a 1:1 mixture of memory and regulatory T cells. Right: Binarization cutoff effect on macro accuracy of TF-IDF_Bin_HC_C method on the same cell mixture</p></caption><graphic xlink:href="12864_2018_4922_Fig4_HTML" id="MO4"/></fig></p><p>The resulting binary expression signatures were then clustered using one of the following algorithms: <italic>Hierarchical clustering with Euclidean, Pearson, cosine and Jaccard distances (TF-IDF_Bin_HC_E, TF-IDF_Bin_HC_P, TF-IDF_Bin_HC_C, TF-IDF_Bin_HC_J).</italic> Hierarchical clustering with Ward aggregation was applied to the binarized TF-IDF expression signature vectors using Euclidean, Pearson correlation, and cosine distances (<xref rid="Equ2" ref-type="">2</xref>), respectively, to compare with the previous variations of hierarchical clustering based on the same distances. Additionally, we performed hierarchical clustering with Ward aggregation using the <italic>Jaccard distance</italic> to measure dissimilarity between cells. This is defined as 1 - Jaccard similarity, where the <italic>Jaccard similarity</italic> between two cells is computed as the number of genes with a signature of 1 in both cells divided by the number of genes with a signatures of 1 in at least one of the cells. <italic>TF-IDF graph-based greedy clustering with Euclidean, Pearson, cosine and Jaccard distances (TF-IDF_Bin_Greedy_E, TF-IDF_Bin_Greedy_P, TF-IDF_Bin_Greedy_C, TF-IDF_Bin_Greedy_J).</italic> In these methods we begin by building an undirected graph with cells as the vertices and edges connecting pairs of cells for which the binarized expression signature vectors have Euclidean, Pearson, cosine, or Jaccard distance below a certain cutoff value. For our experiments we set a rather low cutoff of 0.01 to to build a dense graph, but weighted the edges of this graph by the corresponding pairwise similarity measures for clustering by greedy modularity optimization, which was performed using the algorithm introduced in [<xref ref-type="bibr" rid="CR21">21</xref>] and implemented in the cluster_fast_greedy() function of the igraph R package [<xref ref-type="bibr" rid="CR17">17</xref>]. To ensure the homogeneity of resulting clusters and to force a minimum number of clusters when required, all clusters with a silhouette score below a given threshold were subjected to further partitioning. All cells in such a cluster were used to form a new gene expression matrix which was subjected to TF-IDF transformation, binarization, and then clustering via the greedy modularity optimization algorithm. The process was repeated until the minimum number of clusters was achieved, or no cluster had a silhouette score below the given threshold. <italic>TF-IDF graph-based Louvain clustering with Euclidean, Pearson, cosine and Jaccard distances (TF-IDF_Bin_Louvain_E, TF-IDF_Bin_Louvain_P, TF-IDF_Bin_Louvain_C, TF-IDF_Bin_Louvain_J).</italic> Here, the same approach described above for graph-based greedy clustering was used in conjunction with the Louvain modularity optimization algorithm [<xref ref-type="bibr" rid="CR10">10</xref>] as implemented in the cluster_louvain() function of the igraph R package [<xref ref-type="bibr" rid="CR17">17</xref>].</p></sec><sec id="Sec13"><title>Experimental setup</title><sec id="Sec14"><title>Datasets</title><p>To assess the accuracy of compared clustering methods we used synthetic mixtures of real scRNA-Seq profiles generated from FACS sorted immune cells using the 10x Genomics platform [<xref ref-type="bibr" rid="CR2">2</xref>]. We started from the filtered UMI count matrices generated using the CellRanger pipeline and made publicly available at <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link>. Of the available sorted cell populations we excluded those shown to have substantial heterogeneity in [<xref ref-type="bibr" rid="CR2">2</xref>]. This left us with seven cell types: CD4+/CD25+ Regulatory Cells (regulatory_t), CD4+/CD45RO+ Memory Cells (memory_t), CD19+ B Cells (b_cells), CD14+ Monocytes (cd14_monocytes), CD56+ Natural Killer Cells (cd56_nk), CD8+/CD45RA+ Naive Cytotoxic T Cells(naive_cytotoxic), and CD4+/CD45RA+/CD25- Naive T cells (naive_t). The hierarchical clustering dendrogram based on Pearson correlations between mean gene expression levels of the seven cell types along with a 3-dimensional PCA projection of the individual scRNA-Seq profiles are shown in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Left: Correlation distances between mean expression levels of 7 immune cell types from [<xref ref-type="bibr" rid="CR2">2</xref>]. Right: 3D PCA plot of 1000 cells of each type</p></caption><graphic xlink:href="12864_2018_4922_Fig5_HTML" id="MO5"/></fig></p><p>Clearly, B cells, NK cells and monocytes are relatively dissimilar to each other and to the four T cell types, which in turn form two highly similar pairs (memory_t and naive_cytotoxic) and (regulatory_t and naive_t) and pairs with intermediate dissimilarity like (memory_t and naive_t) and (regulatory_t and naive_cytotoxic). Thus, in a first set of experiments, we focused on mixtures of cells generated from six pairs of cell types of varying degrees of dissimilarity. We chose pairs (b_cells and cd14_monocytes) and (b_cells and cd56_nk) to represent mixtures of highly dissimilar cell types, pairs (memory_t and naive_cytotoxic) and (regulatory_t and naive_t) to represent mixtures of highly similar cell types, and pairs(memory_t and naive_t) and (regulatory_t and naive_cytotoxic) to represent mixtures of cell types with intermediate similarity. To assess clustering accuracy in the presence of different levels of imbalance between the numbers of cells of different types, for each of the six pairs of cell types we generated mixtures in ratios 7:1, 3:1, 1:1, 1:3, and 1:7. For each mixture ratio, we sampled a total of 1,000 cells from the corresponding cell types. Finally, to assess accuracy on a more complex cell population, we generated mixtures comprised of 7,000 cells sampled from all seven cell types in equal proportions.</p><p>We also tested the implemented methods on scRNA-Seq data from [<xref ref-type="bibr" rid="CR5">5</xref>]. For this dataset, cells from pancreatic islets were dissociated and sorted by FACS into 384-well plates. Single-cell RNA-seq libraries were generated using the Smart-seq2 protocol and sequenced on an Illumina HiSeq 2000. We used all 2,045 cells annotated with one of seven cell types (185 acinar cells, 886 alpha cells, 270 beta cells, 197 gamma cells, 114 delta cells, 386 ductal cells, and 7 epsilon cells) identified based on known gene markers in [<xref ref-type="bibr" rid="CR5">5</xref>]. For this dataset we included all cells without any quality filtering to reflect as close as possible the natural frequency of these cell types in pancreatic islets. As in [<xref ref-type="bibr" rid="CR22">22</xref>], marker genes with unusually high expression levels (INS for beta cells, GCG for alpha cells, SST for delta cells, PPY for PP/gamma cells, and GHRL for epsilon cells) were removed prior to clustering to eliminate the possibility that they drive the clustering by themselves. A hierarchical clustering dendrogram based on the Pearson correlation between mean gene expression levels of the seven cell types and a 3-dimensional PCA projection of the individual scRNA-Seq profiles are shown in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Left: Correlation distances between mean expression levels of 7 pancreatic island cell types from [<xref ref-type="bibr" rid="CR5">5</xref>]. Right: 3D PCA plot of the 2045 pancreatic island cells</p></caption><graphic xlink:href="12864_2018_4922_Fig6_HTML" id="MO6"/></fig></p></sec><sec id="Sec15"><title>Accuracy measures</title><p>For each dataset we computed macro- and micro-accuracy measures [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>] defined by: 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \emph {Micro Accuracy} = {\sum_{i=1}^{K}C_{i}} / {\sum_{i=1}^{K}N_{i}}  $$ \end{document}</tex-math><mml:math id="M10"><mml:mtext>Micro Accuracy</mml:mtext><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="12864_2018_4922_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p><p>
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \emph {Macro Accuracy} = \frac{1}{K} \sum_{i=1}^{K} \frac{C_{i}}{N_{i}}  $$ \end{document}</tex-math><mml:math id="M12"><mml:mtext>Macro Accuracy</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12864_2018_4922_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>
</p><p>where <italic>K</italic> is the number of classes, <italic>N</italic><sub><italic>i</italic></sub> is the number of samples in class <italic>i</italic>, and <italic>C</italic><sub><italic>i</italic></sub> is the number of correctly labeled samples in class <italic>i</italic>. Note that macro- and micro-accuracy are identical for 1:1 mixtures, but may differ significantly for imbalanced datasets, as macro-averaging gives equal weight to the accuracy of each class (average accuracy of all classes&#x02019; accuracies), whereas micro-averaging gives equal weight to each cell classification decision (overall accuracy). The ground truth was based on the cell sorting information and annotations from [<xref ref-type="bibr" rid="CR2">2</xref>] and [<xref ref-type="bibr" rid="CR5">5</xref>].</p><p>For methods that identified more clusters than expected (more than two clusters for the 2-class experiments or more than seven for the 7-class mixtures), we used majority based matching to label clusters with cell types. For example, if a predicted cluster has <italic>x</italic> cells labeled as cell type C1 in the ground truth and <italic>y</italic> cells labeled as cell type C2, then all cells are assumed to be predicted as cell type C1 for relevant accuracy calculations when <italic>x</italic>&#x0003e;<italic>y</italic>. This approach ensures that methods that are more sensitive to the existing heterogeneity within the true cell types are not penalized as long as the resulting sub-clusters are &#x0201c;pure&#x0201d;, i.e., all or most cells of that sub-cluster belong to only one of the cell types contributing to the mixture. All datasets used in the paper along with a Shiny application that performs accuracy calculations for user uploaded clustering results are available at <ext-link ext-link-type="uri" xlink:href="http://cnv1.engr.uconn.edu:3838/SCA/">http://cnv1.engr.uconn.edu:3838/SCA/</ext-link>.</p></sec></sec></sec><sec id="Sec16"><title>Results and discussion</title><p>Each of the 36 clustering algorithms described in the Methods section was run on 2-class synthetic mixtures of 1,000 cells sampled in different ratios from six pairs of immune cell types as described in Experimental setup. For each combination of cell types and mixture ratio we repeated each experiment five times and computed the macro- and micro-accuracy using Eqs. (<xref rid="Equ5" ref-type="">5</xref>)-(<xref rid="Equ6" ref-type="">6</xref>). Box-and-whiskers plots displaying the macro- and micro-accuracies of the compared algorithms, grouped into three categories (existing methods, algorithms using TF-IDF based gene selection, and algorithms using TF-IDF binarization), are shown in Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>. Each plot shows the median of the corresponding measure as the middle horizontal line, along with mean values as the middle points connected by lines across methods. The whiskers indicate the extreme non-outlier data points of the upper and lower quartiles. If present, outliers, i.e., data points that lie more than 1.5 interquartile ranges below the first quartile or above the third quartile, are indicated as single points on the plot.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Micro and macro accuracy on 2-class synthetic mixtures of immune cells with ratios 1:1, 1:3/3:1, and 1:7/7:1 for (<bold>a</bold>) existing methods, (<bold>b</bold>) algorithms using TF-IDF based gene selection, and (<bold>c</bold>) algorithms using TF-IDF binarization</p></caption><graphic xlink:href="12864_2018_4922_Fig7_HTML" id="MO7"/></fig></p><p>Overall, algorithms using TF-IDF binarization have consistently high accuracy in all 2-class experiments, with existing methods and algorithms using TF-IDF based gene selection showing a higher degree of variability in accuracy across datasets. For remaining results we eliminated 8 methods that show consistently lower clustering accuracy in the 2-class experiments. Specifically, from the existing methods group we removed from further analysis tSNE_HC_P, Log_Kmeans, and Log_PCA_sKmeans, all of which have both macro and micro-accuracy averages below 0.8. From the group of methods using TF-IDF based gene selection we removed the two GMM methods (TF-IDF_Top_GMM and TF-IDF_Var_GMM), which clearly performed much worse than the rest. We also removed the three hierarchical clustering methods using genes with highly variable TF-IDF scores (TF-IDF_Var_HC_E, TF-IDF_Var_HC_P, TF-IDF_Var_HC_C) since their accuracy is worse than the corresponding methods that use the genes with top average TF-IDF score. All twelve algorithms using TF-IDF binarization were retained for further in-depth comparisons.</p><p>Box-and-whiskers plots displaying the macro- and micro-accuracies of the 28 remaining algorithms on 2-class synthetic mixtures with varying mixture ratios are shown in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>. Among existing methods, the Log_PCA_GMM EM-based algorithm and Seurat_SNN have highest average macro and micro-accuracies, with Log_PCA_GMM having an edge in average accuracies on the more balanced 1:1 and 1:3/3:1 mixtures, and Seurat_SNN yielding slightly better macro-accuracy for the more imbalanced 1:7/7:1 mixtures. However, several TF-IDF based clustering methods achieve higher overall average macro- and micro-accuracies for all mixture ratios, with TF-IDF_Bin_Louvain_C, TF-IDF_Bin_Louvain_P and TF-IDF_Top_sKmeans scoring the highest. For imbalanced mixtures, the micro-accuracy is usually lower than but closely tracks macro-accuracy, generally preserving the relative performance of the compared methods.
<fig id="Fig8"><label>Fig. 8</label><caption><p>Micro and macro accuracies on 2-class synthetic mixtures with ratios 1:1 (<bold>a</bold>), 1:3/3:1 (<bold>b</bold>), and 1:7/7:1 (<bold>c</bold>)</p></caption><graphic xlink:href="12864_2018_4922_Fig8_HTML" id="MO8"/></fig></p><p>Plots displaying the macro- and micro-accuracies of the 28 methods grouped by the level of similarity of the two cell types in the mixtures are given in Fig.&#x000a0;<xref rid="Fig9" ref-type="fig">9</xref>. As expected, all methods have very high clustering accuracy on mixtures of highly dissimilar cell types. The accuracy is generally lower on mixtures of cell types with intermediate similarity, and lower still on mixtures of highly similar cell types. Algorithms based on TF-IDF binarization perform among the best on all types of mixtures, with TF-IDF_Bin_Louvain_C and TF-IDF_Bin_Louvain_P showing most consistent performance. The TF-IDF_Top_sKmeans algorithm is best-performing within the group of algorithms using TF-IDF based gene selection, with only slightly lower performance than TF-IDF_Bin_Louvain_C and TF-IDF_Bin_Louvain_P on mixtures of highly similar pairs.
<fig id="Fig9"><label>Fig. 9</label><caption><p>Micro- and macro-accuracies for synthetic mixtures with ratios 1:1, 1:3/3:1, and 1:7/7:1 simulated from (<bold>a</bold>) highly dissimilar cell type pairs (cd14_monocytes,b_cells) and (cd56_nk,b_cells), (<bold>b</bold>) intermediate similarity cell type pairs (regulatory_t,naive_cytotoxic) and (memory_t,naive_t), and (<bold>c</bold>) highly similar cell type pairs (regulatory_t,naive_t) and (memory_t,naive_cytotoxic)</p></caption><graphic xlink:href="12864_2018_4922_Fig9_HTML" id="MO9"/></fig></p><p>To assess the effect of increased population complexity on accuracy, we also ran the 28 methods on equal-proportion mixtures consisting of all seven immune cell types from [<xref ref-type="bibr" rid="CR2">2</xref>]. The accuracies achieved for each cell type are shown in Fig.&#x000a0;<xref rid="Fig10" ref-type="fig">10</xref>. Since the cell types were mixed in equal proportions in this experiment, the macro- and micro-accuracy of each method are equal to the average accuracy over all cell types, and hence proportional to the total length of the horizontal bars in the figure. These mixtures contain both highly similar and highly dissimilar cell types, and several methods end up assigning highly similar cell types to a single cluster, resulting in significantly reduced accuracy for some of the cell types. TF-IDF_Bin_Louvain_C is least affected by such miss-assignments, achieving the best overall accuracy.
<fig id="Fig10"><label>Fig. 10</label><caption><p>Accuracy for equal-proportion 7-way mixtures of immune cell types (1000 cells each)</p></caption><graphic xlink:href="12864_2018_4922_Fig10_HTML" id="MO10"/></fig></p><p>Figures&#x000a0;<xref rid="Fig11" ref-type="fig">11</xref> and <xref rid="Fig12" ref-type="fig">12</xref> show the accuracy per cell type for experiments on the scRNA-Seq dataset from [<xref ref-type="bibr" rid="CR5">5</xref>], consisting of 2,045 pancreatic islet cells annotated with one of seven cell types. Since cell type abundances in this dataset reflect their natural frequency in pancreatic islets, the total length of the horizontal bars in the figure is proportional with the macro-accuracy (but not necessarily micro-accuracy) of each method. Two sets of results are presented, one based on raw counts and one based on RPKM values in [<xref ref-type="bibr" rid="CR5">5</xref>]. The relative performance of the compared methods on this dataset is quite different from that on the 7-way mixture in Fig.&#x000a0;<xref rid="Fig10" ref-type="fig">10</xref>, underscoring the fact that the performance of clustering algorithms is highly dependent on specific aspects of each dataset. The relative performance is also dependent on the metric used, with raw counts yielding a quite different ranking of methods compared to RPKMs.
<fig id="Fig11"><label>Fig. 11</label><caption><p>Accuracy for pancreatic cells based on raw counts</p></caption><graphic xlink:href="12864_2018_4922_Fig11_HTML" id="MO11"/></fig>
<fig id="Fig12"><label>Fig. 12</label><caption><p>Accuracy for pancreatic cells based on the RPKM values</p></caption><graphic xlink:href="12864_2018_4922_Fig12_HTML" id="MO12"/></fig></p><p>Tables&#x000a0;<xref rid="Tab1" ref-type="table">1</xref> and <xref rid="Tab2" ref-type="table">2</xref> summarizes the results of all experiments by giving the average rank (among the 28 selected methods) achieved on each dataset based on macro-, respectively micro-accuracy, along with overall rank averages that give equal weight to each dataset. TF-IDF_Bin_Louvain_C has the lowest overall average rank with respect to both macro- and micro-accuracy. The next three best performers with respect to overall average rank for both macro- and micro-accuracy are all based on the TF-IDF transform as well (in order, TF-IDF_Bin_Louvain_P, TF-IDF_Bin_Louvain_E, and TF-IDF_Top_sKmeans), with TF-IDF_Bin_Greedy_P coming fifth in macro-accuracy overall average rank (Log_PCA_GMM takes fifth place for micro-accuracy average rank).
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Average ranks based on micro-accuracy</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Methods</th><th align="left">M Nc</th><th align="left">R N</th><th align="left">M N</th><th align="left">R Nc</th><th align="left">B Nk</th><th align="left">B Mc</th><th align="left">7-class</th><th align="left">Pancreas</th><th align="left">Avg.</th></tr></thead><tbody><tr><td align="left">Seurat</td><td align="left">14.6</td><td align="left">19.0</td><td align="left">25.0</td><td align="left">25.6</td><td align="left">
<bold>1.0</bold>
</td><td align="left">25.6</td><td align="left">28.0</td><td align="left">
<bold>4.0</bold>
</td><td align="left">17.9</td></tr><tr><td align="left">Seurat_SNN</td><td align="left">6.8</td><td align="left">13.8</td><td align="left">21.0</td><td align="left">18.4</td><td align="left">
<bold>1.0</bold>
</td><td align="left">25.6</td><td align="left">26.6</td><td align="left">
<bold>1.0</bold>
</td><td align="left">14.3</td></tr><tr><td align="left">tSNE_Kmeans</td><td align="left">26.0</td><td align="left">27.0</td><td align="left">14.6</td><td align="left">18.6</td><td align="left">22.6</td><td align="left">27.8</td><td align="left">11.4</td><td align="left">19.5</td><td align="left">20.9</td></tr><tr><td align="left">tSNE_HC_E</td><td align="left">25.0</td><td align="left">25.4</td><td align="left">12.6</td><td align="left">18.0</td><td align="left">6.0</td><td align="left">11.2</td><td align="left">10.0</td><td align="left">20.0</td><td align="left">16.0</td></tr><tr><td align="left">Log_PCA_GMM</td><td align="left">20.8</td><td align="left">10.6</td><td align="left">
<bold>2.4</bold>
</td><td align="left">12.8</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>4.4</bold>
</td><td align="left">14.5</td><td align="left">8.4</td></tr><tr><td align="left">Log_PCA_Kmeans</td><td align="left">24.4</td><td align="left">24.4</td><td align="left">26.4</td><td align="left">26.8</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">7.6</td><td align="left">14.0</td><td align="left">15.7</td></tr><tr><td align="left">Log_PCA_HC_E</td><td align="left">23.8</td><td align="left">22.8</td><td align="left">22.6</td><td align="left">23.8</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>4.6</bold>
</td><td align="left">14.0</td><td align="left">14.2</td></tr><tr><td align="left">Log_PCA_HC_P</td><td align="left">27.0</td><td align="left">25.2</td><td align="left">25.4</td><td align="left">26.0</td><td align="left">16.4</td><td align="left">6.0</td><td align="left">
<bold>2.4</bold>
</td><td align="left">18.5</td><td align="left">18.4</td></tr><tr><td align="left">Log_Louvain_E</td><td align="left">26.2</td><td align="left">27.2</td><td align="left">25.8</td><td align="left">21.0</td><td align="left">15.4</td><td align="left">6.2</td><td align="left">10.4</td><td align="left">14.0</td><td align="left">18.3</td></tr><tr><td align="left">TF-IDF_Top_Kmeans</td><td align="left">6.0</td><td align="left">16.8</td><td align="left">15.8</td><td align="left">17.0</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">9.2</td><td align="left">21.0</td><td align="left">11.0</td></tr><tr><td align="left">TF-IDF_Top_sKmeans</td><td align="left">
<bold>2.0</bold>
</td><td align="left">7.4</td><td align="left">7.0</td><td align="left">2.4</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">8.4</td><td align="left">9.5</td><td align="left">
<bold>4.8</bold>
</td></tr><tr><td align="left">TF-IDF_Top_HC_E</td><td align="left">20.4</td><td align="left">21.0</td><td align="left">24.4</td><td align="left">23.4</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">19.8</td><td align="left">18.5</td><td align="left">16.2</td></tr><tr><td align="left">TF-IDF_Top_HC_P</td><td align="left">14.8</td><td align="left">15.8</td><td align="left">19.2</td><td align="left">16.0</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">16.4</td><td align="left">12.0</td><td align="left">12.0</td></tr><tr><td align="left">TF-IDF_Top_HC_C</td><td align="left">14.6</td><td align="left">17.0</td><td align="left">17.4</td><td align="left">15.4</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">18.0</td><td align="left">14.5</td><td align="left">12.4</td></tr><tr><td align="left">TF-IDF_Var_Kmeans</td><td align="left">7.2</td><td align="left">10.6</td><td align="left">19.0</td><td align="left">24.2</td><td align="left">10.0</td><td align="left">
<bold>1.0</bold>
</td><td align="left">25.8</td><td align="left">21.5</td><td align="left">15.0</td></tr><tr><td align="left">TF-IDF_Var_sKmeans</td><td align="left">11.0</td><td align="left">15.2</td><td align="left">19.4</td><td align="left">18.2</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">20.2</td><td align="left">
<bold>4.5</bold>
</td><td align="left">11.3</td></tr><tr><td align="left">TF-IDF_Bin_HC_E</td><td align="left">21.0</td><td align="left">21.4</td><td align="left">17.4</td><td align="left">14.6</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">17.0</td><td align="left">19.5</td><td align="left">14.1</td></tr><tr><td align="left">TF-IDF_Bin_HC_P</td><td align="left">13.6</td><td align="left">9.4</td><td align="left">8.4</td><td align="left">9.2</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">8.0</td><td align="left">
<bold>6.0</bold>
</td><td align="left">7.1</td></tr><tr><td align="left">TF-IDF_Bin_HC_C</td><td align="left">14.0</td><td align="left">10.8</td><td align="left">11.4</td><td align="left">9.2</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">10.6</td><td align="left">8.5</td><td align="left">8.3</td></tr><tr><td align="left">TF-IDF_Bin_HC_J</td><td align="left">17.4</td><td align="left">13.2</td><td align="left">13.4</td><td align="left">9.8</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">12.8</td><td align="left">14.0</td><td align="left">10.3</td></tr><tr><td align="left">TF-IDF_Bin_Greedy_E</td><td align="left">11.6</td><td align="left">7.4</td><td align="left">7.2</td><td align="left">8.8</td><td align="left">18.8</td><td align="left">5.8</td><td align="left">23.8</td><td align="left">27.0</td><td align="left">13.8</td></tr><tr><td align="left">TF-IDF_Bin_Greedy_P</td><td align="left">
<bold>4.6</bold>
</td><td align="left">
<bold>4.6</bold>
</td><td align="left">
<bold>5.2</bold>
</td><td align="left">2.4</td><td align="left">
<bold>5.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">19.0</td><td align="left">12.0</td><td align="left">
<bold>6.7</bold>
</td></tr><tr><td align="left">TF-IDF_Bin_Greedy_C</td><td align="left">
<bold>5.2</bold>
</td><td align="left">
<bold>5.2</bold>
</td><td align="left">7.8</td><td align="left">
<bold>2.8</bold>
</td><td align="left">23.2</td><td align="left">
<bold>1.0</bold>
</td><td align="left">19.4</td><td align="left">28.0</td><td align="left">11.6</td></tr><tr><td align="left">TF-IDF_Bin_Greedy_J</td><td align="left">16.2</td><td align="left">9.4</td><td align="left">10.6</td><td align="left">6.4</td><td align="left">5.8</td><td align="left">
<bold>1.0</bold>
</td><td align="left">18.0</td><td align="left">24.5</td><td align="left">11.5</td></tr><tr><td align="left">TF-IDF_Bin_Louvain_E</td><td align="left">5.8</td><td align="left">
<bold>2.0</bold>
</td><td align="left">
<bold>3.2</bold>
</td><td align="left">
<bold>2.4</bold>
</td><td align="left">
<bold>5.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>4.2</bold>
</td><td align="left">13.0</td><td align="left">
<bold>4.6</bold>
</td></tr><tr><td align="left">TF-IDF_Bin_Louvain_P</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.4</bold>
</td><td align="left">
<bold>1.8</bold>
</td><td align="left">
<bold>1.4</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">14.2</td><td align="left">
<bold>4.0</bold>
</td><td align="left">
<bold>3.2</bold>
</td></tr><tr><td align="left">TF-IDF_Bin_Louvain_C</td><td align="left">
<bold>1.2</bold>
</td><td align="left">
<bold>2.0</bold>
</td><td align="left">
<bold>1.6</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.2</bold>
</td><td align="left">11.5</td><td align="left">
<italic>2.6</italic>
</td></tr><tr><td align="left">TF-IDF_Bin_Louvain_J</td><td align="left">9.6</td><td align="left">6.2</td><td align="left">6.0</td><td align="left">
<bold>2.8</bold>
</td><td align="left">18.4</td><td align="left">
<bold>1.0</bold>
</td><td align="left">11.8</td><td align="left">7.0</td><td align="left">7.9</td></tr></tbody></table><table-wrap-foot><p>The lowest five average ranks (including ties) for each dataset are typeset in bold, and the best overall average rank is shown in italic</p></table-wrap-foot></table-wrap>
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Average ranks based on macro-accuracy</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Methods</th><th align="left">M Nc</th><th align="left">R N</th><th align="left">M N</th><th align="left">R Nc</th><th align="left">B Nk</th><th align="left">B Mc</th><th align="left">7-class</th><th align="left">Pancreas</th><th align="left">Avg.</th></tr></thead><tbody><tr><td align="left">Seurat</td><td align="left">8.2</td><td align="left">8.0</td><td align="left">18.8</td><td align="left">24.2</td><td align="left">
<bold>1.0</bold>
</td><td align="left">26.4</td><td align="left">27.2</td><td align="left">10.0</td><td align="left">15.5</td></tr><tr><td align="left">Seurat_SNN</td><td align="left">9.0</td><td align="left">9.2</td><td align="left">18.0</td><td align="left">19.4</td><td align="left">
<bold>1.0</bold>
</td><td align="left">27.0</td><td align="left">27.0</td><td align="left">
<bold>3.5</bold>
</td><td align="left">14.3</td></tr><tr><td align="left">tSNE_Kmeans</td><td align="left">24.2</td><td align="left">24.0</td><td align="left">9.0</td><td align="left">14.8</td><td align="left">22.4</td><td align="left">26.6</td><td align="left">11.6</td><td align="left">18.5</td><td align="left">18.9</td></tr><tr><td align="left">tSNE_HC_E</td><td align="left">24.4</td><td align="left">24.8</td><td align="left">9.4</td><td align="left">18.2</td><td align="left">6.2</td><td align="left">10.4</td><td align="left">9.2</td><td align="left">20.0</td><td align="left">15.3</td></tr><tr><td align="left">Log_PCA_GMM</td><td align="left">20.4</td><td align="left">6.4</td><td align="left">
<bold>3.0</bold>
</td><td align="left">
<bold>4.8</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>4.4</bold>
</td><td align="left">14.0</td><td align="left">
<bold>6.9</bold>
</td></tr><tr><td align="left">Log_PCA_Kmeans</td><td align="left">27.2</td><td align="left">27.4</td><td align="left">26.6</td><td align="left">26.8</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">7.6</td><td align="left">16.0</td><td align="left">16.7</td></tr><tr><td align="left">Log_PCA_HC_E</td><td align="left">27.2</td><td align="left">24.8</td><td align="left">22.0</td><td align="left">24.6</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>4.8</bold>
</td><td align="left">13.5</td><td align="left">14.9</td></tr><tr><td align="left">Log_PCA_HC_P</td><td align="left">25.8</td><td align="left">23.8</td><td align="left">17.8</td><td align="left">20.6</td><td align="left">16.2</td><td align="left">5.6</td><td align="left">
<bold>2.4</bold>
</td><td align="left">18.0</td><td align="left">16.3</td></tr><tr><td align="left">Log_Louvain_E</td><td align="left">23.0</td><td align="left">25.6</td><td align="left">20.8</td><td align="left">14.2</td><td align="left">15.0</td><td align="left">5.8</td><td align="left">10.6</td><td align="left">14.5</td><td align="left">16.2</td></tr><tr><td align="left">TF-IDF_Top_Kmeans</td><td align="left">9.6</td><td align="left">13.4</td><td align="left">18.6</td><td align="left">13.6</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">9.6</td><td align="left">18.5</td><td align="left">10.7</td></tr><tr><td align="left">TF-IDF_Top_sKmeans</td><td align="left">
<bold>4.2</bold>
</td><td align="left">9.4</td><td align="left">8.0</td><td align="left">6.2</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">8.6</td><td align="left">12.5</td><td align="left">
<bold>6.4</bold>
</td></tr><tr><td align="left">TF-IDF_Top_HC_E</td><td align="left">21.4</td><td align="left">19.2</td><td align="left">25.6</td><td align="left">23.6</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">17.4</td><td align="left">13.0</td><td align="left">15.3</td></tr><tr><td align="left">TF-IDF_Top_HC_P</td><td align="left">17.6</td><td align="left">17.4</td><td align="left">20.4</td><td align="left">20.6</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">18.2</td><td align="left">11.5</td><td align="left">13.5</td></tr><tr><td align="left">TF-IDF_Top_HC_C</td><td align="left">17.0</td><td align="left">16.2</td><td align="left">20.6</td><td align="left">21.2</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">20.4</td><td align="left">12.5</td><td align="left">13.7</td></tr><tr><td align="left">TF-IDF_Var_Kmeans</td><td align="left">12.0</td><td align="left">21.0</td><td align="left">27.4</td><td align="left">27.6</td><td align="left">19.6</td><td align="left">19.0</td><td align="left">26.4</td><td align="left">24.0</td><td align="left">22.1</td></tr><tr><td align="left">TF-IDF_Var_sKmeans</td><td align="left">11.8</td><td align="left">18.0</td><td align="left">23.4</td><td align="left">18.6</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">21.6</td><td align="left">
<bold>2.5</bold>
</td><td align="left">12.2</td></tr><tr><td align="left">TF-IDF_Bin_HC_E</td><td align="left">20.2</td><td align="left">22.2</td><td align="left">19.8</td><td align="left">16.6</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">19.2</td><td align="left">21.0</td><td align="left">15.1</td></tr><tr><td align="left">TF-IDF_Bin_HC_P</td><td align="left">15.4</td><td align="left">13.2</td><td align="left">12.0</td><td align="left">12.2</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">8.4</td><td align="left">
<bold>4.5</bold>
</td><td align="left">8.5</td></tr><tr><td align="left">TF-IDF_Bin_HC_C</td><td align="left">15.8</td><td align="left">15.2</td><td align="left">13.2</td><td align="left">11.4</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">10.8</td><td align="left">
<bold>5.5</bold>
</td><td align="left">9.2</td></tr><tr><td align="left">TF-IDF_Bin_HC_J</td><td align="left">17.8</td><td align="left">15.8</td><td align="left">14.0</td><td align="left">12.8</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">13.0</td><td align="left">12.0</td><td align="left">10.9</td></tr><tr><td align="left">TF-IDF_Bin_Greedy_E</td><td align="left">7.0</td><td align="left">
<bold>5.2</bold>
</td><td align="left">5.4</td><td align="left">
<bold>4.8</bold>
</td><td align="left">20.0</td><td align="left">
<bold>1.0</bold>
</td><td align="left">23.0</td><td align="left">27.0</td><td align="left">11.7</td></tr><tr><td align="left">TF-IDF_Bin_Greedy_P</td><td align="left">
<bold>3.8</bold>
</td><td align="left">
<bold>4.2</bold>
</td><td align="left">
<bold>4.4</bold>
</td><td align="left">
<bold>2.2</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">9.8</td><td align="left">19.2</td><td align="left">11.0</td><td align="left">7.0</td></tr><tr><td align="left">TF-IDF_Bin_Greedy_C</td><td align="left">4.8</td><td align="left">
<bold>5.0</bold>
</td><td align="left">5.6</td><td align="left">
<bold>3.2</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">9.8</td><td align="left">19.4</td><td align="left">26.5</td><td align="left">9.4</td></tr><tr><td align="left">TF-IDF_Bin_Greedy_J</td><td align="left">13.8</td><td align="left">10.2</td><td align="left">11.0</td><td align="left">6.2</td><td align="left">10.2</td><td align="left">
<bold>1.0</bold>
</td><td align="left">16.2</td><td align="left">22.0</td><td align="left">11.3</td></tr><tr><td align="left">TF-IDF_Bin_Louvain_E</td><td align="left">
<bold>4.4</bold>
</td><td align="left">
<bold>2.6</bold>
</td><td align="left">
<bold>3.4</bold>
</td><td align="left">6.4</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>4.2</bold>
</td><td align="left">16.0</td><td align="left">
<bold>4.9</bold>
</td></tr><tr><td align="left">TF-IDF_Bin_Louvain_P</td><td align="left">
<bold>1.2</bold>
</td><td align="left">
<bold>3.4</bold>
</td><td align="left">
<bold>2.4</bold>
</td><td align="left">
<bold>2.4</bold>
</td><td align="left">10.0</td><td align="left">
<bold>1.0</bold>
</td><td align="left">11.2</td><td align="left">
<bold>4.0</bold>
</td><td align="left">
<bold>4.5</bold>
</td></tr><tr><td align="left">TF-IDF_Bin_Louvain_C</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>3.0</bold>
</td><td align="left">
<bold>1.8</bold>
</td><td align="left">
<bold>2.4</bold>
</td><td align="left">
<bold>5.2</bold>
</td><td align="left">
<bold>1.0</bold>
</td><td align="left">
<bold>1.2</bold>
</td><td align="left">11.5</td><td align="left">
<italic>3.4</italic>
</td></tr><tr><td align="left">TF-IDF_Bin_Louvain_J</td><td align="left">9.4</td><td align="left">8.2</td><td align="left">9.8</td><td align="left">5.4</td><td align="left">5.6</td><td align="left">
<bold>1.0</bold>
</td><td align="left">12.0</td><td align="left">6.5</td><td align="left">7.2</td></tr></tbody></table><table-wrap-foot><p>The lowest five average ranks (including ties) for each dataset are typeset in bold, and the best overall average rank is shown in italic</p></table-wrap-foot></table-wrap></p></sec><sec id="Sec17" sec-type="conclusion"><title>Conclusions</title><p>In this paper we compared eight methods for clustering scRNA-seq data: nine commonly used existing approaches and nineteen methods based on the use of TF-IDF scores similar to those used in the text analysis field. Empirical experiments on a variety of cell types and ratio mixtures suggest that TF-IDF based methods achieve consistently high accuracy, even on complex mixtures of highly similar cell types.</p><p>A limitation of the TF-IDF_Bin_HC methods&#x02019; group is the quadratic time required for distance calculations used in hierarchical clustering methods, which becomes a performance bottleneck for datasets with millions of single cells. In ongoing work we are exploring MinHashing [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] and Locality Sensitive Hashing (LSH) [<xref ref-type="bibr" rid="CR27">27</xref>&#x02013;<xref ref-type="bibr" rid="CR30">30</xref>] techniques that make feasible the efficient computation of highly similar pairs of cells under, e.g., Jaccard or cosine distances [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>].</p></sec></body><back><ack><title>Acknowledgements</title><p>The abridged abstract of this work was previously published in the Proceedings of the 13th International Symposium on Bioinformatics Research and Applications (ISBRA 2017), Lecture Notes in Computer Science: Bioinformatics Research and Applications [<xref ref-type="bibr" rid="CR33">33</xref>].</p><sec id="d29e3730"><title>Funding</title><p>This work was partially supported by NSF Award 1564936, NIH grants 1R01MH112739-01 and 2R01NS073425-06A1, and a UConn Academic Vision Program Grant. Publication costs were funded by NSF Award 1564936.</p></sec><sec id="d29e3735" sec-type="data-availability"><title>Availability of data and materials</title><p>Datasets used in this paper are available for download from <ext-link ext-link-type="uri" xlink:href="http://cnv1.engr.uconn.edu:3838/SCA/">http://cnv1.engr.uconn.edu:3838/SCA/</ext-link> through an interactive Shiny application. The application also provides accuracy calculations for user uploaded clustering results.</p></sec><sec id="d29e3745"><title>About this supplement</title><p>This article has been published as part of <italic>BMC Genomics</italic> Volume 19 Supplement 6, 2018: Selected articles from the 13th International Symposium on Bioinformatics Research and Applications (ISBRA 2017): genomics. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcgenomics.biomedcentral.com/articles/supplements/volume-19-supplement-6">https://bmcgenomics.biomedcentral.com/articles/supplements/volume-19-supplement-6</ext-link>.</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>MM and IIM designed the experiments. MM implemented the experiments, prepared the illustrations, and developed the Shiny application. Both authors analyzed the data and wrote the manuscript. Both authors have read and approved the final version of the manuscript.</p></notes><notes notes-type="COI-statement"><sec><title>Ethics approval and consent to participate</title><p>Not applicable.</p></sec><sec><title>Consent for publication</title><p>Not applicable.</p></sec><sec><title>Competing interests</title><p>IIM is a co-founder and holds an interest in SmplBio LLC, a company developing cloud-based scRNA-Seq analysis software. No products, services, or technologies of SmplBio have been evaluated or tested in this work. MM declares that she has no competing interests.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>D</given-names></name><name><surname>Tang</surname><given-names>C</given-names></name><name><surname>Zhang</surname><given-names>A</given-names></name></person-group><article-title>Cluster analysis for gene expression data: A survey</article-title><source>IEEE Trans Knowl Data Eng</source><year>2004</year><volume>16</volume><issue>11</issue><fpage>1370</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1109/TKDE.2004.68</pub-id></element-citation></ref><ref id="CR2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>GXY</given-names></name><name><surname>Terry</surname><given-names>JM</given-names></name><name><surname>Belgrader</surname><given-names>P</given-names></name><name><surname>Ryvkin</surname><given-names>P</given-names></name><name><surname>Bent</surname><given-names>ZW</given-names></name><name><surname>Wilson</surname><given-names>R</given-names></name><name><surname>Ziraldo</surname><given-names>SB</given-names></name><name><surname>Wheeler</surname><given-names>TD</given-names></name><name><surname>McDermott</surname><given-names>GP</given-names></name><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>Gregory</surname><given-names>MT</given-names></name><name><surname>Shuga</surname><given-names>J</given-names></name><name><surname>Montesclaros</surname><given-names>L</given-names></name><name><surname>Underwood</surname><given-names>JG</given-names></name><name><surname>Masquelier</surname><given-names>DA</given-names></name><name><surname>Nishimura</surname><given-names>SY</given-names></name><name><surname>Schnall-Levin</surname><given-names>M</given-names></name><name><surname>Wyatt</surname><given-names>PW</given-names></name><name><surname>Hindson</surname><given-names>CM</given-names></name><name><surname>Bharadwaj</surname><given-names>R</given-names></name><name><surname>Wong</surname><given-names>A</given-names></name><name><surname>Ness</surname><given-names>KD</given-names></name><name><surname>Beppu</surname><given-names>LW</given-names></name><name><surname>Deeg</surname><given-names>HJ</given-names></name><name><surname>McFarland</surname><given-names>C</given-names></name><name><surname>Loeb</surname><given-names>KR</given-names></name><name><surname>Valente</surname><given-names>WJ</given-names></name><name><surname>Ericson</surname><given-names>NG</given-names></name><name><surname>Stevens</surname><given-names>EA</given-names></name><name><surname>Radich</surname><given-names>JP</given-names></name><name><surname>Mikkelsen</surname><given-names>TS</given-names></name><name><surname>Hindson</surname><given-names>BJ</given-names></name><name><surname>Bielas</surname><given-names>JH</given-names></name></person-group><article-title>Massively parallel digital transcriptional profiling of single cells</article-title><source>Nat Commun</source><year>2017</year><volume>8</volume><fpage>14049</fpage><pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id><pub-id pub-id-type="pmid">28091601</pub-id></element-citation></ref><ref id="CR3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ilicic</surname><given-names>T</given-names></name><name><surname>Kim</surname><given-names>JK</given-names></name><name><surname>Kolodziejczyk</surname><given-names>AA</given-names></name><name><surname>Bagger</surname><given-names>FO</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name></person-group><article-title>Classification of low quality cells from single-cell RNA-seq data</article-title><source>Genome Biol</source><year>2016</year><volume>17</volume><issue>1</issue><fpage>29</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-0888-1</pub-id><pub-id pub-id-type="pmid">26887813</pub-id></element-citation></ref><ref id="CR4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Satija</surname><given-names>R</given-names></name><name><surname>Farrell</surname><given-names>JA</given-names></name><name><surname>Gennert</surname><given-names>D</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name></person-group><article-title>Spatial reconstruction of single-cell gene expression data</article-title><source>Nat Biotechnol</source><year>2015</year><volume>33</volume><issue>5</issue><fpage>495</fpage><lpage>502</lpage><pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id><pub-id pub-id-type="pmid">25867923</pub-id></element-citation></ref><ref id="CR5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Segerstolpe</surname><given-names>&#x000c5;</given-names></name><name><surname>Palasantza</surname><given-names>A</given-names></name><name><surname>Eliasson</surname><given-names>P</given-names></name><name><surname>Andersson</surname><given-names>E. -M.</given-names></name><name><surname>Andr&#x000e9;asson</surname><given-names>A-C</given-names></name><name><surname>Sun</surname><given-names>X</given-names></name><name><surname>Picelli</surname><given-names>S</given-names></name><name><surname>Sabirsh</surname><given-names>A</given-names></name><name><surname>Clausen</surname><given-names>M</given-names></name><name><surname>Bjursell</surname><given-names>MK</given-names></name><etal/></person-group><article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title><source>Cell Metab</source><year>2016</year><volume>24</volume><issue>4</issue><fpage>593</fpage><lpage>607</lpage><pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.020</pub-id><pub-id pub-id-type="pmid">27667667</pub-id></element-citation></ref><ref id="CR6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Walther</surname><given-names>G</given-names></name><name><surname>Hastie</surname><given-names>T</given-names></name></person-group><article-title>Estimating the number of clusters in a data set via the gap statistic</article-title><source>J R Stat Soc Ser B Stat Methodol</source><year>2001</year><volume>63</volume><issue>2</issue><fpage>411</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.1111/1467-9868.00293</pub-id></element-citation></ref><ref id="CR7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>X</given-names></name><name><surname>Wolfgruber</surname><given-names>TK</given-names></name><name><surname>Tasato</surname><given-names>A</given-names></name><name><surname>Arisdakessian</surname><given-names>C</given-names></name><name><surname>Garmire</surname><given-names>DG</given-names></name><name><surname>Garmire</surname><given-names>LX</given-names></name></person-group><article-title>Granatum: a graphical single-cell RNA-Seq analysis pipeline for genomics scientists</article-title><source>Genome Med</source><year>2017</year><volume>9</volume><issue>1</issue><fpage>108</fpage><pub-id pub-id-type="doi">10.1186/s13073-017-0492-3</pub-id><pub-id pub-id-type="pmid">29202807</pub-id></element-citation></ref><ref id="CR8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Maaten</surname><given-names>LJP</given-names></name><name><surname>Hinton</surname><given-names>GE</given-names></name></person-group><article-title>Visualizing high-dimensional data using t-sne</article-title><source>J Mach Learn Res</source><year>2008</year><volume>9</volume><fpage>2579</fpage><lpage>605</lpage></element-citation></ref><ref id="CR9"><label>9</label><mixed-citation publication-type="other">10x Genomics. Cell Ranger R Kit Tutorial: Secondary Analysis on 10x Genomics Single Cell 30 RNA-seq PBMC Data. <ext-link ext-link-type="uri" xlink:href="http://cf.10xgenomics.com/supp/cellexp/cellrangerrkit-PBMC-vignette-knitr-2.0.0.pdf">http://cf.10xgenomics.com/supp/cellexp/cellrangerrkit-PBMC-vignette-knitr-2.0.0.pdf</ext-link>. Accessed 16 July 2018.</mixed-citation></ref><ref id="CR10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blondel</surname><given-names>VD</given-names></name><name><surname>Guillaume</surname><given-names>J-L</given-names></name><name><surname>Lambiotte</surname><given-names>R</given-names></name><name><surname>Lefebvre</surname><given-names>E</given-names></name></person-group><article-title>Fast unfolding of communities in large networks</article-title><source>J Stat Mech Theory Exp</source><year>2008</year><volume>2008</volume><issue>10</issue><fpage>10008</fpage><pub-id pub-id-type="doi">10.1088/1742-5468/2008/10/P10008</pub-id></element-citation></ref><ref id="CR11"><label>11</label><mixed-citation publication-type="other">Seurat - Guided Clustering Tutorial. <ext-link ext-link-type="uri" xlink:href="https://satijalab.org/seurat/pbmc3k_tutorial.html">https://satijalab.org/seurat/pbmc3k_tutorial.html</ext-link>. Accessed 16 July 2018.</mixed-citation></ref><ref id="CR12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buettner</surname><given-names>F</given-names></name><name><surname>Natarajan</surname><given-names>KN</given-names></name><name><surname>Casale</surname><given-names>FP</given-names></name><name><surname>Proserpio</surname><given-names>V</given-names></name><name><surname>Scialdone</surname><given-names>A</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name><name><surname>Stegle</surname><given-names>O</given-names></name></person-group><article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title><source>Nat Biotechnol</source><year>2015</year><volume>33</volume><issue>2</issue><fpage>155</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1038/nbt.3102</pub-id><pub-id pub-id-type="pmid">25599176</pub-id></element-citation></ref><ref id="CR13"><label>13</label><mixed-citation publication-type="other">Fraley C, Raftery A, Murphy T, Scrucca L. mclust version 4 for r: Normal mixture modeling for model-based clustering, classification, and density estimation. 2012.</mixed-citation></ref><ref id="CR14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartigan</surname><given-names>JA</given-names></name><name><surname>Wong</surname><given-names>MA</given-names></name></person-group><article-title>Algorithm as 136: A k-means clustering algorithm</article-title><source>J R Stat Soc: Ser C: Appl Stat</source><year>1979</year><volume>28</volume><issue>1</issue><fpage>100</fpage><lpage>8</lpage></element-citation></ref><ref id="CR15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hornik</surname><given-names>K</given-names></name><name><surname>Feinerer</surname><given-names>I</given-names></name><name><surname>Kober</surname><given-names>M</given-names></name><name><surname>Buchta</surname><given-names>C</given-names></name></person-group><article-title>Spherical k-means clustering</article-title><source>J Stat Softw</source><year>2013</year><volume>50</volume><issue>10</issue><fpage>1</fpage><lpage>22</lpage></element-citation></ref><ref id="CR16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ward Jr</surname><given-names>JH</given-names></name></person-group><article-title>Hierarchical grouping to optimize an objective function</article-title><source>J Am Stat Assoc</source><year>1963</year><volume>58</volume><issue>301</issue><fpage>236</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1080/01621459.1963.10500845</pub-id></element-citation></ref><ref id="CR17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Csardi</surname><given-names>G</given-names></name><name><surname>Nepusz</surname><given-names>T</given-names></name></person-group><article-title>The igraph software package for complex network research</article-title><source>InterJournal Complex Syst</source><year>2006</year><volume>1695</volume><issue>5</issue><fpage>1</fpage><lpage>9</lpage></element-citation></ref><ref id="CR18"><label>18</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Leskovec</surname><given-names>J</given-names></name><name><surname>Rajaraman</surname><given-names>A</given-names></name><name><surname>Ullman</surname><given-names>JD</given-names></name></person-group><source>Mining of Massive Datasets</source><year>2014</year><publisher-loc>Cambridge</publisher-loc><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="CR19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>H-IH</given-names></name><name><surname>Jin</surname><given-names>Y</given-names></name><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name></person-group><article-title>Detection of high variability in gene expression from single-cell RNA-seq profiling</article-title><source>BMC Genomics</source><year>2016</year><volume>17</volume><issue>7</issue><fpage>508</fpage><pub-id pub-id-type="doi">10.1186/s12864-016-2897-6</pub-id><pub-id pub-id-type="pmid">27556924</pub-id></element-citation></ref><ref id="CR20"><label>20</label><mixed-citation publication-type="other">Dittenbach M. <ext-link ext-link-type="uri" xlink:href="https://www.ir-facility.org/scoring-and-ranking-techniques-tf-idf-term-weighting-and-cosine-similarity">https://www.ir-facility.org/scoring-and-ranking-techniques-tf-idf-term-weighting-and-cosine-similarity</ext-link>. Accessed 16 July 2018.</mixed-citation></ref><ref id="CR21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clauset</surname><given-names>A</given-names></name><name><surname>Newman</surname><given-names>ME</given-names></name><name><surname>Moore</surname><given-names>C</given-names></name></person-group><article-title>Finding community structure in very large networks</article-title><source>Phys Rev E</source><year>2004</year><volume>70</volume><issue>6</issue><fpage>066111</fpage><pub-id pub-id-type="doi">10.1103/PhysRevE.70.066111</pub-id></element-citation></ref><ref id="CR22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawlor</surname><given-names>N</given-names></name><name><surname>George</surname><given-names>J</given-names></name><name><surname>Bolisetty</surname><given-names>M</given-names></name><name><surname>Kursawe</surname><given-names>R</given-names></name><name><surname>Sun</surname><given-names>L</given-names></name><name><surname>Sivakamasundari</surname><given-names>V</given-names></name><name><surname>Kycia</surname><given-names>I</given-names></name><name><surname>Robson</surname><given-names>P</given-names></name><name><surname>Stitzel</surname><given-names>ML</given-names></name></person-group><article-title>Single-cell transcriptomes identify human islet cell signatures and reveal cell-type&#x02013;specific expression changes in type 2 diabetes</article-title><source>Genome Res</source><year>2017</year><volume>27</volume><issue>2</issue><fpage>208</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.1101/gr.212720.116</pub-id><pub-id pub-id-type="pmid">27864352</pub-id></element-citation></ref><ref id="CR23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Mandoiu</surname><given-names>II</given-names></name><name><surname>Nelson</surname><given-names>CE</given-names></name></person-group><article-title>Inferring ethnicity from mitochondrial dna sequence</article-title><source>BMC Proceedings</source><year>2011</year><volume>5</volume><issue>Suppl 2</issue><fpage>S11</fpage><pub-id pub-id-type="doi">10.1186/1753-6561-5-S2-S11</pub-id></element-citation></ref><ref id="CR24"><label>24</label><mixed-citation publication-type="other">Van Asch V. Macro-and micro-averaged evaluation measures. Tech. Rep. 2013.</mixed-citation></ref><ref id="CR25"><label>25</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Charikar</surname><given-names>MS</given-names></name></person-group><article-title>Similarity estimation techniques from rounding algorithms</article-title><source>Proceedings of the Thiry-fourth Annual ACM Symposium on Theory of Computing</source><year>2002</year><publisher-loc>New York</publisher-loc><publisher-name>ACM</publisher-name></element-citation></ref><ref id="CR26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ondov</surname><given-names>BD</given-names></name><name><surname>Treangen</surname><given-names>TJ</given-names></name><name><surname>Melsted</surname><given-names>P</given-names></name><name><surname>Mallonee</surname><given-names>AB</given-names></name><name><surname>Bergman</surname><given-names>NH</given-names></name><name><surname>Koren</surname><given-names>S</given-names></name><name><surname>Phillippy</surname><given-names>AM</given-names></name></person-group><article-title>Mash: fast genome and metagenome distance estimation using minhash</article-title><source>Genome Biol</source><year>2016</year><volume>17</volume><issue>1</issue><fpage>132</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-0997-x</pub-id><pub-id pub-id-type="pmid">27323842</pub-id></element-citation></ref><ref id="CR27"><label>27</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Blekanov</surname><given-names>V</given-names></name><name><surname>Korelin</surname><given-names>V</given-names></name></person-group><article-title>Hierarchical clustering of large text datasets using locality-sensitive hashing</article-title><source>Proceedings of the International Workshop on Applications in Information Technology</source><year>2015</year><publisher-loc>Aizu-Wakamatsu</publisher-loc><publisher-name>University of Aizu Press</publisher-name></element-citation></ref><ref id="CR28"><label>28</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Andoni</surname><given-names>A</given-names></name><name><surname>Indyk</surname><given-names>P</given-names></name><name><surname>Laarhoven</surname><given-names>T</given-names></name><name><surname>Razenshteyn</surname><given-names>I</given-names></name><name><surname>Schmidt</surname><given-names>L</given-names></name></person-group><article-title>Practical and optimal lsh for angular distance</article-title><source>Advances in Neural Information Processing Systems</source><year>2015</year><publisher-loc>Red Hook</publisher-loc><publisher-name>Curran Associates</publisher-name></element-citation></ref><ref id="CR29"><label>29</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Eshghi</surname><given-names>K</given-names></name><name><surname>Kafai</surname><given-names>M</given-names></name></person-group><article-title>The CRO kernel: Using concomitant rank order hashes for sparse high dimensional randomized feature maps</article-title><source>Data Engineering (ICDE), 32nd IEEE International Conference On</source><year>2016</year><publisher-loc>Piscataway</publisher-loc><publisher-name>IEEE</publisher-name></element-citation></ref><ref id="CR30"><label>30</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ioffe</surname><given-names>S</given-names></name></person-group><article-title>Improved consistent sampling, weighted minhash and l1 sketching</article-title><source>Data Mining (ICDM), 2010 IEEE 10th International Conference On</source><year>2010</year><publisher-loc>Piscataway</publisher-loc><publisher-name>IEEE</publisher-name></element-citation></ref><ref id="CR31"><label>31</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Eshghi</surname><given-names>K</given-names></name><name><surname>Rajaram</surname><given-names>S</given-names></name></person-group><article-title>Locality sensitive hash functions based on concomitant rank order statistics</article-title><source>Proceedings of the 14th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</source><year>2008</year><publisher-loc>New York</publisher-loc><publisher-name>ACM</publisher-name></element-citation></ref><ref id="CR32"><label>32</label><mixed-citation publication-type="other">Wang J, Shen HT, Song J, Ji J. Hashing for similarity search: A survey. arXiv preprint arXiv:1408.2927. 2014.</mixed-citation></ref><ref id="CR33"><label>33</label><mixed-citation publication-type="other">Cai Z, Daescu O, Li M. Proceedings of the 13th International Symposium on Bioinformatics Research and Applications, Honolulu, HI, USA, May 29&#x02013;June 2, 2017, Lecture Notes in Computer Science vol. 10330: Springer; 2017.</mixed-citation></ref></ref-list></back></article>