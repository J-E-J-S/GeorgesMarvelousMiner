<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Genome Biol</journal-id><journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id><journal-title-group><journal-title>Genome Biology</journal-title></journal-title-group><issn pub-type="ppub">1474-7596</issn><issn pub-type="epub">1474-760X</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6637521</article-id><article-id pub-id-type="publisher-id">1739</article-id><article-id pub-id-type="doi">10.1186/s13059-019-1739-7</article-id><article-categories><subj-group subj-group-type="heading"><subject>Method</subject></subj-group></article-categories><title-group><article-title>CellSIUS provides sensitive and specific detection of rare cell populations from complex single-cell RNA-seq data</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>Wegmann</surname><given-names>Rebekka</given-names></name><address><email>wegmann@imsb.biol.ethz.ch</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Neri</surname><given-names>Marilisa</given-names></name><address><email>marilisa.neri@novartis.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Schuierer</surname><given-names>Sven</given-names></name><address><email>sven.schuierer@novartis.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Bilican</surname><given-names>Bilada</given-names></name><address><email>bbilican@FL60inc.com</email></address><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff5">5</xref></contrib><contrib contrib-type="author"><name><surname>Hartkopf</surname><given-names>Huyen</given-names></name><address><email>huyen.nguyen@novartis.com</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Nigsch</surname><given-names>Florian</given-names></name><address><email>florian.nigsch@novartis.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Mapa</surname><given-names>Felipa</given-names></name><address><email>felipa.mapa@novartis.com</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Waldt</surname><given-names>Annick</given-names></name><address><email>annick.waldt@novartis.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Cuttat</surname><given-names>Rachel</given-names></name><address><email>rachel.cuttat@novartis.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Salick</surname><given-names>Max R.</given-names></name><address><email>max@insitro.com</email></address><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name><surname>Raymond</surname><given-names>Joe</given-names></name><address><email>joe.raymond@novartis.com</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Kaykas</surname><given-names>Ajamete</given-names></name><address><email>akaykas@insitro.com</email></address><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name><surname>Roma</surname><given-names>Guglielmo</given-names></name><address><email>guglielmo.roma@novartis.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9459-6076</contrib-id><name><surname>Keller</surname><given-names>Caroline Gubser</given-names></name><address><email>caroline.gubser_keller@novartis.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1515 9979</institution-id><institution-id institution-id-type="GRID">grid.419481.1</institution-id><institution>Novartis Institutes for Biomedical Research, </institution></institution-wrap>Basel, Switzerland </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0439 2056</institution-id><institution-id institution-id-type="GRID">grid.418424.f</institution-id><institution>Novartis Institutes for Biomedical Research, </institution></institution-wrap>Cambridge, USA </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2156 2780</institution-id><institution-id institution-id-type="GRID">grid.5801.c</institution-id><institution>Present Address: Institute of Molecular Systems Biology, </institution><institution>ETH Zurich, </institution></institution-wrap>Zurich, Switzerland </aff><aff id="Aff4"><label>4</label>Present Address: Insitro, San Francisco, USA </aff><aff id="Aff5"><label>5</label>Present Address: Flagship Pioneering, Cambridge, USA </aff></contrib-group><pub-date pub-type="epub"><day>17</day><month>7</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>17</day><month>7</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>20</volume><elocation-id>142</elocation-id><history><date date-type="received"><day>7</day><month>5</month><year>2019</year></date><date date-type="accepted"><day>13</day><month>6</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s). 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">We develop CellSIUS (Cell Subtype Identification from Upregulated gene Sets) to fill a methodology gap for rare cell population identification for scRNA-seq data. CellSIUS outperforms existing algorithms for specificity and selectivity for rare cell types and their transcriptomic signature identification in synthetic and complex biological data. Characterization of a human pluripotent cell differentiation protocol recapitulating deep-layer corticogenesis using CellSIUS reveals unrecognized complexity in human stem cell-derived cellular populations. CellSIUS enables identification of novel rare cell populations and their signature genes providing the means to study those populations in vitro in light of their role in health and disease.</p><sec><title>Electronic supplementary material</title><p>The online version of this article (10.1186/s13059-019-1739-7) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Single-cell RNA sequencing</kwd><kwd>Data analysis</kwd><kwd>Rare cell types</kwd><kwd>Clustering</kwd><kwd>Software</kwd><kwd>Benchmarking</kwd><kwd>Human pluripotent stem cells</kwd><kwd>Cortical development</kwd><kwd>Choroid plexus</kwd><kwd>Lineage mapping</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p id="Par19">Single-cell RNA sequencing (scRNA-seq) enables genome-wide mRNA expression profiling with single-cell granularity. With recent technological advances [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>] and the rise of fully commercialized systems [<xref ref-type="bibr" rid="CR3">3</xref>], throughput and availability of this technology are increasing at a fast pace [<xref ref-type="bibr" rid="CR4">4</xref>]. Evolving from the first scRNA-seq dataset measuring gene expression from a single mouse blastomere in 2009 [<xref ref-type="bibr" rid="CR5">5</xref>], scRNA-seq datasets now typically include expression profiles of thousands [<xref ref-type="bibr" rid="CR1">1</xref>&#x02013;<xref ref-type="bibr" rid="CR3">3</xref>] to more than one million cells [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. One of the main applications of scRNA-seq is uncovering and characterizing novel and/or rare cell types from complex tissue in health and disease [<xref ref-type="bibr" rid="CR8">8</xref>&#x02013;<xref ref-type="bibr" rid="CR13">13</xref>].</p><p id="Par20">From an analytical point of view, the high dimensionality and complexity of scRNA-seq data pose significant challenges. Following the platform development, a multitude of computational approaches for the analysis of scRNA-seq data emerged. These comprise tools for cell-centric analyses, such as unsupervised clustering for cell type identification [<xref ref-type="bibr" rid="CR14">14</xref>&#x02013;<xref ref-type="bibr" rid="CR16">16</xref>], analysis of developmental trajectories [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>], or identification of rare cell populations [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR19">19</xref>], as well as approaches for gene-centric analyses such as differential expression (DE) analysis [<xref ref-type="bibr" rid="CR20">20</xref>&#x02013;<xref ref-type="bibr" rid="CR22">22</xref>].</p><p id="Par21">Whereas a large number of computational methods tailored to scRNA-seq analysis are available, comprehensive performance comparisons between those are scarce. This is mainly due to the lack of reference datasets with known cellular composition. Prior knowledge or synthetic data are commonly used to circumvent the problem of a missing ground truth.</p><p id="Par22">Here, we generated a benchmark dataset of ~&#x02009;12,000 single-cell transcriptomes from eight human cell lines to investigate the performance of scRNA-seq feature selection and clustering approaches. Strikingly, results highlighted a methodology gap for sensitive and specific identification of rare cell types. To fill this gap, we developed a method which we called CellSIUS (Cell Subtype Identification from Upregulated gene Sets). For complex scRNA-seq datasets containing both abundant and rare cell populations, we propose a two-step approach consisting of an initial coarse clustering step followed by CellSIUS. Using synthetic and biological datasets containing rare cell populations, we showed that CellSIUS outperforms existing algorithms in both specificity and selectivity for rare cell type and their transcriptomic signature identification. In addition, and in contrast to existing approaches, CellSIUS simultaneously reveals transcriptomic signatures indicative of rare cell type&#x02019;s function(s).</p><p id="Par23">To exemplify the use of CellSIUS, we applied the workflow and our two-step clustering approach to complex biological data. We profiled the gene expression of 4857 human pluripotent stem cell (hPSC)-derived cortical neurons generated by a 3D spheroid differentiation protocol. Analysis of this in vitro model of corticogenesis revealed distinct progenitor, neuronal, and glial populations consistent with developing human telencephalon. Trajectory analysis identified a lineage bifurcation point between Cajal-Retzius cells and layer V/VI cortical neurons, which was not clearly demonstrated in other in vitro hPSC models of corticogenesis [<xref ref-type="bibr" rid="CR23">23</xref>&#x02013;<xref ref-type="bibr" rid="CR26">26</xref>]. Importantly, CellSIUS revealed known as well as novel rare cell populations that differ by migratory, metabolic, or cell cycle status. These include a rare choroid plexus (CP) lineage, a population that was either not detected, or detected only partly by existing approaches for rare cell type identification. We experimentally validated the presence of CP neuroepithelia in our 3D cortical spheroid cultures by confocal microscopy and validated the CP-specific signature gene list output from CellSIUS using primary pre-natal human data. For the CP lineage in particular and other identified rare cell populations in general, the signature gene lists output from CellSIUS provide the means to isolate these populations for in vitro propagation and characterization of their role in neurological disorders.</p></sec><sec id="Sec2"><title>Results</title><sec id="Sec3"><title>Investigation of feature selection and clustering approaches for scRNA-seq data reveals a methodology gap for the detection of rare cell populations</title><p id="Par24">To assess and compare the performance of some of the most recent and widely used feature selection and clustering methodologies for scRNA-seq data, we generated a scRNA-seq dataset with known cellular composition generated from mixtures of eight human cell lines. To this end, a total of ~&#x02009;12,000 cells from eight human cell lines (A549, H1437, HCT116, HEK293, IMR90, Jurkat, K562, and Ramos) were sequenced using the 10X Genomics Chromium platform [<xref ref-type="bibr" rid="CR3">3</xref>]. Cells were processed in batches containing mixtures of two or three cell lines each. One of the cell lines was present in two separate batches and indicated that technical batch effects were minor as compared to the biological variability (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). To infer cell type identity, we profiled each cell line individually using bulk RNA sequencing. Correlation of the single-cell to bulk expression profiles was used for cell type assignment as described in the &#x0201c;<xref rid="Sec10" ref-type="sec">Methods</xref>&#x0201d; section (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>a, b). Cells that did not pass quality control (QC) or could not be unambiguously assigned to a cell line (614 cells, ~&#x02009;5%) were discarded, leaving 11,678 cells of known cell type (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>c and Additional&#x000a0;file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S1, Table S1).<fig id="Fig1"><label>Fig. 1</label><caption><p>Generation of a scRNA-seq dataset with known cellular composition. <bold>a</bold> Schematic illustration of the experimental setup. Eight human cell lines were individually profiled by bulk RNA-seq and mixed in four batches containing mixtures of two or three cell lines each for scRNA-seq profiling. Correlation of the single-cell to bulk expression profiles was used for cell type assignment as described in the Methods section. <bold>b</bold> Visualization of correlations between single-cell and bulk expression profiles for each batch. The top row represents cell type assignment. Single cells were assigned to the cell type correlating most with their expression profile as described in the Methods section. Cells with <italic>z</italic>-scored correlations below 0.2 were not assigned to any cluster. Cells that correlate strongly with more than one bulk expression profile likely represent doublets and were excluded from future analyses. <bold>c</bold> Heatmap of gene expression values, clustered by their Pearson&#x02019;s correlation across rows (genes) and columns (cells). The color bars indicate the cell type and the corresponding batch. Only the top 10% genes selected by NBDrop are shown</p></caption><graphic xlink:href="13059_2019_1739_Fig1_HTML" id="MO1"/></fig></p><p id="Par25">We assembled a modular workflow for the analysis of scRNA-seq data (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a). The quality control, normalization, and marker gene identification modules were based on recent publications and described in methods. For a data-driven choice of the most appropriate feature selection method upstream of the clustering module, we compared methods using either a mean-variance trend to find highly variable genes (HVG, [<xref ref-type="bibr" rid="CR27">27</xref>]) or a depth-adjusted negative binomial model (DANB [<xref ref-type="bibr" rid="CR28">28</xref>]) for selection of genes with unexpected dropout rates (NBDrop) or dispersions (NBDisp). Using linear modeling as implemented in the plotExplanatoryVariables function from scater [<xref ref-type="bibr" rid="CR29">29</xref>], we quantified the influence of these feature selection methods on the contribution of four predictors to the total observed variance: cell line, total counts per cell, total detected features per cell, and predicted cell cycle phase (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>b). Results highlighted that (i) for HVG selected genes, cell line accounted for 10% of the total variance only; (ii) for NBDisp and NBDrop selected genes, the percentage of total variance explained by cell line increased to 37% and 47%, respectively, with half of the selected features common to both methods; (iii) genes selected only by NBDisp were generally low expressed (data not shown), highlighting a drawback of variance-based feature selection [<xref ref-type="bibr" rid="CR28">28</xref>]; and (iv) NBDrop selected features showed an increased contribution of library size (i.e., total detected features and total counts per cell) to the total variance. For our benchmark dataset, the number of total features co-varied with cell type and cell cycle indicating that library size is partially dependent on the cell line (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S1), and thus determined by both technical and biological factors. Therefore, and because in our benchmark dataset, the genes selected by NBDrop explained more cell-line-based variance, we compared some of the most recent or widely used clustering methods after feature selection using NBDrop.<fig id="Fig2"><label>Fig. 2</label><caption><p>Performance assessment of feature selection and clustering methods. <bold>a</bold> Overview of the computational analysis workflow. <bold>b</bold> Benchmarking of feature selection methods. In each case, the top 10% of features were selected using either a mean-variance trend to find highly variable genes (HVG, left) or a depth-adjusted negative binomial model (DANB) followed by selecting genes with unexpected dropout rates (NBDrop, middle) or dispersions (NBDisp, right). Plots show the percentage of variance explained by each of the four predictors to the total observed variance: cell line, total counts per cell, total detected features per cell, and predicted cell cycle phase. The blue dashed line indicates the average for the predictor cell line. <bold>c</bold>&#x02013;<bold>e</bold> tSNE projections of the full dataset (<bold>c</bold>) and two sub-sampled datasets with unequal proportions between different cell lines (<bold>d</bold>, <bold>e</bold>). <bold>f</bold>&#x02013;<bold>h</bold> Comparison of clustering assignments by different methods on the full dataset (<bold>f</bold>), subset 1 (<bold>g</bold>), and subset 2 (<bold>h</bold>). Stochastic methods (SC3, mclust, pcaReduce) were run 25 times. Bars and indicated values represent mean adjusted rand index (ARI), and dots correspond to results from individual runs. All other methods are deterministic and were run only once</p></caption><graphic xlink:href="13059_2019_1739_Fig2_HTML" id="MO2"/></fig></p><p id="Par26">For the clustering module, we investigated seven unsupervised clustering methods for scRNA-seq data (SC3 [<xref ref-type="bibr" rid="CR15">15</xref>], Seurat [<xref ref-type="bibr" rid="CR1">1</xref>], pcaReduce, hclust [<xref ref-type="bibr" rid="CR30">30</xref>], mclust [<xref ref-type="bibr" rid="CR31">31</xref>], DBSCAN [<xref ref-type="bibr" rid="CR32">32</xref>], MCL [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>], Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Table S2) by in silico subsampling of our dataset of known composition in two subsets with different cell type proportions (later referred to as subset 1 and subset 2, Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>c&#x02013;e, Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Subset 1 consisted of 4999 cells from eight cell types with abundance varying between 2 and 32%. Subset 2 consisted of 3989 cells with two major cell populations including 90% of all cells of this subset, four medium to low abundant (between 1% and 5%), and two rarer cell types with abundances below 1%, containing 3 (0.08%) and 6 (0.15%) cells, respectively. We applied each clustering method to the complete dataset as well as to both subsets, using principal component analysis (PCA) [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR36">36</xref>] to project the original expression values to vectors in a lower dimensional space and calculating all distances based on these projections. For all clustering methods, we adjusted parameters such that they resulted in the expected number of 8 clusters. We then assessed the quality of the classification by calculating the adjusted Rand index (ARI) [<xref ref-type="bibr" rid="CR37">37</xref>] between assignment and true cell line annotation.</p><p id="Par27">On the full dataset, most methods resulted in a perfect assignment (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>f) with only two of the stochastic methods&#x02014;pcaReduce and mclust&#x02014;yielding a lower average ARI of 0.90 and 0.92. In contrast, on subset 1, where cell type proportions were no longer equal, <italic>k</italic>-means-based methods and mclust failed to identify the different cell types correctly and resulted in average ARI of 0.85 (SC3), 0.78 (pcaReduce), and 0.69 (mclust) (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>g). On subset 2, all methods failed to correctly identify rarer (6 cells, 0.16% of total cells) cell types (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>h). DBSCAN achieved the highest ARI (0.99) classifying rare cells as outliers (&#x0201c;border points&#x0201d;). All other methods merged rare cells with clusters of abundant cell types resulting in lower ARI of 0.98 (hclust on Euclidean distance), 0.96 (MCL), 0.96 (hclust on correlation distance), and 0.76 (Seurat).</p><p id="Par28">In conclusion, and consistently with a recent review describing the challenges in unsupervised clustering of single-cell RNA-seq data [<xref ref-type="bibr" rid="CR16">16</xref>], our results showed that most clustering methods performed well in identifying populations defined by more than 2% of total cells. Yet, none of the methods could identify rarer populations, highlighting the need for dedicated tools tailored to detecting rare cell types.</p></sec><sec id="Sec4"><title>Development of CellSIUS for rare cell population identification and characterization</title><p id="Par29">To overcome the abovementioned limitations, we developed a novel method to identify rare cell populations which we called CellSIUS (Cell Subtype Identification from Upregulated gene Sets). CellSIUS takes as input the expression values of <italic>N</italic> cells grouped into <italic>M</italic> clusters (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>a). For each cluster <italic>C</italic><sub><italic>m</italic></sub>, candidate marker genes <italic>g</italic><sub><italic>m1</italic></sub>, <italic>g</italic><sub><italic>m2</italic></sub>, &#x02026;, <italic>g</italic><sub><italic>mj</italic></sub> that exhibit a bimodal distribution of expression values with a fold change above a certain threshold (fc_within) across all cells within <italic>C</italic><sub><italic>m</italic></sub> are identified by one-dimensional <italic>k</italic>-means clustering (with <italic>k</italic>&#x02009;=&#x02009;2). For each candidate gene <italic>g</italic><sub><italic>mi</italic></sub>, the mean expression in the second mode is then compared to this gene&#x02019;s mean expression level outside <italic>C</italic><sub><italic>m</italic></sub> (fc_between), considering only cells that have non-zero expression of <italic>g</italic><sub><italic>mi</italic></sub> to avoid biases arising from stochastic zeroes. Only genes with significantly higher expression within the second mode of <italic>C</italic><sub><italic>m</italic></sub> (by default, at least a twofold difference in mean expression) are retained. For these remaining cluster-specific candidate marker genes, gene sets with correlated expression patterns are identified using the graph-based clustering algorithm MCL. MCL does not require a pre-specified number of clusters and works on the gene correlation network derived from single-cell RNAseq data and detects communities in this network. These (gene) communities are guaranteed to contain genes that are co-expressed, by design. In contrast, in a <italic>k</italic>-means clustering with a pre-specified <italic>k</italic>, we cannot be sure that all genes within all clusters are co-expressed to the same degree: genes are assigned the closest centroid, but this is only a relative measure. Thus, by using communities of a gene correlation network, with a pre-specified correlation threshold, we can be sure that those communities (if such exist) satisfy the criteria of containing correlated genes. In a last step, cells within each cluster <italic>C</italic><sub><italic>m</italic></sub> are assigned to subgroups by one-dimensional <italic>k</italic>-means clustering of their average expression of each gene set.<fig id="Fig3"><label>Fig. 3</label><caption><p>Development and benchmarking of CellSIUS. <bold>a</bold> Schematic overview of CellSIUS. Starting from an initial assignment of N cells in M clusters (i), within each cluster, genes with a bimodal distribution are identified (ii) and only genes with cluster-specific expression are retained (iii). Among the candidate genes, sets with correlated expression patterns are identified by graph-based clustering (iv). Cells are assigned to subgroups based on their average expression of each gene set (v). <bold>b</bold>, <bold>c</bold> Performance comparison of CellSIUS to GiniClust2 and RaceID3 in detecting cells from sub-clusters and their signatures. <bold>b</bold> Recall, precision, and true negative rate (TNR) with regard to the detection of rare cells in synthetic data when varying the number of rare cells from 2 (0.2%) to 100 (10%) <bold>c</bold> Recall, precision, and true negative rate (TNR) with regard to the detection of outlier genes (gene signature) in synthetic data when varying and the number of signature genes from 2 to 100</p></caption><graphic xlink:href="13059_2019_1739_Fig3_HTML" id="MO3"/></fig></p><p id="Par30">The overall idea behind CellSIUS is similar to RaceID3 [<xref ref-type="bibr" rid="CR38">38</xref>] and GiniClust2 [<xref ref-type="bibr" rid="CR19">19</xref>], two recent methods for the identification of rare cell types in scRNA-seq datasets. All of these algorithms combine a global clustering with a second assignment method tailored to the identification of rare cell types. However, in contrast to existing methods, CellSIUS requires candidate marker genes to be cluster specific, and therefore, we hypothesized that our method will be more specific and less sensitive to genes that co-vary with confounders such as the total number of detected genes per cell. To overcome biases associated to the high dropout rates in scRNA-seq, CellSIUS considers only cells that have non-zero expression for the selected marker genes. Finally, in contrast to both RaceID3 and GiniClust2, CellSIUS directly returns a gene signature for each of the new cell subpopulations recovered.</p></sec><sec id="Sec5"><title>CellSIUS outperforms existing algorithms in the identification of rare cell populations</title><p id="Par31">We first compared CellSIUS performance to RaceID3 [<xref ref-type="bibr" rid="CR38">38</xref>] and GiniClust2 [<xref ref-type="bibr" rid="CR19">19</xref>] using a synthetic dataset. Briefly, we used the expression values of 1000&#x02009;K562 cells from our dataset to estimate the parameters for the simulation and generated two homogeneous populations of 500 cells (later referred to as clusters 1 and 2). We confirmed the mean-variance and mean-dropout relationships, library sizes, and percentage of zero counts per cells and per gene were similar to the underlying real data (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S2a-f). For this data, both CellSIUS and GiniClust correctly identified the two predefined clusters whereas RaceID3 detected a large number of false positives (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S2&#x02009;g).</p><p id="Par32">We then assessed each algorithm&#x02019;s ability to detect an increasingly rare cell type by adding between 2 and 100 (0.2&#x02013;10% of the cluster size) cells of a third type to the two homogenous populations described above. This new synthetic cell type was generated by increasing the log2 expression values of 20 randomly selected genes by an average of 2.5.</p><p id="Par33">We compared (i) recall as the fraction of rare cells correctly assigned to new clusters, i.e., the number of correctly identified rare cells divided by the total number of rare cells; (ii) precision as the fraction of true rare cells among all cells not assigned to the two main clusters; and (iii) true negative rate (TNR) as the fraction of abundant cells that were correctly assigned to the two main clusters. To enable a more direct comparison between the methods, benchmarking analyses were carried out with a predefined initial clustering for all approaches. CellSIUS had a recall of 1 for rare cell populations consisting of more than 2 cells. In contrast GiniClust2 did not identify any rare cell populations and RaceID3 recalled only ~&#x02009;50% of true positives (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>b, top panel). Additionally, CellSIUS exhibited a TNR of 1.0 and thus a precision of 1.0 (except in the one case where no true positives were recovered). While GiniClust2&#x02019;s TNR was also 1.0, the precision could not be defined due to the lack of identification of true and false positives. RaceID3 had a low TNR (mean&#x02009;=&#x02009;0.95, sd&#x02009;=&#x02009;0.01), resulting in low precision (mean&#x02009;=&#x02009;0.1, sd&#x02009;=&#x02009;0.1) (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>b, middle and bottom panel). We then repeated this comparison for the identification of signature genes. To this end, we generated a second set of populations. Briefly, the number of rare cells was fixed at 20 (~&#x02009;2% of total cells), and we increased the log2 expression values of between 2 and 100 genes by 2.5 on average. We compared (i) recall, (ii) precision, and (iii) TNR as above but with respect to genes. In comparison to CellSIUS, GiniClust2 showed a poor performance (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>c, top panel), consistent with failing to detect rare cell population. In contrast, RaceID3 performed slightly better than CellSIUS in terms of recall, however, with a precision cost. Whereas both precision and TNR were 1.0 for CellSIUS, RaceID3 had a low TNR (0.5) and consequently a low precision (mean&#x02009;=&#x02009;0.012, sd&#x02009;=&#x02009;0.007) (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>c, top and bottom panels).</p><p id="Par34">To systematically investigate the stability of CellSIUS&#x02019; output to parameter changes, we repeated the above-described analysis when varying fc_within, fc_between and corr_cutoff (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S3; <xref rid="Sec10" ref-type="sec">Methods</xref>). Results that highlighted the stability of both sensitivity and specificity are across a wide range of parameters.</p><p id="Par35">In summary, using synthetic data, we showed an increased sensitivity and specificity of our algorithm for rare cell type identification and outlier gene identification compared to GiniClust2 and RaceID3 (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>b, c) and demonstrated robustness to parameter choices (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S3).</p><p id="Par36">We next benchmarked CellSIUS&#x02019; specificity and selectivity using our dataset of known cell composition, randomly subsampling 100 HEK293 cells and 125 Ramos cells, and including 2, 5, or 10 Jurkat cells. Only cells assigned to be in cell cycle phase G1 were considered to ensure within-cluster homogeneity. To simulate varying degrees of transcriptional difference between the rare cell type (Jurkat) and its closest more abundant cell type (Ramos), we adapted an approach recently presented by Crow et al. [<xref ref-type="bibr" rid="CR39">39</xref>] (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>a). Briefly, from the initial dataset, 25 Ramos cells were held out. Subsequently, an increasing fraction of gene expression values in the Jurkat cells were replaced by the respective values in the held out Ramos cells, thus diluting the Jurkat-specific gene expression profile and making the Jurkat cells more and more similar to Ramos. Using this approach, we generated datasets with two equally sized abundant populations (HEK293 and Ramos, 100 cells each) and one rare population (Jurkat, varying between 2, 5, and 10 cells). We predefined two initial clusters: cluster 1 contained all HEK293 cells and cluster 2 combined the two lymphomas (Ramos and Jurkat).<fig id="Fig4"><label>Fig. 4</label><caption><p>CellSIUS benchmarking on cell line data. <bold>a</bold> Schematic overview of dataset perturbations. Starting from a dataset containing three cell types (abundant cell type 1, abundant cell type 2, and rare cell type), we first generated a defined number of rare cells by subsampling. In addition, we partitioned the type 2 cells in two, leaving out 25 cells from the dataset for later use. Next, we adjusted the subtlety of the transcriptional difference between the rare cells and their closest neighbor (cell type 2) by swapping a fraction of gene expression values in the type 2 cells with the corresponding value in the left-out rare cells. We then pre-defined an initial cluster assignment as cluster 1&#x02009;=&#x02009;type 1, cluster 2&#x02009;=&#x02009;the union of type 2 and rare cells and assessed whether different algorithms for detecting rare cell types are able to correctly classify the rare cells as such. <bold>b</bold>, <bold>c</bold> Comparison of CellSIUS to GiniClust2 and RaceID3 for varying incidence of the rare cell type and varying subtlety of the transcriptional signature here, we used 100 HEK293 cells as type 1, 100 Ramos cells as type 2, and up to 10 Jurkat cells as the rare cell type and we swapped between 0 and 99.5% of gene expression values. For each algorithm, we assessed the recall (<bold>b</bold>), i.e., the fraction of correctly identified rare cells, and precision (<bold>c</bold>), i.e., the probability that a cell which is classified as rare is actually a rare cell. <bold>d</bold> tSNE projection of subset 2 of the cell line dataset, colored by CellSIUS assignment. Cluster numbers correspond to the main clusters identified by MCL, clusters labeled x.sub indicate the CellSIUS subgroups. Symbols correspond to the cell line annotation. <bold>e</bold> Violin plot showing the main markers identified by CellSIUS, grouped by cluster</p></caption><graphic xlink:href="13059_2019_1739_Fig4_HTML" id="MO4"/></fig></p><p id="Par37">We then tested the ability of CellSIUS, RaceID3, and GiniClust2 to identify rare cell types for varying incidence (i.e., total number of rare cells) and subtlety (i.e., fraction of Jurkat genes replaced by Ramos genes). We assessed the recall (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>b) and precision (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>c) as above. Results showed a high sensitivity of all three methods for very subtle transcriptional signatures (99.5% of genes replaced, corresponding to 230 unperturbed genes) and low incidence (down to two cells except for GiniClust2). However, CellSIUS exhibited high precision (88.4% on average), in comparison to GiniClust2 (51.6% on average) and RaceID3 (15.6% on average).</p><p id="Par38">Having shown that CellSIUS is more sensitive and specific for the identification of rare cell types and outlier genes using synthetic and simulated biological data, we tested its ability to reveal transcriptomic signatures indicative of rare cell type&#x02019;s function(s). We applied CellSIUS to subset 2 of our dataset of known composition (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Table S1) with 6 clusters predefined using MCL (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>d). CellSIUS identified three subgroups (Jurkat, H1437, and a small subgroup of IMR90 cells) within the 6 initial clusters characterized by upregulation of three or more genes (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>e). Notably, the two strongest signatures were obtained for the two subgroups corresponding to Jurkat and H1437 cells with top marker genes consistent with previous knowledge: <italic>CD3G</italic> and <italic>CD3D</italic>, both of which are known T cell markers [<xref ref-type="bibr" rid="CR40">40</xref>] being the top markers for Jurkat (T cell lymphoma), and <italic>TFF1</italic> and <italic>BPIFA2,</italic> both shown to function in the respiratory tract [<xref ref-type="bibr" rid="CR41">41</xref>, <xref ref-type="bibr" rid="CR42">42</xref>] being the top markers for H1437 (lung adenocarcinoma, epithelial/glandular cell type).</p><p id="Par39">Taken together, these results show that CellSIUS outperforms existing methods in identifying rare cell populations and outlier genes from both synthetic and biological data. In addition, CellSIUS simultaneously reveals transcriptomic signatures indicative of rare cell type&#x02019;s function.</p></sec><sec id="Sec6"><title>Application to hPSC-derived cortical neurons generated by 3D spheroid directed-differentiation approach</title><p id="Par40">As a proof of concept, we applied our two-step approach consisting of an initial coarse clustering step followed by CellSIUS to a high-quality scRNA-seq dataset of 4857 hPSC-derived cortical neurons generated by a 3D cortical spheroid differentiation protocol generated using the 10X Genomics Chromium platform [<xref ref-type="bibr" rid="CR3">3</xref>] (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S4a and Table S3; see the &#x0201c;<xref rid="Sec10" ref-type="sec">Methods</xref>&#x0201d; section). During this in vitro differentiation process, hPSCs are expected to commit to definitive neuroepithelia, restrict to dorsal telencephalic identity, and generate neocortical progenitors (NP), Cajal-Retzius (CR) cells, EOMES<sup>+</sup> intermediate progenitors (IP), layer V/VI cortical excitatory neurons (N), and outer radial-glia (oRG) (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S4b). We confirmed that our 3D spheroid protocol generates cortical neurons with expected transcriptional identity that continue to mature upon platedown with expression of synaptic markers and features of neuronal connectivity at network level [<xref ref-type="bibr" rid="CR43">43</xref>] (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S4c, d, e, and see the &#x0201c;<xref rid="Sec10" ref-type="sec">Methods</xref>&#x0201d; section).</p><p id="Par41">Initial coarse-grained clustering using MCL identified four major groups of cells that specifically express known markers for NPs [<xref ref-type="bibr" rid="CR44">44</xref>], mixed glial cells (G), CR cells [<xref ref-type="bibr" rid="CR45">45</xref>], and neurons (N) [<xref ref-type="bibr" rid="CR46">46</xref>] (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>a, b). A small population of contaminating fibroblasts (0.1% of total cells) was removed from the dataset for downstream analyses. CR cells expressed <italic>DCX</italic>, <italic>CALB2</italic>, <italic>STMN2</italic>, and <italic>MAPT</italic> consistently with developing mouse and human cortex (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>b) [<xref ref-type="bibr" rid="CR49">49</xref>&#x02013;<xref ref-type="bibr" rid="CR51">51</xref>]. The robust expression of <italic>FOXG1</italic> in the general population (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S5a) and the expression of <italic>PAX6</italic>, <italic>EMX2</italic>, and <italic>LHX2</italic> in NPs (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>b) indicated our differentiation protocol mainly generates cells with dorsal telencephalic identity [<xref ref-type="bibr" rid="CR52">52</xref>].<fig id="Fig5"><label>Fig. 5</label><caption><p>Characterization of hPSC-derived cortical excitatory neurons by scRNA-seq. <bold>a</bold> tSNE projection of 4857 single-cell transcriptomes of hPSC-derived neuronal cell types after 86&#x02009;days of differentiation. Unsupervised clustering using MCL groups cells into four major classes: Neurons (N), neuroepithelial progenitors (NP), mixed glial cells (G), and Cajal-Retzius cells (CR). In addition, a small population of fibroblasts (Fib) is identified. <bold>b</bold> The identified cell populations are characterized by expression of known markers for the expected cell types. Expression values are shown as log2 (normalized UMI counts +&#x02009;1). <bold>c</bold> tSNE projection, colored by CellSIUS assignment. Main clusters are denoted .main, subclusters .sub. <bold>d</bold> Mean expression of each marker gene set identified by CellSIUS, projected onto the same tSNE map as shown in <bold>a</bold>. The top markers are indicated for each gene sets; numbers in brackets refer to how many additional genes are part of the marker gene set. <bold>e</bold> Comparison of the gene signature uncovered by CellSIUS to genes found to be enriched (<italic>p</italic>&#x02009;&#x0003c;&#x02009;0.05) in choroid plexus of the fourth ventricle according to harmonizome [<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR48">48</xref>]. <bold>f</bold> Single optical sections of neurosphere cryosections acquired by confocal microscopy showing co-localization of TTR and PTGDS in cells predominantly on the periphery of neurospheres (panel left&#x02014;composite image of a neurosphere; panels right&#x02014;split images from a different neurosphere)</p></caption><graphic xlink:href="13059_2019_1739_Fig5_HTML" id="MO5"/></fig></p><p id="Par42">Applying CellSIUS to this data identified 7 subpopulations (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>c, d). Notably, within the mixed glial cells (G), CellSIUS identified a rare subgroup (1.1% of total population, G.sub_1) characterized by a signature of 10 genes. Nine of those <italic>((TRPM3, PTGDS, TTR, CXCL14, HTR2C, WIF1, IGFBP7, MT1E, DLK1</italic>) are known to be enriched in primary pre-natal human choroid plexus (CP) (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>e) compared to the other tissues from the developing human cortex (harmonizome database [<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR48">48</xref>] using a cutoff of 1.3 for the standardized value, corresponding to a Benjamini-Hochberg-corrected <italic>p</italic> adjusted &#x0003c;&#x02009;0.05). This G.sub_1 population is therefore consistent with the formation of CP, a secretory neuroepithelial tissue that produces cerebrospinal fluid (CSF) and that has multiple origins along the rostro-caudal axis of the developing nervous system including the dorsal telencephalic midline [<xref ref-type="bibr" rid="CR53">53</xref>]. We further validated the presence of CP neuroepithelia in our 3D human cortical cultures by confocal microscopy analysis. Using neurosphere cryosections, we demonstrated co-localization of canonical CP marker transthyretin (TTR) with prostaglandin D2 synthase (PTGDS), another CP enriched protein described in primary mouse and human tissue, in a limited number of cells located almost exclusively on the periphery of neurospheres (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>f). Collectively, these results suggest that the 3D spheroid human cortical differentiation protocol described here can generate developmentally relevant cell types and that CellSIUS can identify rare cell populations within the heterogeneity and complexity of stem cell-based models.</p><p id="Par43">CellSIUS identified a second subgroup in the mixed glial cells (G) characterized by high expression levels of glycolytic enzymes (G.sub_2, 2.6%) (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>c, d and Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S6a). Analysis between G.sub_2 and the rest of the G cells revealed upregulation of <italic>HOPX, PTPRZ1, CLU, BCAN, ID4,</italic> and <italic>TTYH1</italic> in the main group, a transcriptional signature consistent with developing human outer radial glia (oRG) [<xref ref-type="bibr" rid="CR54">54</xref>]<italic>,</italic> (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S6a Additional&#x000a0;file&#x000a0;<xref rid="MOESM2" ref-type="media">2</xref>: Table S4). oRG cells also upregulated mitochondrial genes (Additional file&#x000a0;<xref rid="MOESM2" ref-type="media">2</xref>: Table S4) that are crucial for oxidative phosphorylation, highlighting the metabolic difference between these two groups. We hypothesize the G.sub_2 subgroup to be a progenitor population that is located closer to the hypoxic interior of neurospheres, a common feature of the 3D spheroid differentiation protocols.</p><p id="Par44">In addition, CellSIUS identified a subgroup of NP cells (NP.sub, 10.6%) defined by upregulation of cell-cycle-related genes such as <italic>HMGB2, TOP2A</italic>, and <italic>MKI67</italic> (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>c, d, Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S6a) as well as a subgroup of CR cells (CR.sub, 0.8%) characterized by <italic>SEMA3E</italic>, <italic>BTG1</italic>, and <italic>PCDH11X</italic> (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>b and Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S6A) which may represent CR cells at a different stage of migration [<xref ref-type="bibr" rid="CR55">55</xref>&#x02013;<xref ref-type="bibr" rid="CR57">57</xref>].</p><p id="Par45">Finally, CellSIUS revealed a split in the neuronal population (N), identifying 2 groups, N.sub_2 (8.6%) and N.sub_1 (16.7%) (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>c, d, Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S6a)<italic>.</italic> In addition to <italic>NHLH1</italic> and <italic>PPP1R17</italic> known to be enriched in immature neurons [<xref ref-type="bibr" rid="CR54">54</xref>], N.sub_2 expressed <italic>EOMES</italic> (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S5b), a well-characterized marker of cortical intermediate progenitors [<xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR54">54</xref>] that give rise to TBR1<sup>+</sup> cortical neurons (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S5c) and is likely a mixed population of intermediate progenitors and immature neurons. In contrast, markers identified by CellSIUS for the N.sub_1 neuronal population were unexpected. Although co-expression of <italic>FEZF2</italic>, <italic>CRYM</italic>, <italic>PCDH17,</italic> and <italic>RUNX1T1</italic> in this cortical neuronal population is consistent with recent scRNA-seq data from the developing human cortex (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S7b, EN-V1&#x02013;1: Early-born deep-layer/sub-plate excitatory neurons, EN-PFC1: Early-born deep-layer/sub-plate excitatory neurons prefrontal cortex), robust <italic>NTS</italic> expression in developing cortical neurons has not been reported so far to the best of our knowledge. The expression of <italic>FEZF2</italic> (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S5d) in this culture which is consistent with the general dorsal telencephalic identity of these cells and co-expression of <italic>FEZF2</italic> and <italic>BCL11B</italic> (CTIP2) in this particular post-mitotic neuronal sub-population (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S5d-e) could suggest patterning towards cortico-spinal motor neurons (CSMNs). However, the presence of <italic>NTS,</italic> which encodes a 13-amino acid neuropeptide called neurotensin highly expressed in the hypothalamus and amygdala, is not in line with the overall transcriptional identity as discussed above. Analysis of a recently published scRNA-seq dataset from different regions and developmental stages of the human cortex [<xref ref-type="bibr" rid="CR46">46</xref>] revealed that only a few cells derived from the fetal primary visual cortex (age 13 pcw) express <italic>NTS</italic> (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S7). The limited number of cells in our dataset limits any firm conclusions.</p><p id="Par46">To further characterize the transition from progenitors to the two different neuronal cell types (CR cells and all N populations), we applied Monocle for trajectory analysis to a subset of the cells corresponding to these three identities. This analysis revealed a tree with two branches (Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>a). As expected, cells progress from the tree root which is composed of progenitors via the NHLH1<sup>high</sup>/PPP1R17<sup>high</sup> population towards either N (branch 1) or CR cells (branch 2). Along the trajectory, the NP marker <italic>VIM</italic> decreases gradually whereas <italic>NHLH1</italic> increases up to the branch point, then decreases again (Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>b). The CR branch ends with cells expressing high levels of <italic>RELN</italic>, and the N branch is characterized by gradual increase of <italic>FEZF2</italic> expression and ending in the N.sub_1 population (Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>b). Notably, at the very tip of this branch, we also find a very small number of cells expressing <italic>LDB2</italic> and <italic>DIAPH3</italic> which are markers of CSMNs in the mouse [<xref ref-type="bibr" rid="CR58">58</xref>]. It is plausible that, given more time, this population may eventually give rise to CSMNs with a more defined transcriptional signature.<fig id="Fig6"><label>Fig. 6</label><caption><p>Monocle analysis of the NP, N, and CR cluster. <bold>a</bold> Consistent with the subgroup assignment by CellSIUS, monocle orders cells on a trajectory from NP via immature neurons (N_early) to either mature N or CR cells. <bold>b</bold> Gene expression along pseudotime. Shown is a marker for NPs (VIM), immature neurons (NHLH1), N.sub_2 (FEZF2), and CR cells (RELN)</p></caption><graphic xlink:href="13059_2019_1739_Fig6_HTML" id="MO6"/></fig></p></sec><sec id="Sec7"><title>Comparison of CellSIUS, RaceID3, and Giniclust2 performance for rare cell type identification in hPSC-derived cortical neurons</title><p id="Par47">To get an understanding of how CellSIUS, GiniClust2, and RaceID3 differ in the identification of rare cell types from a complex dataset, we compared their output when run on the cortical neuron datasets. Because a classic benchmarking is not possible here due to the lack of a ground truth, we instead focus on comparing the ability of each algorithm to reveal experimentally validated signatures or cell types known from literature. As before, we used the same initial of 4 main clusters identified by MCL (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>a) for all algorithms. GiniClust2 resulted in a total of 20 clusters. The main differences between GiniClust2 and CellSIUS (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S6b) results can be summarized as follows: (i) GiniClust2 generated clusters that merge major known cell types (for example cluster 14 merges G, G.sub_1 (=CP), G.sub_2, N, N.sub_1 (late neurons) and N.sub_2 (early neurons)), and (ii) GiniClust2 did not detect CP (G.Sub_1), cycling NPs (NP.sub) nor the well-described immature neurons (N.sub_2).</p><p id="Par48">RaceID3 with default settings resulted in a total of &#x0003e;&#x02009;50 clusters, consistent with the high false-positive rate observed with synthetic and cell line data. With a more stringent outlier probability cutoff (10<sup>&#x02212;20</sup>), RaceID3 identified 10 clusters with a similar overall assignment to CellSIUS (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S6c). However, if RaceID3 did partly detect CP (G.Sub_1), it also split the CP cluster identified by CellSIUS across several other clusters with the majority of cells assigned to either cluster 3 (19 CP together with 4 other cells) or cluster 5 (mixed with a large number of G, N, and NP cells). The CP markers <italic>PTGDS</italic> and <italic>TTR</italic> are co-expressed in 49/53 CP cells identified by CellSIUS but only in 19/54 CP cells identified by RaceID3 suggesting that RaceID3 incorrectly assigned most of the CP cells to a merged G/NP/N cluster. In addition, and similarly to GiniClust2, RaceID3 did identify neither cycling NPs (NP.sub) nor the above-described progenitors and immature neurons population (N.sub_2).</p><p id="Par49">In summary, these results indicate superior performance with regard to specificity and sensitivity of CellSIUS compared to other approaches when applied to the complex and heterogeneous data generated here and demonstrate the algorithm&#x02019;s ability to identify rare populations within major cell types that differ by their metabolic state, cell cycle phase, or migratory state.</p></sec></sec><sec id="Sec8"><title>Discussion</title><p id="Par50">We generated a benchmark dataset of ~&#x02009;12,000 single-cell transcriptomes from 8 cell lines to compare the performance of some of the most recent and widely used scRNA-seq feature selection and clustering approaches. Our findings suggest that in our dataset, for unsupervised feature selection, the DANB methods implemented in the M3Drop package outperformed HVG. While all clustering methods tested performed equally well on data with balanced and abundant cell populations, <italic>k</italic>-means and model-based methods performed poorly on subsampled datasets with unequal cell type proportions, typically splitting clusters containing many cells while merging those containing few cells. This is likely a consequence of feature selection and PCA-based dimensionality reduction prior to clustering where these methods select or assign weights to genes based on mean expression and variance across the whole cell population, which are both low if a gene is specifically expressed in a small subset of cells only.</p><p id="Par51">In contrast, hclust in combination with dynamicTreeCut, MCL, and DBSCAN resulted in accurate cluster assignments across all subsampled datasets. Strikingly, none of the methods we tested was able to identify rare cell types (&#x0003c;&#x02009;1% in this dataset). It is worth noting that although DBSCAN does classify rare cell types as border points, it did however not reliably identify these populations for two reasons: (i) additional cells that did not belong to the rare populations are also classified as border points; (ii) DBSCAN does not perform well if there are points connecting clusters, which is often the case in scRNA-seq datasets. In summary, our comparison of clustering methods is consistent with a recent review describing the challenges in unsupervised clustering of single-cell RNA-seq data [<xref ref-type="bibr" rid="CR16">16</xref>], highlighting the methodology gap for detecting rare cell types.</p><p id="Par52">To overcome these limitations, we developed CellSIUS, a novel algorithm that takes initial coarse clusters as input and identifies rare cell subtypes based on correlated gene sets specific to subpopulations. Based on our comparison of clustering methods above, we used MCL as our default clustering method: MCL showed a high accuracy in the comparison to other methods, requires fewer parameter choices than hclust for defining the number of clusters, and, unlike DBSCAN, assigns all points to clusters.</p><p id="Par53">The overall idea behind CellSIUS is similar to RaceID3 [<xref ref-type="bibr" rid="CR38">38</xref>] and GiniClust2 [<xref ref-type="bibr" rid="CR19">19</xref>], two recent methods for the identification of rare cell types in scRNA-seq datasets. All of these algorithms combine a global clustering with a second assignment method which is tailored to finding rare cell types. There are however important differences between the approaches which are at the basis of CellSIUS&#x02019; superior performance for both rare cell type as well as outlier genes&#x02019; identification in terms of specificity and selectivity.</p><p id="Par54">RaceID3&#x02019;s initial step is a <italic>k</italic>-medoids clustering, followed by outlier cell identification in each cluster in four steps: (i) calibration of a background model of gene expression by fitting a negative binomial distribution to the mean and variance of each gene in each cluster; (ii) identification of outlier cells by calculating for each gene and each cell the probability of observing this expression value under the assumption of the background model; (iii) merging of potential outlier cells into new clusters based on the similarity of their gene expression; and (iv) definition of new cluster centers for both the original and the outlier clusters. In a final step, cells are assigned to the cluster they are closest to. In contrast to CellSIUS, RaceID3 does not require the outlier genes to be cluster specific; consequently, it may select genes that co-vary with technical confounders such as the total number of detected genes per cell. In addition, whereas CellSIUS only considers subcluster-specific genes to assign cells to final clusters, the final cluster assignment in RaceID3 is done based on the similarity of each cell&#x02019;s whole transcriptomic signature to each cluster center. In cases where the distance between the outlier cluster and neighboring clusters is small, this leads to a high number of false positives, with many cells initially not identified as outliers being merged into the nearest outlier cluster.</p><p id="Par55">GiniClust2 runs two independent clustering steps on the same data. The first clustering aims at capturing global structure of the data by running a <italic>k</italic>-means clustering on the expression of genes with a high Fano factor. This is motivated by the fact that a high Fano factor is associated with genes that are differentially expressed between abundant cell types. The second clustering is performed by running a density-based clustering on genes with a high Gini index which is typically associated with genes being differentially expressed between rare and abundant cells. In a final step, the results of both clustering are merged based on a weighted consensus association. The main differences to CellSIUS are as follows: (i) the selection of the genes for the rare cell type assignment is performed using a global metric (i.e., the Gini coefficient across the whole dataset), whereas CellSIUS takes into account the information on the global clustering (e.g., considers only cluster-specific genes), and (ii) the final assignment is a weighted average of the results from both clustering steps, whereas we use a two-step approach consisting of an initial coarse clustering step followed by CellSIUS for the identification of rare cell types and outlier genes.</p><p id="Par56">Enforcing gene signatures to be cluster-specific comes with the promise to overcome some technical biases, e.g., different number of detected genes between cells, differences in the total number of counts per cell or normalization artifacts. For example, normalization may lead to artificially high counts for abundant transcripts in cells that have overall few detected genes. These genes are, however, present across different clusters and would therefore not be considered a valid signature. While restricting to cluster-specific signatures has the potential to help disentangle technical and biological variability and increase the precision of rare cell type identification, it comes with the limitation of potentially missing rare cell types spread over multiple clusters. This issue could be addressed by iteratively merging the most similar clusters and re-running CellSIUS for each initial cluster definition. A further consideration is CellSIUS&#x02019; output sensitivity to initial cluster assignments. In practice, this should only be an issue if there is no clear global structure in the data and cluster assignments are not consistent between different clustering methods and/or parameter settings. In such cases, one could use a consensus assignment from a combination of different clustering assignments.</p><p id="Par57">To exemplify the added value of CellSIUS over existing approaches in a real-world setting, we applied the workflow and our two-step clustering approach to a complex biological dataset consisting of hPSC-derived neurons. We identified major neural cell types of early human corticogenesis such as cycling and quiescent NPs, <italic>EOMES</italic><sup>+</sup> IPs, CR cells, immature and mature neurons with a transcriptional identity indicative of layer V/VI neurons, and oRG. Overall, the transcriptional fingerprint of each major group was in line with a recent scRNA-seq data set from the developing human cortex. CellSIUS analysis also revealed a transcriptional signature in the mature neuronal population that deviates from the expected cortical trajectory, typified by the high expression levels of <italic>NTS</italic> detected in N.sub_1, highlighting the importance of unbiased characterization of hPSC differentiation platforms at single-cell level. Single-cell trajectory analysis of NP, CR, and N cells using Monocle revealed a pseudo-temporal order of progenitors gradually differentiating into neurons, with a lineage split between Cajal-Retzius cells and <italic>FEZF2</italic><sup>+</sup> neurons.</p><p id="Par58">Importantly, CellSIUS identified known as well as novel rare cell types within the major groups, such as putative CP (G.sub_1), a population that was either not detected, or detected only partly by existing approaches for rare cell type identification. Single-cell RNA-seq data usually contains a small fraction of doublets, i.e., transcriptomes derived from two or more cells, which could form artifactual clusters. Our results do not indicate the presence of doublet-driven clusters&#x02014;each subcluster has its own unique markers. In addition, most of the subpopulation signatures represent biological function that is supported by the literature. Finally, we experimentally validated the presence of CP neuroepithelia in our 3D cortical spheroid cultures by confocal microscopy and validated the CP-specific signature gene list identified by CellSIUS using primary pre-natal human data. For the CP lineage in particular and other identified rare cell populations in general, the signature gene lists output from CellSIUS provide the means to isolate these populations for in vitro propagation and characterization of their role in neurological disorders.</p></sec><sec id="Sec9"><title>Conclusions</title><p id="Par59">In this study, we present CellSIUS, a novel method to identify and characterize rare cell types from complex scRNA-seq datasets. Benchmarking of CellSIUS on synthetic data and a large dataset with known cell composition generated from 8 human cell lines demonstrated the high sensitivity and specificity of CellSIUS over existing approaches. Characterization of a novel human pluripotent cell differentiation protocol recapitulating deep-layer corticogenesis in vitro using scRNA-seq and CellSIUS revealed previously unrecognized complexities in human stem cell-derived cellular populations. Importantly, CellSIUS enabled identification of known and novel rare cell populations and their signature gene list providing the means to study those populations in vitro in light of their role in health and disease.</p></sec><sec id="Sec10"><title>Methods</title><sec id="Sec11"><title>Human cell lines</title><p id="Par60">For the benchmarking dataset, 8 different human cell lines from the ATCC biorepository have been used (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>). Cell lines were shown to be mycoplasma free using the Mycoalert kit from Lonza.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Cell lines and culture conditions used in this study</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Cell line</th><th>Gender</th><th>Cell type</th><th>Tissue of origin</th><th>Obtained from</th><th>Culture conditions</th></tr></thead><tbody><tr><td>A549</td><td>M</td><td>Alveolar basal epithelial (adherent)</td><td>Lung adenocarcinoma</td><td><p>ATCC</p><p>CCL-185</p></td><td>ATCC F12K (ATCC, P/N 30-2004) +10% FCS (AMIMED, P/N 2-01F36-I).</td></tr><tr><td>H1437</td><td>M</td><td>Epithelial/glandular (adherent)</td><td>Lung adenocarcinoma, derived from metastatic site: pleural effusion</td><td><p>ATCC</p><p>CRL-5872</p></td><td>RPMI (Invitrogen, P/N A1049101) +10% FBS (ATCC, P/N SCRR-30-2020)</td></tr><tr><td>HCT116</td><td>M</td><td>Epithelium-like (adherent)</td><td>Colon carcinoma</td><td><p>ATCC</p><p>CCL-247</p></td><td>ATCC McCoy's 5A (ATCC, P/N 30-2007) + 10% FCS (AMIMED, P/N 2-01F36-I)</td></tr><tr><td>HEK293</td><td>F</td><td>Epithelial (adherent)</td><td>Transformed cell line, derived from embryonic kidney</td><td>ATCC, P/N CRL-1573</td><td>ATCC EMEM (ATCC, P/N 30-2003) +10% FCS (AMIMED, P/N 2-01F36-I)</td></tr><tr><td>IMR90</td><td>F</td><td>Fibroblast (adherent)</td><td>Fetal lung</td><td><p>ATCC</p><p>CRL-186</p></td><td>ATCC EMEM (ATCC, P/N 30-2003) 10% FCS (AMIMED, P/N 2-01F36-I)</td></tr><tr><td>Jurkat</td><td>M</td><td>T cell (suspension)</td><td>Childhood T acute lymphoblastic leukemia</td><td>ATCC, P/N TIB-152</td><td>RPMI (Invitrogen, P/N 61870-044) + 10% FCS (AMIMED, P/N 2-01F36-I)</td></tr><tr><td>K562</td><td>F</td><td>Undifferentiated, lymphoblast with granulocyte/erythrocyte/monocyte characteristics (suspension)</td><td>Chronic myelogenous leukemia, BCR-ABL1 positive</td><td>ATCC, P/N CRL-1573</td><td>RPMI (Invitrogen, P/N 61870-044) + 10% FCS (AMIMED, P/N 2-01F36-I).</td></tr><tr><td>Ramos</td><td>M</td><td>B cell (suspension)</td><td>Burkitt&#x02019;s lymphoma</td><td>ATCC, P/N CRL-1596</td><td><p>Batch 3: RPMI (Invitrogen, P/N A1049101) +10% FBS (ATCC, P/N SCRR-30-2020)</p><p>Batch 4: RPMI (Invitrogen, P/N 61870-044) + 10% FCS (AMIMED, P/N 2-01F36-I)</p></td></tr></tbody></table></table-wrap></p></sec><sec id="Sec12"><title>Single-cell RNA-sequencing of cell lines</title><p id="Par61">Cellular suspensions were loaded on a 10x Genomics Chromium Single Cell instrument to generate GEMs. Single-cell RNA-seq libraries were prepared using GemCode Single Cell 3&#x02032; Gel Bead and Library Kit according to CG00052_SingleCell3&#x02019;ReagentKitv2UserGuide_RevB. GEM-RT was performed in a Bio-Rad PTC-200 Thermal Cycler with semi-skirted 96-well plate (Eppendorf, P/N 0030 128.605): 53&#x02009;&#x000b0;C for 45&#x02009;min and 85&#x02009;&#x000b0;C for 5&#x02009;min, held at 4&#x02009;&#x000b0;C. After RT, GEMs were broken and the single strand cDNA was cleaned up with DynaBeads&#x000ae; MyOne&#x02122; Silane Beads (Life Technologies P/N, 37002D). cDNA was amplified using a Bio-Rad PTC-200 Thermal cycler with 0.2-ml 8-strip non-Flex PCR tubes, with flat Caps (STARLAB, P/N I1402&#x02013;3700): 98&#x02009;&#x000b0;C for 3&#x02009;min; cycled 12x: 98&#x02009;&#x000b0;C for 15&#x02009;s, 67&#x02009;&#x000b0;C for 20&#x02009;s, and 72&#x02009;&#x000b0;C for 1&#x02009;min; 72&#x02009;&#x000b0;C for 1&#x02009;min; and held at 4&#x02009;&#x000b0;C. Amplified cDNA product was cleaned up with the SPRIselect Reagent Kit (0.6X SPRI). Indexed sequencing libraries were constructed using the reagents in the Chromium Single Cell 3&#x02032; library kit V2 (10x Genomics P/N-120237), following these steps: (1) fragmentation, end-repair and A-tailing; (2) post fragmentation, end-repair, and A-tailing double sided size selection with SPRIselect Reagent Kit (0.6X SPRI and 0.8X SPRI); (3) adaptor ligation; (4) post-ligation cleanups with SPRIselect (0.8X SPRI); (5) sample index PCR using the Chromium Multiplex kit (10x Genomics P/N-120262); (6) post sample index double sided size selection&#x02014;with SPRIselect Reagent Kit (0.6X SPRI and 0.8X SPRI). The barcode sequencing libraries were quantified using a Qubit 2.0 with a Qubit&#x02122; dsDNA HS Assay Kit (Invitrogen P/N Q32854), and the quality of the libraries was performed on a 2100 Bioanalyzer from Agilent using an Agilent High Sensitivity DNA kit (Agilent P/N 5067&#x02013;4626). Sequencing libraries were loaded at 10&#x02009;pM on an Illumina HiSeq2500 with 2&#x02009;&#x000d7;&#x02009;50 paired-end kits using the following read length: 26&#x02009;cycles Read1, 8&#x02009;cycles i7 Index, and 98&#x02009;cycles Read2. The CellRanger suite (2.0.2) was used to generate the aggregated gene expression matrix from the BCL files generated by the sequencer based on the hg38 Cell Ranger human genome annotation files.</p></sec><sec id="Sec13"><title>Bulk RNA-sequencing of cell lines</title><p id="Par62">For each individual cell line, RNA was isolated from 5&#x02009;&#x000d7;&#x02009;10<sup>5</sup> cells using the RNeasy Micro kit (Qiagen, Cat# 74104). The amount of RNA was quantified with the Agilent RNA 6000 Nano Kit (Agilent Technologies, Cat# 5067&#x02013;1511). RNA sequencing libraries were prepared using the Illumina TruSeq RNA Sample Prep kit v2 and sequenced using the Illumina HiSeq2500 platform. Samples were sequenced to a length of 2&#x02009;&#x000d7;&#x02009;76 base-pairs. Read pairs were mapped to the <italic>Homo sapiens</italic> genome (GRCh38) and the human gene transcripts from Ensembl version 87 [<xref ref-type="bibr" rid="CR59">59</xref>] by using an in-house gene quantification pipeline [<xref ref-type="bibr" rid="CR60">60</xref>]. Genome and transcript alignments were used to calculate gene counts based on Ensembl gene IDs.</p></sec><sec id="Sec14"><title>Differentiation of cortical excitatory neurons from human pluripotent stem cells in suspension</title><p id="Par63">H9-hESCs (WA09) were obtained from WiCell and maintained in TeSR-E8 medium (Stemcell Tech., 05990) on tissue-culture plates coated with vitronectin (Gibco, A14700). hESCs were passaged using ReLeSR (Stemcell Tech., 05873) to dissociate into cell clumps and were replated in E8 plus thiazovivin (Selleckchem, S1459) at 0.2&#x02009;&#x003bc;M. H9-hESC line was free of mycoplasma and was tested using the Mycoalert detection kit (Lonza).</p><p id="Par64">hESCs were changed to mTesR1 (Stemcell Tech., 85,850) media when they were 70&#x02013;80% confluent and maintained in mTesR1 for a minimum of 2&#x000a0;days before confluent monolayer of hESCs were neurally converted by changing the media to phase I (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref><bold>:</bold> Table S5). Seven days post induction, cells were dissociated to single-cell suspension with Accutase (Gibco A1110501), seeded at 1.5E6 cells/mL in spinner flasks with phase II media <bold>(</bold>Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref><bold>:</bold> Table S5) supplemented with 2&#x02009;&#x003bc;M Thiazovivin and 10&#x02009;ng/mL FGF2 (Peprotech, 100-18B) (final) and incubated at 37&#x02009;&#x000b0;C on a micro-stir plate at 40&#x02009;rpm for 4&#x02009;days. Media was then changed to phase III (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref><bold>:</bold> Table S5), and neurospheres were further cultured for 17&#x02009;days at 60&#x02009;rpm, changing media 50% twice a week. On day 28, media were changed to phase IV <bold>(</bold>Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Table S5) and cultures were maintained 21 more days with 50% media change twice a week. From day 49 onwards, cultures were switched to Ph IV media for maintenance. Neurospheres were dissociated with Papain kit (Worthington) at day 86 for single-cell RNAseq or neuronal platedowns on laminin (Sigma, L2020), fibronectin (Corning, 354,008), and Matrigel (Corning, 354,230) coated plates.</p></sec><sec id="Sec15"><title>Characterization of cortical neurons generated by the 3D spheroid protocol</title><p id="Par65">Generation of layer V/VI neuronal populations was confirmed by immuno-fluorescence analysis of D86 cultures upon dissociation and plating, showing robust expression of deep-layer cortical neuronal markers TBR1 and CTIP2 (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S4c). Cortical neurons generated by the 3D spheroid protocol co-cultured with rat glia for 4&#x000a0;weeks were positive for pre- and post-synaptic markers Synaptophysin I and PSD-95 (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S4d). Calcium imaging by FDSS 7000EX platform demonstrated spontaneous intracellular calcium oscillations, indicating that spontaneous firing was synchronized between the majority of the cortical neurons in the 96-wells (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S4e).</p></sec><sec id="Sec16"><title>Immunofluorescence and cryosectioning</title><p id="Par66">Cells were fixed with 4% PFA, permeabilized with 0.2% Triton X-100 at room temperature, and then blocked in 3% goat serum, followed by incubation with primary (TBR1 - Abcam, ab31940; CTIP2 &#x02013; Abcam, ab18465; &#x003b2;-3 tubulin &#x02013; Biolegend, 801,202; PSD-95 &#x02013; Synaptic Systems, 124,011; Synaptophysin 1 &#x02013; Synaptic Systems, 101,002; Transthyretin &#x02013; Novus Biologicals, NBP2&#x02013;52575, Prostaglandin D Synthase (PTGDS) &#x02013; Abcam, ab182141) and secondary antibodies (Alexa Flours, Invitrogen). The nuclei were counter-stained with 49,6-diamidino-2-phenylindole (DAPI, Sigma). Cryosectioning of neurospheres was performed as previously described [<xref ref-type="bibr" rid="CR61">61</xref>]. Cells were imaged using an Observer D1 (Zeiss) microscope or Olympus SD-OSR spinning-disk confocal microscope (60x oil immersion). The images were processed using Zen 2 (Zeiss), MetaMorph, or Image J (brightness and contrast adjustments, thresholding for composite images) and assembled using Adobe Photoshop CS6.</p><p id="Par67">Antibody validation: TBR1: validated on Mouse Hippocampus Tissue Lysate, Rat Hippocampus Tissue Lysate, Human cerebral cortex. CTIP2: validated by IHC on adult mouse hippocampus and adult mouse spinal cord and by ICC on neonatal mouse hippocampal cultured neurons. b3-tubulin: Quality control tested by formalin-fixed paraffin-embedded immunohistochemical staining. PSD-95: Knock-out verified, validated by IF on rat hippocampal neurons. Synaptophysin I: Does not cross-react with other synaptophysins, validated by IF on hippocampal neurons. TTR: Validated by IF analysis of A549 and MCF-7 cells and IHC of human liver tissue. PTGDS: Validated by IF on HEPG2 cells and IHC on human prostate tissue. All information is from supplier product data sheets.</p></sec><sec id="Sec17"><title>Calcium imaging</title><p id="Par68">The intracellular Ca<sup>2+</sup> oscillations in human cortical neuron and rat glia co-cultures were assessed using the FLIPR Calcium 6 Kit (Molecular Devices LLC, San Jose, California). Briefly, 96-well Greiner &#x003bc;-clear plates (655097) were seeded with 2500 rat glia (Lonza, R-CXAS-520) per well in Ph IV media and cultured for 7&#x000a0;days. Human cortical neurospheres were dissociated with papain as described above at DIV 56, and 50,000 single cells per well were plated on rat glia in phase IV media. Co-cultures were maintained for 4&#x000a0;weeks with twice-weekly 50% medium exchange. Cells were loaded with calcium 6 dye for an hour which was reconstituted in imaging buffer (NaCl 2.5&#x02009;mM, KCl 125&#x02009;mM, KH<sub>2</sub>PO<sub>4</sub> 1.25&#x02009;mM, CaCl<sub>2</sub> 2&#x02009;mM, MgCl<sub>2</sub> 2&#x02009;mM, HEPES (acid) 25&#x02009;mM, D-glucose 30&#x02009;mM, pH&#x02009;7.4, filter-sterilized). Kinetics of Ca<sup>2+</sup> oscillations were determined as fluorescence intensity at 540&#x02009;nm following excitation at 480 using the FDSS 7000EX Functional Drug Screening System (Hamamatsu) maintained at a constant 37&#x02009;&#x000b0;C throughout the assay. A total of 3000 reads per assay were recorded. The exposure time per read was 100&#x02009;ms with sensitivity set to 1.</p></sec><sec id="Sec18"><title>Single-cell RNA-sequencing of neuronal cells</title><p id="Par69">Cells were resuspended to 1 million cells/mL and run through the 10X Chromium, Version 2, single-cell RNA-seq pipeline per vendor&#x02019;s instructions. Reverse transcription master mix was prepared from 50&#x02009;&#x003bc;L RT reagent mix (10X, 220,089), 3.8&#x02009;&#x003bc;L RT primer (10X, 310,354), 2.4&#x02009;&#x003bc;L additive A (10X, 220,074), and 10&#x02009;&#x003bc;L RT enzyme mix (10X, 220,079). 4.3&#x02009;&#x003bc;L cell solution was mixed with 29.5&#x02009;&#x003bc;L H<sub>2</sub>O and 66.2&#x02009;&#x003bc;L reverse transcription master mix. Ninety-microliter sample was loaded onto the 10X Single Cell 3&#x02032; Chip along with 40&#x02009;&#x003bc;L barcoded gel beads and 270&#x02009;&#x003bc;L partitioning oil, and the microfluidics system was run to match gel beads with individual cells. The droplet solution was then slowly transferred to an 8-tube strip, which was immediately incubated for 45&#x02009;min at 53&#x02009;&#x000b0;C to perform reverse transcription, then 5&#x02009;min at 85&#x02009;&#x000b0;C. The sample was treated with 125&#x02009;&#x003bc;L recovery agent (10X, 220,016), which was then removed along with the partitioning oil. Two hundred microliters of cleanup solution containing 4&#x02009;&#x003bc;L DynaBeads MyOne Silane Beads (Thermo Fisher, 37002D), 9&#x02009;&#x003bc;L water, 182&#x02009;&#x003bc;L Buffer Sample Clean Up 1 (10X, 220,020), and Additive A (10X, 220,074) was added to the sample, and the solution was mixed 5 times by pipetting and allowed to incubate at room temperature for 10&#x02009;min. Beads were separated via magnetic separator and supernatant was removed. While still on the magnetic separator, the beads were then washed twice with 80% ethanol. The separator was then removed and the beads were resuspended in 35.5&#x02009;&#x003bc;L elution solution consisting of 98&#x02009;&#x003bc;L Buffer EB (Qiagen, 19,086), 1&#x02009;&#x003bc;L 10% Tween 20 (Bio-Rad, 1,610,781), and 1&#x02009;&#x003bc;L Additive A (10X, 220,074). The solution was then incubated for 1&#x02009;min at room temperature and placed back onto the magnetic separator. Thirty-five microliters of eluted sample was transferred to a new tube strip. cDNA amplification reaction mix was prepared from 8&#x02009;&#x003bc;L water, 50&#x02009;&#x003bc;L Amplification Master Mix (10X, 220,125), 5&#x02009;&#x003bc;L cDNA Additive (10X, 220,067), and 2&#x02009;&#x003bc;L cDNA Primer Mix (10X, 220,106). Sixty-five microliters of amplification master mix was added to the sample, mixed 15 times via pipetting, and briefly centrifuged. The sample then underwent 12 amplification cycles (15&#x02009;s at 98&#x02009;&#x000b0;C, 20&#x02009;s at 67&#x02009;&#x000b0;C, 1&#x02009;min at 72&#x02009;&#x000b0;C).</p><p id="Par70">SPRIselect beads (Beckman Coulter, B23318) were then applied at 0.6X, and solution was mixed 15 times via pipetting. The sample was incubated at room temperature for 5&#x02009;min, placed onto a magnetic separator, and washed twice with 80% ethanol. Sample was air-dried for 2&#x02009;min and eluted in 40.5&#x02009;&#x003bc;L Buffer EB. cDNA yield was measured on a 2100 Bioanalyzer (Agilent, G2943CA) via DNA High Sensitivity Chip (Agilent, 5067&#x02013;4626).</p><p id="Par71">Fragmentation mix was prepared at 4&#x02009;&#x000b0;C from 10&#x02009;&#x003bc;L fragmentation enzyme blend (10X, 220,107) and 5&#x02009;&#x003bc;L fragmentation buffer (10X, 220,108). Thirty-five microliters of sample cDNA was then added to the chilled fragmentation mix. Sample was incubated for 5&#x02009;min at 32&#x02009;&#x000b0;C, then 30&#x02009;min at 65&#x02009;&#x000b0;C to conduct enzymatic fragmentation, end repair, and A-tailing. Sample was then purified using 0.6X SPRIselect reagent (see above). Adaptor ligation mix was prepared from 17.5&#x02009;&#x003bc;L water, 20&#x02009;&#x003bc;L ligation buffer (10X, 220,109), 10&#x02009;&#x003bc;L DNA ligase (10X, 220,110), and 2.5&#x02009;&#x003bc;L Adaptor Mix (10X, 220,026). The ligation mix was added to 50&#x02009;&#x003bc;L of sample and mixed 15 times via pipetting. Sample was then incubated for 15&#x02009;min at 20&#x02009;&#x000b0;C to conduct the ligation. The sample was purified using 0.8X SPRIselect reagent (see above). Sample index PCR mix was prepared from 8&#x02009;&#x003bc;L water, 50&#x02009;&#x003bc;L Amplification Master Mix (10X, 220,125), and 2&#x02009;&#x003bc;L SI-PCR Primer (10X, 220,111). 60&#x02009;&#x003bc;L sample index PCR mix, 30&#x02009;&#x003bc;L purified sample, and 10&#x02009;&#x003bc;L of sample index (10X, 220,103) were combined and mixed 15 times via pipetting. Indexing was conducted via 9&#x02009;cycles of 20&#x02009;s at 98&#x02009;&#x000b0;C, 30&#x02009;s at 54&#x02009;&#x000b0;C, then 20&#x02009;s at 72&#x02009;&#x000b0;C. Sample was purified via double-sided SPRI selection at 0.6X and 0.8X, respectively. Sample was then quantified via DNA High Sensitivity Chip.</p><p id="Par72">Additional quantification was conducted via KAPA Library Quantification Kit (Illumina, KK4828&#x02013;07960166001). Sample was diluted at 10-fold increments from 1:100 to 1:1,000,000, and mixed 1:9 with KAPA qPCR mix. qPCR was conducted on a Viia7 qPCR machine (Life Technologies).</p><p id="Par73">Sample was then sequenced on a HiSeq 4000 (Illumina) using 2&#x02009;&#x000d7;&#x02009;50-cycle SBS kits (Illumina, FC-410-1001). Sample library was diluted to 2&#x02009;nM in EB buffer with 1% PhiX spike-in. Five microliters nondenatured library was then mixed with 5&#x02009;&#x003bc;L 0.1&#x02009;N NaOH, then vortexed and briefly centrifuged. Denaturing was conducted at room temperature for exactly 8&#x02009;min, then stopped via the addition of 5&#x02009;&#x003bc;L 200&#x02009;mM Tris-HCl pH&#x02009;8.0 (Fluka, 93,283). Sample was mixed, briefly centrifuged, and placed on ice. ExAmp reaction mix (Illumina, PE-410-1001) was prepared, added to the sample, and clustering was done on a HiSeq 4000 flow cell via cBot2 (Illumina). The library was then sequenced with paired-end reagents, with 26xRead 1&#x02009;cycles, 8xi7 index cycles, and 98xRead 2&#x02009;cycles.</p><p id="Par74">The 10X Cell Ranger 1.3.1 pipeline was utilized to convert raw BCL files to cell-gene matrices. FASTQ files were aligned to the GRCh37.75 human reference genome, UMI-filtered, and barcodes were matched via the CellRanger count script.</p></sec><sec id="Sec19"><title>Computational analysis</title><sec id="Sec20"><title>Software requirements and scRNA-seq workflow</title><p id="Par75">All computational analysis was carried out using R v. 3.4.1 with Bioconductor v. 3.5. We assembled a modular workflow for the analysis of scRNA-seq data that contains five modules: (i) quality control, (ii) data normalization, (iii) feature selection, (iv) clustering, and (v) identification of marker genes (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a). Based on recent publications, the quality control and normalization modules were based on the popular scater [<xref ref-type="bibr" rid="CR29">29</xref>] and scran [<xref ref-type="bibr" rid="CR62">62</xref>] packages. Scran was set as the default normalization based on a recent benchmarking study by Vallejos et al. [<xref ref-type="bibr" rid="CR63">63</xref>] showing that scran was superior for recovering true size factors compared to other methods. For the marker gene identification module we used the Wilcoxon test [<xref ref-type="bibr" rid="CR64">64</xref>] by default and provided wrappers to MAST [<xref ref-type="bibr" rid="CR21">21</xref>] and Limma-trend [<xref ref-type="bibr" rid="CR65">65</xref>], based on Soneson et al.<italic>&#x02019;</italic>s [<xref ref-type="bibr" rid="CR66">66</xref>] comprehensive assessment of a large number of DE analysis methods for their performance for controlling type I and type II error rates while being scalable to large datasets.</p></sec><sec id="Sec21"><title>Generation of synthetic data</title><p id="Par76">A synthetic dataset was generated based on estimated parameters for the gene-wise mean <italic>&#x003bc;</italic><sub><italic>i</italic></sub> and variance <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_i^2 $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1739_Article_IEq1.gif"/></alternatives></inline-formula> from experimentally determined counts of 1000&#x02009;K562 cells from our benchmarking dataset.</p><p id="Par77">Because gene expression within each cell is typically not independent but cells that have high/low count number for one gene also tend to have high/low counts for another, we sampled for each cell <italic>j</italic> a scaling factor <italic>&#x003b8;</italic><sub><italic>j</italic></sub> such that <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\log}_2\left({\theta}_j\right)\sim \mathcal{N}\left(\mathrm{0,0.25}\right) $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:msub><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0,0.25</mml:mn></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1739_Article_IEq2.gif"/></alternatives></inline-formula>, as described in [<xref ref-type="bibr" rid="CR62">62</xref>]. Simulated counts for gene <italic>i</italic> and cell <italic>j</italic> were generated by sampling from a negative binomial with mean<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mu}_{ij}={\theta}_j\ast {\mu}_i $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x02217;</mml:mo><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><graphic xlink:href="13059_2019_1739_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par78">and dispersion<xref ref-type="fn" rid="Fn1">1</xref><disp-formula id="Equb"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\lambda}_{ij}=\frac{\mu_{ij}^2}{\ {\sigma}_i^2-{\mu}_{ij}} $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2019_1739_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par80">A second-order polynomial was fit to the sample variance as a function of the mean in logarithmic space as described in [<xref ref-type="bibr" rid="CR8">8</xref>]. This polynomial served as an estimate of the global mean-variance relationship. Replacing the term <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_i^2 $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1739_Article_IEq3.gif"/></alternatives></inline-formula> in the equation above with this estimate, the dispersion can be expressed as a function of <italic>&#x003bc;</italic><sub><italic>ij</italic></sub>:<disp-formula id="Equc"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\lambda}_{ij}=\frac{\mu_{ij}^2}{f\left({\mu}_{ij}\right)-{\mu}_{ij}} $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2019_1739_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par81">where<disp-formula id="Equd"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ f\left({\mu}_{ij}\right)=2\hat{\mkern6mu} \left(a\ast \mathrm{lo}{\mathrm{g}}_2\left({\mu}_{ij}\right)\hat{\mkern6mu} 2+b\ast {\log}_2\left({\mu}_{ij}\right)+c\right) $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>^</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>a</mml:mi><mml:mo>&#x02217;</mml:mo><mml:mi>lo</mml:mi><mml:msub><mml:mi mathvariant="normal">g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mfenced><mml:mo>^</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>&#x02217;</mml:mo><mml:msub><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1739_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par82">is derived from the second-order polynomial approximating the gene-wise variance as a function of mean expression. For genes exhibiting Poissonian behavior (i.e., equal mean and variance), we set <italic>&#x003bb;</italic> to a fixed value of 10<sup>10</sup>.</p><p id="Par83">Main cell populations were obtained by permutation of the expression values of 100 randomly chosen genes with mean counts larger than 2.</p><p id="Par84">Cell subgroups characterized by high expression of a small set of marker genes were generated by replacing the base mean values <italic>&#x003bc;</italic><sub><italic>i</italic></sub> in a small set of genes with low expression (<italic>&#x003bc;</italic><sub><italic>i</italic></sub>&#x02009;&#x0003c;&#x02009;0.1) by a value of 2<sup><italic>x</italic></sup> where <inline-formula id="IEq4"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ x\sim \mathcal{N}\left(\mathrm{2.5,1}\right) $$\end{document}</tex-math><mml:math id="M16" display="inline"><mml:mi>x</mml:mi><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="("><mml:mn>2.5,1</mml:mn></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1739_Article_IEq4.gif"/></alternatives></inline-formula>. Thus, the upregulated genes exhibit a log2 fold change of 2.5 on average.</p></sec></sec><sec id="Sec22"><title>Simulating varying degrees of subtlety in transcriptional differences</title><p id="Par85">An initial small dataset was subsampled from the benchmarking (8 human cell lines) dataset, comprising 100 HEK293, 125 Ramos, and between 10 Jurkat cells. We used scran to predict cell cycle stage and only included cells in G1 phase.</p><p id="Par86">From this initial dataset, 25 Ramos cells were held out. From the remaining dataset (100 HEK293, 100 Ramos, 10 Jurkat), datasets with varying incidence of a rare cell type and subtlety (i.e., degree of difference to closest neighbor) of its transcriptional signature were generated in silico, following an approach recently described by Crow et al. [<xref ref-type="bibr" rid="CR39">39</xref>]: First, a number of Jurkat cells (i.e., incidence of 2, 5, or 10) were sampled from the initial dataset. Then, to simulate varying degrees of transcriptional difference between the rare cell type (Jurkat) and its closest abundant cell type (Ramos), an increasing fraction of gene expression values, ranging from 0 to 0.995 in steps of 0.05 (0.045 for the very last step) in the Jurkat cells were replaced by the respective values in the held out Ramos cells. This fraction of replaced expression values is referred to as subtlety.</p><p id="Par87">This procedure was repeated 5 times for each incidence of the rare cell type and each value of the subtlety parameter.</p><p id="Par88">The performance of CellSIUS, GiniClust2, and RaceID3 was evaluated in terms of recall, precision and true negative rate (TNR) for each configuration. To this end, a confusion matrix between the true cell type and the predicted cell type was generated. &#x0201c;Main clusters&#x0201d; were defined as the two clusters containing the majority of the HEK293 and Ramos cells, respectively. The TPR was then defined as the fraction of Jurkat cells that were not assigned to the main clusters, precision was defined as the fraction of Jurkat cells among all cells not assigned to the two main clusters, and the TNR was defined as the fraction of HEK293 and Ramos cells that were assigned to the main clusters.</p></sec><sec id="Sec23"><title>Data pre-processing</title><p id="Par89">Initial pre-processing was applied to each batch of cell lines separately prior to annotating cell types.</p><p id="Par90">First, cells were filtered based on the total number of detected genes, total UMI counts, and the percentage of total UMI counts attributed to mitochondrial genes. Cutoffs were set individually per batch based on the overall distributions (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Table S5).</p><p id="Par91">Second, genes have to present with at least 3 UMIs in at least one cell. After this initial QC, remaining outlier cells were identified and removed using the <italic>plotPCA</italic> function from the scater [<xref ref-type="bibr" rid="CR29">29</xref>] R package with <italic>detect_outliers</italic> set to TRUE.</p><p id="Par92">Data were normalized using scran [<xref ref-type="bibr" rid="CR62">62</xref>], including a first clustering step as implemented in the <italic>quickCluster</italic> function and with all parameters set to their default values.</p></sec><sec id="Sec24"><title>Cell type annotation</title><p id="Par93">First, the top 10% overdispersed genes were selected using the NBDrop method described in [<xref ref-type="bibr" rid="CR28">28</xref>]. Cell types were then annotated based on Pearson&#x02019;s correlation of the expression profile (log<sub>2</sub>(normalized counts+&#x02009;1)) of the selected features with bulk RNA-seq data obtained for each individual cell line (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>a, b). For the batches 1&#x02013;3 that contained only two cell lines each, the Pearson&#x02019;s correlation coefficients were scaled to <italic>z</italic>-scores prior to the assignment, and for batch 4, the raw correlation values were used instead. A cell was then assigned to the cell line with the highest value unless this maximum was below 0.2 or if the second highest value was within 5% of the maximum in which case no assignment was given. We found that the latter applied only to a small percentage of cells (1&#x02013;2%), which most likely correspond to cell doublets. Furthermore, for the cell line mixes, IMR90/HCT116 and A549/Ramos additional potential doublets were identified and excluded from the cell line assignment employing a visual inspection of the tSNE plot by looking for (small) clusters of cells having high correlation to both cell lines as well as a high UMI count (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Table S3).</p><p id="Par94">After cell type annotation, the raw count matrices from all four batches were concatenated. Cells that had not passed the initial QC or could not be annotated were discarded. The gene filtering step described above was then repeated for the aggregated dataset, leaving a final cleaned dataset containing a total of 12,718 genes and 11,678 cells.</p></sec><sec id="Sec25"><title>Dimensionality reduction and calculation of distance matrix</title><p id="Par95">The original expression (log2(normalized counts +&#x02009;1) coordinates were projected into low-dimensional space by PCA, using an implicitly restarted Lanczos method as implemented in the irlba [<xref ref-type="bibr" rid="CR36">36</xref>] R package. The number of dimensions to retain was determined by visual inspection of a scree plot. It was 10 for all cell line data and 12 for the neuron dataset, and the first <italic>k</italic> principal components accounted for 40&#x02013;50% of the total variance in each case. Cell-cell distances (Euclidean or Pearson, Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Table S2) were then calculated on these projections.</p></sec><sec id="Sec26"><title>Benchmarking of clustering approaches</title><p id="Par96">The accuracy of each prediction was assessed by the adjusted rand index (ARI). Given two partitions&#x000a0;<italic>X</italic>&#x02009;=&#x02009;<italic>X</italic><sub>1</sub>,&#x02009;&#x02026;&#x02009;, <italic>X</italic><sub><italic>m</italic></sub> and <italic>Y</italic>&#x02009;=&#x02009;<italic>Y</italic><sub>1</sub>,&#x02009;&#x02026;&#x02009;, <italic>Y</italic><sub><italic>k</italic></sub> of a set S with <italic>n</italic> elements, the ARI is defined as:<disp-formula id="Eque"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{ARI}=\frac{\sum_{ij}\left(\genfrac{}{}{0pt}{}{n_{ij}}{2}\right)-\left[{\sum}_i\left(\genfrac{}{}{0pt}{}{a_i}{2}\right){\sum}_j\left(\genfrac{}{}{0pt}{}{b_j}{2}\right)\right]/\left(\genfrac{}{}{0pt}{}{n}{2}\right)\kern0.75em }{\frac{1}{2}\left[{\sum}_i\left(\genfrac{}{}{0pt}{}{a_i}{2}\right)+{\sum}_j\left(\genfrac{}{}{0pt}{}{b_j}{2}\right)\right]-\left[{\sum}_i\left(\genfrac{}{}{0pt}{}{a_i}{2}\right){\sum}_j\left(\genfrac{}{}{0pt}{}{b_j}{2}\right)\right]/\left(\genfrac{}{}{0pt}{}{n}{2}\right)\kern0.75em } $$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mi>ARI</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mspace width="0.75em"/></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mspace width="0.75em"/></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2019_1739_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par97">where <italic>n</italic><sub><italic>ij</italic></sub> denotes the elements that are common between <italic>X</italic><sub><italic>i</italic></sub> and <italic>Y</italic><sub><italic>j</italic></sub>, and <italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>j</italic></sub> are the total number of elements in <italic>X</italic><sub><italic>i</italic></sub> and <italic>Y</italic><sub><italic>j</italic></sub>, respectively.</p></sec><sec id="Sec27"><title>CellSIUS</title><p id="Par98">CellSIUS detects cell subpopulations and their gene signatures (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>a). Starting from an initial partitioning of <italic>N</italic> cells into <italic>m</italic> clusters <italic>C</italic><sub>1</sub>,&#x02009;&#x02026;&#x02009;, <italic>C</italic><sub><italic>m</italic></sub>, the method identifies cell subpopulations and their signatures as follows:<list list-type="order"><list-item><p id="Par99">Identification of genes with bimodal expression: For each gene <italic>g</italic><sub><italic>i</italic></sub>, within each cluster <italic>C</italic><sub><italic>j</italic></sub>, a one-dimensional <italic>k</italic>-means clustering is used to partition the cellular expression levels (log2 normalized UMI counts) into two groups (&#x0201c;low&#x0201d; and &#x0201c;high&#x0201d;). Candidate marker genes are selected according to three criteria: (i) the average expression fold change between &#x0201c;low&#x0201d; and &#x0201c;high&#x0201d; is at least 2 on a log2-scale, (ii) less than a user defined percentage (50% by default) of all cells in cluster <italic>C</italic><sub><italic>j</italic></sub> fall in the &#x0201c;high&#x0201d; category, and (iii) there is a significant difference (<italic>t</italic> test and Benjamini-Hochberg correction, <italic>p</italic> value &#x0003c;&#x02009;0.1) between the &#x0201c;low&#x0201d; and &#x0201c;high&#x0201d; expression values.</p></list-item><list-item><p id="Par100">Testing cluster specificity: For the list of candidate genes, it is assessed whether the cell subgroup expressing them is specific to cluster&#x000a0;<italic>C</italic><sub><italic>j</italic></sub>. Required for each gene <italic>g</italic><sub><italic>i</italic></sub> are (i) a significant difference in the expression of <italic>g</italic><sub><italic>i</italic></sub> in cells with &#x0201c;high&#x0201d; expression compared to cells not in Cj (<italic>t</italic> test and FDR correction, <italic>p</italic> value &#x0003c;&#x02009;0.1) and (ii) the average expression fold change between all cells with &#x0201c;high&#x0201d; expression and all other cells with non-zero expression of <italic>g</italic><sub><italic>i</italic></sub> to be at least 1 on a log2-scale.</p></list-item><list-item><p id="Par101">Identification of correlated gene sets: For each cluster&#x000a0;<italic>C</italic><sub><italic>j</italic></sub>, the correlation matrix of the expression of all candidate genes <italic>g</italic><sub>1, . . , <italic>n</italic></sub> across all cells in cluster <italic>C</italic><sub><italic>j</italic></sub> is transformed into a graph where genes correspond to nodes and edges are weighted by correlations between them. Edges with weights below a fixed threshold are assigned a weight of 0. By default, this threshold is set to the 95th percentile of all correlations if this value lies between 0.35 and 0.5, and to the lower and upper bound if it is below or above, respectively. The lower bound is set such that it is higher than the maximum of all gene-wise correlations on simulated data from an entirely homogeneous population, which serves as an estimate of the background correlation. Setting an upper bound ensures that gene sets are not falsely split in cases where all candidate genes are highly correlated. Subsequently, MCL [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>] is used to identify correlated gene sets, denoted <italic>s</italic><sub><italic>jk</italic></sub>, where <italic>j</italic> is the index of the main cluster and <italic>k</italic> the index of the gene set within this cluster.</p></list-item><list-item><p id="Par102">Assigning cells to subgroups: For each cluster <italic>C</italic><sub><italic>j</italic></sub> and each gene set <italic>s</italic><sub><italic>jk</italic></sub>, a one-dimensional <italic>k</italic>-means is run on the mean expression of <italic>s</italic><sub><italic>jk</italic></sub>. Cells falling in the &#x0201c;high&#x0201d; mode of this clustering are assigned to a new cluster <italic>C</italic><sub><italic>jk</italic></sub>.</p></list-item><list-item><p id="Par103">Final cluster assignment: Cells are assigned to a final cluster which is the combination of all subgroups they belong to. This means if a cell belongs to two subgroups A and B, it will be assigned to a new subgroup AB. The gene signatures for this new subgroup correspond to the union of gene signatures A and B. Only subgroups characterized by a minimum of min_n_genes (default: 3 genes) are considered.</p></list-item></list></p></sec><sec id="Sec28"><title>Identification of rare cell types with RaceID and Giniclust</title><p id="Par104">RaceID3 [<xref ref-type="bibr" rid="CR38">38</xref>] was obtained from GitHub (dgrun/RaceID3_StemID2, version as of March 26th 2018). Analysis was run with all parameters at their default values, except that we fixed the initial clusters (RaceID@kpart) instead of determining them by <italic>k</italic>-medoids. On biological data (cell line subset 2 and neuronal population), we in addition changed the probability threshold to 10<sup>&#x02212;20</sup> and set the minimum number of outlier genes (outlg) to 3. This adjustment was made because the default cutoffs in RaceID are not very stringent and resulted in extensive overclustering of the data.</p><p id="Par105">GiniClust2 [<xref ref-type="bibr" rid="CR19">19</xref>] was obtained from GitHub (dtsoucas/GiniClust2, version as of 4 May 2018). All analysis was run with dataset-specific parameters: MinPts&#x02009;=&#x02009;3, eps&#x02009;=&#x02009;0.45, <italic>k</italic>&#x000a0;=&#x02009;2 for the simulated data, and MinPts&#x02009;=&#x02009;3, eps&#x02009;=&#x02009;0.45, <italic>k</italic>&#x02009;=&#x02009;8 for the cell line dataset. All other parameters were set to their defaults.</p></sec><sec id="Sec29"><title>Trajectory analysis using monocle</title><p id="Par106">Analysis was run using monocle version 2.4.0. As input, the counts of the top 10% genes selected by NBDrop were used. Prior to monocle analysis, all genes annotated with the GO term cell cycle (GO:0007049) as well as mitochondrial genes and genes encoding ribosomal proteins were removed from the dataset. All parameters were set to default values.</p></sec></sec><sec sec-type="supplementary-material"><title>Additional files</title><sec id="Sec30"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="13059_2019_1739_MOESM1_ESM.pdf"><label>Additional file 1:</label><caption><p><bold>Figure S1.</bold> tSNE visualization of potential confounders in cell line dataset. <bold>Figure S2.</bold> Generation of synthetic scRNA-seq data. <bold>Figure S3.</bold> Parameter sensitivity analysis of CellSIUS. <bold>Figure S4.</bold> In vitro differentiation of hPSCs into cortical excitatory neurons. <bold>Figure S5.</bold> hPSC-derived cortical neurons express characteristic marker genes. <bold>Figure S6.</bold> Identification of cell subgroups in neuronal populations. <bold>Figure S7.</bold> Comparison of neuronal population markers to scRNA-seq data from the developing human cortex. <bold>Table S1.</bold> Composition of full and subsampled cell line datasets. <bold>Table S2.</bold> Overview of clustering algorithms benchmarked in this study. <bold>Table S3.</bold> Medium composition for the in vitro differentiation of cortical excitatory neurons from human pluripotent stem cells in suspension. <bold>Table S5.</bold> Sequencing statistics and QC cutoffs per batch. (PDF 3452 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="13059_2019_1739_MOESM2_ESM.xlsx"><label>Additional file 2:</label><caption><p><bold>Table S4.</bold> DE analysis between subclusters and main clusters in the neuroscience dataset. The file contains one sheet per comparison. All sheets are listed below: G.sub_1_vs_all_G: compares the G.sub_1 population to all other cells in the G cluster. G.sub_2_vs_all_G: compares the G.sub_2 population to all other cells in the G cluster. G.sub_3_vs_all_G: compares the G.sub_3 population to all other cells in the G cluster. CR.sub_vs_all_CR: compares the CR.sub population to all other cells in the CR cluster. NP.sub_vs_all_NP: compares the NP.sub population to all other cells in the NP cluster. N.sub_1_vs_all_N: compares the N.sub_1 population to all other cells in the N cluster. N.sub_2_vs_all_N: compares the N.sub_2 population to all other cells in the N cluster. Each sheet contains the following columns: Gene_id: Ensembl gene ID. Mean_exprs: Mean expression [log2(normalized counts +&#x02009;1)] across the whole dataset. Mean_in_subgroup: Mean expression in the respective subgroup. Pval, adj_pval: <italic>p</italic> value (Wilcoxon test), adj_pval is adjusted <italic>p</italic> value (Benjamini-Hochberg). Log2fc: Fold change, calculated as the difference in mean[log2(normalized counts +&#x02009;1)]. DE_flag: is TRUE if abs(log2fc)&#x02009;&#x0003e;&#x02009;0.5 and adj_pval &#x0003c;&#x02009;0.05. Chr, symbol, eg, gene_biotype, description: Additional gene info (chromosome, gene symbol, entrez gene identifier, gene biotype, short description of gene function). (XLSX 8049 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="13059_2019_1739_MOESM3_ESM.docx"><label>Additional file 3:</label><caption><p>Review history (DOCX 58 kb)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>ARI</term><def><p id="Par2">Adjusted Rand index</p></def></def-item><def-item><term>CP</term><def><p id="Par3">Choroid plexus</p></def></def-item><def-item><term>CR</term><def><p id="Par4">Cajal-Retzius</p></def></def-item><def-item><term>CSF</term><def><p id="Par5">Cerebrospinal fluid</p></def></def-item><def-item><term>DANB</term><def><p id="Par6">Depth-adjusted negative binomial</p></def></def-item><def-item><term>DE</term><def><p id="Par7">Differential expression</p></def></def-item><def-item><term>G</term><def><p id="Par8">Glia</p></def></def-item><def-item><term>GC</term><def><p id="Par9">Glycolytic cell</p></def></def-item><def-item><term>GMM</term><def><p id="Par10">Gaussian mixture model</p></def></def-item><def-item><term>hPSC</term><def><p id="Par11">Human pluripotent stem cell</p></def></def-item><def-item><term>HVG</term><def><p id="Par12">High variance gene</p></def></def-item><def-item><term>IP</term><def><p id="Par13">Intermediate progenitor</p></def></def-item><def-item><term>N</term><def><p id="Par14">Neuron</p></def></def-item><def-item><term>NP</term><def><p id="Par15">Neocortical progenitor</p></def></def-item><def-item><term>oRG</term><def><p id="Par16">Outer radial glia</p></def></def-item><def-item><term>PCA</term><def><p id="Par17">Principal component analysis</p></def></def-item><def-item><term>scRNA-seq</term><def><p id="Par18">Single-cell RNA sequencing</p></def></def-item></def-list></glossary><fn-group><fn id="Fn1"><label>1</label><p id="Par79">We use this nomenclature in order to be consistent with the definition in R. Note that there is an alternative nomenclature, which defines <italic>&#x003b1;</italic>&#x02009;=&#x02009;1/<italic>&#x003bb;</italic> as dispersion and is used in edgeR [<xref ref-type="bibr" rid="CR67">67</xref>] and DESeq2 [<xref ref-type="bibr" rid="CR68">68</xref>].</p></fn><fn><p><bold>Publisher&#x02019;s Note</bold></p><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn><fn><p>Rebekka Wegmann and Marilisa Neri have contributed equally to this work</p></fn></fn-group><ack><title>Acknowledgements</title><p>We thank our Novartis colleagues: John Reece-Hoyes, Kushal Joshi, Qiong Wang, and Dojna Shkoza for providing the cell lines; Walter Carbone and Judith Knehr for help with sequencing; Anthony Sonrel and Somesh Sai for discussion about the analytical approach; and Jeremy Jenkins for scientific discussions.</p><sec id="FPar1"><title>Review history</title><p id="Par107">The review history for this manuscript is available as Additional&#x000a0;file&#x000a0;<xref rid="MOESM3" ref-type="media">3</xref>.</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>MN, FN, and RW developed CellSIUS and implemented the computational workflow. AW and RC sequenced the human cell lines for the benchmarking study. RW performed the benchmarking analysis. RW, MN, MS, BB, and CGK analyzed and interpreted the neuroscience data. HN, MS, and JR performed the experiments. MF, BB, and AK designed the experiments. MN, GR, SS, AJ, BB, and CGK contributed to the conception of the studies and the interpretation of data. RW, MN, BB, MS, AK, and CGK wrote the manuscript. All authors examined the results and approved the final version of the manuscript.</p></notes><notes notes-type="funding-information"><title>Funding</title><p>Not applicable.</p></notes><notes notes-type="data-availability"><title>Availability of data and materials</title><p>ScRNA-seq data of human cell lines have been deposited in the NCBI Short Read Archive (SRA) under accession number SRA: PRJNA484547 [<xref ref-type="bibr" rid="CR69">69</xref>].</p><p>ScRNA-seq data of differentiation of cortical excitatory neurons from human pluripotent stem cells in suspension have been deposited in the NCBI Short Read Archive (SRA) under accession number SRA: PRJNA545246 [<xref ref-type="bibr" rid="CR70">70</xref>].</p><p>The workflow written in the R programming language is deposited in GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/Novartis/scRNAseq_workflow_benchmark">https://github.com/Novartis/scRNAseq_workflow_benchmark</ext-link>) and Zenodo (DOI: 10.5281/zenodo.3237742) [<xref ref-type="bibr" rid="CR71">71</xref>]. The code, vignette, and an example dataset for the computational workflow are included in the repository.</p><p>The CellSIUS is deposited in GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/Novartis/CellSIUS">https://github.com/Novartis/CellSIUS</ext-link>) [<xref ref-type="bibr" rid="CR72">72</xref>] and Zenodo (DOI: 10.5281/zenodo.3237749) [<xref ref-type="bibr" rid="CR73">73</xref>] as a standalone R package. It requires <italic>R</italic>&#x000a0;&#x02265;&#x02009;3.4.1 and uses an external installation of the Markov Clustering Algorithm (MCL) [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. The R implementation is platform independent; the external MCL runs on any UNIX platform.</p><p>The codes and processed data to reproduce the analyses presented here are uploaded in Zenodo (10.5281/zenodo.3238275) [<xref ref-type="bibr" rid="CR74">74</xref>].</p><p>All the open source released repositories are under the &#x0201c;Apache License 2.0&#x0201d;.</p></notes><notes><title>Ethics approval and consent to participate</title><p id="Par108">Not applicable.</p></notes><notes><title>Consent for publication</title><p id="Par109">Not applicable.</p></notes><notes notes-type="COI-statement"><title>Competing interests</title><p id="Par110">All authors are, or were, employees or affiliates of the Novartis Pharma AG.</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Basu</surname><given-names>A</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name><name><surname>Nemesh</surname><given-names>J</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Goldman</surname><given-names>M</given-names></name><etal/></person-group><article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title><source>Cell</source><year>2015</year><volume>161</volume><fpage>1202</fpage><lpage>1214</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id><pub-id pub-id-type="pmid">26000488</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>AM</given-names></name><name><surname>Mazutis</surname><given-names>L</given-names></name><name><surname>Akartuna</surname><given-names>I</given-names></name><name><surname>Tallapragada</surname><given-names>N</given-names></name><name><surname>Veres</surname><given-names>A</given-names></name><name><surname>Li</surname><given-names>V</given-names></name><etal/></person-group><article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title><source>Cell</source><year>2015</year><volume>161</volume><fpage>1187</fpage><lpage>1201</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.04.044</pub-id><pub-id pub-id-type="pmid">26000487</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>GXY</given-names></name><name><surname>Terry</surname><given-names>JM</given-names></name><name><surname>Belgrader</surname><given-names>P</given-names></name><name><surname>Ryvkin</surname><given-names>P</given-names></name><name><surname>Bent</surname><given-names>ZW</given-names></name><name><surname>Wilson</surname><given-names>R</given-names></name><etal/></person-group><article-title>Massively parallel digital transcriptional profiling of single cells</article-title><source>Nat Commun</source><year>2017</year><volume>8</volume><fpage>14049</fpage><pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id><pub-id pub-id-type="pmid">28091601</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Svensson</surname><given-names>V</given-names></name><name><surname>Vento-Tormo</surname><given-names>R</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name></person-group><article-title>Exponential scaling of single-cell RNA-seq in the last decade</article-title><source>Nature Protocols</source><year>2018</year><volume>13</volume><fpage>599</fpage><lpage>604</lpage><pub-id pub-id-type="doi">10.1038/nprot.2017.149</pub-id><pub-id pub-id-type="pmid">29494575</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>F</given-names></name><name><surname>Barbacioru</surname><given-names>C</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Nordman</surname><given-names>E</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Xu</surname><given-names>N</given-names></name><etal/></person-group><article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title><source>Nat Methods</source><year>2009</year><volume>6</volume><fpage>377</fpage><lpage>382</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1315</pub-id><pub-id pub-id-type="pmid">19349980</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>R</given-names></name><name><surname>Zhou</surname><given-names>Y</given-names></name><name><surname>Yuan</surname><given-names>G-C</given-names></name><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>Correspondence</surname><given-names>GG</given-names></name><etal/></person-group><article-title>Mapping the mouse cell atlas by Microwell-Seq</article-title><source>Cell</source><year>2018</year><volume>172</volume><fpage>1091</fpage><lpage>1107</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.02.001</pub-id><pub-id pub-id-type="pmid">29474909</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>J</given-names></name><name><surname>Spielmann</surname><given-names>M</given-names></name><name><surname>Qiu</surname><given-names>X</given-names></name><name><surname>Huang</surname><given-names>X</given-names></name><name><surname>Ibrahim</surname><given-names>DM</given-names></name><name><surname>Hill</surname><given-names>AJ</given-names></name><etal/></person-group><article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title><source>Nature</source><year>2019</year><volume>566</volume><fpage>496</fpage><lpage>502</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-0969-x</pub-id><pub-id pub-id-type="pmid">30787437</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gr&#x000fc;n</surname><given-names>D</given-names></name><name><surname>Lyubimova</surname><given-names>A</given-names></name><name><surname>Kester</surname><given-names>L</given-names></name><name><surname>Wiebrands</surname><given-names>K</given-names></name><name><surname>Basak</surname><given-names>O</given-names></name><name><surname>Sasaki</surname><given-names>N</given-names></name><etal/></person-group><article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title><source>Nature</source><year>2015</year><volume>525</volume><fpage>251</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1038/nature14966</pub-id><pub-id pub-id-type="pmid">26287467</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>L</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Pinello</surname><given-names>L</given-names></name><name><surname>Yuan</surname><given-names>G-C</given-names></name></person-group><article-title>GiniClust: detecting rare cell types from single-cell gene expression data with Gini index</article-title><source>Genome Biol</source><year>2016</year><volume>17</volume><fpage>144</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-1010-4</pub-id><pub-id pub-id-type="pmid">27368803</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Izar</surname><given-names>B</given-names></name><name><surname>Prakadan</surname><given-names>SM</given-names></name><name><surname>Wadsworth</surname><given-names>MH</given-names></name><name><surname>Treacy</surname><given-names>D</given-names></name><name><surname>Trombetta</surname><given-names>JJ</given-names></name><etal/></person-group><article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title><source>Science</source><year>2016</year><volume>352</volume><fpage>189</fpage><lpage>196</lpage><pub-id pub-id-type="doi">10.1126/science.aad0501</pub-id><pub-id pub-id-type="pmid">27124452</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Villani</surname><given-names>A-C</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name><name><surname>Reynolds</surname><given-names>G</given-names></name><name><surname>Sarkizova</surname><given-names>S</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Fletcher</surname><given-names>J</given-names></name><etal/></person-group><article-title>Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title><source>Science</source><year>2017</year><volume>356</volume><fpage>eaah4573</fpage><pub-id pub-id-type="doi">10.1126/science.aah4573</pub-id><pub-id pub-id-type="pmid">28428369</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shalek Alex</surname><given-names>K</given-names></name><name><surname>Rahul</surname><given-names>S</given-names></name><name><surname>Joe</surname><given-names>S</given-names></name><name><surname>Trombetta John</surname><given-names>J</given-names></name><name><surname>Dave</surname><given-names>G</given-names></name><name><surname>Diana</surname><given-names>L</given-names></name><etal/></person-group><article-title>Single-cell RNA-seq reveals dynamic paracrine control of cellular variation</article-title><source>Nature</source><year>2014</year><volume>510</volume><fpage>363</fpage><lpage>369</lpage><pub-id pub-id-type="doi">10.1038/nature13437</pub-id><pub-id pub-id-type="pmid">24919153</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><name><surname>Amit</surname><given-names>I</given-names></name><name><surname>Benoist</surname><given-names>C</given-names></name><name><surname>Birney</surname><given-names>E</given-names></name><etal/></person-group><article-title>The human cell atlas</article-title><source>Elife</source><year>2017</year><volume>6</volume><fpage>e27041</fpage><pub-id pub-id-type="doi">10.7554/eLife.27041</pub-id><pub-id pub-id-type="pmid">29206104</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>&#x0017e;urauskiene</surname><given-names>J</given-names></name><name><surname>Yau</surname><given-names>C</given-names></name></person-group><article-title>pcaReduce: Hierarchical clustering of single cell transcriptional profiles</article-title><source>BMC Bioinformatics</source><year>2016</year><volume>17</volume><fpage>140</fpage><pub-id pub-id-type="doi">10.1186/s12859-016-0984-y</pub-id><pub-id pub-id-type="pmid">27005807</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kiselev</surname><given-names>VY</given-names></name><name><surname>Kirschner</surname><given-names>K</given-names></name><name><surname>Schaub</surname><given-names>MT</given-names></name><name><surname>Andrews</surname><given-names>T</given-names></name><name><surname>Yiu</surname><given-names>A</given-names></name><name><surname>Chandra</surname><given-names>T</given-names></name><etal/></person-group><article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title><source>Nat Methods</source><year>2017</year><volume>14</volume><fpage>483</fpage><lpage>486</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4236</pub-id><pub-id pub-id-type="pmid">28346451</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kiselev</surname><given-names>Vladimir Yu</given-names></name><name><surname>Andrews</surname><given-names>Tallulah S.</given-names></name><name><surname>Hemberg</surname><given-names>Martin</given-names></name></person-group><article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title><source>Nature Reviews Genetics</source><year>2019</year><volume>20</volume><issue>5</issue><fpage>273</fpage><lpage>282</lpage><pub-id pub-id-type="doi">10.1038/s41576-018-0088-9</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Setty</surname><given-names>M</given-names></name><name><surname>Tadmor</surname><given-names>MD</given-names></name><name><surname>Reich-Zeliger</surname><given-names>S</given-names></name><name><surname>Angel</surname><given-names>O</given-names></name><name><surname>Salame</surname><given-names>TM</given-names></name><name><surname>Kathail</surname><given-names>P</given-names></name><etal/></person-group><article-title>Wishbone identifies bifurcating developmental trajectories from single-cell data</article-title><source>Nat Biotechnol</source><year>2016</year><volume>34</volume><fpage>637</fpage><lpage>645</lpage><pub-id pub-id-type="doi">10.1038/nbt.3569</pub-id><pub-id pub-id-type="pmid">27136076</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X</given-names></name><name><surname>Mao</surname><given-names>Q</given-names></name><name><surname>Tang</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Chawla</surname><given-names>R</given-names></name><name><surname>Pliner</surname><given-names>HA</given-names></name><etal/></person-group><article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title><source>Nat Methods.</source><year>2017</year><volume>14</volume><fpage>979</fpage><lpage>982</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4402</pub-id><pub-id pub-id-type="pmid">28825705</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsoucas</surname><given-names>D</given-names></name><name><surname>Yuan</surname><given-names>G-C</given-names></name></person-group><article-title>GiniClust2: a cluster-aware, weighted ensemble clustering method for cell-type detection</article-title><source>Genome Biol</source><year>2018</year><volume>19</volume><fpage>58</fpage><pub-id pub-id-type="doi">10.1186/s13059-018-1431-3</pub-id><pub-id pub-id-type="pmid">29747686</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kharchenko Peter</surname><given-names>V</given-names></name><name><surname>Lev</surname><given-names>S</given-names></name><name><surname>Scadden</surname><given-names>DT</given-names></name></person-group><article-title>Bayesian approach to single-cell differential expression analysis</article-title><source>Nat Meth</source><year>2014</year><volume>11</volume><fpage>740</fpage><lpage>742</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2967</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finak</surname><given-names>G</given-names></name><name><surname>McDavid</surname><given-names>A</given-names></name><name><surname>Yajima</surname><given-names>M</given-names></name><name><surname>Deng</surname><given-names>J</given-names></name><name><surname>Gersuk</surname><given-names>V</given-names></name><name><surname>Shalek</surname><given-names>AK</given-names></name><etal/></person-group><article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title><source>Genome Biol</source><year>2015</year><volume>16</volume><fpage>278</fpage><pub-id pub-id-type="doi">10.1186/s13059-015-0844-5</pub-id><pub-id pub-id-type="pmid">26653891</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="other">Korthauer KD, Chu LF, Newton MA, Li Y, Thomson J, Stewart R, <italic>et al.</italic> A statistical approach for identifying differential distributions in single-cell RNAseq experiments. Genome Biol. 2016;17(1):222 Available from: https://doi/org/10.1186/s13059-016-1077-y</mixed-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>MB</given-names></name><name><surname>Wang</surname><given-names>PP</given-names></name><name><surname>Atabay</surname><given-names>KD</given-names></name><name><surname>Murphy</surname><given-names>EA</given-names></name><name><surname>Doan</surname><given-names>RN</given-names></name><name><surname>Hecht</surname><given-names>JL</given-names></name><etal/></person-group><article-title>Single-cell analysis reveals transcriptional heterogeneity of neural progenitors in human cortex</article-title><source>Nat Neurosci</source><year>2015</year><volume>18</volume><fpage>637</fpage><lpage>646</lpage><pub-id pub-id-type="doi">10.1038/nn.3980</pub-id><pub-id pub-id-type="pmid">25734491</pub-id></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Camp</surname><given-names>JG</given-names></name><name><surname>Badsha</surname><given-names>F</given-names></name><name><surname>Florio</surname><given-names>M</given-names></name><name><surname>Kanton</surname><given-names>S</given-names></name><name><surname>Gerber</surname><given-names>T</given-names></name><name><surname>Wilsch-Br&#x000e4;uninger</surname><given-names>M</given-names></name><etal/></person-group><article-title>Human cerebral organoids recapitulate gene expression programs of fetal neocortex development</article-title><source>Proc Natl Acad Sci</source><year>2015</year><volume>112</volume><issue>5</issue><fpage>15672</fpage><lpage>15677</lpage><?supplied-pmid 26644564?><pub-id pub-id-type="pmid">26644564</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bardy</surname><given-names>C</given-names></name><name><surname>Van Den Hurk</surname><given-names>M</given-names></name><name><surname>Kakaradov</surname><given-names>B</given-names></name><name><surname>Erwin</surname><given-names>JA</given-names></name><name><surname>Jaeger</surname><given-names>BN</given-names></name><name><surname>Hernandez</surname><given-names>RV</given-names></name><etal/></person-group><article-title>Predicting the functional states of human iPSC-derived neurons with single-cell RNA-seq and electrophysiology</article-title><source>Mol Psychiatry</source><year>2016</year><volume>21</volume><fpage>1573</fpage><lpage>1588</lpage><pub-id pub-id-type="doi">10.1038/mp.2016.158</pub-id><pub-id pub-id-type="pmid">27698428</pub-id></element-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Handel</surname><given-names>AE</given-names></name><name><surname>Chintawar</surname><given-names>S</given-names></name><name><surname>Lalic</surname><given-names>T</given-names></name><name><surname>Whiteley</surname><given-names>E</given-names></name><name><surname>Vowles</surname><given-names>J</given-names></name><name><surname>Giustacchini</surname><given-names>A</given-names></name><etal/></person-group><article-title>Assessing similarity to primary tissue and cortical layer identity in induced pluripotent stem cell-derived cortical neurons through single-cell transcriptomics</article-title><source>Hum Mol Genet</source><year>2016</year><volume>25</volume><fpage>989</fpage><lpage>1000</lpage><pub-id pub-id-type="doi">10.1093/hmg/ddv637</pub-id><pub-id pub-id-type="pmid">26740550</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brennecke</surname><given-names>P</given-names></name><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Kim</surname><given-names>JK</given-names></name><name><surname>Ko&#x00142;odziejczyk</surname><given-names>AA</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Proserpio</surname><given-names>V</given-names></name><etal/></person-group><article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title><source>Nat Methods</source><year>2013</year><volume>10</volume><fpage>1093</fpage><lpage>1095</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2645</pub-id><pub-id pub-id-type="pmid">24056876</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="other">Andrews TS, Hemberg M. M3drop: dropout-based feature selection for scRNASeq. Bioinformatics. 2018:1&#x02013;3 Available from: 10.1093/bioinformatics/bty1044.</mixed-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Campbell</surname><given-names>KR</given-names></name><name><surname>Lun</surname><given-names>ATL</given-names></name><name><surname>Wills</surname><given-names>QF</given-names></name></person-group><article-title>Scater: pre-processing, quality control, normalization and visualization of single-cell RNA-seq data in R</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><fpage>1179</fpage><lpage>1186</lpage><?supplied-pmid 28088763?><pub-id pub-id-type="pmid">28088763</pub-id></element-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langfelder</surname><given-names>Peter</given-names></name><name><surname>Zhang</surname><given-names>Bin</given-names></name><name><surname>Horvath</surname><given-names>Steve</given-names></name></person-group><article-title>Defining clusters from a hierarchical cluster tree: the Dynamic Tree Cut package for R</article-title><source>Bioinformatics</source><year>2007</year><volume>24</volume><issue>5</issue><fpage>719</fpage><lpage>720</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btm563</pub-id><pub-id pub-id-type="pmid">18024473</pub-id></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fraley</surname><given-names>C</given-names></name><name><surname>Raftery</surname><given-names>AE</given-names></name></person-group><article-title>Model-based clustering, discriminant analysis and density estimation</article-title><source>J Am Stat Assoc.</source><year>2002</year><volume>97</volume><fpage>611</fpage><lpage>631</lpage><pub-id pub-id-type="doi">10.1198/016214502760047131</pub-id></element-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="other">Ester M, Kriegel HP, Sander J, Xu X. A density-based algorithm for discovering clusters in large spatial databases with noise. Proc 2nd Int Conf Knowl Discov data min; 1996. p. 226&#x02013;31. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.aaai.org/Papers/KDD/1996/KDD96-037.pdf">https://www.aaai.org/Papers/KDD/1996/KDD96-037.pdf</ext-link></mixed-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="other">van Dongen S. Graph clustering by flow simulation. PhD thesis, University of Utrecht; 2000 Avalaible from <ext-link ext-link-type="uri" xlink:href="https://dspace.library.uu.nl/handle/1874/848">https://dspace.library.uu.nl/handle/1874/848</ext-link></mixed-citation></ref><ref id="CR34"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Enright</surname><given-names>AJ</given-names></name><name><surname>Van Dongen</surname><given-names>S</given-names></name><name><surname>Ouzounis</surname><given-names>CA</given-names></name></person-group><article-title>An efficient algorithm for large-scale detection of protein families</article-title><source>Nucleic Acids Res</source><year>2002</year><volume>30</volume><fpage>1575</fpage><lpage>1584</lpage><pub-id pub-id-type="doi">10.1093/nar/30.7.1575</pub-id><pub-id pub-id-type="pmid">11917018</pub-id></element-citation></ref><ref id="CR35"><label>35.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Mardia</surname><given-names>K</given-names></name><name><surname>Kent</surname><given-names>J</given-names></name><name><surname>Bibby</surname><given-names>J</given-names></name></person-group><source>Multivariate analysis</source><year>1979</year><publisher-loc>London</publisher-loc><publisher-name>Acad Press</publisher-name></element-citation></ref><ref id="CR36"><label>36.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baglama</surname><given-names>J</given-names></name><name><surname>Reichel</surname><given-names>L</given-names></name></person-group><article-title>Augmented implicitly restarted Lanczos Bidiagonalization methods</article-title><source>SIAM J Sci Comput.</source><year>2005</year><volume>27</volume><fpage>19</fpage><lpage>42</lpage><pub-id pub-id-type="doi">10.1137/04060593X</pub-id></element-citation></ref><ref id="CR37"><label>37.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hubert</surname><given-names>L</given-names></name><name><surname>Arabie</surname><given-names>P</given-names></name></person-group><article-title>Comparing partitions</article-title><source>J Classif.</source><year>1985</year><volume>2</volume><fpage>193</fpage><lpage>218</lpage><pub-id pub-id-type="doi">10.1007/BF01908075</pub-id></element-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gr&#x000fc;n</surname><given-names>D</given-names></name><name><surname>Muraro</surname><given-names>MJ</given-names></name><name><surname>Boisset</surname><given-names>J-C</given-names></name><name><surname>Wiebrands</surname><given-names>K</given-names></name><name><surname>Lyubimova</surname><given-names>A</given-names></name><name><surname>Dharmadhikari</surname><given-names>G</given-names></name><etal/></person-group><article-title>De novo prediction of stem cell identity using single-cell transcriptome data</article-title><source>Cell Stem Cell</source><year>2016</year><volume>19</volume><fpage>266</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1016/j.stem.2016.05.010</pub-id><pub-id pub-id-type="pmid">27345837</pub-id></element-citation></ref><ref id="CR39"><label>39.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crow</surname><given-names>M</given-names></name><name><surname>Paul</surname><given-names>A</given-names></name><name><surname>Ballouz</surname><given-names>S</given-names></name><name><surname>Huang</surname><given-names>ZJ</given-names></name><name><surname>Gillis</surname><given-names>J</given-names></name></person-group><article-title>Characterizing the replicability of cell types defined by single cell RNA-sequencing data using MetaNeighbor</article-title><source>Nat Commun.</source><year>2018</year><volume>9</volume><fpage>884</fpage><pub-id pub-id-type="doi">10.1038/s41467-018-03282-0</pub-id><pub-id pub-id-type="pmid">29491377</pub-id></element-citation></ref><ref id="CR40"><label>40.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhns</surname><given-names>MS</given-names></name><name><surname>Badgandi</surname><given-names>HB</given-names></name></person-group><article-title>Piecing together the family portrait of TCR-CD3 complexes</article-title><source>Immunol Rev</source><year>2012</year><volume>250</volume><fpage>120</fpage><lpage>143</lpage><pub-id pub-id-type="doi">10.1111/imr.12000</pub-id><pub-id pub-id-type="pmid">23046126</pub-id></element-citation></ref><ref id="CR41"><label>41.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nourani</surname><given-names>MR</given-names></name><name><surname>Farajpour</surname><given-names>Z</given-names></name><name><surname>Najafi</surname><given-names>A</given-names></name><name><surname>Imani Fooladi</surname><given-names>AA</given-names></name></person-group><article-title>Trefoil factor family 1 is involved in airway remodeling of mustard lung</article-title><source>Iran J Allergy Asthma Immunol</source><year>2016</year><volume>15</volume><fpage>275</fpage><lpage>282</lpage><?supplied-pmid 27921407?><pub-id pub-id-type="pmid">27921407</pub-id></element-citation></ref><ref id="CR42"><label>42.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prokopovic</surname><given-names>V</given-names></name><name><surname>Popovic</surname><given-names>M</given-names></name><name><surname>Andjelkovic</surname><given-names>U</given-names></name><name><surname>Marsavelski</surname><given-names>A</given-names></name><name><surname>Raskovic</surname><given-names>B</given-names></name><name><surname>Gavrovic-Jankulovic</surname><given-names>M</given-names></name><etal/></person-group><article-title>Isolation, biochemical characterization and antibacterial activity of BPIFA2 protein</article-title><source>Arch Oral Biol Pergamon</source><year>2014</year><volume>59</volume><fpage>302</fpage><lpage>309</lpage><pub-id pub-id-type="doi">10.1016/j.archoralbio.2013.12.005</pub-id></element-citation></ref><ref id="CR43"><label>43.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuijlaars</surname><given-names>J</given-names></name><name><surname>Oyelami</surname><given-names>T</given-names></name><name><surname>Diels</surname><given-names>A</given-names></name><name><surname>Rohrbacher</surname><given-names>J</given-names></name><name><surname>Versweyveld</surname><given-names>S</given-names></name><name><surname>Meneghello</surname><given-names>G</given-names></name><etal/></person-group><article-title>Sustained synchronized neuronal network activity in a human astrocyte co-culture system</article-title><source>Sci Rep</source><year>2016</year><volume>6</volume><fpage>36529</fpage><pub-id pub-id-type="doi">10.1038/srep36529</pub-id><pub-id pub-id-type="pmid">27819315</pub-id></element-citation></ref><ref id="CR44"><label>44.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pollen</surname><given-names>AA</given-names></name><name><surname>Nowakowski</surname><given-names>TJ</given-names></name><name><surname>Shuga</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Leyrat</surname><given-names>AA</given-names></name><name><surname>Lui</surname><given-names>JH</given-names></name><etal/></person-group><article-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</article-title><source>Nat Biotechnol.</source><year>2014</year><volume>32</volume><fpage>1053</fpage><lpage>1058</lpage><pub-id pub-id-type="doi">10.1038/nbt.2967</pub-id><pub-id pub-id-type="pmid">25086649</pub-id></element-citation></ref><ref id="CR45"><label>45.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frotscher</surname><given-names>M</given-names></name></person-group><article-title>Cajal-Retzius cells, Reelin, and the formation of layers</article-title><source>Curr Opin Neurobiol</source><year>1998</year><volume>8</volume><issue>5</issue><fpage>570</fpage><lpage>575</lpage><pub-id pub-id-type="doi">10.1016/S0959-4388(98)80082-2</pub-id><pub-id pub-id-type="pmid">9811621</pub-id></element-citation></ref><ref id="CR46"><label>46.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nowakowski</surname><given-names>TJ</given-names></name><name><surname>Bhaduri</surname><given-names>A</given-names></name><name><surname>Pollen</surname><given-names>AA</given-names></name><name><surname>Alvarado</surname><given-names>B</given-names></name><name><surname>Mostajo-Radji</surname><given-names>MA</given-names></name><name><surname>Di Lullo</surname><given-names>E</given-names></name><etal/></person-group><article-title>Spatiotemporal gene expression trajectories reveal developmental hierarchies of the human cortex</article-title><source>Science</source><year>2017</year><volume>358</volume><fpage>1318</fpage><lpage>1323</lpage><pub-id pub-id-type="doi">10.1126/science.aap8809</pub-id><pub-id pub-id-type="pmid">29217575</pub-id></element-citation></ref><ref id="CR47"><label>47.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rouillard</surname><given-names>AD</given-names></name><name><surname>Gundersen</surname><given-names>GW</given-names></name><name><surname>Fernandez</surname><given-names>NF</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Monteiro</surname><given-names>CD</given-names></name><name><surname>McDermott</surname><given-names>MG</given-names></name><etal/></person-group><article-title>The harmonizome: a collection of processed datasets gathered to serve and mine knowledge about genes and proteins</article-title><source>Database (Oxford)</source><year>2016</year><volume>2016</volume><fpage>baw100</fpage><pub-id pub-id-type="doi">10.1093/database/baw100</pub-id><pub-id pub-id-type="pmid">27374120</pub-id></element-citation></ref><ref id="CR48"><label>48.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>JA</given-names></name><name><surname>Ding</surname><given-names>SL</given-names></name><name><surname>Sunkin</surname><given-names>SM</given-names></name><name><surname>Smith</surname><given-names>KA</given-names></name><name><surname>Ng</surname><given-names>L</given-names></name><name><surname>Szafer</surname><given-names>A</given-names></name><etal/></person-group><article-title>Transcriptional landscape of the prenatal human brain</article-title><source>Nature</source><year>2014</year><volume>508</volume><fpage>199</fpage><lpage>206</lpage><pub-id pub-id-type="doi">10.1038/nature13185</pub-id><pub-id pub-id-type="pmid">24695229</pub-id></element-citation></ref><ref id="CR49"><label>49.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyer</surname><given-names>G</given-names></name><name><surname>Perez-Garcia</surname><given-names>CG</given-names></name><name><surname>Gleeson</surname><given-names>JG</given-names></name></person-group><article-title>Selective expression of doublecortin and LIS1 in developing human cortex suggests unique modes of neuronal movement</article-title><source>Cereb Cortex</source><year>2002</year><volume>12</volume><fpage>1225</fpage><lpage>1236</lpage><pub-id pub-id-type="doi">10.1093/cercor/12.12.1225</pub-id><pub-id pub-id-type="pmid">12427674</pub-id></element-citation></ref><ref id="CR50"><label>50.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gonzalez-Gomez</surname><given-names>M</given-names></name><name><surname>Meyer</surname><given-names>G</given-names></name></person-group><article-title>Dynamic expression of calretinin in embryonic and early fetal human cortex</article-title><source>Front Neuroanat</source><year>2014</year><volume>8</volume><fpage>41</fpage><?supplied-pmid 24917793?><pub-id pub-id-type="pmid">24917793</pub-id></element-citation></ref><ref id="CR51"><label>51.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martinez-Galan</surname><given-names>JR</given-names></name><name><surname>Moncho-Bogani</surname><given-names>J</given-names></name><name><surname>Caminos</surname><given-names>E</given-names></name></person-group><article-title>Expression of calcium-binding proteins in layer 1 Reelin-Immunoreactive cells during rat and mouse neocortical development</article-title><source>J Histochem Cytochem</source><year>2014</year><volume>62</volume><fpage>60</fpage><lpage>69</lpage><pub-id pub-id-type="doi">10.1369/0022155413509381</pub-id><pub-id pub-id-type="pmid">24134921</pub-id></element-citation></ref><ref id="CR52"><label>52.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Molyneaux</surname><given-names>BJ</given-names></name><name><surname>Arlotta</surname><given-names>P</given-names></name><name><surname>JRL</surname><given-names>M</given-names></name><name><surname>Macklis</surname><given-names>JD</given-names></name></person-group><article-title>Neuronal subtype specification in the cerebral cortex</article-title><source>Nat Rev Neurosci</source><year>2007</year><volume>8</volume><fpage>427</fpage><lpage>437</lpage><pub-id pub-id-type="doi">10.1038/nrn2151</pub-id><pub-id pub-id-type="pmid">17514196</pub-id></element-citation></ref><ref id="CR53"><label>53.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lun</surname><given-names>MP</given-names></name><name><surname>Monuki</surname><given-names>ES</given-names></name><name><surname>Lehtinen</surname><given-names>MK</given-names></name></person-group><article-title>Development and functions of the choroid plexus-cerebrospinal fluid system</article-title><source>Nat Rev Neurosci</source><year>2015</year><volume>16</volume><fpage>445</fpage><lpage>457</lpage><pub-id pub-id-type="doi">10.1038/nrn3921</pub-id><pub-id pub-id-type="pmid">26174708</pub-id></element-citation></ref><ref id="CR54"><label>54.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pollen</surname><given-names>AA</given-names></name><name><surname>Nowakowski</surname><given-names>TJ</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Retallack</surname><given-names>H</given-names></name><name><surname>Sandoval-Espinosa</surname><given-names>C</given-names></name><name><surname>Nicholas</surname><given-names>CR</given-names></name><etal/></person-group><article-title>Molecular identity of human outer radial glia during cortical development</article-title><source>Cell</source><year>2015</year><volume>163</volume><fpage>55</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.09.004</pub-id><pub-id pub-id-type="pmid">26406371</pub-id></element-citation></ref><ref id="CR55"><label>55.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cooper</surname><given-names>JA</given-names></name></person-group><article-title>Molecules and mechanisms that regulate multipolar migration in the intermediate zone</article-title><source>Front Cell Neurosci</source><year>2014</year><volume>8</volume><fpage>386</fpage><?supplied-pmid 25452716?><pub-id pub-id-type="pmid">25452716</pub-id></element-citation></ref><ref id="CR56"><label>56.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>G</given-names></name><name><surname>Sima</surname><given-names>J</given-names></name><name><surname>Jin</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>KY</given-names></name><name><surname>Xue</surname><given-names>XJ</given-names></name><name><surname>Zheng</surname><given-names>W</given-names></name><etal/></person-group><article-title>Semaphorin-3A guides radial migration of cortical neurons during development</article-title><source>Nat Neurosci</source><year>2008</year><volume>11</volume><fpage>36</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1038/nn2018</pub-id><pub-id pub-id-type="pmid">18059265</pub-id></element-citation></ref><ref id="CR57"><label>57.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Priddle</surname><given-names>TH</given-names></name><name><surname>Crow</surname><given-names>TJ</given-names></name></person-group><article-title>Protocadherin 11X/Y a human-specific gene pair: an immunohistochemical survey of fetal and adult brains</article-title><source>Cereb Cortex</source><year>2013</year><volume>23</volume><fpage>1933</fpage><lpage>1941</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhs181</pub-id><pub-id pub-id-type="pmid">22744706</pub-id></element-citation></ref><ref id="CR58"><label>58.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lodato</surname><given-names>S</given-names></name><name><surname>Molyneaux</surname><given-names>BJ</given-names></name><name><surname>Zuccaro</surname><given-names>E</given-names></name><name><surname>Goff</surname><given-names>LA</given-names></name><name><surname>Chen</surname><given-names>HH</given-names></name><name><surname>Yuan</surname><given-names>W</given-names></name><etal/></person-group><article-title>Gene co-regulation by Fezf2 selects neurotransmitter identity and connectivity of corticospinal neurons</article-title><source>Nat Neurosci</source><year>2014</year><volume>17</volume><fpage>1046</fpage><lpage>1054</lpage><pub-id pub-id-type="doi">10.1038/nn.3757</pub-id><pub-id pub-id-type="pmid">24997765</pub-id></element-citation></ref><ref id="CR59"><label>59.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cunningham</surname><given-names>F</given-names></name><name><surname>Amode</surname><given-names>MR</given-names></name><name><surname>Barrell</surname><given-names>D</given-names></name><name><surname>Beal</surname><given-names>K</given-names></name><name><surname>Billis</surname><given-names>K</given-names></name><name><surname>Brent</surname><given-names>S</given-names></name><etal/></person-group><article-title>Ensembl 2015</article-title><source>Nucleic Acids Res.</source><year>2015</year><volume>43</volume><fpage>D662</fpage><lpage>D669</lpage><pub-id pub-id-type="doi">10.1093/nar/gku1010</pub-id><pub-id pub-id-type="pmid">25352552</pub-id></element-citation></ref><ref id="CR60"><label>60.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schuierer</surname><given-names>S</given-names></name><name><surname>Roma</surname><given-names>G</given-names></name><etal/></person-group><source>Nucleic Acids Res</source><year>2016</year><volume>44</volume><issue>16</issue><fpage>e132</fpage><pub-id pub-id-type="doi">10.1093/nar/gkw538</pub-id><pub-id pub-id-type="pmid">27302131</pub-id></element-citation></ref><ref id="CR61"><label>61.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bilican</surname><given-names>B</given-names></name><name><surname>Livesey</surname><given-names>MR</given-names></name><name><surname>Haghi</surname><given-names>G</given-names></name><name><surname>Qiu</surname><given-names>J</given-names></name><name><surname>Burr</surname><given-names>K</given-names></name><name><surname>Siller</surname><given-names>R</given-names></name><etal/></person-group><article-title>Physiological normoxia and absence of EGF is required for the long-term propagation of anterior neural precursors from human pluripotent cells</article-title><source>PLoS One</source><year>2014</year><volume>9</volume><issue>1</issue><fpage>e85932</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0085932</pub-id><pub-id pub-id-type="pmid">24465796</pub-id></element-citation></ref><ref id="CR62"><label>62.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lun</surname><given-names>AT</given-names></name><name><surname>Bach</surname><given-names>K</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title><source>Genome Biol</source><year>2016</year><volume>17</volume><fpage>75</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-0947-7</pub-id><pub-id pub-id-type="pmid">27122128</pub-id></element-citation></ref><ref id="CR63"><label>63.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vallejos</surname><given-names>CA</given-names></name><name><surname>Risso</surname><given-names>D</given-names></name><name><surname>Scialdone</surname><given-names>A</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>Normalizing single-cell RNA sequencing data: challenges and opportunities</article-title><source>Nat Methods</source><year>2017</year><volume>14</volume><fpage>565</fpage><lpage>571</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4292</pub-id><pub-id pub-id-type="pmid">28504683</pub-id></element-citation></ref><ref id="CR64"><label>64.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilcoxon</surname><given-names>F</given-names></name></person-group><article-title>Individual comparisons by ranking methods</article-title><source>Biom Bull.</source><year>1945</year><volume>1</volume><fpage>80</fpage><pub-id pub-id-type="doi">10.2307/3001968</pub-id></element-citation></ref><ref id="CR65"><label>65.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ritchie</surname><given-names>ME</given-names></name><name><surname>Phipson</surname><given-names>B</given-names></name><name><surname>Wu</surname><given-names>D</given-names></name><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Law</surname><given-names>CW</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name><etal/></person-group><article-title>Limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title><source>Nucleic Acids Res</source><year>2015</year><volume>43</volume><fpage>e47</fpage><pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id><pub-id pub-id-type="pmid">25605792</pub-id></element-citation></ref><ref id="CR66"><label>66.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group><article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title><source>Nat Methods.</source><year>2018</year><volume>15</volume><fpage>255</fpage><lpage>261</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4612</pub-id><pub-id pub-id-type="pmid">29481549</pub-id></element-citation></ref><ref id="CR67"><label>67.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>edgeR: a bioconductor package for differential expression analysis of digital gene expression data</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>139</fpage><lpage>140</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id><pub-id pub-id-type="pmid">19910308</pub-id></element-citation></ref><ref id="CR68"><label>68.</label><mixed-citation publication-type="other">Love MI, Huber W, Anders S. Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2. Genome Biol. 2014; Available from: 10.1186/s13059-014-0550-8.</mixed-citation></ref><ref id="CR69"><label>69.</label><mixed-citation publication-type="other">Novartis Institutes for Biomedical Research. Single cell RNA-sequencing of human cell lines performed for the benchmarking of single cell transcriptome analytics. Sequence Read Archive. 2019; Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=PRJNA484547">https://www.ncbi.nlm.nih.gov/sra/?term=PRJNA484547</ext-link>.</mixed-citation></ref><ref id="CR70"><label>70.</label><mixed-citation publication-type="other">Novartis Institutes for Biomedical Research. Neurons were made from H9 ESCs using a directed differentiation protocol in spinner flasks. After 86 DIV, cells were dissociated and run through the 10X Genomics Chromium single cell RNAseq platform. Sequence Read Archive. 2019; Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=PRJNA545246">https://www.ncbi.nlm.nih.gov/sra/?term=PRJNA545246</ext-link>.</mixed-citation></ref><ref id="CR71"><label>71.</label><mixed-citation publication-type="other">Novartis Institutes for Biomedical Research. scRNAseq_workflow_benchmark: single cell RNAseq data analysis workflow. Zenodo. 2019; Available from: 10.5281/zenodo.3237742.</mixed-citation></ref><ref id="CR72"><label>72.</label><mixed-citation publication-type="other">Novartis Institutes for Biomedical Research. CellSIUS: Cell Subtype Identification from Upregulated gene Sets. Github Repository. 2019; Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/Novartis/CellSIUS">https://github.com/Novartis/CellSIUS</ext-link>.</mixed-citation></ref><ref id="CR73"><label>73.</label><mixed-citation publication-type="other">Novartis Institutes for Biomedical Research. CellSIUS: Cell Subtype Identification from Upregulated gene Sets. Zenodo. 2019; Available from: 10.5281/zenodo.3237749.</mixed-citation></ref><ref id="CR74"><label>74.</label><mixed-citation publication-type="other">Novartis Institutes for Biomedical Research. CellSIUS provides sensitive and specific detection of rare cell populations from complex single cell RNA-seq data: Codes and processed data. Zenodo. 2019; Available from: 10.5281/zenodo.3238275.</mixed-citation></ref></ref-list></back></article>