<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Commun Biol</journal-id><journal-id journal-id-type="iso-abbrev">Commun Biol</journal-id><journal-title-group><journal-title>Communications Biology</journal-title></journal-title-group><issn pub-type="epub">2399-3642</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6355807</article-id><article-id pub-id-type="publisher-id">291</article-id><article-id pub-id-type="doi">10.1038/s42003-019-0291-z</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Somatic mutation detection and classification through probabilistic integration of clonal population information</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Dorri</surname><given-names>Fatemeh</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Jewell</surname><given-names>Sean</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Bouchard-C&#x000f4;t&#x000e9;</surname><given-names>Alexandre</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6402-523X</contrib-id><name><surname>Shah</surname><given-names>Sohrab P.</given-names></name><address><email>shahs3@mskcc.org</email></address><xref ref-type="aff" rid="Aff4">4</xref><xref ref-type="aff" rid="Aff5">5</xref><xref ref-type="aff" rid="Aff6">6</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2288 9830</institution-id><institution-id institution-id-type="GRID">grid.17091.3e</institution-id><institution>Department of Computer Science, </institution><institution>University of British Columbia, </institution></institution-wrap>201- 2366 Main Mall, V6T 1Z4 Vancouver, Canada </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000000122986657</institution-id><institution-id institution-id-type="GRID">grid.34477.33</institution-id><institution>Department of Statistics, </institution><institution>University of Washington, </institution></institution-wrap>B313 Padelford Hall, Northeast Stevens Way, Seattle, WA 24105 USA </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2288 9830</institution-id><institution-id institution-id-type="GRID">grid.17091.3e</institution-id><institution>Department of Statistics, </institution><institution>University of British Columbia, </institution></institution-wrap>3182 Earth Sciences Building, 2207 Main Mall, V6T 1Z4 Vancouver, Canada </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2288 9830</institution-id><institution-id institution-id-type="GRID">grid.17091.3e</institution-id><institution>Department of Molecular Oncology, </institution><institution>University of British Columbia, </institution></institution-wrap>675 West 10th Avenue, V5Z 1L3 Vancouver, Canada </aff><aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2288 9830</institution-id><institution-id institution-id-type="GRID">grid.17091.3e</institution-id><institution>Department of Pathology and Laboratory Medicine, </institution><institution>University of British Columbia, </institution></institution-wrap>Rm. G227 - 2211 Wesbrook Mall, 24105 Vancouver, Canada </aff><aff id="Aff6"><label>6</label>Computational Oncology, Department of Epidemiology and Biostatistics, Memorial Sloan Kettering Cancer Center, Kettering Cancer Center, 417 E 68th Street, New York, NY 10065 USA </aff></contrib-group><pub-date pub-type="epub"><day>31</day><month>1</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>31</day><month>1</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>2</volume><elocation-id>44</elocation-id><history><date date-type="received"><day>17</day><month>5</month><year>2018</year></date><date date-type="accepted"><day>20</day><month>12</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">Somatic mutations are a primary contributor to malignancy in human cells. Accurate detection of mutations is needed to define the clonal composition of tumours whereby clones may have distinct phenotypic properties. Although analysis of mutations over multiple tumour samples from the same patient has the potential to enhance identification of clones, few analytic methods exploit the correlation structure across samples. We posited that incorporating clonal information into joint analysis over multiple samples would improve mutation detection, particularly those with low prevalence. In this paper, we develop a new procedure called MuClone, for detection of mutations across multiple tumour samples of a patient from whole genome or exome sequencing data. In addition to mutation detection, MuClone classifies mutations into biologically meaningful groups and allows us to study clonal dynamics. We show that, on lung and ovarian cancer datasets, MuClone improves somatic mutation detection sensitivity over competing approaches without compromising specificity.</p></abstract><abstract id="Abs2" abstract-type="web-summary"><p id="Par2">Fatemeh Dorri et al. present MuClone, a method for simultaneous detection and classification of mutations across multiple tumor samples derived from one patient. They show that clonal information improves sensitivity in detecting somatic mutations.</p></abstract><funding-group><award-group><funding-source><institution>1- Natural Sciences and Engineering Research Council of Canada Frontiers grant #448167-13 2- Canadian Institutes for Health Research Foundation award FDN 143246a</institution></funding-source></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par3">Genomic accumulation of somatic point mutations, or single nucleotide variants (SNVs), can disrupt the regular activity of cells and result in cancer initiation and progression. Collectively, the complete repertoire of SNVs across a cancer genome (numbering in the thousands) form a statistically robust marker for inferring clonal populations and studying tumour evolution. As such, accurate detection of all somatic SNVs, including those with low prevalence, is vital as they can define clones with phenotypic properties of interest. Mechanistic association of specific clones with properties such as treatment resistance, metastatic potential, and fitness under therapeutic selective pressures remains a key objective of biomedical investigators studying tumour progression.</p><p id="Par4">Phylogenetic analysis can encode the evolutionary lineage of tumour cells across time and anatomic space<sup><xref ref-type="bibr" rid="CR1">1</xref>&#x02013;<xref ref-type="bibr" rid="CR7">7</xref></sup>. Sequencing of multiple samples of a cancer to reconstruct evolutionary patterns and drug response profiles are increasingly common. For example, in rapid autopsy programs, at the time of a patient&#x02019;s death, tens to hundreds of metastatic samples are collected for future study<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup>. Recent multi-sample sequencing studies in renal, lung, ovary, breast, colorectal, and other cancers have revealed striking evolutionary and clinically important properties of cancers<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>. However, the analytical methods to detect mutations from such experimental designs are still immature, and few studies have leveraged shared statistical strength across samples to detect mutations with greater sensitivity.</p><p id="Par5">In the limit case, all cells likely harbour unique genomes, however due to the nature of branched evolutionary processes, clones can be coarsely modelled as major clades in the cell lineage phylogeny of a cancer. These clades share the majority of mutations, and therefore define first approximations to the genotypes of clones. Clonal genotypes and their relative abundances in the cancer cell population can be approximated by clustering mutations measured in bulk tissues and estimating their cellular prevalences (the variant tumour cell fraction)<sup><xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup>.</p><p id="Par6">Phylogenetic algorithms mostly use mutations (represented as binary genetic markers), as inputs to infer the branched evolutionary lineages of tumour cells<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>. Thus, mutation detection accuracy will ultimately impact the performance of phylogenetic inference algorithms.</p><p id="Par7">Detection of low prevalence mutations is a major challenge due to typically small signal to noise ratios, owing to: (i) contamination by normal cells; (ii) genome copy number alteration; and (iii) the presence of mutations in only a small fraction of tumour cells (intra-tumour heterogeneity). In this work, we illustrate that knowledge of the clonal population structure improves detection of mutations defining low prevalence clonal genotypes.</p><p id="Par8">Although SNV calling algorithms are ubiquitous in the literature, it remains challenging to detect low prevalence mutations. Algorithms have been developed for calling mutations from a single sample<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>, paired (matched normal and tumour) samples<sup><xref ref-type="bibr" rid="CR18">18</xref>&#x02013;<xref ref-type="bibr" rid="CR22">22</xref></sup>, or multiple samples<sup><xref ref-type="bibr" rid="CR23">23</xref>,<xref ref-type="bibr" rid="CR24">24</xref></sup>. We list several popular algorithms. Mutationseq uses a feature based classifier for calling mutations<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, where the features are constructed from matched paired normal and tumour samples. Strelka is a method for somatic SNV and small indel detection from sequencing data of matched normal and tumour samples<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. It is based on a Bayesian approach that uses normal and tumour samples&#x02019; allele frequencies with normal expected genotype structure. MuTect uses a Bayesian classifier that employs various filters to ensure high specificity to detect mutations from matched normal and tumour samples<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. FreeBayes uses short read alignments to call the most likely genotypes for the population at each position. It can be run in single mode using only one tumour sample or in multiple mode utilizing multiple tumour samples from the same patient<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. FreeBayes can detect somatic mutations if germlines are manually removed. MultiSNV jointly analyses all available samples under a Bayesian framework to improve the performance of calling shared mutations<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. SNV calls from GATK<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> are refined and corrected by using phylogeny information across multiple samples<sup><xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>.</p><p id="Par9">In our proposal, MuClone, we exploit prior knowledge of tumour content, tumour cellular prevalence, and copy number information across multiple samples to improve detection of somatic SNVs, and in particular, low prevalence ones. Our model uses mutation clusters and copy number information obtained from standard approaches<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>. In the first step, a set of stringent SNV calls or validated SNVs (using targeted sequencing data) is used to infer mutation cluster information. Then, MuClone uses the inferred cluster information to more accurately call mutations across genome (whole genome or exome sequencing data). In addition to calling mutations, MuClone also classifies mutations into clusters based on cellular prevalence. This provides the user with the opportunity to profile mutation changes across time and space, and adds a rich layer of interpretation into the detection process.</p><p id="Par10">We test MuClone through simulation studies and an application to real, multiple sample, patient data. These experiments reveal that incorporating the cellular prevalences of different clusters improves accuracy. Moreover, in real data, MuClone exhibits higher sensitivity (true positive rate or recall) in detecting mutations without compromising specificity (true negative rate) compared with other methods.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><sec id="Sec3"><title>Synthetic data</title><p id="Par11">In this section, we examine the performance of MuClone on simulated data. In what follows, we generate <italic>N</italic> loci from <italic>M</italic> samples with <italic>K</italic> underlying tumour mutation clusters with sequencing error rate <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon$$\end{document}</tex-math><mml:math id="M2"><mml:mi>&#x003f5;</mml:mi></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq1.gif"/></alternatives></inline-formula> and tumour content <italic>t</italic><sub><italic>m</italic></sub>.</p><p id="Par12">We first randomly generate an evolutionary relationship between clusters, viewed as a binary phylogenetic tree. Each node in the tree represents a mutation cluster. The root node represents the ancestral cluster. For each sample,&#x000a0;the cellular prevalence of the first descendant, <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi} _{1^{\mathrm{st}}}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">st</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq2.gif"/></alternatives></inline-formula>, is sampled from a Uniform distribution over [0, <italic>&#x003d5;</italic><sub>parent</sub>], where <italic>&#x003d5;</italic><sub>parent</sub> is the cellular prevalence of the parent node (cluster). The cellular prevalence of the second descendant, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi} _{2^{\mathrm{nd}}}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">nd</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq3.gif"/></alternatives></inline-formula>, is sampled from a Uniform distribution over <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[ {0,{\phi} _{{\mathrm{parent}}} - {\phi} _{1^{\mathrm{st}}}}]$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">parent</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">st</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq4.gif"/></alternatives></inline-formula>, defined so that the sum of the children&#x02019;s prevalences do not exceed their parent&#x02019;s cellular prevalence. The absence or presence of each cluster, in each sample, is sampled from a Bernoulli distribution that assigns equal probability to both outcomes. If a cluster is not present in a sample, the corresponding cellular prevalence will be 0. See Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref> for an example of this process. Loci are assigned to a cluster uniformly at random from {0, &#x02026;, <italic>K</italic>}, where cluster 0 represents the wildtype cluster and {1, &#x02026;, <italic>K</italic>} are mutation clusters. For each locus, in each sample, the number of reads overlapping the locus (depth) is sampled from a Poisson distribution with mean <italic>d</italic><sub><italic>m</italic></sub>. Wildtype copy number is deterministically set to 2, and a copy number profile (major and minor copy number) is generated according to the following steps: The total copy number, <italic>C</italic><sup><italic>t</italic></sup>, is sampled uniformly at random from {1, &#x02026;, <italic>C</italic><sub>max</sub>}. An integer number, <italic>C</italic><sup><italic>b</italic></sup>, is randomly (following a discrete Uniform distribution) picked from 1 to <italic>C</italic><sup><italic>t</italic></sup>, and <italic>C</italic><sup><italic>a</italic></sup> is defined as <italic>C</italic><sup><italic>a</italic></sup>&#x02009;=&#x02009;<italic>C</italic><sup><italic>t</italic></sup>&#x02009;&#x02212;&#x02009;<italic>C</italic><sup><italic>b</italic></sup>. Lastly, the major copy number is set to the maximum of <italic>C</italic><sup><italic>b</italic></sup> and <italic>C</italic><sup><italic>a</italic></sup>; the minor copy number is set to the minimum of those two values. Then, corresponding to each cluster, the number of variant reads are sampled from the Beta-Binomial distribution described in Eq. (<xref rid="Equ7" ref-type="">7</xref>) with precision parameter equal to 1000.</p></sec><sec id="Sec4"><title>Synthetic data evaluation</title><p id="Par13">We simulated 10 synthetic data for 20,000 loci from 4 samples of a patient, with 5 underlying clusters, including an ancestral cluster. The maximum copy number was 5, and the error rate was 0.01. The average sequencing depth was assumed to be 100 for all samples.</p><p id="Par14">To assess the performance and robustness of MuClone, we systematically shielded MuClone from clonal information (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). In particular, the cellular prevalence information was perturbed by (i) adding noise to its value, or (ii) removing the cellular prevalence information of the clusters. The noise was generated from a normal distribution with mean zero and standard deviations: 0, 0.01, 0.1, and 0.2. The noise value, <italic>&#x003bd;</italic>, was added to the cellular prevalence of the cluster, while bounding the resulting value between 0 and 1, that is,<disp-formula id="Equa"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi} _m^{ \ast z} = {\mathrm{min}}\left( {{\mathrm{max}}({\phi} _m^z + \nu ,0),1} \right),$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">min</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>&#x003bd;</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2019_291_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi} _m^{ \ast z}$$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi} _m^z$$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq6.gif"/></alternatives></inline-formula> are the perturbed and original cellular prevalence of cluster <italic>z</italic> and sample <italic>m</italic>, respectively. The clusters which their clonal information was removed, were randomly chosen with equal probabilities. As expected, both sensitivity and specificity were highest with complete and accurate clonal information; see Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>. This suggests that incorporating clonal information can improve mutation detection accuracy and gives evidence to support MuClone&#x02019;s approach. Furthermore, since the sensitivities were only marginally impacted by adding noise to the clonal information, MuClone should be able to cope with modest misspecification of the prior. However, specificity can decrease if the cellular prevalence is reduced to levels associated with the wildtype cluster and sensitivity can improve if adding noise increases the cellular prevalence to levels associated with a removed mutation cluster.<fig id="Fig1"><label>Fig. 1</label><caption><p>MuClone's performance with inaccurate clonal information: 10 synthetic datasets generated for 20,000 loci, from 4 samples of a hypothetical patient, with 5 underlying clusters. The maximum copy number is 5, error rate is set to 0.01, and average sequencing depth is approximately 100. To assess performance, we add noise from a mean zero normal with standard deviation equal to 0 (dark purple), 0.01 (light purple), 0.1 (light blue), and 0.2 (dark blue) to the cellular prevalence and also remove the clonal information of different number of clusters. <bold>a</bold> Sensitivity and <bold>b</bold> Specificity of MuClone with parameters: wildtype prior&#x02009;=&#x02009;0.5, <italic>&#x003a6;</italic><sub><italic>T</italic></sub>&#x02009;=&#x02009;0.02, error rate&#x02009;=&#x02009;0.01, tumour content&#x02009;=&#x02009;0.75, and precision parameter&#x02009;=&#x02009;1000</p></caption><graphic xlink:href="42003_2019_291_Fig1_HTML" id="d29e770"/></fig></p><p id="Par15">Naturally, accuracy is most severely impacted with reduced/corrupted clonal information; see Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>. For the modest level of noise (noise standard deviation 0 and 0.01), the sensitivity and specificity of removing various numbers of clusters were compared through a Kruskal&#x02013;Wallis test (4e&#x02212;5&#x02009;&#x02264;&#x02009;<italic>p</italic>-values&#x02009;&#x02264;&#x02009;1e&#x02212;4) which shows that the change in performance due to clonal information is significant. In noiseless settings, the confidence interval for the difference (of zero and four removed clusters) in mean sensitivity and specificity are [0.16, 0.26] and [0.08, 0.32], respectively. When the noise standard deviation is equal to 0.01, these intervals are [0.11, 0.21] and [0.09, 0.36].</p><p id="Par16">We also explored how sensitivity and specificity change as a function of the wildtype prior and the threshold <italic>&#x003a6;</italic><sub><italic>T</italic></sub> used to distinguish the cellular prevalence cutoff of a mutation cluster. In Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>, we tested MuClone with wildtype prior values 0.5, 0.75, and 0.99, and with <italic>&#x003a6;</italic><sub><italic>T</italic></sub> values 0.001, 0.01, 0.02, 0.03, and 0.04. In the case that the wildtype prior equals 0.5, we assumed that a locus is equally likely to be a mutation or not (when no other information is provided). MuClone&#x02019;s sensitivity and specificity are near 1 for <italic>&#x003a6;</italic><sub><italic>T</italic></sub>&#x02009;equal to&#x02009;0.02 and wildtype prior equal to 0.5. As expected, with small values of <italic>&#x003a6;</italic><sub><italic>T</italic></sub>, the sensitivity and specificity decrease since it is difficult to distinguish between wildtypes and mutations with small cellular prevalences. The sensitivity also decreases for large values of <italic>&#x003a6;</italic><sub><italic>T</italic></sub> because mutations are miscalled as wildtypes. When the error rate was 0.01, and wildtype prior was 0.5, the optimal <italic>&#x003a6;</italic><sub><italic>T</italic></sub> was about 0.02. We used these values for the following experiments.<fig id="Fig2"><label>Fig. 2</label><caption><p>MuClone&#x02019;s performance as a function of wildtype prior: 10 synthetic datasets generated for 20,000 loci, from 4 samples of a hypothetical patient, with 5 underlying clusters. The maximum copy number is 5 and the error rate is set to 0.01, and average sequencing depth is approximately 100. We assess the performance for <italic>&#x003a6;</italic><sub><italic>T</italic></sub> equal to 0.001 (dark purple), 0.01 (light purple), 0.02 (white smoke), 0.03 (light blue), 0.04 (dark blue). <bold>a</bold> Sensitivity and <bold>b</bold> Specificity of MuClone with parameters: error rate&#x02009;=&#x02009;0.01, tumour content&#x02009;=&#x02009;0.75, and precision parameter&#x02009;=&#x02009;1000</p></caption><graphic xlink:href="42003_2019_291_Fig2_HTML" id="d29e841"/></fig></p><p id="Par17">The performance of MuClone was tested with various tumour content (from 0.1 to 0.99) and different error rates (0.01 and 0.001); see Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>. For samples with tumour content greater than 0.5, the sensitivity and specificity remain close to 1. Sensitivity and specificity decreased to only about 0.9 when the tumour content in the sample is as low as 0.1. These results establish promising performance over different ranges of tumour content with different error rates (likely scenarios in real data).<fig id="Fig3"><label>Fig. 3</label><caption><p>MuClone&#x02019;s performance as a function of tumour content: 10 synthetic datasets generated for 20,000 loci, from 4 samples of a hypothetical patient, with 5 underlying clusters. The maximum copy number is 5, and average sequencing depth is approximately 100. We assess the performance for error rate equal to 0.001 (light purple) and 0.01 (light blue), and tumour content from 0.1 to 0.99. <bold>a</bold> Sensitivity and <bold>b</bold> Specificity of MuClone with parameters: wildtype prior&#x02009;=&#x02009;0.5, <italic>&#x003a6;</italic><sub><italic>T</italic></sub>&#x02009;=&#x02009;0.02, and precision parameter&#x02009;=&#x02009;1000</p></caption><graphic xlink:href="42003_2019_291_Fig3_HTML" id="d29e867"/></fig></p><p id="Par18">In addition, we also explored the performance of MuClone for samples with different coverage (mean depth): 30, 60 and 100; see Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>. Intuitively, the performance is higher when we have more coverage. Since MuClone leverages cellular prevalence information to improve the performance of mutation detection, the performance gain is noticeable when the variant allelic ratio resolution supports the given cellular prevalence resolution (in our analysis the cellular prevalence of mutations is greater than 0.02).<fig id="Fig4"><label>Fig. 4</label><caption><p>MuClone&#x02019;s performance as a function of different depth: 10 synthetic datasets generated for 20,000 loci, from 4 samples of a hypothetical patient, with 5 underlying clusters. The maximum copy number is 5, error rate is set to 0.01 and average sequencing depth is approximately 100. <bold>a</bold> Sensitivity and <bold>b</bold> Specificity of MuClone with parameters: wildtype prior&#x02009;=&#x02009;0.5, <italic>&#x003a6;</italic><sub><italic>T</italic></sub>&#x02009;=&#x02009;0.02, error rate&#x02009;=&#x02009;0.01, tumour content&#x02009;=&#x02009;0.75, and precision parameter&#x02009;=&#x02009;1000</p></caption><graphic xlink:href="42003_2019_291_Fig4_HTML" id="d29e893"/></fig></p><p id="Par19">Figure&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref> demonstrates how well mutations are classified by MuClone. The input clonal information was perturbed by adding noise from zero mean normal distribution with standard deviation 0.01 to simulate a more realistic scenario. In Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5a</xref>, each bin (<italic>i</italic>, <italic>j</italic>) shows the fraction of mutations in cluster <italic>i</italic> that are classified into cluster <italic>j</italic> by MuClone. Figure&#x000a0;<xref rid="Fig5" ref-type="fig">5a</xref> shows that 85% of mutations are classified into the correct cluster.<fig id="Fig5"><label>Fig. 5</label><caption><p>MuClone&#x02019;s classification performance: 10 synthetic datasets generated for 20,000 loci, from 4 samples of a hypothetical patient, with 5 underlying clusters. The maximum copy number is 5, error rate is set to 0.01. <bold>a</bold> Bin (<italic>i</italic>, <italic>j</italic>) shows the fraction of mutations in cluster <italic>i</italic> that are classified into cluster <italic>j</italic> by MuClone. 85% of the mutations are classified correctly. <bold>b</bold> Misclassification index for 10 independent samples. MuClone with parameters: wildtype prior&#x02009;=&#x02009;0.5, <italic>&#x003a6;</italic><sub><italic>T</italic></sub>&#x02009;=&#x02009;0.02, error rate&#x02009;=&#x02009;0.01, tumour content&#x02009;=&#x02009;0.75, and precision parameter&#x02009;=&#x02009;1000</p></caption><graphic xlink:href="42003_2019_291_Fig5_HTML" id="d29e951"/></fig></p><p id="Par20">In order to show that the classification errors occurred between clusters with small phylogenetic distance, we define a misclassification index to quantify phylogenetic distance; calculated as<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{Misclassification}}\,{\mathrm{index}} = \frac{{\mathop {\sum}\nolimits_{i \ne j} {\kern 1pt} q_{(i,j)} \times \frac{{{\mathrm{dist}}_{(i,j)} - {\mathrm{dist}}_i^{{\mathrm{min}}}}}{{{\mathrm{dist}}_i^{{\mathrm{max}}} - {\mathrm{dist}}_i^{{\mathrm{min}}}}}}}{{\mathop {\sum}\nolimits_{i \ne j} {\kern 1pt} q_{(i,j)}}},$$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mi mathvariant="normal">Misclassification</mml:mi><mml:mspace width="0.3em"/><mml:mi mathvariant="normal">index</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">dist</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">dist</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">dist</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">dist</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2019_291_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>q</italic><sub>(<italic>i</italic>,<italic>j</italic>)</sub> is the number of mutations in cluster <italic>i</italic> that are classified into cluster <italic>j</italic>, and the Euclidean distance between the cellular prevalences of cluster <italic>i</italic> and <italic>j</italic> is denoted by dist<sub>(<italic>i</italic>,<italic>j</italic>)</sub>. The distance of the closest and farthest cluster to cluster <italic>i</italic> is denoted by <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{dist}_i^{{\mathrm{min}}}$$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">dist</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq7.gif"/></alternatives></inline-formula> and <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{dist}_i^{{\mathrm{max}}}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">dist</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq8.gif"/></alternatives></inline-formula>, respectively. In Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5b</xref>, small misclassification indices demonstrate that misclassified mutations occur between close clusters. This can be interpreted as phylogenetically recently separated clusters.</p></sec><sec id="Sec5"><title>Real data</title><p id="Par21">Two real data sets with multiple samples for each patient were used to evaluate the performance of MuClone. The first data set was multiple whole genome sequencing data from 7 patients with high grade serous ovarian cancer. The second data set was multiple whole exome sequencing data from 8 patients with non-small-cell lung cancer (NSCLC).</p></sec><sec id="Sec6"><title>High grade serous ovarian cancer</title><p id="Par22">We tested MuClone&#x02019;s performance on whole genome sequencing data (with depth 30x) from multiple tumour samples surgically resected from high grade serous ovarian cancer patients<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. The samples were obtained from different spatially distributed metastatic sites. Brief details about the number of samples for each patient, sample sites and the number of validated loci for each patient are shown in Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>. Germline mutations were excluded from the list.</p><p id="Par23">The copy number, tumour purity, and mutation cluster information for experimentally re-validated mutation status were taken from the phylogenetic study of high-grade serous ovarian cancer (see the supplementary note of the paper<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>). Mutation clusters were estimated with PyClone<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> on the deep targeted sequencing data (&#x0003e;1000x coverage) from the same samples and in three patients with accompanying single cell sequencing data (see Table S16 in the phylogenetic study of high-grade serous ovarian cancer paper<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>). Copy number and tumour purity estimates were calculated with the TITAN software<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. In order to eliminate germlines, loci with variant nucleotides in the corresponding normal sample were removed from the dataset. Then, the performance of MuClone was benchmarked against Strelka<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>(v2.0.15), MutationSeq<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>(v4.3.7), MuTect<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, FreeBayes<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>(v1.2.0-2), MultiSNV<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> and naive MuClone. Naive MuClone is a version of MuClone where no clonal information is provided (that is, all mutations are from an ancestral cluster).</p><p id="Par24">In Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>, the performance of MuClone is compared with other methods executed with default settings. For each patient, <italic>p</italic>, we assessed performance by averaging Youden&#x02019;s index, sensitivity, and specificity across different samples. For patient <italic>p</italic>, with <italic>n</italic><sub><italic>p</italic></sub> samples, these are calculated as<disp-formula id="Equb"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{Sensitivity}}_p = \frac{1}{{n_p}}\mathop {\sum}\limits_{i = 1}^{n_p} {\kern 1pt} {\mathrm{Sensitivity}}_p^i,$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Sensitivity</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Sensitivity</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2019_291_Article_Equb.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{Specificity}}_p = \frac{1}{{n_p}}\mathop {\sum}\limits_{i = 1}^{n_p} {\kern 1pt} {\mathrm{Specificity}}_p^i,$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Specificity</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Specificity</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2019_291_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equc"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hbox{Youden's index}}_p = \frac{1}{{n_p}}\mathop {\sum}\limits_{i = 1}^{n_p} \left( {{\mathrm{Sensitivity}}_p^i + {\mathrm{Specificity}}_p^i - 1} \right),$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:msub><mml:mrow><mml:mi>Y</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>&#x02019;</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Sensitivity</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Specificity</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2019_291_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq9"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{Sensitivity}}_p^i$$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Sensitivity</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq9.gif"/></alternatives></inline-formula>, <inline-formula id="IEq10"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{Specificity}}_p^i$$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Specificity</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hbox{Youden's index}}_{p}^{i}$$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>&#x02019;</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq11.gif"/></alternatives></inline-formula> are the sensitivity, specificity and Youden&#x02019;s index of sample <italic>i</italic> and patient <italic>p</italic>, respectively. In aggregate, MuClone outperforms other methods by improving sensitivity without compromising specificity; see Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>. False negatives arise mainly because the WGS data is under-represented (the average depth of the WGS data is about 30x) and lacks variant alleles that are present in the targeted sequencing data. False positives arise due to erroneous signal from sequencing technical artefacts.<fig id="Fig6"><label>Fig. 6</label><caption><p>Performance comparison of different methods on whole genome sequencing data from patients with high grade serous ovarian cancer. <bold>a</bold> Youden&#x02019;s index, <bold>b</bold> Sensitivity, and <bold>c</bold> Specificity across different mutation detection methods (from left to right: MuClone (dark blue), MultiSNV (orange), MuTect (light blue), Naive MuClone (yellow), Strelka (purple), MutationSeq (brown), and FreeBayes (pink)). MuClone parameters are: wildtype prior&#x02009;=&#x02009;0.5, <italic>&#x003a6;</italic><sub><italic>T</italic></sub>&#x02009;=&#x02009;0.02, tumour content&#x02009;=&#x02009;0.75, error rate&#x02009;=&#x02009;0.01, and precision parameter&#x02009;=&#x02009;1000</p></caption><graphic xlink:href="42003_2019_291_Fig6_HTML" id="d29e1572"/></fig></p><p id="Par25">In Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>, Strelka, MutationSeq, MuTect and Naive MuClone have lower performance as they do not incorporate information across multiple samples. FreeBayes was run on multiple samples and germlines were removed manually, but since the method only considers tumour samples, it has the lower performance versus other methods.</p><p id="Par26">To assess the performance of MuClone and MultiSNV, we conducted a two-sided <italic>t</italic>-test for the difference in the mean of Youden&#x02019;s index evaluated on mutation calls from MuClone and MultiSNV. The 95% confidence interval is [0.03, 0.1], with <italic>p</italic>-value equal to 0.0006; this shows that the difference is statistically significant. Importantly, MuClone improves sensitivity, enabling the detection of more mutations across the whole genome.</p><p id="Par27">Figure&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref> depicts the classification of mutations into clusters relative to the ground truth, as defined by running PyClone on the data (omitting singleton clusters<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>). Each bin (<italic>i</italic>, <italic>j</italic>) of Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref> shows the fraction of mutations in cluster <italic>i</italic> that are classified into cluster <italic>j</italic> by MuClone; 93% are correctly classified by MuClone. Moreover, we notice that misclassified mutations are classified into phylogenetically similar clusters (the misclassification index for patient 1 was 0.015).<fig id="Fig7"><label>Fig. 7</label><caption><p>Classification of 153 mutations of patient 1 with high grade serous ovarian cancer across 6 samples. Bin (<italic>i</italic>, <italic>j</italic>) shows the fraction of mutations in cluster <italic>i</italic> that are classified into cluster <italic>j</italic> by MuClone. MuClone parameters are: wildtype prior&#x02009;=&#x02009;0.5, <italic>&#x003a6;</italic><sub><italic>T</italic></sub>&#x02009;=&#x02009;0.02, error rate&#x02009;=&#x02009;0.01, tumour content&#x02009;=&#x02009;0.75, and precision parameter&#x02009;=&#x02009;1000. 93% of the elements are diagonal</p></caption><graphic xlink:href="42003_2019_291_Fig7_HTML" id="d29e1637"/></fig></p></sec><sec id="Sec7"><title>Non-small-cell lung cancer</title><p id="Par28">We tested MuClone&#x02019;s performance on early-stage NSCLC samples from the TRACERx data set<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. To help obtain the clonal and subclonal census, multiple tumour regions for each patient were sequenced by Illumina HiSeq. We used the copy number, purity estimate, and the mutation cluster information available in TRACERx study Supplementary Material<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. In the TRACERX study, the cellular prevalence was calculated from the whole exome sequencing data on a set of stringent mutations that were selected from MuTect and VarScan2 results with post-processing. In addition, the TRACERx study added a few mutations to reduce missed subclonal mutations; see Supplementary Appendix of TRACERx study<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>.</p><p id="Par29">To compare the performance of MuClone with Strelka, MultiSNV, and MuTect, we randomly selected 8 patients with subclonal mutations from the TRACERx data set (see Table S2 Supplementary Appendix 1 of the paper<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>). The TRACERx study generated a re-validated and curated list of mutations for their analysis; see Supplementary Appendix 2 of TRACERx study<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. The mutations with full copy number information across all 8 patients were used as ground truth to evaluate performance.</p><p id="Par30">We evaluated the false negative rates of mutation calling across several methods; see Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>. Altogether, out of 7238 mutations, MuClone missed 475 mutations while Strelka, MultiSNV and MuTect missed 7205, 5720, and 1086 mutations respectively. Hence, borrowing statistical strength, as done in MuClone, across samples likely increases sensitivity to real mutations.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Total number of false negative calls, across multiple samples of non-small cell lung cancer patients, from different mutation detection algorithms</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Patient</th><th>MuClone</th><th>MultiSNV</th><th>MuTect</th><th>Strelka</th></tr></thead><tbody><tr><td>CRUK0003</td><td>52</td><td>350</td><td>60</td><td>430</td></tr><tr><td>CRUK0004</td><td>16</td><td>188</td><td>36</td><td>240</td></tr><tr><td>CRUK0005</td><td>212</td><td>1736</td><td>236</td><td>2040</td></tr><tr><td>CRUK0013</td><td>26</td><td>490</td><td>270</td><td>540</td></tr><tr><td>CRUK0062</td><td>30</td><td>469</td><td>42</td><td>609</td></tr><tr><td>CRUK0063</td><td>75</td><td>445</td><td>40</td><td>510</td></tr><tr><td>CRUK0065</td><td>60</td><td>1902</td><td>342</td><td>2640</td></tr><tr><td>CRUK0094</td><td>4</td><td>140</td><td>60</td><td>196</td></tr></tbody></table></table-wrap></p><p id="Par31">We next ran MuClone, MultiSNV and MuTect on the whole exome data from multiple samples of 8 patients to ascertain specificity. We note that MuClone removes reads with mapping quality less than 5 and for positions that have (i) a variant nucleotide in a normal sample, (ii) more than 40% filtered basecalls (A basecall is filtered if more than 3 mismatches occur between the read and the reference within a window of 20 bases on each side of the site.); or (iii) more than 75% of the reads that cross the site have deletions in any of the samples<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. For exome sequencing data, mutations were called if the corresponding MuClone mutation probability is greater than 0.9. The other methods were executed with default settings. The total number of calls and the number of common calls between different methods (restricted to positions with copy number information) at the patient level is depicted in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>. A high degree of variation across callers is observed. Altogether, MuClone called 13,556 mutations while MultiSNV and MuTect called 31,374 and 11,915, respectively. MultiSNV output the largest number of calls in all of the samples, while MuTect and MuClone output similar number of calls. Figure&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref> also demonstrates the mutations used in the TRACERx study and their overlap with the mutation calls in different methods. The set of mutations overlapping between MuClone and TRACERx is most similar; this suggests that the increase in sensitivity conferred by MuClone does not come at the expense of specificity.<fig id="Fig8"><label>Fig. 8</label><caption><p>Comparison of detected mutations from MultiSNV, MuTect, MuClone, and TRACERx on whole exome sequencing data from non-small cell lung cancer patients. CRUK0003 (dark blue), CRUK0004 (orange), CRUK0005 (dark purple), CRUK0013 (light blue), CRUK0062 (light purple), CRUK0063 (brown), CRUK0065 (pink), and CRUK0094 (grey). To illustrate overlap in detected mutations from all combinations of different methods, in <bold>a</bold> the number of mutations called in all selected methods, but not in any other method, are plotted for each patient. Dark circles in the columns of <bold>c</bold> indicate selected methods. For example, the first column in <bold>c</bold> indicates mutations that are only called by MultiSNV (all circles are grey except the one corresponding to MultiSNV). <bold>b</bold> displays the total number of mutations called for each method. MuClone removes reads with mapping quality less than 5 and positions which have (i) a variant nucleotide in a normal sample, (ii) more than 40% filtered basecalls; or (iii) more than 75% of the reads that cross the site have deletions in any of the samples. Other methods executed with default settings. See UpSet tool for additional visualization details<sup><xref ref-type="bibr" rid="CR31">31</xref></sup></p></caption><graphic xlink:href="42003_2019_291_Fig8_HTML" id="d29e1864"/></fig></p><p id="Par32">We also explored the performance of MuClone when clonal information differs in the number of input clusters or the value of the cellular prevalence; see Fig.&#x000a0;<xref rid="Fig9" ref-type="fig">9</xref>. We perturbed the value of the cellular prevalences (estimated by PyClone) by adding noise from a mean zero normal distribution with different standard deviations: 0, 0.01, 0.1, and 0.2. We see that MuClone is robust to slight changes of cellular prevalence values. We also shielded MuClone from different fractions of the clonal information and that decreased the&#x000a0;performance more than adding noise. In general, this result shows that more accurate clonal information provides better mutation detection.<fig id="Fig9"><label>Fig. 9</label><caption><p>MuClone performance with inaccurate clonal information: The mutations with full copy number information across all 8 non-small cell lung cancer patients are used as ground truth. To asses the performance, we add noise from a zero mean normal with standard deviation equal to 0 (dark blue), 0.01 (orange), 0.1 (light blue), and 0.2 (purple) and also remove the clonal information of different fractions of clusters. <bold>a</bold> Youden&#x02019;s index, <bold>b</bold> Sensitivity, and <bold>c</bold> Specificity of MuClone with different fraction of clusters information removed</p></caption><graphic xlink:href="42003_2019_291_Fig9_HTML" id="d29e1887"/></fig></p></sec><sec id="Sec8"><title>Conclusion</title><p id="Par33">We studied the use of clonal information for the purpose of somatic mutation detection and classification in multi-sample whole-genome sequencing data. The proposed statistical framework uses the clusters cellular prevalences and copy number information for detection and classification of low prevalence mutations. Our proposal, MuClone, outperformed other popular mutation detection tools, while providing the added benefit of classifying whole genome sequencing mutations into biologically relevant groups. Both synthetic and real data results showed that using the cellular prevalences of tumour clusters can improve mutation detection sensitivity. Importantly, our results suggest improvement in sensitivity can be achieved without compromising specificity.</p><p id="Par34">Since the accuracy of detecting mutations can affect the performance of phylogenetic analysis, we suggest improvement from using MuClone will impact the field of multi-region sequencing for cancer evolution studies. As the field matures, we expect that the method presented here will be incorporated into more analytically comprehensive modelling of whole genome sequencing data when multiple samples are used to infer properties of clonal dynamics. Next steps are in developing a unified iterative algorithm that alternates between identifying the phylogenetic structure of the constituent clones comprising each tumour sample, and detection of mutations leveraging the new phylogenetic structure.</p><p id="Par35">As sequencing costs continue to decrease (e.g., with Illumina&#x02019;s NovoSeq platform), multi-sample whole genome sequencing of tumours will continue to proliferate (e.g., rapid autopsy program) as a viable experimental design. Thus, MuClone will be an asset in the arsenal of analytical methods deployed to interpret evolutionary properties of cancer and to gain insights into clonal dynamics in time and space.</p></sec></sec><sec id="Sec9"><title>Methods</title><sec id="Sec800"><title>Description of MuClone</title><p id="Par36">MuClone uses previously known cellular prevalence information to improve mutation detection and classification. For each sample, MuClone detects mutations from joint analysis of multiple samples. We encode this process in a generative probabilistic framework to perform joint statistical inference of multiple observations (from multiple samples) of the variant allele counts of a mutation of interest. The inputs to the model are: the number of variant reads, and the depth for a set of sequenced loci from multiple samples derived from the same patient; a measure of allele-specific copy number at each locus, in each sample, with tumour content; and the cellular prevalence and the abundance of underlying mutation clusters. MuClone outputs (i) a probability for each locus, at each sample, of being a mutation, and (ii) its cluster.</p><p id="Par37">The probabilistic graphical model of MuClone is depicted in Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">2</xref>.</p></sec><sec id="Sec10"><title>Model definition</title><p id="Par38">We first define <inline-formula id="IEq12"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_m^n$$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq12.gif"/></alternatives></inline-formula> the genotype of a given locus <italic>n</italic> in sample <italic>m</italic>, taking values in <inline-formula id="IEq13"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G} = \{ A,B,AB,AAB,ABB, \ldots \}$$\end{document}</tex-math><mml:math id="M36"><mml:mi mathvariant="script">G</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq13.gif"/></alternatives></inline-formula>. For example, the genotype <italic>ABB</italic> refers to the genotype with one reference allele <italic>A</italic> and two variant allele <italic>B</italic>. For simplicity, we assume the number of reads containing the variant alleles, <inline-formula id="IEq14"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_m^n$$\end{document}</tex-math><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq14.gif"/></alternatives></inline-formula> at a given locus with genotype <inline-formula id="IEq15"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_m^n$$\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq15.gif"/></alternatives></inline-formula> and read depth <inline-formula id="IEq16"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_m^n$$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq16.gif"/></alternatives></inline-formula> follows a Binomial distribution with genotype-specific variant probability <inline-formula id="IEq17"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {g_m^n} \right)$$\end{document}</tex-math><mml:math id="M44"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq17.gif"/></alternatives></inline-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_m^n|d_m^n,p(g_m^n)\sim {\mathrm{Binomial}}\left( {d_m^n,p(g_m^n)} \right).$$\end{document}</tex-math><mml:math id="M46" display="block"><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>~</mml:mo><mml:mi mathvariant="normal">Binomial</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="42003_2019_291_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>For <inline-formula id="IEq18"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_m^n \in {\cal G}$$\end{document}</tex-math><mml:math id="M48"><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq18.gif"/></alternatives></inline-formula>, the variant probability <inline-formula id="IEq19"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(g_m^n):{\cal G} \to [0,1]$$\end{document}</tex-math><mml:math id="M50"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq19.gif"/></alternatives></inline-formula> is defined as<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(g_m^n) = \left\{ {\begin{array}{*{20}{l}} {\frac{{v(g_{m}^{n})}}{{c(g_{m}^{n})}}} &#x00026; {v(g_{m}^{n}) \ne 0,v(g_{m}^{n}) \ne c(g_{m}^{n}),} \\ \epsilon &#x00026; {v(g_{m}^{n}) = 0,} \\ {1 - \epsilon } &#x00026; {v(g_{m}^{n}) \ne 0,v(g_{m}^{n}) = c(g_{m}^{n}),} \end{array}} \right.$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02260;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02260;</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>&#x003f5;</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>&#x003f5;</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02260;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="42003_2019_291_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq20"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v(g_m^n):{\cal G} \to {\Bbb N}$$\end{document}</tex-math><mml:math id="M54"><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq20.gif"/></alternatives></inline-formula> and <inline-formula id="IEq21"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c(g_m^n):{\cal G} \to {\Bbb N}$$\end{document}</tex-math><mml:math id="M56"><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq21.gif"/></alternatives></inline-formula> return the number of the variant allele and the copy number of genotype <inline-formula id="IEq22"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_m^n$$\end{document}</tex-math><mml:math id="M58"><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq22.gif"/></alternatives></inline-formula> respectively, for example <italic>v</italic>(<italic>ABB</italic>)&#x02009;=&#x02009;2 and <italic>c</italic>(<italic>ABB</italic>)&#x02009;=&#x02009;3. The variable <inline-formula id="IEq23"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon \,&#x0003e; \, 0$$\end{document}</tex-math><mml:math id="M60"><mml:mi>&#x003f5;</mml:mi><mml:mspace width="0.3em"/><mml:mo>&#x0003e;</mml:mo><mml:mspace width="0.3em"/><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq23.gif"/></alternatives></inline-formula> is a small positive constant that accounts for sequencing error. It allows for non-zero variant reads, due to sequencing error, when there are no variant alleles in genotype <inline-formula id="IEq24"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_m^n$$\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq24.gif"/></alternatives></inline-formula>.</p><p id="Par39">However, since the sequenced reads are independently sampled from an infinite pool of DNA fragments, at a given locus, each read may belong to the normal, reference, or variant population. The normal population stands for normal cells; The reference population are tumour cells which do not have the mutation at the given locus; and the variant population are the ones carrying the mutation. Therefore, using a single genotype state, <inline-formula id="IEq25"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_m^n$$\end{document}</tex-math><mml:math id="M64"><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq25.gif"/></alternatives></inline-formula>, introduces error into our analysis. To account for this fact, we consider using the full genotype state, <inline-formula id="IEq26"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi _m^n = \left( {{g_N}_m^n,{g_R}_m^n,{g_V}_m^n} \right)$$\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mrow><mml:mi>&#x003c8;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq26.gif"/></alternatives></inline-formula>, at a given locus <italic>n</italic> and sample <italic>m</italic>, to model the number of variant reads. Normal population fraction is 1&#x02009;&#x02212;&#x02009;<italic>t</italic><sub><italic>m</italic></sub> where <italic>t</italic><sub><italic>m</italic></sub> is the tumour content of sample <italic>m</italic> and the cellular prevalence of the mutation is <inline-formula id="IEq27"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi} _m^z$$\end{document}</tex-math><mml:math id="M68"><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq27.gif"/></alternatives></inline-formula> which is the fraction of tumour cells carrying the mutation. According to our prior knowledge, we assume mutations are clustered into <italic>K</italic> clusters. For a given locus <italic>n</italic>, <italic>Z</italic><sup><italic>n</italic></sup>&#x02009;=&#x02009;<italic>z</italic>&#x02009;&#x02208;&#x02009;{1, &#x02026;, <italic>K</italic>} defines which cluster the mutation belongs to. If a position is not a mutation then it belongs to wildtype cluster identified by <italic>Z</italic><sup><italic>n</italic></sup>&#x02009;=&#x02009;0.</p><p id="Par40">Therefore, for a mutation at a given locus <italic>n</italic> and sample <italic>m</italic> with cellular prevalence <inline-formula id="IEq28"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi} _m^z$$\end{document}</tex-math><mml:math id="M70"><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq28.gif"/></alternatives></inline-formula> and tumour content <italic>t</italic><sub><italic>m</italic></sub>, the variant allele probability is denoted by <inline-formula id="IEq29"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\xi (\psi _m^n,{\phi} _m^z,t_m)$$\end{document}</tex-math><mml:math id="M72"><mml:mi>&#x003be;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c8;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq29.gif"/></alternatives></inline-formula>. It is proportional to the sum of the (properly scaled) variant probabilities from each population:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}{l}} {\xi ({\psi} _{m}^{n},{\phi} _{m}^{z},{t}_{m})} \hfill &#x00026; \propto \hfill &#x00026; {(1 - {t}_{m})c({g_{N}}_{m}^{n})p({g_{N}}_{m}^{n})} \hfill \\ {} \hfill &#x00026; {} \hfill &#x00026; { + t_m(1 - {\phi} _{m}^{z})c({g_{R}}_{m}^{n})p({{g}_{R}}_{m}^{n})} \hfill \\ {} \hfill &#x00026; {} \hfill &#x00026; { + {t}_{m}{\phi} _{m}^{z}c({g_{V}}_{m}^{n})p({{g}_{V}}_{m}^{n}),} \hfill \end{array}$$\end{document}</tex-math><mml:math id="M74" display="block"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>&#x003be;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c8;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mo>&#x0221d;</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"/><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"/><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="42003_2019_291_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where the first term <inline-formula id="IEq30"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(1 - t_m)c({g_N}_m^n)p({g_N}_m^n)$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq30.gif"/></alternatives></inline-formula> is proportional to the probability of sampling a read containing variant allele from the normal population, and the second and third terms, <inline-formula id="IEq31"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_m(1 - \phi _m^z)c({g_R}_m^n)p({g_R}_m^n)$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq31.gif"/></alternatives></inline-formula> and <inline-formula id="IEq32"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_m\phi _m^zc({g_V}_m^n)p({g_V}_m^n)$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq32.gif"/></alternatives></inline-formula>, are proportional to the probabilities of sampling a read containing variant alleles from the reference and variant populations, respectively.</p><p id="Par41">Considering the full genotype state, the number of reads containing the variant alleles at a given locus <italic>n</italic> that belongs to cluster <italic>Z</italic><sup><italic>n</italic></sup> follows a Binomial distribution with probability<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu (Z^n) = \left\{ {\begin{array}{*{20}{l}} \epsilon &#x00026; {{\mathrm{if}}\,Z^n = 0} \\ {\xi (\psi _m^n,\phi _m^z,t_m)} &#x00026; {{\mathrm{if}}\,Z^n = z\,{\mathrm{and}}\,z \in \{ 1, \ldots ,K\} ,} \end{array}} \right.$$\end{document}</tex-math><mml:math id="M82" display="block"><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>&#x003f5;</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>&#x003be;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c8;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mspace width="0.3em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="0.3em"/><mml:mi>z</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="42003_2019_291_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq33"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon$$\end{document}</tex-math><mml:math id="M84"><mml:mi>&#x003f5;</mml:mi></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq33.gif"/></alternatives></inline-formula> accounts for sequencing error in wildtype cluster and <inline-formula id="IEq34"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\xi (\psi _m^n,\phi _m^z,t_m)$$\end{document}</tex-math><mml:math id="M86"><mml:mi>&#x003be;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c8;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq34.gif"/></alternatives></inline-formula> is the variant alleles probability for <italic>n</italic>th locus, <italic>m</italic>th sample from <italic>z</italic>th cluster. According to Eq. (<xref rid="Equ5" ref-type="">5</xref>), tumour content and cellular prevalence information are incorporated to estimate <inline-formula id="IEq35"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\xi (\psi _m^n,\phi _m^z,t_m)$$\end{document}</tex-math><mml:math id="M88"><mml:mi>&#x003be;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c8;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq35.gif"/></alternatives></inline-formula>.</p><p id="Par42">Since empirical evidence shows that variant read data is overdispersed, we replace the Binomial model (<xref rid="Equ3" ref-type="">3</xref>) with a BetaBinomial model<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_m^n|d_m^n,\mu (Z^n),s\sim {\mathrm{BetaBinomial}}\left( {b_{m}^{n}|d_{m}^{n},{\mu} (Z^{n}),s} \right),$$\end{document}</tex-math><mml:math id="M90" display="block"><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>~</mml:mo><mml:mi mathvariant="normal">BetaBinomial</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2019_291_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <italic>&#x003bc;</italic>(<italic>Z</italic><sup><italic>n</italic></sup>) is the expected variant alleles probability and the hyperparameter <italic>s</italic> is the precision parameter of the BetaBinomial distribution. The BetaBinomial distribution in Eq. (<xref rid="Equ7" ref-type="">7</xref>) assigns a small chance for mutation when the locus is wildtype, otherwise it is governed by the prior clonal information.</p><p id="Par43">To fully express our model, for each locus, we assume the genotype state follows a categorical distribution with probability vector <inline-formula id="IEq36"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{\pi }}_m^n \in [0,1]^{|{\cal G}|}$$\end{document}</tex-math><mml:math id="M92"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>&#x02223;</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>&#x02223;</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq36.gif"/></alternatives></inline-formula> whose <italic>i</italic>th element is the probability of the <italic>i</italic>th genotype state,<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi _m^n|{\boldsymbol{\pi }}_m^n\sim {\mathrm{Categorical}}\left( {{\boldsymbol{\pi }}_m^n} \right).$$\end{document}</tex-math><mml:math id="M94" display="block"><mml:msubsup><mml:mrow><mml:mi>&#x003c8;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>~</mml:mo><mml:mi mathvariant="normal">Categorical</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="42003_2019_291_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>The number of possible genotype states, denoted by <inline-formula id="IEq37"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left| {\cal G} \right|$$\end{document}</tex-math><mml:math id="M96"><mml:mfenced close="&#x02223;" open="&#x02223;" separators=""><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq37.gif"/></alternatives></inline-formula>, is finite given the copy number information. For simplicity, we assume every element of <inline-formula id="IEq38"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{\pi }}_m^n$$\end{document}</tex-math><mml:math id="M98"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq38.gif"/></alternatives></inline-formula> is equal to <inline-formula id="IEq39"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{{\left| {\cal G} \right|}}$$\end{document}</tex-math><mml:math id="M100"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mfenced close="&#x02223;" open="&#x02223;" separators=""><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq39.gif"/></alternatives></inline-formula>.</p><p id="Par44">In addition, we also assume that the clonal assignment of a locus, denoted by <italic>Z</italic><sup><italic>n</italic></sup>, follows categorical distribution with probability vector <bold><italic>&#x003c4;</italic></bold>:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z^n|{\boldsymbol{\tau }}\sim {\mathrm{Categorical}}\left( {\boldsymbol{\tau }} \right).$$\end{document}</tex-math><mml:math id="M102" display="block"><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>&#x02223;</mml:mo><mml:mi mathvariant="bold-italic">&#x003c4;</mml:mi><mml:mo>~</mml:mo><mml:mi mathvariant="normal">Categorical</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c4;</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="42003_2019_291_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par45">Our probabilistic framework can be succinctly written as<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{rcl}{b_{m}^{n} |d_{m}^{n},\mu (Z^{n}),s} &#x00026; \sim {{\mathrm{BetaBinomial}}\left( {b_{m}^{n}|d_{m}^{n},\mu (Z^{n}),s} \right),} \\ {{\psi} _m^n|{\boldsymbol{\pi }}_m^n} &#x00026;\sim {{\mathrm{Categorical}}\left( {{\boldsymbol{\pi }}_{m}^{n}} \right),} \\ {Z^{n}|{\boldsymbol{\tau }}} &#x00026;\sim {{\mathrm{Categorical}}\left( {\boldsymbol{\tau }} \right)}.\end{array} $$\end{document}</tex-math><mml:math id="M104" display="block"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mo>~</mml:mo><mml:mi mathvariant="normal">BetaBinomial</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mrow><mml:mi>&#x003c8;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="center"><mml:mo>~</mml:mo><mml:mi mathvariant="normal">Categorical</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>&#x02223;</mml:mo><mml:mi mathvariant="bold-italic">&#x003c4;</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mo>~</mml:mo><mml:mi mathvariant="normal">Categorical</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c4;</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="42003_2019_291_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec11"><title>Inference</title><p id="Par46">Based on the generative model introduced in (<xref rid="Equ10" ref-type="">10</xref>) mutations are inferred via the posterior probability distribution of a locus <italic>n</italic> belonging to cluster <italic>z</italic>:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(Z^{n} = z|b_m^{n},d_{m}^{n},s) \propto {\tau} _{z}\mathop {\prod}\limits_{m = 1}^M {\kern 1pt} \mathop {\sum}\limits_{i \in I} {\kern 1pt} {\pi} _{mi}^n{\cal L}(Z^{n} = z|b_{m}^{n},d_{m}^{n},s),$$\end{document}</tex-math><mml:math id="M106" display="block"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x0221d;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> &#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2019_291_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where the variable <italic>i</italic> indexes <inline-formula id="IEq40"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{\pi }}_m^n$$\end{document}</tex-math><mml:math id="M108"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq40.gif"/></alternatives></inline-formula> over the genotype states, <inline-formula id="IEq41"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{I}} = \left\{ {1 \ldots \left| {\cal G} \right|} \right\}$$\end{document}</tex-math><mml:math id="M110"><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02026;</mml:mo><mml:mfenced close="&#x02223;" open="&#x02223;" separators=""><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq41.gif"/></alternatives></inline-formula>. The posterior probability of locus <italic>n</italic> belongs to cluster <italic>z</italic> is proportional to the likelihood of observing <inline-formula id="IEq42"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_m^n$$\end{document}</tex-math><mml:math id="M112"><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq42.gif"/></alternatives></inline-formula> number of nucleotides matching the variant alleles times the prior over tumour cluster <italic>z</italic>. The tumour cluster prior <italic>&#x003c4;</italic><sub><italic>z</italic></sub> is the fraction of mutations belonging to cluster <italic>z</italic> and it has been tuned according to wildtype prior; the tumour cluster prior and the cellular prevalence information are encoded in <bold>&#x003a9;</bold>. Wildtype prior is our prior information if a locus is a mutation. If we don&#x02019;t have any information we can set it to 0.5. The likelihood function, <inline-formula id="IEq43"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal L}(Z^n = z|b_m^n,d_m^n,s)$$\end{document}</tex-math><mml:math id="M114"><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq43.gif"/></alternatives></inline-formula>, is the BetaBinomial distribution defined in 7.</p><p id="Par47">Based on basic decision theory, a decision can be extracted from a posterior distribution given a loss function. Under the loss function <inline-formula id="IEq44"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell (z,z\prime ) = {\mathbf{1}}[{\mathbf{1}}[z = 0] \ne {\mathbf{1}}[z\prime = 0]]$$\end{document}</tex-math><mml:math id="M116"><mml:mi>&#x02113;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>&#x02032;</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold">1</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">1</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>&#x02260;</mml:mo><mml:mi mathvariant="bold">1</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>&#x02032;</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq44.gif"/></alternatives></inline-formula>, the decision is simply the maximum a posteriori (MAP). That is, if the probability <italic>&#x003b7;</italic> of belonging to any of the tumour clusters is greater than 0.5, we conclude that the locus is mutated in at least one of the <italic>M</italic> samples. The value of <italic>&#x003b7;</italic> is<disp-formula id="Equd"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta = \mathop {\sum}\limits_{z = 1}^K {\kern 1pt} P(Z^n = z|b_m^n,d_m^n,s).$$\end{document}</tex-math><mml:math id="M118" display="block"><mml:mi>&#x003b7;</mml:mi><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="42003_2019_291_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par48">If locus <italic>n</italic> is mutated in at least one of the <italic>M</italic> samples, then the probability of mutation, in each sample, is calculated separately as<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{m}^{n}({\mathrm{mutant}}) = \mathop {\sum}\limits_{j \in {\boldsymbol{J}}_{m}^ {\ast} } {\kern 1pt} P(Z^{n} = j|b_{m}^{n},d_{m}^{n},s),$$\end{document}</tex-math><mml:math id="M120" display="block"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">mutant</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2019_291_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq45"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{J}}_m^ \ast$$\end{document}</tex-math><mml:math id="M122"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2019_291_Article_IEq45.gif"/></alternatives></inline-formula> is the set of clusters of sample <italic>m</italic> whose cellular prevalences are greater than a fixed positive threshold called <italic>&#x003a6;</italic><sub><italic>T</italic></sub>,<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{J}}_m^ {\ast} = \{ j|\phi _{m}^{j} &#x0003e; {\it{\Phi }}_T\} .$$\end{document}</tex-math><mml:math id="M124" display="block"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x0003e;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003a6;</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="42003_2019_291_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>The threshold <italic>&#x003a6;</italic><sub><italic>T</italic></sub> distinguishes the clusters of sample <italic>m</italic> in which their non-zero cellular prevalence are due to actual variant alleles. The default value of <italic>&#x003a6;</italic><sub><italic>T</italic></sub> is zero. However, depending on the method used for estimating cellular prevalences, it can be set to another positive value, if some non-zero input cellular prevalences indicate wildtype clusters.</p><p id="Par49">In addition, MuClone assigns the locus to cluster <italic>z</italic><sup>*</sup> that maximizes<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z^ {\ast} = \mathop {{{\mathrm{argmax}}}}\limits_{z \in \{ 1, \ldots ,K\} } P(Z^{n} = z|b_{m}^{n},d_{m}^{n},s).$$\end{document}</tex-math><mml:math id="M126" display="block"><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">argmax</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="42003_2019_291_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>This classifies mutations to one of the previously known clusters. The classification of mutations helps in biological interpretation and phylogenetic analysis of the data.</p></sec><sec id="Sec12"><title>Code availability</title><p id="Par50">The code is available from <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/fdorri/muclone">https://bitbucket.org/fdorri/muclone</ext-link>.</p></sec></sec><sec sec-type="supplementary-material"><title>Supplementary information</title><sec id="Sec13"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="42003_2019_291_MOESM1_ESM.pdf"><caption><p>Supplementary Information</p></caption></media></supplementary-material>
</p></sec></sec></body><back><fn-group><fn><p><bold>Publisher&#x02019;s note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><sec><title>Electronic supplementary material</title><p><bold>Supplementary information</bold> accompanies this paper at 10.1038/s42003-019-0291-z.</p></sec><ack><title>Acknowledgements</title><p>This work is supported by long-term funding support from the British Columbia Cancer Foundation. S.J. is supported by an NSERC scholarship. S.P.S. and A.B.C. received funding from a Natural Sciences and Engineering Research Council of Canada Frontiers grant #448167-13. S.P.S. received a Canadian Institutes for Health Research Foundation award #FDN 143246 to support this work. S.P.S. holds a Canada Research Chair and is a Michael Smith Foundation for Health Research scholar.</p></ack><notes notes-type="author-contribution"><title>Author contributions</title><p>Project conception and oversight: S.P.S. and F.D.; method development: F.D, S.J, A.B.-C. and S.P.S.; implementation: F.D, and S.J.; benchmarking: F.D; manuscript writing and editing: F.D, S.J, A.B.-C. and S.P.S.</p></notes><notes notes-type="data-availability"><title>Data availability</title><p>The high grade serous ovarian cancer data used in the current study are available on-line at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/fdorri/muclone">https://bitbucket.org/fdorri/muclone</ext-link>. All sequencing data has been deposited in the European Genome-Phenome Archive under study accession EGAS00001000547<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. The NSCLC data used for the analysis is included in suppleantary material of TRACERx study manuscript. Sequencing data is also available for download in the European Genome&#x02013;Phenome Archive under accession number EGAS00001002247<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. The patient consent for high grade serous ovarian cancer and NSCLC data are outlined in their primary manuscript<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>.</p></notes><notes notes-type="COI-statement"><sec id="FPar1"><title>Competing interests</title><p>S.P.S. is a founder, shareholder and consultant of Contextual Genomics Inc. The remaining authors declare that they have no competing interests.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shah</surname><given-names>SP</given-names></name><etal/></person-group><article-title>Mutational evolution in a lobular breast tumour profiled at single nucleotide resolution</article-title><source>Nature</source><year>2009</year><volume>461</volume><fpage>809</fpage><lpage>813</lpage><pub-id pub-id-type="doi">10.1038/nature08489</pub-id><pub-id pub-id-type="pmid">19812674</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yachida</surname><given-names>S</given-names></name><etal/></person-group><article-title>Distant metastasis occurs late during the genetic evolution of pancreatic cancer</article-title><source>Nature</source><year>2010</year><volume>467</volume><fpage>1114</fpage><lpage>1117</lpage><pub-id pub-id-type="doi">10.1038/nature09515</pub-id><pub-id pub-id-type="pmid">20981102</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Govindan</surname><given-names>R</given-names></name><etal/></person-group><article-title>Genomic landscape of non-small cell lung cancer in smokers and never-smokers</article-title><source>Cell</source><year>2012</year><volume>150</volume><fpage>1121</fpage><lpage>1134</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2012.08.024</pub-id><pub-id pub-id-type="pmid">22980976</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nik-Zainal</surname><given-names>S</given-names></name><etal/></person-group><article-title>The life history of 21 breast cancers</article-title><source>Cell</source><year>2012</year><volume>149</volume><fpage>994</fpage><lpage>1007</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2012.04.023</pub-id><pub-id pub-id-type="pmid">22608083</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McPherson</surname><given-names>A</given-names></name><etal/></person-group><article-title>Divergent modes of clonal spread and intraperitoneal mixing in high-grade serous ovarian cancer</article-title><source>Nat. Genet.</source><year>2016</year><volume>48</volume><fpage>758</fpage><lpage>767</lpage><pub-id pub-id-type="doi">10.1038/ng.3573</pub-id><pub-id pub-id-type="pmid">27182968</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kridel</surname><given-names>R</given-names></name><etal/></person-group><article-title>Histological transformation and progression in follicular lymphoma: A clonal evolution study</article-title><source>PLoS. Med.</source><year>2016</year><volume>13</volume><fpage>1002197</fpage><pub-id pub-id-type="doi">10.1371/journal.pmed.1002197</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jamal-Hanjani</surname><given-names>M</given-names></name><etal/></person-group><article-title>Tracking the evolution of non&#x02013;small&#x02013;cell lung cancer</article-title><source>New Engl. J. Med.</source><year>2017</year><volume>367</volume><fpage>2109</fpage><lpage>2121</lpage><pub-id pub-id-type="doi">10.1056/NEJMoa1616288</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xie</surname><given-names>T</given-names></name><etal/></person-group><article-title>Whole exome sequencing of rapid autopsy tumors and xenograft models reveals possible driver mutations underlying tumor progression</article-title><source>PLoS One</source><year>2015</year><volume>10</volume><fpage>1</fpage><lpage>13</lpage></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Siegel</surname><given-names>MB</given-names></name><etal/></person-group><article-title>Integrated RNA and DNA sequencing reveals early drivers of metastatic breast cancer</article-title><source>J. Clin. Invest.</source><year>2018</year><volume>128</volume><fpage>1371</fpage><lpage>1383</lpage><pub-id pub-id-type="doi">10.1172/JCI96153</pub-id><pub-id pub-id-type="pmid">29480819</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerlinger</surname><given-names>M</given-names></name><etal/></person-group><article-title>Intratumor heterogeneity and branched evolution revealed by multiregion sequencing</article-title><source>New Engl. J. Med.</source><year>2012</year><volume>366</volume><fpage>883</fpage><lpage>892</lpage><pub-id pub-id-type="doi">10.1056/NEJMoa1113205</pub-id><pub-id pub-id-type="pmid">22397650</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eirew</surname><given-names>P</given-names></name><etal/></person-group><article-title>Dynamics of genomic clones in breast cancer patient xenografts at single-cell resolution</article-title><source>Nature</source><year>2015</year><volume>518</volume><fpage>422</fpage><lpage>426</lpage><pub-id pub-id-type="doi">10.1038/nature13952</pub-id><pub-id pub-id-type="pmid">25470049</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roth</surname><given-names>A</given-names></name><etal/></person-group><article-title>PyClone: statistical inference of clonal population structure in cancer</article-title><source>Nat. Methods</source><year>2014</year><volume>11</volume><fpage>396</fpage><lpage>398</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2883</pub-id><pub-id pub-id-type="pmid">24633410</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuan</surname><given-names>K</given-names></name><etal/></person-group><article-title>BitPhylogeny: a probabilistic framework for reconstructing intra-tumor phylogenies</article-title><source>Genome Biol.</source><year>2015</year><volume>16</volume><fpage>36</fpage><pub-id pub-id-type="doi">10.1186/s13059-015-0592-6</pub-id><pub-id pub-id-type="pmid">25786108</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Popic</surname><given-names>V</given-names></name><etal/></person-group><article-title>Fast and scalable inference of multi-sample cancer lineages</article-title><source>Genome Biol.</source><year>2015</year><volume>16</volume><fpage>1</fpage><lpage>17</lpage><pub-id pub-id-type="doi">10.1186/s13059-015-0647-8</pub-id><pub-id pub-id-type="pmid">25583448</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deshwar</surname><given-names>AG</given-names></name><etal/></person-group><article-title>PhyloWGS: Reconstructing subclonal composition and evolution from whole-genome sequencing of tumors</article-title><source>Genome Biol.</source><year>2015</year><volume>16</volume><fpage>1</fpage><lpage>20</lpage><pub-id pub-id-type="doi">10.1186/s13059-015-0602-8</pub-id><pub-id pub-id-type="pmid">25583448</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koboldt</surname><given-names>DC</given-names></name><etal/></person-group><article-title>VarScan: variant detection in massively parallel sequencing of individual and pooled samples</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2283</fpage><lpage>2285</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp373</pub-id><pub-id pub-id-type="pmid">19542151</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goya</surname><given-names>R</given-names></name><etal/></person-group><article-title>SNVMix: predicting single nucleotide variants from next-generation sequencing of tumors</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>730</fpage><lpage>736</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq040</pub-id><pub-id pub-id-type="pmid">20130035</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saunders</surname><given-names>CT</given-names></name><etal/></person-group><article-title>Strelka: accurate somatic small-variant calling from sequenced tumor-normal sample pairs</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>1811</fpage><lpage>1817</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts271</pub-id><pub-id pub-id-type="pmid">22581179</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roth</surname><given-names>A</given-names></name><etal/></person-group><article-title>JointSNVMix: a probabilistic model for accurate detection of somatic mutations in normal/tumour paired next-generation sequencing data</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>907</fpage><lpage>913</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts053</pub-id><pub-id pub-id-type="pmid">22285562</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>J</given-names></name><etal/></person-group><article-title>Feature-based classifiers for somatic mutation detection in tumour-normal paired sequencing data</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>167</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr629</pub-id><pub-id pub-id-type="pmid">22084253</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cibulskis</surname><given-names>K</given-names></name><etal/></person-group><article-title>Sensitive detection of somatic point mutations in impure and heterogeneous cancer samples</article-title><source>Nat. Biotechnol.</source><year>2013</year><volume>31</volume><fpage>213</fpage><lpage>219</lpage><pub-id pub-id-type="doi">10.1038/nbt.2514</pub-id><pub-id pub-id-type="pmid">23396013</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>S</given-names></name><etal/></person-group><article-title>Virmid: accurate detection of somatic mutations with sample impurity inference</article-title><source>Genome Biol.</source><year>2013</year><volume>14</volume><fpage>90</fpage><pub-id pub-id-type="doi">10.1186/gb-2013-14-8-r90</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Josephidou</surname><given-names>M</given-names></name><etal/></person-group><article-title>MultiSNV: a probabilistic approach for improving detection of somatic point mutations from multiple related tumour samples</article-title><source>Nucleic Acids Res.</source><year>2015</year><volume>43</volume><fpage>61</fpage><pub-id pub-id-type="doi">10.1093/nar/gkv135</pub-id></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Rens</surname><given-names>KE</given-names></name><etal/></person-group><article-title>SNV-PPILP: refined SNV calling for tumor data using perfect phylogenies and ILP</article-title><source>Bioinformatics</source><year>2015</year><volume>31</volume><fpage>1133</fpage><lpage>1135</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu755</pub-id><pub-id pub-id-type="pmid">25398608</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="other">Garrison, E. &#x00026; Marth, G. Haplotype-based variant detection from short-read sequencing. Preprint at arXiv:1207.3907v2 (2012).</mixed-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>A</given-names></name><etal/></person-group><article-title>The genome analysis toolkit: a map reduce framework for analyzing next-generation DNA sequencing data</article-title><source>Genome Res.</source><year>2010</year><volume>20</volume><fpage>1297</fpage><lpage>1303</lpage><pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id><pub-id pub-id-type="pmid">20644199</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salari</surname><given-names>R</given-names></name><etal/></person-group><article-title>Inference of tumor phylogenies with improved somatic mutation discovery</article-title><source>J. Comput. Biol.</source><year>2013</year><volume>20</volume><fpage>933</fpage><lpage>944</lpage><pub-id pub-id-type="doi">10.1089/cmb.2013.0106</pub-id><pub-id pub-id-type="pmid">24195709</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ha</surname><given-names>G</given-names></name><etal/></person-group><article-title>TITAN: inference of copy number architectures in clonal cell populations from tumor whole-genome sequence data</article-title><source>Genome Res.</source><year>2014</year><volume>24</volume><fpage>1881</fpage><lpage>1893</lpage><pub-id pub-id-type="doi">10.1101/gr.180281.114</pub-id><pub-id pub-id-type="pmid">25060187</pub-id></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Loo</surname><given-names>P</given-names></name><etal/></person-group><article-title>Allele-specific copy number analysis of tumors</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2010</year><volume>107</volume><fpage>16910</fpage><lpage>16915</lpage><pub-id pub-id-type="doi">10.1073/pnas.1009843107</pub-id><pub-id pub-id-type="pmid">20837533</pub-id></element-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="other">MuTect2. <ext-link ext-link-type="uri" xlink:href="https://software.broadinstitute.org/gatk/documentation/tooldocs/3.8-0/org_broadinstitute_gatk_tools_walkers_cancer_m2_MuTect2.php">https://software.broadinstitute.org/gatk/documentation/tooldocs/3.8-0/org_broadinstitute_gatk_tools_walkers_cancer_m2_MuTect2.php</ext-link>.</mixed-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lex</surname><given-names>A</given-names></name><etal/></person-group><article-title>UpSet: Visualization of intersecting sets</article-title><source>Ieee. Trans. Vis. Comput. Graph.</source><year>2014</year><volume>20</volume><fpage>1983</fpage><lpage>1992</lpage><pub-id pub-id-type="doi">10.1109/TVCG.2014.2346248</pub-id><pub-id pub-id-type="pmid">26356912</pub-id></element-citation></ref></ref-list></back></article>