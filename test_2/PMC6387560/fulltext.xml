<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Hum Genomics</journal-id><journal-id journal-id-type="iso-abbrev">Hum. Genomics</journal-id><journal-title-group><journal-title>Human Genomics</journal-title></journal-title-group><issn pub-type="ppub">1473-9542</issn><issn pub-type="epub">1479-7364</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6387560</article-id><article-id pub-id-type="publisher-id">194</article-id><article-id pub-id-type="doi">10.1186/s40246-019-0194-6</article-id><article-categories><subj-group subj-group-type="heading"><subject>Primary Research</subject></subj-group></article-categories><title-group><article-title>vi-HMM: a novel HMM-based method for sequence variant identification in short-read data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Tang</surname><given-names>Man</given-names></name><address><email>tman5@vt.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Hasan</surname><given-names>Mohammad Shabbir</given-names></name><address><email>shabbir5@vt.edu</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Zhu</surname><given-names>Hongxiao</given-names></name><address><email>hongxiao@vt.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Liqing</given-names></name><address><email>lqzhang@cs.vt.edu</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9916-3624</contrib-id><name><surname>Wu</surname><given-names>Xiaowei</given-names></name><address><email>xwwu@vt.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0694 4940</institution-id><institution-id institution-id-type="GRID">grid.438526.e</institution-id><institution>Department of Statistics, </institution><institution>Virginia Tech, </institution></institution-wrap>250 Drillfield Drive, Blacksburg, 24061 VA USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0694 4940</institution-id><institution-id institution-id-type="GRID">grid.438526.e</institution-id><institution>Department of Computer Science, </institution><institution>Virginia Tech, </institution></institution-wrap>225 Stanger Street, Blacksburg, 24060 VA USA </aff></contrib-group><pub-date pub-type="epub"><day>13</day><month>2</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>13</day><month>2</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>13</volume><elocation-id>9</elocation-id><history><date date-type="received"><day>2</day><month>10</month><year>2018</year></date><date date-type="accepted"><day>29</day><month>1</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p>Accurate and reliable identification of sequence variants, including single nucleotide polymorphisms (SNPs) and insertion-deletion polymorphisms (INDELs), plays a fundamental role in next-generation sequencing (NGS) applications. Existing methods for calling these variants often make simplified assumptions of positional independence and fail to leverage the dependence between genotypes at nearby loci that is caused by linkage disequilibrium (LD).</p></sec><sec><title>Results and conclusion</title><p>We propose vi-HMM, a hidden Markov model (HMM)-based method for calling SNPs and INDELs in mapped short-read data. This method allows transitions between hidden states (defined as &#x0201c;SNP,&#x0201d; &#x0201c;Ins,&#x0201d; &#x0201c;Del,&#x0201d; and &#x0201c;Match&#x0201d;) of adjacent genomic bases and determines an optimal hidden state path by using the Viterbi algorithm. The inferred hidden state path provides a direct solution to the identification of SNPs and INDELs. Simulation studies show that, under various sequencing depths, vi-HMM outperforms commonly used variant calling methods in terms of sensitivity and <italic>F</italic><sub>1</sub> score. When applied to the real data, vi-HMM demonstrates higher accuracy in calling SNPs and INDELs.</p></sec><sec><title>Electronic supplementary material</title><p>The online version of this article (10.1186/s40246-019-0194-6) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>HMM</kwd><kwd>Variant calling</kwd><kwd>SNP</kwd><kwd>INDEL</kwd><kwd>Viterbi algorithm</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007263</institution-id><institution>Virginia Polytechnic Institute and State University</institution></institution-wrap></funding-source></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p>Rapid evolution of next-generation sequencing (NGS) technologies in recent years enables various genetic applications in a fast, efficient, and cost-effective way [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. One fundamental procedure in NGS data analysis is variant calling, i.e., to identify the existence of genetic variants from short-read data. Accurate and reliable identification of single nucleotide polymorphisms (SNPs) and insertion-deletion polymorphisms (INDELs) plays an important role in all NGS applications as these common sequence variants are highly abundant in the human genome and have been found to likely influence human traits and disease [<xref ref-type="bibr" rid="CR3">3</xref>&#x02013;<xref ref-type="bibr" rid="CR5">5</xref>].</p><p>The process of variant calling starts with aligning a set of short reads to the reference genome. After reads are correctly mapped, statistical models or heuristics may be used to predict the likelihood of variation at each locus based on available information such as quality scores and allele counts of aligned reads at the locus [<xref ref-type="bibr" rid="CR6">6</xref>]. Most statistical models used for variant calling are built on the Bayes&#x02019; theorem, with an ultimate goal to predict genotypes from aligned reads by using the maximum a posteriori (MAP) estimate. Following this Bayesian approach, a number of variant calling tools have been developed, including SAMtools [<xref ref-type="bibr" rid="CR7">7</xref>], GATK [<xref ref-type="bibr" rid="CR8">8</xref>], FreeBayes [<xref ref-type="bibr" rid="CR9">9</xref>], and Platypus [<xref ref-type="bibr" rid="CR10">10</xref>]. Heuristic-based tools, such as VarScan [<xref ref-type="bibr" rid="CR11">11</xref>], call variants based on a variety of heuristic factors, e.g., minimum allele counts, read quality cut-offs, and bounds on read depth. Though heuristic methods could be robust to outlier data that do not follow probabilistic model assumptions, the selection of cutoffs and bounds is highly empirical which largely restricts their practical usage. Other alternatives such as machine learning tools [<xref ref-type="bibr" rid="CR12">12</xref>] are also applicable for variant calling, but they appear to be relatively unpopular in practice. Due to divergence of the model assumptions, these variant calling tools perform quite differently on NGS data [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. It should be noted that, although Bayesian statistical models are highly prevalent in variant calling, existing tools developed using this approach often make simplified assumptions of positional independence and fail to leverage the dependence between genotypes at nearby loci that is caused by linkage disequilibrium (LD). A statistical model that appropriately incorporates such dependence information has the potential to improve the accuracy of variant detection, especially in regions of high LD in the human genome.</p><p>Hidden Markov models (HMMs) can effectively model dependence between adjacent symbols or regions, thus have been extensively used in various disciplines [<xref ref-type="bibr" rid="CR15">15</xref>]. Since its first application in computational biology in the late 1980s [<xref ref-type="bibr" rid="CR16">16</xref>], HMMs become popular in biological sequence analysis [<xref ref-type="bibr" rid="CR17">17</xref>]. Generally speaking, the occurrences of genetic variants (SNPs and INDELs) on the genome are not independent events because of the existence of LD between SNPs or between INDELs and SNPs [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. For this reason, one may use Markov models to better characterize the dependence between genotypes at nearby loci in order to improve the analysis of NGS data. Several HMM-based programs have been developed for read mapping and variant calling in sequencing data, including Dindel [<xref ref-type="bibr" rid="CR19">19</xref>], PyroHMMsnp [<xref ref-type="bibr" rid="CR20">20</xref>], and PyroHMMvar [<xref ref-type="bibr" rid="CR21">21</xref>]. All these programs call SNPs and/or INDELs by estimating top candidate (most likely) haplotypes/genotypes using the Bayesian approach. In particular, Dindel [<xref ref-type="bibr" rid="CR19">19</xref>] constructs a two-layer HMM by treating both the insertion status and its position index as hidden variables, and PyroHMMsnp [<xref ref-type="bibr" rid="CR20">20</xref>] and PyroHMMvar [<xref ref-type="bibr" rid="CR21">21</xref>] use HMMs to formulate homopolymer errors and employ a weighted alignment graph to reconstruct the consensus sequences. Though these programs show remarkable flexibility in detecting genetic variants, they are usually designed for specific applications: Dindel is for INDEL calling only, and PyroHMMsnp and PyroHMMvar emphasize the modeling of homopolymer. Moreover, the Bayesian paradigm of these programs may slow down the variant calling process when dealing with massive datasets.</p><p>In this paper, we propose vi-HMM, a novel HMM-based method for identifying small-scale sequence variants in short-read data. This method allows transitions between hidden states (hereafter defined as &#x0201c;SNP,&#x0201d; &#x0201c;Ins,&#x0201d; &#x0201c;Del,&#x0201d; and &#x0201c;Match&#x0201d;) of adjacent genomic loci and determines an optimal hidden state sequence by using the Viterbi algorithm. The inferred hidden state sequence provides a direct solution to the identification of SNPs and INDELs. Through simulations, we show that vi-HMM represents an improvement over five other variant callers&#x02014;GATK HaplotypeCaller, FreeBayes, Platypus, SAMtools, and VarScan in terms of sensitivity, precision, and <italic>F</italic><sub>1</sub> score. When applied to a real short-read dataset (NA12878) generated by the Genome in a Bottle (GIAB) project [<xref ref-type="bibr" rid="CR22">22</xref>], vi-HMM demonstrates its major advantage in identifying INDEL variants as compared to four other variant callers&#x02014;FreeBayes, Platypus, SAMtools, and VarScan, while still maintaining good performance in SNP calling at different read coverage depths.</p></sec><sec id="Sec2"><title>Methods</title><p>Along the genome, the states of genomic bases, i.e., whether or not and which type of sequence variants exist on the bases, often exhibit dependence. Incorporating such dependence information helps improve the accuracy of variant calling but poses challenges in calculating the joint likelihood of the entire sequence. In this study, we assume Markov property for the dependence and accordingly propose a new method for <italic>variant identification on the basis of HMM</italic>, acronymized by vi-HMM.</p><p>The vi-HMM method performs variant calling for SNPs and INDELs after short reads are mapped to a reference genome (an example of the mapped reads is shown by the IGV visualization tool in Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>). Its input includes a reference genome sequence and a file with mapped reads (a SAM/BAM file). The core of this method lies in the construction of an HMM that models state transitions among the bases on the genome as well as emissions from the hidden states to the observed pileup read data. From the HMM, we can uncover the optimal hidden state sequence (i.e., the Viterbi path), which is then used to call variants or infer the underlying genotypes. The workflow of the vi-HMM algorithm is shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>, including three major steps: 
<list list-type="order"><list-item><p>Define the states (Match, SNP, Insertion, and Deletion) and identify the transition probabilities among the states to build the transition matrix.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow of vi-HMM</p></caption><graphic xlink:href="40246_2019_194_Fig1_HTML" id="MO1"/></fig>
</p></list-item><list-item><p>Compute the likelihood (emission probability) of observing the pileup of reads under different states.</p></list-item><list-item><p>Given a reference genome sequence, find the optimal hidden state sequence by using the Viterbi algorithm and based on which infer variants/genotypes.</p></list-item></list></p><p>Details of these steps are explained in the following subsections.</p><sec id="Sec3"><title>The states and transition matrix</title><p>We assume that all reads have been mapped to the reference genome by a standard mapping tool, such as Bowtie2 [<xref ref-type="bibr" rid="CR23">23</xref>] or BWA-MEM [<xref ref-type="bibr" rid="CR24">24</xref>], resulting in a SAM file. Using the CIGAR strings from the SAM file, detailed alignment information for each base can be obtained, which indicates the relation between the reference genome and the genotype sequence that underlies the mapped reads. We consider a genomic region with length <italic>L</italic>, that is, a total of <italic>L</italic> adjacent bases including the ones in the reference but not in the genotype and vice versa. We define an alphabetic set <italic>&#x003a9;</italic>={<italic>A</italic>,<italic>C</italic>,<italic>G</italic>,<italic>T</italic>,&#x02212;} to include the symbolic elements in this genomic region with <italic>A</italic>,<italic>C</italic>,<italic>G</italic>,<italic>T</italic> denoting the nucleotides and &#x0201c; &#x02212;&#x0201d; denoting a missing nucleotide caused by deletions or insertions. Let <italic>R</italic><sub><italic>i</italic></sub> and <italic>G</italic><sub><italic>i</italic></sub>, 1&#x02264;<italic>i</italic>&#x02264;<italic>L</italic> denote the symbol on base <italic>i</italic> for the reference sequence and for the genotype sequence, respectively. Then, <italic>R</italic><sub><italic>i</italic></sub>&#x02208;<italic>&#x003a9;</italic>, and <italic>G</italic><sub><italic>i</italic></sub> can take 15 possible diploid genotypes, enumerated as <italic>AA</italic>, <italic>AC</italic>, <italic>AG</italic>, <italic>AT</italic>, <italic>A</italic>&#x02013;, <italic>CC</italic>, <italic>CG</italic>, <italic>CT</italic>, <italic>C</italic>&#x02013;, <italic>GG</italic>, <italic>GT</italic>, <italic>G</italic>&#x02013;, <italic>TT</italic>, <italic>T</italic>&#x02013;, and &#x02212;&#x02212;. In general, the relation between <italic>R</italic><sub><italic>i</italic></sub> and <italic>G</italic><sub><italic>i</italic></sub>, i.e., the state of base <italic>i</italic>, can be defined by &#x0201c;Match,&#x0201d; &#x0201c;SNP,&#x0201d; &#x0201c;Ins,&#x0201d; and &#x0201c;Del&#x0201d; and we use a latent variable <italic>Z</italic><sub><italic>i</italic></sub> to describe this hidden state on base <italic>i</italic>. Depending on the value that <italic>R</italic><sub><italic>i</italic></sub> takes, two cases should be considered for <italic>Z</italic><sub><italic>i</italic></sub>: 
<list list-type="order"><list-item><p>If <italic>R</italic><sub><italic>i</italic></sub>&#x02260;&#x02212;, the state can be a &#x0201c;Match,&#x0201d; &#x0201c;SNP,&#x0201d; or &#x0201c;Del&#x0201d; and correspondingly the hidden state variable <italic>Z</italic><sub><italic>i</italic></sub> can take 15 possible values in accordance with the 15 diploid genotypes, denoted by <italic>s</italic><sub><italic>j</italic></sub>,<italic>j</italic>=1,&#x02026;,15. For example, suppose the reference base <italic>R</italic><sub><italic>i</italic></sub>=<italic>A</italic>, then <italic>s</italic><sub>1</sub>=<italic>A</italic><italic>A</italic> representing the state &#x0201c;Match,&#x0201d; <italic>s</italic><sub>15</sub>=&#x02212;&#x02212; representing the state &#x0201c;Del,&#x0201d; and other states may be considered as &#x0201c;SNP&#x0201d;s.</p></list-item><list-item><p>If <italic>R</italic><sub><italic>i</italic></sub>=&#x02212;, the state can be either an &#x0201c;Ins&#x0201d; or a not valid state and the hidden state variable <italic>Z</italic><sub><italic>i</italic></sub> can also take 15 values, denoted by <italic>s</italic><sub><italic>j</italic></sub>,<italic>j</italic>=16,&#x02026;,30. For example, suppose the reference base <italic>R</italic><sub><italic>i</italic></sub>=&#x02212;, then <italic>s</italic><sub>30</sub>=&#x02212;&#x02212; is a not valid state, and all other states are considered as &#x0201c;Ins&#x0201d;.</p></list-item></list></p><p>It is worth noting that the inference of the most likely genotype <italic>G</italic><sub><italic>i</italic></sub> is equivalent to finding the most likely <italic>Z</italic><sub><italic>i</italic></sub>, which directly indicates the occurrence of the variant&#x02014;SNP or INDEL, on base <italic>i</italic>.</p><p>After defining the hidden states, we characterize transitions among the states by a transition matrix <italic>T</italic>={<italic>t</italic><sub><italic>mn</italic></sub>},1&#x02264;<italic>m</italic>&#x02264;30,1&#x02264;<italic>n</italic>&#x02264;30. Each component of the matrix is defined by <italic>t</italic><sub><italic>mn</italic></sub>=<italic>P</italic>(<italic>Z</italic><sub><italic>i</italic>+1</sub>=<italic>n</italic>|<italic>Z</italic><sub><italic>i</italic></sub>=<italic>m</italic>),1&#x02264;<italic>i</italic>&#x0003c;<italic>L</italic>, representing the probability of being in state <italic>n</italic> at the current base given the observed state <italic>m</italic> at the previous base. In our simulation studies, these transition probabilities are set by empirical values. In the analysis of real data, the transition matrix can be obtained by calculating the conditional frequencies of the variants from the NCBI dbSNP database (version 136) [<xref ref-type="bibr" rid="CR25">25</xref>].</p></sec><sec id="Sec4"><title>The emission probabilities</title><p>Emission probabilities govern the distribution of the observed data (a pileup of reads) at each base given the hidden state at that base. In vi-HMM, we first identify the bases on which the pileup of reads have size &#x02265;5. Denoting these read data on base <italic>i</italic> by <italic>D</italic><sub><italic>i</italic></sub>,1&#x02264;<italic>i</italic>&#x02264;<italic>L</italic>, we write the probability (likelihood) of observing <italic>D</italic><sub><italic>i</italic></sub> given the hidden state <italic>Z</italic><sub><italic>i</italic></sub> as 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  P_{i}=L\left(Z_{i}|D_{i} \right) = \prod\limits_{k=1}^{n_{i}} p \left(d_{ik}|Z_{i} \right), \quad Z_{i} \in \left\{ s_{1},\ldots,s_{30}\right\}  $$ \end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>30</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="40246_2019_194_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p><p>where <italic>d</italic><sub><italic>ik</italic></sub> represents the nucleotide on the <italic>k</italic>th read covering base <italic>i</italic> and <italic>n</italic><sub><italic>i</italic></sub> represents the size of the pileup on that base. Since each value taken by the hidden state <italic>Z</italic><sub><italic>i</italic></sub> corresponds to a specific underlying genotype <italic>G</italic><sub><italic>i</italic></sub> which contains two alleles <italic>A</italic><sub>1</sub> and <italic>A</italic><sub>2</sub>, we further write the probability of observing each <italic>d</italic><sub><italic>ik</italic></sub>,1&#x02264;<italic>i</italic>&#x02264;<italic>L</italic>,1&#x02264;<italic>k</italic>&#x02264;<italic>n</italic><sub><italic>i</italic></sub> given <italic>Z</italic><sub><italic>i</italic></sub> as 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned}  p\left(d_{ik}|Z_{i} \right) &#x00026;= p \left(d_{ik}| \left\{ A_{1}, A_{2} \right\} \right) \\ &#x00026;= \frac{1}{2}p \left(d_{ik}|A_{1} \right) + \frac{1}{2} p \left(d_{ik}|A_{2} \right) \end{aligned}  $$ \end{document}</tex-math><mml:math id="M4"><mml:mtable><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="40246_2019_194_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p><p>where the probability of observing <italic>d</italic><sub><italic>ik</italic></sub> given one allele <italic>A</italic>&#x02208;{<italic>A</italic><sub>1</sub>,<italic>A</italic><sub>2</sub>} is 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  p \left(d_{ik}|A \right) =\left\{ \begin{array}{ll} {e_{ik}} &#x00026; \text{if}~ d_{ik}\neq A \\ 1-\frac{e_{ik}}{4} &#x00026; \text{if}~ d_{ik}= A \end{array} \right..  $$ \end{document}</tex-math><mml:math id="M6"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02260;</mml:mo><mml:mi>A</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="40246_2019_194_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p><p>In the above expression (<xref rid="Equ3" ref-type="">3</xref>), <italic>e</italic><sub><italic>ik</italic></sub> represents the sequencing error rate on base <italic>i</italic> for read <italic>k</italic>, which can be calculated from the reversed Phred-scaled quality score in the SAM file. For simplicity, here, we assume that the sequencing error on base <italic>i</italic> is caused by four possible point mutations (from allele <italic>A</italic> of <italic>G</italic><sub><italic>i</italic></sub> to the nucleotide of <italic>d</italic><sub><italic>ik</italic></sub> which may take four other symbols in set <italic>&#x003a9;</italic>) with equal probability. In particular, when &#x0201c; &#x02212;&#x0201d; appears in a read (meaning a deletion in the CIGAR string of the SAM file) so the corresponding Phred quality score on that read base is missing, we take the average of all other reads&#x02019; Phred quality scores on that base to impute the missing value.</p><p>We note that the emission distribution can vary for different bases. Given <italic>n</italic><sub><italic>i</italic></sub> pileup reads on base <italic>i</italic>, for each possible combination of <italic>R</italic><sub><italic>i</italic></sub> and <italic>G</italic><sub><italic>i</italic></sub>, i.e., for <italic>Z</italic><sub><italic>i</italic></sub>=<italic>s</italic><sub><italic>j</italic></sub>,1&#x02264;<italic>s</italic><sub><italic>j</italic></sub>&#x02264;30, the emission distribution at this base will be a discrete distribution which categorizes the pileup read data <italic>D</italic><sub><italic>i</italic></sub> into 15 groups corresponding to the possible diploid genotypes. Nevertheless, the probability of observing <italic>D</italic><sub><italic>i</italic></sub> given <italic>Z</italic><sub><italic>i</italic></sub> can be easily calculated through a multinomial probability mass function (PMF) by incorporating the sequencing error rates <italic>e</italic><sub><italic>ik</italic></sub>,1&#x02264;<italic>k</italic>&#x02264;<italic>n</italic><sub><italic>i</italic></sub>.</p></sec><sec id="Sec5"><title>The optimal state sequence</title><p>With the HMM parameters identified, we use the Viterbi algorithm to find the optimal hidden state path <bold>Z</bold>=<italic>Z</italic><sub>1</sub><italic>Z</italic><sub>2</sub>&#x02026;<italic>Z</italic><sub><italic>L</italic></sub>, which not only indicates the most likely genotypes but also can be used to call SNPs and INDELs directly.</p></sec></sec><sec id="Sec6"><title>Datasets</title><sec id="Sec7"><title>Simulated data</title><p>To evaluate the performance of vi-HMM, we simulate two datasets of short reads using different processes: one introducing positional dependence by HMM and the other assuming random occurrence of the genetic variants by the wgsim tool [<xref ref-type="bibr" rid="CR26">26</xref>]. In the first process, the simulation starts with generating a 50,000 base pairs (bp) genomic segment as the reference sequence. In order to take into account the spatial dependence in the genotype, we first generate a haplotype sequence based on an HMM with four states: &#x0201c;Match,&#x0201d; &#x0201c;SNP,&#x0201d; &#x0201c;Del,&#x0201d; and &#x0201c;Ins.&#x0201d; The transition matrix of this HMM is pre-specified (for details, please refer to <ext-link ext-link-type="uri" xlink:href="https://github.com/tangmanhd/vi-HMM">https://github.com/tangmanhd/vi-HMM</ext-link>). The observed haplotype sequence (which takes value from the alphabetic set <italic>&#x003a9;</italic>) is determined by the emission distribution, which, for simplicity, is set to be discrete uniform conditioning on the hidden states. That is, for each base of the haplotype, the probability vector of observing a nucleotide symbol other than the corresponding nucleotide shown in the reference is [1/3,1/3,1/3] if the hidden state is &#x0201c;SNP&#x0201d; and is [1/4,1/4,1/4,1/4] if the hidden state is &#x0201c;Ins&#x0201d; (note that the emissions for the other two hidden states are deterministic). Based on the generated haplotype sequence, the second haplotype can be generated by incorporating a pre-specified heterozygous rate. Once the haplotype pair is generated, we then generate the short-read data, half from each haplotype, by specifying the length, number of reads, and base quality. In the second process, we randomly select a 50,000-bp segment of chromosome 21 on the human genome as the reference sequence and then use wgsim to simulate paired end reads (<ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/wgsim">https://github.com/lh3/wgsim</ext-link>) (Additional file&#x000a0;<xref rid="MOESM2" ref-type="media">2</xref>). In both processes, the base-calling errors are considered to be stochastic and are generated from a uniform distribution. These base-calling error probabilities are then transformed into Phred quality scores for sequence alignment and variant calling.</p><p>In each simulation process, four datasets were generated at the 15&#x000d7;, 20&#x000d7;, 25&#x000d7;, and 30&#x000d7; sequencing depths, respectively. The simulated short reads are, on average, 100 bp long. All simulated reads are mapped to the reference sequence by using sequence alignment tools Bowtie2 (version 2.2.5) and BWA-MEM (version 0.7.12). After read alignment, we apply vi-HMM, GATK HaplotypeCaller (version 4.0), FreeBayes (version 1.1.0), Platypus (version 0.8.1), SAMtools (version 1.3), and VarScan (version 2.3.9) to these datasets for variant calling (commands and settings for extant variant callers are listed in Additional file&#x000a0;<xref rid="MOESM2" ref-type="media">2</xref>). Evaluation of the calling accuracy is based on the following criteria. For SNP calling, if the locus of a called SNP is exactly the same as the truth, this SNP is recorded as a true positive (TP); otherwise, it is a false positive (FP). On the other hand, if a true SNP is not identified by the caller, it is a false negative (FN). For INDEL calling, if the called locus is the same as the the simulated truth, this INDEL is regarded as a TP, and the definitions of FP and FN are the same as those for calling SNPs. With these concepts, we calculate the sensitivity, precision, and <italic>F</italic><sub>1</sub> score by: 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} \text{sensitivity} &#x00026;= \mathrm{\frac{TP}{TP + FN}}\\ \text{precision} &#x00026;= \mathrm{\frac{TP}{TP + FP}}\\ F_{1} &#x00026;= \mathrm{\frac{2 TP}{2 TP + FP + FN}} \end{aligned}  $$ \end{document}</tex-math><mml:math id="M8"><mml:mtable><mml:mtr><mml:mtd><mml:mtext>sensitivity</mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle mathvariant="normal"><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">FN</mml:mtext></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>precision</mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle mathvariant="normal"><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">FP</mml:mtext></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle mathvariant="normal"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mtext mathvariant="italic">TP</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mtext mathvariant="italic">TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">FP</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">FN</mml:mtext></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="40246_2019_194_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p><p>This simulation procedure is repeated 1000 times to summarize the averages on sensitivity, precision, and <italic>F</italic><sub>1</sub> score.</p></sec><sec id="Sec8"><title>Real data</title><p>We further run vi-HMM to call SNPs and INDELs on a dataset from the GIAB project (NA12878; chr21, 1&#x02013;48129895 and chr22, 1&#x02013;51304566; genome version hs37d5). This dataset consists of 19,020,457 (chr21) and 17,598,950 (chr22) mapped reads. The average lengths of reads on chr21 and chr22 are 100.9 bp and 101 bp and the average coverages on chr21 and chr22 are 54&#x000d7; and 50&#x000d7;, respectively. In order to evaluate the performance of variant calling at lower coverage, we downsample this real dataset to 15&#x000d7; and 30&#x000d7; sequencing depths and then apply several variant callers to the datasets accordingly. These three datasets are denoted as low (15&#x000d7;), medium (30&#x000d7;), and high (54&#x000d7; or 50&#x000d7;) coverage depths, respectively. A validation dataset by Zook et al. [<xref ref-type="bibr" rid="CR22">22</xref>] is treated as the &#x0201c;ground truth&#x0201d; to evaluate the calling accuracy [<xref ref-type="bibr" rid="CR22">22</xref>]. It should be noted that Zook et al. [<xref ref-type="bibr" rid="CR22">22</xref>] has applied GATK in the process of obtaining these high-confidence variants. Therefore, to avoid biased comparison, we choose to not include GATK but only compare the vi-HMM calling results to those generated by the other four popular variant callers&#x02014;FreeBayes, Platypus, SAMtools, and VarScan (version numbers of these callers are the same as those in simulations). The transition matrix of vi-HMM is pre-specified according to the conditional frequencies estimated from the NCBI dbSNP database (version 136) [<xref ref-type="bibr" rid="CR25">25</xref>].</p></sec></sec><sec id="Sec9" sec-type="results"><title>Results</title><sec id="Sec10"><title>Performance evaluation based on data simulated by HMM</title><p>The SNP calling results by the six variant callers (vi-HMM, GATK HaplotypeCaller, FreeBayes, Platypus, SAMtools, and VarScan) for the simulated data are shown in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>. We observe that, when Bowtie2 is used for read mapping, vi-HMM achieves the highest sensitivity and <italic>F</italic><sub>1</sub> score at every read coverage depth, indicating its good accuracy in detecting SNPs as compared to the other variant callers, especially at the low-coverage (15&#x000d7; depth) setting (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a, e). The sensitivity of SNP calling by vi-HMM reaches 93.83%, whereas the second highest sensitivity by SAMtools is only 81.45% at the 15&#x000d7; depth; the <italic>F</italic><sub>1</sub> score by vi-HMM (95.29%) is also much higher than that by SAMtools (89.27%). All six variant callers show high precision (above 95%) on this simulated data (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>c). When BWA-MEM is used for read mapping, the sensitivities and <italic>F</italic><sub>1</sub> scores by vi-HMM are also the highest across all read coverage depths (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>b, f). The sensitivity and <italic>F</italic><sub>1</sub> score by SAMtools are comparable to those by vi-HMM. Again, high precision is observed for all six variant callers (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>d).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Comparison of SNP calling by different variant callers using data simulated by HMM at various sequencing depths. <bold>a</bold> Sensitivity with Bowtie2 mapping. <bold>b</bold> Sensitivity with BWA-MEM mapping. <bold>c</bold> Precision with Bowtie2 mapping. <bold>d</bold> Precision with BWA-MEM mapping. <bold>e</bold>
<italic>F</italic><sub>1</sub> score with Bowtie2 mapping. <bold>f</bold>
<italic>F</italic><sub>1</sub> score with BWA-MEM mapping</p></caption><graphic xlink:href="40246_2019_194_Fig2_HTML" id="MO2"/></fig>
</p><p>For INDEL calling, with Bowtie2 mapping, the sensitivity and <italic>F</italic><sub>1</sub> score by vi-HMM are the highest at every read coverage depth (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>a, e) and the precision by vi-HMM is the second highest (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>c), indicating the superiority of vi-HMM in detecting INDELs than the other variant callers. As the coverage depth increases, the INDEL calling accuracy of vi-HMM becomes higher. With BWA-MEM mapping, the sensitivity by vi-HMM is only slightly lower than those by Platypus and GATK HaplotypeCaller (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>b). The precisions by vi-HMM are much higher than those by GATK HaplotypeCaller, FreeBayes, and Platypus and slightly lower than those by the other methods (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>d). Overall, the <italic>F</italic><sub>1</sub> score by vi-HMM reaches the highest at every read coverage depth (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>f).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison of INDEL calling by different variant callers using data simulated by HMM at various sequencing depths. <bold>a</bold> Sensitivity with Bowtie2 mapping. <bold>b</bold> Sensitivity with BWA-MEM mapping. <bold>c</bold> Precision with Bowtie2 mapping. <bold>d</bold> Precision with BWA-MEM mapping. <bold>e</bold>
<italic>F</italic><sub>1</sub> score with Bowtie2 mapping. <bold>f</bold>
<italic>F</italic><sub>1</sub> score with BWA-MEM mapping</p></caption><graphic xlink:href="40246_2019_194_Fig3_HTML" id="MO3"/></fig>
</p></sec><sec id="Sec11"><title>Performance evaluation based on data simulated by wgsim</title><p>In general, vi-HMM performs well in calling SNPs and INDELs on the data simulated by wgsim. For SNP calling, when Bowtie2 is used for read mapping, the sensitivity by vi-HMM is slightly lower than that by FreeBayes at the low-coverage (15&#x000d7; depth) setting but becomes the highest when the read coverage depth increases (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>a). <italic>F</italic><sub>1</sub> scores by vi-HMM and GATK HaplotypeCaller are the highest across all read coverage depths, with only subtle differences between the two (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>e). When BWA-MEM is used for read mapping, the sensitivity by vi-HMM is the highest at the medium to high-coverage (20&#x000d7;, 25&#x000d7;, 30&#x000d7; depths) settings (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>b). The <italic>F</italic><sub>1</sub> scores by vi-HMM and SAMtools are the highest at every read coverage depth (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>f). For INDEL calling, the sensitivity by vi-HMM reaches the highest at 15&#x000d7; and 20&#x000d7; depths on reads mapped with Bowtie2 (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>a). Under both mapping methods, the <italic>F</italic><sub>1</sub> scores by vi-HMM and GATK HaplotypeCaller remain the highest when the read coverage depth increases (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>e, f).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparison of SNP calling by different variant callers using data simulated by wgsim at various sequencing depths. <bold>a</bold> Sensitivity with Bowtie2 mapping. <bold>b</bold> Sensitivity with BWA-MEM mapping. <bold>c</bold> Precision with Bowtie2 mapping. <bold>d</bold> Precision with BWA-MEM mapping. <bold>e</bold>
<italic>F</italic><sub>1</sub> score with Bowtie2 mapping. <bold>f</bold>
<italic>F</italic><sub>1</sub> score with BWA-MEM mapping</p></caption><graphic xlink:href="40246_2019_194_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison of INDEL calling by different variant callers using data simulated by wgsim at various sequencing depths. <bold>a</bold> Sensitivity with Bowtie2 mapping. <bold>b</bold> Sensitivity with BWA-MEM mapping. <bold>c</bold> Precision with Bowtie2 mapping. <bold>d</bold> Precision with BWA-MEM mapping. <bold>e</bold>
<italic>F</italic><sub>1</sub> score with Bowtie2 mapping. <bold>f</bold>
<italic>F</italic><sub>1</sub> score with BWA-MEM mapping</p></caption><graphic xlink:href="40246_2019_194_Fig5_HTML" id="MO5"/></fig>
</p></sec><sec id="Sec12"><title>Application to the real data for NA12878</title><p>The results of comparing the sensitivity, precision, and <italic>F</italic><sub>1</sub> score between the five variant callers are shown in Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>, by using real data on chr21 at the 15&#x000d7;, 30&#x000d7;, and 54&#x000d7; sequencing depths. For SNP calling, we observe that all five callers except FreeBayes achieve very high precision (&#x0003e;99<italic>%</italic>) at the three depths. Thus, the differences in <italic>F</italic><sub>1</sub> score are mainly driven by sensitivity, for which vi-HMM and SAMtools outperform the others especially at low (15&#x000d7;: both &#x0003e;95<italic>%</italic>) to medium (30&#x000d7;: both &#x0003e;99<italic>%</italic>) depths. For INDEL calling, it is obvious that vi-HMM produces the highest <italic>F</italic><sub>1</sub> score over all other callers, and the superiority in <italic>F</italic><sub>1</sub> score becomes more apparent at low (15&#x000d7;: vi-HMM &#x0003e;91<italic>%</italic> whereas others &#x0003c;90<italic>%</italic>) to medium depths (30&#x000d7;: vi-HMM &#x0003e;95<italic>%</italic> whereas other callers&#x02019; <italic>F</italic><sub>1</sub> scores range from 80.54 to 93.67<italic>%</italic>). We also note that among all five variant callers, vi-HMM is able to control the false positives and false negatives in a balanced way (i.e., achieve &#x0003e;90<italic>%</italic> sensitivity and precision simultaneously) for both SNP and INDEL calling at all three depths, whereas others cannot (for example, FreeBayes and Platypus have low precision in INDEL calling, the sensitivity of SAMtools for calling INDELs is less competitive, and the sensitivity of VarScan for calling both SNPs and INDELs drops too fast at lower depths). To check the consistency of the comparison results on different chromosomes, we also apply the same variant calling process to chromosome 22. Similarly, for SNP calling, vi-HMM and SAMtools achieve very high <italic>F</italic><sub>1</sub> score at low (15&#x000d7;: both &#x0003e;96<italic>%</italic>) to medium (30&#x000d7;: both &#x0003e;99<italic>%</italic>) depths, and for INDEL calling, vi-HMM also outperforms the others at low to medium depths (at low depth, the <italic>F</italic><sub>1</sub> scores of vi-HMM and SAMtools are comparable, see details in Additional file&#x000a0;<xref rid="MOESM3" ref-type="media">3</xref>). These comparisons provide us evidence that on the real datasets, vi-HMM represents an improvement over the other four variant callers in terms of calling SNPs and INDELs, as its performance gets closer to the recognized &#x0201c;ground truth&#x0201d;&#x02014;which was obtained by GATK in practice.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of different variant callers using real data on chromosome 21</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="3">SNP</th><th align="left" colspan="3">INDEL</th></tr><tr><th align="left">Caller</th><th align="left">Sensitivity (%)</th><th align="left">Precision (%)</th><th align="left"><italic>F</italic><sub>1</sub> score (%)</th><th align="left">Sensitivity (%)</th><th align="left">Precision (%)</th><th align="left"><italic>F</italic><sub>1</sub> score (%)</th></tr></thead><tbody><tr><td align="left" colspan="7">15 &#x000d7;</td></tr><tr><td align="left">&#x02003;vi-HMM</td><td align="left">95.11</td><td align="left">99.62</td><td align="left">97.31</td><td align="left">91.95</td><td align="left">90.18</td><td align="left">91.06</td></tr><tr><td align="left">&#x02003;FreeBayes</td><td align="left">94.82</td><td align="left">91.61</td><td align="left">93.18</td><td align="left">88.93</td><td align="left">74.79</td><td align="left">81.25</td></tr><tr><td align="left">&#x02003;Platypus</td><td align="left">90.97</td><td align="left">99.84</td><td align="left">95.20</td><td align="left">93.74</td><td align="left">70.03</td><td align="left">80.17</td></tr><tr><td align="left">&#x02003;SAMtools</td><td align="left">98.66</td><td align="left">99.56</td><td align="left">99.11</td><td align="left">83.79</td><td align="left">95.45</td><td align="left">89.24</td></tr><tr><td align="left">&#x02003;VarScan</td><td align="left">76.31</td><td align="left">99.87</td><td align="left">86.51</td><td align="left">74.00</td><td align="left">99.44</td><td align="left">84.85</td></tr><tr><td align="left" colspan="7">30 &#x000d7;</td></tr><tr><td align="left">&#x02003;vi-HMM</td><td align="left">99.81</td><td align="left">99.44</td><td align="left">99.63</td><td align="left">95.22</td><td align="left">95.62</td><td align="left">95.42</td></tr><tr><td align="left">&#x02003;FreeBayes</td><td align="left">95.80</td><td align="left">95.48</td><td align="left">95.64</td><td align="left">90.36</td><td align="left">76.41</td><td align="left">82.80</td></tr><tr><td align="left">&#x02003;Platypus</td><td align="left">92.92</td><td align="left">99.73</td><td align="left">96.21</td><td align="left">95.67</td><td align="left">69.54</td><td align="left">80.54</td></tr><tr><td align="left">&#x02003;SAMtools</td><td align="left">99.64</td><td align="left">99.62</td><td align="left">99.62</td><td align="left">87.84</td><td align="left">93.23</td><td align="left">90.46</td></tr><tr><td align="left">&#x02003;VarScan</td><td align="left">97.93</td><td align="left">99.82</td><td align="left">98.86</td><td align="left">88.59</td><td align="left">99.37</td><td align="left">93.67</td></tr><tr><td align="left" colspan="7">54 &#x000d7;</td></tr><tr><td align="left">&#x02003;vi-HMM</td><td align="left">99.95</td><td align="left">99.18</td><td align="left">99.56</td><td align="left">95.61</td><td align="left">96.09</td><td align="left">95.85</td></tr><tr><td align="left">&#x02003;FreeBayes</td><td align="left">95.88</td><td align="left">96.90</td><td align="left">96.39</td><td align="left">90.77</td><td align="left">77.27</td><td align="left">83.48</td></tr><tr><td align="left">&#x02003;Platypus</td><td align="left">92.97</td><td align="left">99.63</td><td align="left">96.18</td><td align="left">96.06</td><td align="left">69.11</td><td align="left">80.38</td></tr><tr><td align="left">&#x02003;SAMtools</td><td align="left">99.70</td><td align="left">99.61</td><td align="left">99.65</td><td align="left">88.99</td><td align="left">90.53</td><td align="left">89.75</td></tr><tr><td align="left">&#x02003;VarScan</td><td align="left">99.53</td><td align="left">99.77</td><td align="left">99.65</td><td align="left">91.67</td><td align="left">99.24</td><td align="left">95.31</td></tr></tbody></table></table-wrap>
</p></sec></sec><sec id="Sec13" sec-type="discussion"><title>Discussion</title><p>In this article, we describe a new HMM-based method, vi-HMM, for accurate calling of SNP and INDEL variants in mapped reads. By taking advantage of the HMM features, vi-HMM allows us to detect variants directly through inferring an optimal hidden state path from the observed pileup read data and the reference genome. Both simulation studies and real data analysis have confirmed that vi-HMM is able to improve the accuracy of SNP/INDEL identification as compared to other variant callers, especially at low and medium depths.</p><p>As an important step in NGS data analysis, variant calling has received much attention in bioinformatics research. Although a number of variant calling methods have been developed, it remains unclear how different model assumptions used in these methods affect their practical performance. In general, the performance of a variant caller can be evaluated through either real data analysis or simulations. Real data analysis is able to reveal features of the variant caller under different settings (sequencing platforms, coverage depths, etc), however, due to lack of &#x0201c;ground truth&#x0201d; on experimentally validated variant sets in real data, the results of false positives and false negatives in variant identification are often arguable. Simulation studies, on the other hand, provide strong evidences for evaluation of a variant caller or comparison among variant callers. However, the simulated data need to be justified to have similar characteristics as real data in order to guarantee that the conclusions still remain meaningful in real data scenarios.</p><p>In the present work, we have performed both simulations and real data analysis to evaluate the proposed variant caller vi-HMM and compare it with other commonly used callers. Interestingly, we found something in common in the two sets of calling results (at 15&#x000d7; and 30&#x000d7; depths using both simulated and real data): (1) Overall, vi-HMM and SAMtools have higher <italic>F</italic><sub>1</sub> score than FreeBayes, Platypus, and VarScan, in both SNP calling and INDEL calling. (2) The precision for most variant callers are very high in SNP calling. (3) When sequencing depth increases from low (15&#x000d7;) to medium (30&#x000d7;), most variant callers have better calling performance. (4) The sensitivity and precision for vi-HMM are balanced and remain high across different depths, whereas for the other variant callers they could be very unbalanced (e.g., Platypus and FreeBayes in INDEL calling) or easily influenced by low depth of the data (e.g., the fast dropping of VarScan sensitivity in INDEL calling from 30&#x000d7; to 15&#x000d7;). These findings in variant calling performance indicate that our simulated data share some similarities with the real data, and both demonstrate that our proposed method, vi-HMM, has a good performance overall and is applicable not only to med-to-high read coverage depth but also to low read coverage, with robust performance.</p><p>Particularly, for the two &#x0201c;better performers&#x0201d; vi-HMM and SAMtools, we also see the differences between their SNP calling and INDEL calling. While they both have high sensitivity, precision, and <italic>F</italic><sub>1</sub> score in simulations and real data analysis, vi-HMM does not display remarkable superiority in calling SNPs. This may be because the state &#x0201c;SNP&#x0201d; is more likely to move to &#x0201c;Match&#x0201d; (94.99<italic>%</italic> from dbSNP) rather than to another variant across the genome. Thus the dependence between &#x0201c;SNP&#x0201d; and the adjacent variants becomes negligible and plays a less important role in SNP calling. However, in terms of INDEL calling, vi-HMM certainly outperforms SAMtools. This could be possibly explained by the fact that the transition probability from the state &#x0201c;Ins&#x0201d; to &#x0201c;Match&#x0201d; is only 28.80<italic>%</italic> (data from dbSNP), indicating that there exists strong dependence between &#x0201c;Ins&#x0201d; and the adjacent variants and therefore vi-HMM should have a better performance in calling INDELs by considering such state dependence between adjacent genomic bases.</p><p>Another observation in real data analysis is that, the <italic>F</italic><sub>1</sub> scores of these tools vary at different INDEL lengths. Figure&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> shows the <italic>F</italic><sub>1</sub> scores by vi-HMM, FreeBayes, Platypus, SAMtools, and VarScan at INDEL lengths 1, 2,..., 6, and &#x0003e;6 on real data with 15&#x000d7; depth on chromosome 21. We see that the <italic>F</italic><sub>1</sub> score by vi-HMM remains above 80% for all INDEL lengths whereas other variant callers, such as FreeBayes, Platypus, and VarScan cannot maintain their <italic>F</italic><sub>1</sub> scores consistently high. In particular, all these tools have comparable <italic>F</italic><sub>1</sub> scores at INDEL length 1, and vi-HMM achieves the highest <italic>F</italic><sub>1</sub> score at INDEL length from 2 to 6, indicating that this HMM-based method appears to be more accurate in detecting short INDELs.
<fig id="Fig6"><label>Fig. 6</label><caption><p><italic>F</italic><sub>1</sub> scores by vi-HMM, FreeBayes, Platypus, SAMtools, and VarScan at different INDEL lengths on real data with 15&#x000d7; depth on chromosome 21</p></caption><graphic xlink:href="40246_2019_194_Fig6_HTML" id="MO6"/></fig>
</p><p>Noteworthy, the accuracy of variant calling also depends on the quality of read alignment. In general, the occurrence of INDELs in reads may shift the alignments and result in mismatch [<xref ref-type="bibr" rid="CR27">27</xref>], which may impact the subsequent variant calling procedure remarkably. This is especially true for large INDELs. As seen from our simulation study 1, vi-HMM produces higher sensitivity and <italic>F</italic><sub>1</sub> score on reads mapped with Bowtie2 than it does on reads mapped with BWA-MEM at every read coverage depth. One plausible explanation is that Bowtie2 performs better than BWA-MEM in the read alignment (further examination of the two aligners on correct mapping, multiple alignment, second alignment, soft/hard clipped reads is included in Additional file&#x000a0;<xref rid="MOESM4" ref-type="media">4</xref>). Such a phenomenon of variant calling being influenced by read alignment can also be observed in a simulated dataset with homopolymers (Additional file&#x000a0;<xref rid="MOESM5" ref-type="media">5</xref>). It is thus important to choose an alignment tool that produces high-quality mapping prior to variant calling.</p></sec><sec id="Sec14" sec-type="conclusion"><title>Conclusion</title><p>In conclusion, we have developed a novel HMM-based method for sequence variant identification in short-read data. This variant caller provides an effective solution to modeling the dependence of adjacent genomic loci, which is expected to be useful for accurate calling of variants but is often overlooked in existing tools. To evaluate the performance of calling SNPs and INDELs in synthetic and real sequencing data, we compared the new variant calling method, vi-HMM, with five prevalent methods (GATK HaplotypeCaller, FreeBayes, Platypus, SAMtools, and VarScan) in simulation studies and with four (FreeBayes, Platypus, SAMtools, and VarScan) in real data analysis. Both comparison results demonstrate that vi-HMM is able to identify SNP and INDEL variants in a more accurate (overall high <italic>F</italic><sub>1</sub> score), reliable (smaller fluctuations across different read coverage depths), and balanced (both good sensitivity and good precision) way, as compared to the other variant callers.</p></sec><sec sec-type="supplementary-material"><title>Additional files</title><sec id="Sec15"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="40246_2019_194_MOESM1_ESM.pdf"><label>Additional file 1</label><caption><p>Mapped reads in IGV viewer. (PDF 78 kb)</p></caption></media></supplementary-material>
</p><p>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="40246_2019_194_MOESM2_ESM.pdf"><label>Additional file 2</label><caption><p>Commands and settings for data simulation by wgsim and variant calling by GATK HaplotypeCaller, FreeBayes, Platypus, SAMtools, and VarScan. (PDF 77 kb)</p></caption></media></supplementary-material>
</p><p>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="40246_2019_194_MOESM3_ESM.pdf"><label>Additional file 3</label><caption><p>Performance of different variant callers using real data on chromosome 22. (PDF 83 kb)</p></caption></media></supplementary-material>
</p><p>
<supplementary-material content-type="local-data" id="MOESM4"><media xlink:href="40246_2019_194_MOESM4_ESM.pdf"><label>Additional file 4</label><caption><p>The alignment information by Bowtie2 and BWA-MEM at different coverage depths. (PDF 36 kb)</p></caption></media></supplementary-material>
</p><p>
<supplementary-material content-type="local-data" id="MOESM5"><media xlink:href="40246_2019_194_MOESM5_ESM.pdf"><label>Additional file 5</label><caption><p>Performance of vi-HMM on simulated data with homopolymers. (PDF 60 kb)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><ack><title>Acknowledgements</title><p>We thank all members of the Zhang Lab at Virginia Tech for helpful discussion.</p><sec id="d29e2337"><title>Funding</title><p>This work was supported by Virginia Tech&#x02019;s Open Access Subvention Fund, and partially supported by an NSF grant DMS-1611901 to H. Zhu.</p></sec><sec id="d29e2342" sec-type="data-availability"><title>Availability of data and materials</title><p>The datasets supporting the results of this article are publicly available at the Genome in a Bottle (GIAB) ftp site at NCBI (<ext-link ext-link-type="uri" xlink:href="ftp://ftp-trace.ncbi.nih.gov/giab/ftp/data/NA12878">ftp://ftp-trace.ncbi.nih.gov/giab/ftp/data/NA12878</ext-link>).</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>MT and MSH carried out the data processing, coding, and computational experiments. XW and HZ conceptualized the main idea of the project. XW designed the study and supervised the project. MT, MSH, HZ, LZ, and XW wrote the paper. All authors read and approved the final manuscript.</p></notes><notes notes-type="COI-statement"><sec><title>Ethics approval and consent to participate</title><p>Not applicable.</p></sec><sec><title>Consent for publication</title><p>Not applicable.</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Publisher&#x02019;s Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mardis</surname><given-names>ER</given-names></name></person-group><article-title>Next-generation DNA sequencing methods</article-title><source>Annu Rev Genomics Hum Genet</source><year>2008</year><volume>9</volume><fpage>387</fpage><lpage>402</lpage><?supplied-pmid 18576944?><pub-id pub-id-type="pmid">18576944</pub-id></element-citation></ref><ref id="CR2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metzker</surname><given-names>ML</given-names></name></person-group><article-title>Sequencing technologies&#x02014;the next generation</article-title><source>Nat Rev Genet</source><year>2010</year><volume>11</volume><issue>1</issue><fpage>31</fpage><lpage>46</lpage><?supplied-pmid 19997069?><pub-id pub-id-type="pmid">19997069</pub-id></element-citation></ref><ref id="CR3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>K</given-names></name><name><surname>McLellan</surname><given-names>MD</given-names></name><name><surname>Ding</surname><given-names>L</given-names></name><name><surname>Wendl</surname><given-names>MC</given-names></name><name><surname>Kasai</surname><given-names>Y</given-names></name><name><surname>Wilson</surname><given-names>RK</given-names></name><name><surname>Mardis</surname><given-names>ER</given-names></name></person-group><article-title>Polyscan: an automatic indel and SNP detection approach to the analysis of human resequencing data</article-title><source>Genome Res</source><year>2007</year><volume>17</volume><issue>5</issue><fpage>659</fpage><lpage>66</lpage><?supplied-pmid 17416743?><pub-id pub-id-type="pmid">17416743</pub-id></element-citation></ref><ref id="CR4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mills</surname><given-names>RE</given-names></name><name><surname>Pittard</surname><given-names>WS</given-names></name><name><surname>Mullaney</surname><given-names>JM</given-names></name><name><surname>Farooq</surname><given-names>U</given-names></name><name><surname>Creasy</surname><given-names>TH</given-names></name><name><surname>Mahurkar</surname><given-names>AA</given-names></name><name><surname>Kemeza</surname><given-names>DM</given-names></name><name><surname>Strassler</surname><given-names>DS</given-names></name><name><surname>Ponting</surname><given-names>CP</given-names></name><name><surname>Webber</surname><given-names>C</given-names></name><name><surname>Devine</surname><given-names>SE</given-names></name></person-group><article-title>Natural genetic variation caused by small insertions and deletions in the human genome</article-title><source>Genome Res</source><year>2011</year><volume>21</volume><issue>6</issue><fpage>830</fpage><lpage>9</lpage><?supplied-pmid 21460062?><pub-id pub-id-type="pmid">21460062</pub-id></element-citation></ref><ref id="CR5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mullaney</surname><given-names>JM</given-names></name><name><surname>Mills</surname><given-names>RE</given-names></name><name><surname>Pittard</surname><given-names>WS</given-names></name><name><surname>Devine</surname><given-names>SE</given-names></name></person-group><article-title>Small insertions and deletions (INDELs) in human genomes</article-title><source>Hum Mol Genet</source><year>2010</year><volume>19</volume><issue>R2</issue><fpage>131</fpage><lpage>6</lpage></element-citation></ref><ref id="CR6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altmann</surname><given-names>A</given-names></name><name><surname>Weber</surname><given-names>P</given-names></name><name><surname>Bader</surname><given-names>D</given-names></name><name><surname>Preu&#x000df;</surname><given-names>M</given-names></name><name><surname>Binder</surname><given-names>EB</given-names></name><name><surname>M&#x000fc;ller-Myhsok</surname><given-names>B</given-names></name></person-group><article-title>A beginners guide to SNP calling from high-throughput DNA-sequencing data</article-title><source>Hum Genet</source><year>2012</year><volume>131</volume><issue>10</issue><fpage>1541</fpage><lpage>1554</lpage><?supplied-pmid 22886560?><pub-id pub-id-type="pmid">22886560</pub-id></element-citation></ref><ref id="CR7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Handsaker</surname><given-names>B</given-names></name><name><surname>Wysoker</surname><given-names>A</given-names></name><name><surname>Fennell</surname><given-names>T</given-names></name><name><surname>Ruan</surname><given-names>J</given-names></name><name><surname>Homer</surname><given-names>N</given-names></name><name><surname>Marth</surname><given-names>G</given-names></name><name><surname>Abecasis</surname><given-names>G</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>The sequence alignment/map format and SAMtools</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><issue>16</issue><fpage>2078</fpage><lpage>9</lpage><?supplied-pmid 19505943?><pub-id pub-id-type="pmid">19505943</pub-id></element-citation></ref><ref id="CR8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DePristo</surname><given-names>MA</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name><name><surname>Poplin</surname><given-names>R</given-names></name><name><surname>Garimella</surname><given-names>KV</given-names></name><name><surname>Maguire</surname><given-names>JR</given-names></name><name><surname>Hartl</surname><given-names>C</given-names></name><name><surname>Philippakis</surname><given-names>AA</given-names></name><name><surname>Del Angel</surname><given-names>G</given-names></name><name><surname>Rivas</surname><given-names>MA</given-names></name><name><surname>Hanna</surname><given-names>M</given-names></name><etal/></person-group><article-title>A framework for variation discovery and genotyping using next-generation dna sequencing data</article-title><source>Nat Genet</source><year>2011</year><volume>43</volume><issue>5</issue><fpage>491</fpage><?supplied-pmid 21478889?><pub-id pub-id-type="pmid">21478889</pub-id></element-citation></ref><ref id="CR9"><label>9</label><mixed-citation publication-type="other">Garrison E, Marth G. Haplotype-based variant detection from short-read sequencing. arXiv preprint arXiv:12073907. 2012.</mixed-citation></ref><ref id="CR10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rimmer</surname><given-names>A</given-names></name><name><surname>Phan</surname><given-names>H</given-names></name><name><surname>Mathieson</surname><given-names>I</given-names></name><name><surname>Iqbal</surname><given-names>Z</given-names></name><name><surname>Twigg</surname><given-names>SR</given-names></name><name><surname>Wilkie</surname><given-names>AO</given-names></name><name><surname>McVean</surname><given-names>G</given-names></name><name><surname>Lunter</surname><given-names>G</given-names></name><name><surname>Consortium</surname><given-names>W</given-names></name><etal/></person-group><article-title>Integrating mapping-, assembly-and haplotype-based approaches for calling variants in clinical sequencing applications</article-title><source>Nat Genet</source><year>2014</year><volume>46</volume><issue>8</issue><fpage>912</fpage><lpage>8</lpage><?supplied-pmid 25017105?><pub-id pub-id-type="pmid">25017105</pub-id></element-citation></ref><ref id="CR11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koboldt</surname><given-names>DC</given-names></name><name><surname>Chen</surname><given-names>K</given-names></name><name><surname>Wylie</surname><given-names>T</given-names></name><name><surname>Larson</surname><given-names>DE</given-names></name><name><surname>McLellan</surname><given-names>MD</given-names></name><name><surname>Mardis</surname><given-names>ER</given-names></name><name><surname>Weinstock</surname><given-names>GM</given-names></name><name><surname>Wilson</surname><given-names>RK</given-names></name><name><surname>Ding</surname><given-names>L</given-names></name></person-group><article-title>Varscan: variant detection in massively parallel sequencing of individual and pooled samples</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><issue>17</issue><fpage>2283</fpage><lpage>5</lpage><?supplied-pmid 19542151?><pub-id pub-id-type="pmid">19542151</pub-id></element-citation></ref><ref id="CR12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matukumalli</surname><given-names>LK</given-names></name><name><surname>Grefenstette</surname><given-names>JJ</given-names></name><name><surname>Hyten</surname><given-names>DL</given-names></name><name><surname>Choi</surname><given-names>IY</given-names></name><name><surname>Cregan</surname><given-names>PB</given-names></name><name><surname>Tassell</surname><given-names>CPV</given-names></name></person-group><article-title>Application of machine learning in SNP discovery</article-title><source>BMC Bioinforma</source><year>2006</year><volume>7</volume><issue>1</issue><fpage>1</fpage></element-citation></ref><ref id="CR13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pabinger</surname><given-names>S</given-names></name><name><surname>Dander</surname><given-names>A</given-names></name><name><surname>Fischer</surname><given-names>M</given-names></name><name><surname>Snajder</surname><given-names>R</given-names></name><name><surname>Sperk</surname><given-names>M</given-names></name><name><surname>Efremova</surname><given-names>M</given-names></name><name><surname>Krabichler</surname><given-names>B</given-names></name><name><surname>Speicher</surname><given-names>MR</given-names></name><name><surname>Zschocke</surname><given-names>J</given-names></name><name><surname>Trajanoski</surname><given-names>Z</given-names></name></person-group><article-title>A survey of tools for variant analysis of next-generation genome sequencing data</article-title><source>Brief Bioinform</source><year>2014</year><volume>15</volume><issue>2</issue><fpage>256</fpage><lpage>78</lpage><?supplied-pmid 23341494?><pub-id pub-id-type="pmid">23341494</pub-id></element-citation></ref><ref id="CR14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hasan</surname><given-names>MS</given-names></name><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name></person-group><article-title>Performance evaluation of indel calling tools using real short-read data</article-title><source>Hum Genomics</source><year>2015</year><volume>9</volume><fpage>20</fpage><?supplied-pmid 26286629?><pub-id pub-id-type="pmid">26286629</pub-id></element-citation></ref><ref id="CR15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rabiner</surname><given-names>LR</given-names></name></person-group><article-title>A tutorial on hidden Markov models and selected applications in speech recognition</article-title><source>Proc IEEE</source><year>1989</year><volume>77</volume><issue>2</issue><fpage>257</fpage><lpage>86</lpage></element-citation></ref><ref id="CR16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Churchill</surname><given-names>GA</given-names></name></person-group><article-title>Stochastic models for heterogeneous DNA sequences</article-title><source>Bull Math Biol</source><year>1989</year><volume>51</volume><issue>1</issue><fpage>79</fpage><lpage>94</lpage><?supplied-pmid 2706403?><pub-id pub-id-type="pmid">2706403</pub-id></element-citation></ref><ref id="CR17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoon</surname><given-names>BJ</given-names></name></person-group><article-title>Hidden Markov models and their applications in biological sequence analysis</article-title><source>Curr Genom</source><year>2009</year><volume>10</volume><issue>6</issue><fpage>402</fpage><lpage>15</lpage></element-citation></ref><ref id="CR18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>JT</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Gibbs</surname><given-names>RA</given-names></name><name><surname>Yu</surname><given-names>F</given-names></name></person-group><article-title>Characterizing linkage disequilibrium and evaluating imputation power of human genomic insertion-deletion polymorphisms</article-title><source>Genome Biol</source><year>2012</year><volume>13</volume><issue>2</issue><fpage>15</fpage></element-citation></ref><ref id="CR19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albers</surname><given-names>CA</given-names></name><name><surname>Lunter</surname><given-names>G</given-names></name><name><surname>MacArthur</surname><given-names>DG</given-names></name><name><surname>McVean</surname><given-names>G</given-names></name><name><surname>Ouwehand</surname><given-names>WH</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>Dindel: accurate indel calls from short-read data</article-title><source>Genome Res</source><year>2011</year><volume>21</volume><issue>6</issue><fpage>961</fpage><lpage>73</lpage><?supplied-pmid 20980555?><pub-id pub-id-type="pmid">20980555</pub-id></element-citation></ref><ref id="CR20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeng</surname><given-names>F</given-names></name><name><surname>Jiang</surname><given-names>R</given-names></name><name><surname>Chen</surname><given-names>T</given-names></name></person-group><article-title>PyroHMMsnp: an SNP caller for Ion Torrent and 454 sequencing data</article-title><source>Nucleic Acids Res</source><year>2013</year><volume>41</volume><issue>13</issue><fpage>136</fpage></element-citation></ref><ref id="CR21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeng</surname><given-names>F</given-names></name><name><surname>Jiang</surname><given-names>R</given-names></name><name><surname>Chen</surname><given-names>T</given-names></name></person-group><article-title>PyroHMMvar: a sensitive and accurate method to call short indels and SNPs for Ion Torrent and 454 data</article-title><source>Bioinformatics</source><year>2013</year><volume>29</volume><issue>22</issue><fpage>2859</fpage><lpage>68</lpage><?supplied-pmid 23995392?><pub-id pub-id-type="pmid">23995392</pub-id></element-citation></ref><ref id="CR22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zook</surname><given-names>JM</given-names></name><name><surname>Chapman</surname><given-names>B</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Mittelman</surname><given-names>D</given-names></name><name><surname>Hofmann</surname><given-names>O</given-names></name><name><surname>Hide</surname><given-names>W</given-names></name><name><surname>Salit</surname><given-names>M</given-names></name></person-group><article-title>Integrating human sequence data sets provides a resource of benchmark SNP and indel genotype calls</article-title><source>Nat Biotechnol</source><year>2014</year><volume>32</volume><issue>3</issue><fpage>246</fpage><lpage>51</lpage><?supplied-pmid 24531798?><pub-id pub-id-type="pmid">24531798</pub-id></element-citation></ref><ref id="CR23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>Fast gapped-read alignment with Bowtie 2</article-title><source>Nat Methods</source><year>2012</year><volume>9</volume><issue>4</issue><fpage>357</fpage><lpage>9</lpage><?supplied-pmid 3322381?><pub-id pub-id-type="pmid">22388286</pub-id></element-citation></ref><ref id="CR24"><label>24</label><mixed-citation publication-type="other">Li H. Aligning sequence reads, clone sequences and assembly contigs with bwa-mem. arXiv preprint arXiv:13033997. 2013.</mixed-citation></ref><ref id="CR25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sherry</surname><given-names>ST</given-names></name><name><surname>Ward</surname><given-names>MH</given-names></name><name><surname>Kholodov</surname><given-names>M</given-names></name><name><surname>Baker</surname><given-names>J</given-names></name><name><surname>Phan</surname><given-names>L</given-names></name><name><surname>Smigielski</surname><given-names>EM</given-names></name><name><surname>Sirotkin</surname><given-names>K</given-names></name></person-group><article-title>dbSNP: the NCBI database of genetic variation</article-title><source>Nucleic Acids Res</source><year>2001</year><volume>29</volume><issue>1</issue><fpage>308</fpage><lpage>11</lpage><?supplied-pmid 11125122?><pub-id pub-id-type="pmid">11125122</pub-id></element-citation></ref><ref id="CR26"><label>26</label><mixed-citation publication-type="other">Li H. wgsim-read simulator for next generation sequencing. Github Repository. 2011. <ext-link ext-link-type="uri" xlink:href="http://github.com/lh3/wgsim">http://github.com/lh3/wgsim</ext-link>.</mixed-citation></ref><ref id="CR27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Ruan</surname><given-names>J</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title><source>Genome Res</source><year>2008</year><volume>18</volume><issue>11</issue><fpage>1851</fpage><lpage>8</lpage><?supplied-pmid 18714091?><pub-id pub-id-type="pmid">18714091</pub-id></element-citation></ref></ref-list></back></article>