<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Proc Natl Acad Sci U S A</journal-id><journal-id journal-id-type="iso-abbrev">Proc. Natl. Acad. Sci. U.S.A</journal-id><journal-id journal-id-type="hwp">pnas</journal-id><journal-id journal-id-type="pmc">pnas</journal-id><journal-id journal-id-type="publisher-id">PNAS</journal-id><journal-title-group><journal-title>Proceedings of the National Academy of Sciences of the United States of America</journal-title></journal-title-group><issn pub-type="ppub">0027-8424</issn><issn pub-type="epub">1091-6490</issn><publisher><publisher-name>National Academy of Sciences</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6166824</article-id><article-id pub-id-type="pmid">30201725</article-id><article-id pub-id-type="publisher-id">201806447</article-id><article-id pub-id-type="doi">10.1073/pnas.1806447115</article-id><article-categories><subj-group subj-group-type="heading"><subject>Biological Sciences</subject><subj-group><subject>Applied Biological Sciences</subject></subj-group></subj-group></article-categories><title-group><article-title>Improving nanopore read accuracy with the R2C2 method enables the sequencing of highly multiplexed full-length single-cell cDNA</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Volden</surname><given-names>Roger</given-names></name><xref ref-type="aff" rid="aff1"><sup>a</sup></xref><xref ref-type="aff" rid="aff2"><sup>b</sup></xref></contrib><contrib contrib-type="author"><name><surname>Palmer</surname><given-names>Theron</given-names></name><xref ref-type="aff" rid="aff1"><sup>a</sup></xref><xref ref-type="aff" rid="aff2"><sup>b</sup></xref></contrib><contrib contrib-type="author"><name><surname>Byrne</surname><given-names>Ashley</given-names></name><xref ref-type="aff" rid="aff2"><sup>b</sup></xref><xref ref-type="aff" rid="aff3"><sup>c</sup></xref></contrib><contrib contrib-type="author"><name><surname>Cole</surname><given-names>Charles</given-names></name><xref ref-type="aff" rid="aff1"><sup>a</sup></xref><xref ref-type="aff" rid="aff2"><sup>b</sup></xref></contrib><contrib contrib-type="author"><name><surname>Schmitz</surname><given-names>Robert J.</given-names></name><xref ref-type="aff" rid="aff4"><sup>d</sup></xref></contrib><contrib contrib-type="author"><name><surname>Green</surname><given-names>Richard E.</given-names></name><xref ref-type="aff" rid="aff1"><sup>a</sup></xref><xref ref-type="aff" rid="aff2"><sup>b</sup></xref></contrib><contrib contrib-type="author"><name><surname>Vollmers</surname><given-names>Christopher</given-names></name><xref ref-type="aff" rid="aff1"><sup>a</sup></xref><xref ref-type="aff" rid="aff2"><sup>b</sup></xref><xref ref-type="corresp" rid="cor1"><sup>1</sup></xref></contrib><aff id="aff1"><sup>a</sup>Department of Biomolecular Engineering, <institution>University of California</institution>, Santa Cruz, <addr-line>CA</addr-line> 95064;</aff><aff id="aff2"><sup>b</sup>Genomics Institute, <institution>University of California</institution>, Santa Cruz, <addr-line>CA</addr-line> 95064;</aff><aff id="aff3"><sup>c</sup>Department of Molecular, Cellular, and Developmental Biology, <institution>University of California</institution>, Santa Cruz, <addr-line>CA</addr-line> 95064;</aff><aff id="aff4"><sup>d</sup>Department of Genetics, <institution>University of Georgia</institution>, Athens, <addr-line>GA</addr-line> 30602</aff></contrib-group><author-notes><corresp id="cor1"><sup>1</sup>To whom correspondence should be addressed. Email: <email>vollmers@ucsc.edu</email>.</corresp><fn fn-type="edited-by"><p>Edited by Jasper Rine, University of California, Berkeley, CA, and approved August 14, 2018 (received for review April 15, 2018)</p></fn><fn fn-type="con"><p>Author contributions: R.V., A.B., R.J.S., R.E.G., and C.V. designed research; R.V., T.P., A.B., R.J.S., and C.V. performed research; R.V., T.P., C.C., and C.V. analyzed data; and R.V., R.E.G., and C.V. wrote the paper.</p></fn></author-notes><pub-date pub-type="ppub"><day>25</day><month>9</month><year>2018</year></pub-date><pub-date pub-type="epub"><day>10</day><month>9</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>10</day><month>9</month><year>2018</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>115</volume><issue>39</issue><fpage>9726</fpage><lpage>9731</lpage><permissions><copyright-statement>Copyright &#x000a9; 2018 the Author(s). Published by PNAS.</copyright-statement><copyright-year>2018</copyright-year><license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/"><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="vor"/><license-p>This open access article is distributed under <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives License 4.0 (CC BY-NC-ND)</ext-link>.</license-p></license></permissions><self-uri xlink:title="pdf" xlink:href="pnas.201806447.pdf"/><abstract abstract-type="executive-summary"><title>Significance</title><p>Subtle changes in RNA transcript isoform expression can have dramatic effects on cellular behavior in both health and disease. As such, comprehensive and quantitative analysis of isoform-level transcriptomes would open an entirely new window into cellular diversity in fields ranging from developmental to cancer biology. The Rolling Circle Amplification to Concatemeric Consensus (R2C2) method we are presenting here has sufficient throughput and accuracy to make the comprehensive and quantitative analysis of RNA transcript isoforms in bulk and single-cell samples economically feasible.</p></abstract><abstract><p>High-throughput short-read sequencing has revolutionized how transcriptomes are quantified and annotated. However, while Illumina short-read sequencers can be used to analyze entire transcriptomes down to the level of individual splicing events with great accuracy, they fall short of analyzing how these individual events are combined into complete RNA transcript isoforms. Because of this shortfall, long-distance information is required to complement short-read sequencing to analyze transcriptomes on the level of full-length RNA transcript isoforms. While long-read sequencing technology can provide this long-distance information, there are issues with both Pacific Biosciences (PacBio) and Oxford Nanopore Technologies (ONT) long-read sequencing technologies that prevent their widespread adoption. Briefly, PacBio sequencers produce low numbers of reads with high accuracy, while ONT sequencers produce higher numbers of reads with lower accuracy. Here, we introduce and validate a long-read ONT-based sequencing method. At the same cost, our Rolling Circle Amplification to Concatemeric Consensus (R2C2) method generates more accurate reads of full-length RNA transcript isoforms than any other available long-read sequencing method. These reads can then be used to generate isoform-level transcriptomes for both genome annotation and differential expression analysis in bulk or single-cell samples.</p></abstract><kwd-group><kwd>full-length cDNA sequencing</kwd><kwd>isoforms</kwd><kwd>single-cell transcriptomics</kwd><kwd>B cells</kwd><kwd>nanopore sequencing</kwd></kwd-group><funding-group><award-group id="gs1"><funding-source id="sp1">Hellman Foundation<named-content content-type="funder-id">100010336</named-content></funding-source><award-id rid="sp1">N/A</award-id><principal-award-recipient>Christopher Vollmers</principal-award-recipient></award-group><award-group id="gs2"><funding-source id="sp2">HHS | NIH | National Human Genome Research Institute (NHGRI)<named-content content-type="funder-id">100000051</named-content></funding-source><award-id rid="sp2">1T32HG008345-01</award-id><principal-award-recipient>Ashley Byrne</principal-award-recipient><principal-award-recipient>Charles Cole</principal-award-recipient></award-group></funding-group><counts><page-count count="6"/></counts></article-meta></front><body><p content-type="flushleft">Short-read RNAseq has been used for the analysis of transcriptomes for over a decade (<xref rid="r1" ref-type="bibr">1</xref>). The massive read output of Illumina sequencers makes it possible to quantify gene expression accurately using this approach. However, to accommodate Illumina sequencers&#x02019; short read-length, RNA or cDNA has to be fragmented during sample preparation, thereby losing long-distance RNA transcript isoform information. Specialized protocols like synthetic long read (SLR) (<xref rid="r2" ref-type="bibr">2</xref>) or sparse isoform sequencing (spISO-seq) (<xref rid="r3" ref-type="bibr">3</xref>) have been used successfully to recover long-distance information, but they require either specialized instrumentation or complex workflows. The SLR method assembles mostly incomplete cDNA molecules and has limited throughput, while spISO-seq requires a 10x Genomics instrument and generates read clouds, which capture long-distance information and yet cannot assemble full-length cDNA molecules.</p><p>In contrast, long-read sequencing technology has the capability to sequence entire cDNA molecules end-to-end. Currently, the Pacific Biosciences (PacBio) Iso-Seq pipeline represents a powerful gold standard for cDNA sequencing (<xref rid="r4" ref-type="bibr">4</xref>) and has been used to investigate a wide range of transcriptomes (<xref rid="r5" ref-type="bibr">5</xref>, <xref rid="r6" ref-type="bibr">6</xref>). The PacBio Sequel sequencer produces &#x0223c;200,000 accurate circular consensus reads of full-length cDNA molecules per run.</p><p>Oxford Nanopore Technologies (ONT) technology could present a valuable alternative for cDNA sequencing, because the ONT MinION can currently generate more than one million reads per run. We and others have shown that the ONT MinION can sequence cDNA at high throughput, but that data analysis is challenging (<xref rid="r7" ref-type="bibr">7</xref>, <xref rid="r8" ref-type="bibr">8</xref>) due to its high error rate. Base-level identification of splice junction sequence is the main challenge.</p><p>One strategy to increase the base accuracy of cDNA sequences produced by the higher-output ONT MinION sequencer is to apply the circular consensus principle applied by PacBio sequencers. By sequencing 16S amplicon molecules, the INC-seq (<xref rid="r9" ref-type="bibr">9</xref>) method has shown that this is possible, in principle. However, the reported throughput of a few thousand reads per run would be insufficient for transcriptome analysis. Further, like PacBio technology, the INC-seq method uses blunt-end ligation to circularize double-stranded DNA molecules, which does not differentiate between full-length or fragmented DNA molecules. In summary, current technology produces reads that are either too inaccurate (ONT), potentially incomplete (Illumina, PacBio, ONT, INC-seq), or too low-throughput/expensive (PacBio, SLR, INC-seq) to enable high-throughput complete cDNA sequencing.</p><p>Here we introduce the Rolling Circle to Concatemeric Consensus (R2C2) method, which overcomes these limitations by leveraging the long-read length of the ONT technology to generate consensus sequences with increased base accuracy. First, we benchmark R2C2 against the PacBio Iso-Seq gold standard for the analysis of the same synthetic transcript mixture. Second, we apply R2C2 to analyze the transcriptomes of 96 single B cells derived from a healthy adult. We show that a single run of R2C2 can generate over 400,000 reads covering full-length cDNA molecules with a median base accuracy of 94%. Using an updated version of our Mandalorion pipeline, these reads can be used to identify high-confidence RNA transcript isoforms present in bulk or single-cell transcriptomes. Illustrating the power of this approach, we find that some of the B cells in our study express RNA transcript isoforms of the CD19 gene that lack the epitope targeted by chimeric antigen receptor (CAR) T cell therapy (<xref rid="r10" ref-type="bibr">10</xref><xref rid="r11" ref-type="bibr"/>&#x02013;<xref rid="r12" ref-type="bibr">12</xref>).</p><sec sec-type="results" id="s1"><title>Results</title><sec id="s2"><title>R2C2 Improves the Base Accuracy of the ONT MinION.</title><p>To benchmark the R2C2 method, we analyzed Spike-in RNA Variant (SIRV) E2 synthetic spike in RNA. First, we reverse-transcribed and amplified the synthetic spike in RNA using the Tn5Prime (<xref rid="r13" ref-type="bibr">13</xref>) protocol, which is a modification of the Smart-seq2 protocol, which uses a distinct template switch oligo containing 7-nt sample indexes during reverse transcription. Amplification introduces an additional 8-nt index into the cDNA molecules. The amplified cDNA is then circularized using a DNA splint and the NEBuilder HiFi DNA Assembly Master Mix, a proprietary variant of Gibson Assembly. The DNA splint is designed to circularize only full-length cDNA terminating on both ends in sequences complementary to the primers used to amplify cDNA (<xref ref-type="fig" rid="fig01">Fig. 1</xref>). Circularized cDNA is then amplified using Phi29 and random hexamers to perform Rolling Circle Amplification (RCA). The resulting High Molecular Weight (HMW) DNA was then debranched using T7 Endonuclease and sequenced on the ONT MinION sequencer using the 1D sequencing kit (LSK108) kit and R9.5 flow cell (FLO-MIN107).</p><fig id="fig01" fig-type="featured" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>R2C2 method overview. cDNA is circularized using Gibson Assembly, amplified using RCA, and sequenced using the ONT MinION. The resulting raw reads are split into subreads containing full-length or partial cDNA sequences, which are combined into an accurate consensus sequence using our C3POa workflow, which relies on a custom algorithm to detect DNA splints as well as poaV2 and racon.</p></caption><graphic id="gra1" xlink:href="pnas.1806447115fig01"/></fig><p>The sequencing run produced 828,684 reads with an average length of 5.0 kb, resulting in a total base output of 4.1 Gb. For downstream analysis we selected 621,970 of these reads that were longer than 1 kb and had a raw quality score (Q) &#x02265; 9. We next used our C3POa [Concatemeric Consensus Caller using partial order alignments (POA)] computational workflow to generate full-length cDNA consensus reads from the raw reads. C3POa detects DNA splint sequence raw reads using BLAST-Like Alignment Tool (BLAT) (<xref rid="r14" ref-type="bibr">14</xref>). Because BLAT is likely to miss DNA splint sequences in the noisy raw reads, we analyze each raw read for which BLAT found at least one DNA splint sequence with a custom repeat finder, which parses the score matrix of a modified Smith&#x02013;Waterman self-to-self alignment (<xref ref-type="fig" rid="fig01">Figs. 1</xref> and <xref ref-type="fig" rid="fig02">2<italic>A</italic></xref>). Repeats, or subreads, are then combined into a consensus and error-corrected using poaV2 (<xref rid="r15" ref-type="bibr">15</xref>) and racon (<xref rid="r16" ref-type="bibr">16</xref>), respectively. Finally, only reads containing known priming sites at both cDNA ends are retained as full-length consensus reads. In this way, C3POa generated 435,074 full-length cDNA consensus reads (and an additional 46,994 consensus reads from another multiplexed experiment) with varying subread coverage (<xref ref-type="fig" rid="fig02">Fig. 2 <italic>A</italic> and <italic>B</italic></xref> and <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/lookup/suppl/doi:10.1073/pnas.1806447115/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Table S1</ext-link>).</p><fig id="fig02" fig-type="figure" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>Raw reads are processed into consensus reads of varying subread coverage. (<italic>A</italic>) Example of an 11.5-kb raw ONT read that was analyzed by our custom Smith&#x02013;Waterman repeat finder. One initial splint (red line) is identified using the BLAT aligner, and then modified Smith&#x02013;Waterman self-to-self alignments are performed starting from the location of the initial splint. The score matrices (<italic>Top</italic>) are then processed to generate alignment score histograms (teal). We then call peaks (orange) on these histograms. Complete subreads are then defined as the sequences between two peaks. (<italic>B</italic>) Cumulative number of SIRV E2 R2C2 consensus reads is plotted against their subread coverage. To the <italic>Right</italic>, coverage (Cov), fraction of all consensus reads (Frac), and accuracy (Acc) are given for four read bins. (<italic>C</italic>) PacBio Isoseq, standard ONT 1D, and 1D<sup>2</sup> are compared with R2C2 at different subread coverages. Read accuracy is determined by minimap2 alignments to SIRV transcripts (see <italic>Methods</italic>). Median accuracy is shown as a red line. Accuracy distribution is shown as a swarm plot of 250 randomly subsampled reads. Average raw read quality of ONT reads is indicated by the color of the individual points.</p></caption><graphic id="gra2" xlink:href="pnas.1806447115fig02"/></fig><p>We also analyzed the same cDNA pool using a standard, heavily multiplexed ONT 1D<sup>2</sup> run generating 5,904 full-length 1D and 1,142 1D<sup>2</sup> cDNA reads and the PacBio IsoSeq protocol generating 233,852 full-length cDNA Circular Consensus (CCS) reads. We aligned the resulting reads generated by each protocol to the SIRV transcript sequences using minimap2 and calculated percent identity (accuracy) using those alignments. The 1D<sup>2</sup> run produced reads with a median accuracy of 87% (1D reads) or 95.6% (1D<sup>2</sup> reads), while PacBio CCS reads had a median accuracy of 98.9%. R2C2 reads had a median accuracy of 94% (<xref ref-type="fig" rid="fig02">Fig. 2<italic>C</italic></xref>) with the accuracy of individual R2C2 reads being highly correlated with average quality score of its underlying raw read as well as the numbers of subreads this raw read contained (<xref ref-type="fig" rid="fig02">Fig. 2<italic>C</italic></xref>). While mismatch errors declined rapidly with increasing number of subreads, insertion and deletion errors declined more slowly. This might be explained by insertion and deletion errors not being entirely random but systematically appearing in stretches of the same base, i.e., homopolymers (<xref rid="r8" ref-type="bibr">8</xref>). Indeed, 4-mers (&#x0201c;AAAA,&#x0201d; &#x0201c;CCCC,&#x0201d; &#x0201c;TTTT,&#x0201d; and &#x0201c;GGGG&#x0201d;) were enriched around insertion and deletion errors in R2C2 consensus reads (<ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/lookup/suppl/doi:10.1073/pnas.1806447115/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Fig. S1</ext-link>). Overall, more aggressive filtering of R2C2 reads based on raw read quality score and subread coverage could increase the median accuracy of the R2C2 method but would also reduce overall read output.</p></sec><sec id="s3"><title>R2C2 Correlates Well with PacBio for the Quantification of SIRV Transcripts.</title><p>Next, we wanted to test whether R2C2 reads could be used to identify and quantify transcript isoforms. The SIRV E2 (Lexogen) transcript isoform mix presents a challenging test case for transcript isoform identification and quantification. The SIRV E2 mix contains a total of 69 polyadenylated transcript isoforms which are between 0.3 and 2.5 kb in length and belong to seven artificial gene loci. These gene loci and their associated transcript isoforms were designed to mirror highly complex gene loci in mammalian genomes and include alternative splicing events, transcription start sites (TSSs), and polyA sites as well as antisense transcripts. Each transcript isoform is present at one of four different concentrations (&#x0201c;1/32,&#x0201d; &#x0201c;1/4,&#x0201d; &#x0201c;1,&#x0201d; &#x0201c;4&#x0201d;) spanning two orders of magnitude.</p><p>By analyzing the same SIRV E2 cDNA pools using R2C2 and PacBio IsoSeq we found that our R2C2 transcript counts generally matched nominal SIRV concentrations (<xref ref-type="fig" rid="fig03">Fig. 3<italic>A</italic></xref>). Additionally, there seems to be no clear length bias (<xref ref-type="fig" rid="fig03">Fig. 3<italic>B</italic></xref>), and our R2C2 transcript counts matched PacBio transcript counts very well with a Pearson correlation coefficient of 0.93 (<xref ref-type="fig" rid="fig03">Fig. 3<italic>C</italic></xref>). This indicates that the potential variations in transcript quantification seen in <xref ref-type="fig" rid="fig03">Fig. 3<italic>A</italic></xref> were either rooted in differences in the initial RNA concentration found in the SIRV E2 mix or biases of our modified Smart-seq2&#x02013;based cDNA amplification step rather than new biases introduced by the sequencing technology.</p><fig id="fig03" fig-type="figure" orientation="portrait" position="float"><label>Fig. 3.</label><caption><p>R2C2 reads can quantify SIRV transcripts. R2C2 reads were aligned to SIRV transcripts using minimap2, and expression values&#x02019; transcript abundance was determined as Reads Per Transcript Per 10,000 reads (RPT10K). The transcript count ratio was plotted on the <italic>y</italic> axis against the (<italic>A</italic>) nominal transcript abundance bin reported by the SIRV transcript manufacturer (Lexogen), (<italic>B</italic>) transcript length, and (<italic>C</italic>) transcript count ratio calculated from PacBio Isoseq reads. Pearson correlation coefficient (<italic>r</italic>) is reported in <italic>C</italic>. Each point represents a transcript and is colored according to its transcript abundance bin in all panels. (<italic>D</italic>) Genome browser view of Transcriptome annotation, isoforms identified by Mandalorion, and R2C2 consensus reads is shown of the indicated synthetic SIRV gene loci. Transcript and read direction are shown by colors (blue: +strand; yellow, &#x02212;strand).</p></caption><graphic id="gra3" xlink:href="pnas.1806447115fig03"/></fig></sec><sec id="s4"><title>R2C2 Enables Simple and Accurate Isoform Identification.</title><p>Next, we tested whether the increased accuracy of R2C2 reads would benefit splice junction and isoform identification. To this end, we aligned PacBio, ONT, and R2C2 reads to the artificial SIRVome sequence provided as a genome reference for their SIRV transcripts (<xref ref-type="fig" rid="fig03">Fig. 3<italic>D</italic></xref>). The percentage of splice sites detected in sequencing reads that matched annotated splice sites perfectly was 91.26% (95% CI: 91.2176&#x02013;91.2940%) for R2C2 consensus reads, far exceeding the 80.43% (95% CI: 80.1400&#x02013;80.7341%) for ONT 1D raw reads and approaching the 96.88% (95% CI: 96.8592&#x02013;96.9137%) for PacBio CCS reads.</p><p>This increased accuracy allowed us to simplify our Mandalorion pipeline for isoform identification (see <italic>Methods</italic>). To test how this updated version of Mandalorion would perform we subsampled R2C2 consensus read alignments to levels found in highly expressed genes in whole transcriptome analysis (500 read alignments per SIRV gene locus). Some of these subsampled R2C2 consensus reads did not align from end to end to a SIRV transcript (<xref ref-type="fig" rid="fig02">Fig. 2<italic>D</italic></xref>). We suspect they are products of cDNA synthesis of degraded RNA molecules likely caused by repeated freeze&#x02013;thaw cycles of the SIRV E2 standards, for they all contained complete 5&#x02032; and 3&#x02032; priming sites and adapter sequences. This highlighted the importance of RNA integrity for full-length transcriptome sequencing. Indeed, R2C2 reads created from single B cell lysates, which are thawed only once immediately before cDNA synthesis showed evidence of degradation products at much lower levels (<ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/lookup/suppl/doi:10.1073/pnas.1806447115/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Fig. S2</ext-link>).</p><p>Because these degradation products appear to be largely random, they had little effect on the Mandalorion pipeline. The SIRV E2 mix contains 69 transcript isoforms; 28 of these are present at high concentration (concentration bins &#x0201c;1&#x0201d; and &#x0201c;4&#x0201d;), while 40 are present at low concentration (concentration bins &#x0201c;1/4&#x0201d; and &#x0201c;1/32&#x0201d;). Based on subsampled R2C2 reads, Mandalorion identified 34 high-confidence isoforms (<xref ref-type="fig" rid="fig02">Fig. 2<italic>D</italic></xref>). Twenty-four of these isoforms matched one of the 29 annotated transcripts (83%) from the &#x0201c;1&#x0201d; and &#x0201c;4&#x0201d; concentration bins, while eight isoforms matched one of the 40 annotated transcripts (20%) from the &#x0201c;1/4&#x0201d; and &#x0201c;1/32&#x0201d; concentration bins. Two of 34 (5.6%) high-confidence isoforms represented truncated transcripts, caused by an oligo(dT) mispriming on an A-rich region of the SIRV303 transcript or a premature template switch on the (likely degraded) SIRV602 transcript, respectively. This indicated that R2C2 consensus reads paired with the Mandalorion pipeline can identify complex transcript isoforms. It also highlights the difficulty of correct identification of low-abundance transcript isoforms and the abiding problem of incomplete cDNA amplification.</p></sec><sec id="s5"><title>R2C2 Allows the Demultiplexing of 7- to 8-nt Cellular Indexes.</title><p>Next, we tested whether R2C2 reads are accurate enough to demultiplex reads based on short cellular indexes like those employed by 10x, Drop-Seq, or our own Tn5Prime single-cell RNAseq protocols. To this end, the SIRV cDNA we sequenced with the R2C2 method was indexed with eight distinct combinations of 7-nt [template switch oligo (TSO)] and 8-nt (Nextera adapter) indexes. We could confidently assign one 7-nt and one 8-nt index to 74% of R2C2 reads using a custom demultiplexing script based on Levenshtein distance between the observed sequence at the index position and our known input indexes. In 99.8% of these R2C2 reads the combination of assigned indexes matched one of the distinct combinations present in the cDNA pool. Next, we performed the same analysis on 1D reads. We could confidently assign one 7-nt and one 8-nt index to 22% of full-length 1D reads. In 92.9% of these 1D reads the combination of assigned indexes matched one of the distinct combinations present in the cDNA pool. This showed that demultiplexing 1D reads results in the loss of the majority of reads and introduces high levels of index crosstalk that would negatively affect downstream analysis. In contrast, the majority of R2C2 reads covering highly multiplexed cDNA could be accurately demultiplexed.</p></sec><sec id="s6"><title>Analysis of 96 Single B Cell Transcriptomes Using R2C2.</title><p>Having established that we could demultiplex our Tn5Prime data using R2C2 reads with very little crosstalk between samples, we sequenced cDNA from 96 single B cells, which we have recently analyzed using Illumina sequencing (<xref rid="r13" ref-type="bibr">13</xref>). To streamline the sequencing reaction, we used the ONT RAD4 (RAD004) kit, which has a lower average read output than the ligation-based 1D kit but has a much shorter sequencing library preparation protocol (&#x0223c;20 min) and, in our hands, more consistent and less error-prone workflow. Using the ONT RAD4 kit we generated 2,064,911 raw reads across four sequencing runs using R9.5 flow cells. C3POa generated 1,132,707 full-length R2C2 consensus reads which matched the length distribution of the sequenced cDNA closely (<xref ref-type="fig" rid="fig04">Fig. 4<italic>A</italic></xref>). Out of these 1,132,707 R2C2 consensus reads, 975,500 successfully aligned to the human genome, and 730,023 of those aligned reads were assigned to single B cells based on their 7-nt and 8-nt cellular indexes. We found that the vast majority of those reads were complete on the 5&#x02032; end by comparing the alignment ends of these reads to TSSs previously identified (<xref rid="r13" ref-type="bibr">13</xref>) using Illumina sequencing. Out of the 730,023 aligned and assigned reads, 653,410 (90%) either aligned to within 10 bp of a predicted TSS (604,940 reads) or aligned within a rearranged antibody locus (48,470 reads), which makes accurate read alignment impossible.</p><fig id="fig04" fig-type="figure" orientation="portrait" position="float"><label>Fig. 4.</label><caption><p>R2C2 length bias and gene expression quantification. (<italic>A</italic>) B cell cDNA molecule length distribution as determined by electrophoresis on 2% agarose gel is compared with R2C2 consensus read length distribution. (<italic>B</italic>) Pearson correlation coefficient (<italic>r</italic>) is shown for R2C2 and Illumina-based gene expression quantification of the same or different cells. Red lines indicate medians. All 96 correlation coefficients from same cell comparisons and 96 subsampled correlation coefficients from different cell comparisons are shown as a swarm plot to display their distributions. (<italic>C</italic>) t-SNE dimensional reduction plots of the same 96 B cells whose transcriptomes were quantified with either the Tn5Prime Illumina-based method or the R2C2 ONT-based method. Cells are colored based on the J chain expression, which is strongly associated with plasmablast cell identity.</p></caption><graphic id="gra4" xlink:href="pnas.1806447115fig04"/></fig></sec><sec id="s7"><title>R2C2 Quantifies Gene Expression in Single Human B Cells.</title><p>Individual cells were assigned 7,604 reads on average. We detected an average of 532 genes per cell (at least one R2C2 consensus read overlapping with the gene). Both the number of genes detected as well as gene expression quantification based on these R2C2 consensus reads closely matched RNAseq-based quantification (<xref rid="r13" ref-type="bibr">13</xref>). When comparing gene expression of the same cell, RNAseq and R2C2 quantification had a median Pearson correlation coefficient (<italic>r</italic>) of 0.79 opposed to 0.14 when comparing different cells with one another (<xref ref-type="fig" rid="fig04">Fig. 4<italic>B</italic></xref>). Using t-distributed stochastic neighbor embedding (t-SNE) clustering on R2C2 and Illumina data resulted in the subclustering of the same J chain-positive cells which we previously identified as plasmablasts (as opposed to memory B cells) (<xref ref-type="fig" rid="fig04">Fig. 4<italic>C</italic></xref>).</p></sec><sec id="s8"><title>R2C2 Identifies Isoforms in Single Human B Cells.</title><p>We used our updated Mandalorion pipeline to identify high-confidence isoforms separately for each of the 96 B cells we analyzed. By grouping R2C2 consensus reads based on their splice sites and alignment starts and ends, Mandalorion identified an average of 163 high-confidence isoforms per cell. We found that identification of high-confidence isoforms was dependent upon R2C2 consensus read coverage. We identified at least one isoform in 3.1%, 64.9%, and 92.2% of genes covered by 1&#x02013;4 reads, 5&#x02013;9 reads, or &#x0003e;10 reads, respectively. The vast majority of genes with &#x0003e;10 R2C2 consensus reads contained one (78%) or two (11%) isoforms, highlighting the low complexity of single-cell transcriptomes.</p><p>Overall, the isoforms we identified had a 99.1% sequence similarity with the human genome. As previously observed for mouse B1 cells (<xref rid="r7" ref-type="bibr">7</xref>), human B cells show a diverse array of isoforms across their surface receptors. CD37 and CD79B, which were expressed in several B cells, showed diverse isoforms. These isoforms were defined by (<italic>i</italic>) intron retention events (CD79B, Cell A12_T6; CD37, Cells A11_T2 and A17_T1), (<italic>ii</italic>) variable transcription start sites (TSSs) and alternatively spliced exons (CD79B, Cell A20_T2; CD37, Cell A17_T1), with the alternatively spliced exon being only partially annotated (<xref ref-type="fig" rid="fig05">Fig. 5</xref>).</p><fig id="fig05" fig-type="figure" orientation="portrait" position="float"><label>Fig. 5.</label><caption><p>R2C2 reads identify isoforms in B cell surface receptor genes. (<italic>A</italic>&#x02013;<italic>C</italic>) Genome browser views of Transcriptome annotation, isoforms (Iso) identified by Mandalorion, and R2C2 consensus reads (Reads) (<italic>C</italic> only, downsampled to 20 reads) are shown for CD79B (<italic>A</italic>), CD37 (<italic>B</italic>), and CD19 (<italic>C</italic>) gene loci. Transcript and read direction is shown by colors (blue, +strand; yellow, &#x02212;strand). Cell IDs are indicated by combinations of A and TSO (T) indexes. (<italic>C</italic>) CD19 exon numbers are indicated on the transcript annotation in white.</p></caption><graphic id="gra5" xlink:href="pnas.1806447115fig05"/></fig><p>Finally, for the B cell-defining CD19 receptors we also observed multiple isoforms across cells, which is of particular interest because CD19 is a target for CAR T cell therapy. Alternative splicing of CD19 has been shown to confer therapy resistance to B cell lymphomas. Interestingly, when we reference-corrected [sqanti-qc (<xref rid="r17" ref-type="bibr">17</xref>)] and translated the four isoforms we identified, only one contained the epitope required for FMC63-based CAR T cell therapy (<xref ref-type="fig" rid="fig05">Fig. 5</xref> and <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/lookup/suppl/doi:10.1073/pnas.1806447115/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Fig. S3</ext-link>) (<xref rid="r10" ref-type="bibr">10</xref>, <xref rid="r11" ref-type="bibr">11</xref>), which has been mapped to exon 4 (<xref rid="r12" ref-type="bibr">12</xref>).</p></sec></sec><sec sec-type="discussion" id="s9"><title>Discussion</title><p content-type="flushleft">While RNAseq analysis has fundamentally changed how transcriptional profiling is performed, it is ultimately a stop-gap solution born from the limitations of short-read sequencing technologies. The need to fragment transcripts to fit short-read technologies like Illumina results in often unsurmountable analysis challenges. As a result, RNAseq analysis is often used like gene expression microarrays with the data used for downstream analysis being gene expression values. Single-cell RNAseq has further exacerbated this limitation because it is often restricted to 3&#x02032; or 5&#x02032; tag counting and generates gene expression values that are sparse due to both biological and technical reasons.</p><p>This results in a loss of information because individual genes can express many different isoforms, often with different functions. However, many bulk and single-cell RNAseq methods do generate full-length cDNA as an intermediate product in library preparation. Long-read technology is able to take advantage of this full-length cDNA. While long-read sequencing technologies do not currently match Illumina&#x02019;s read output and accuracy, their outputs and accuracies are increasing. Here, we produced over 200,000 reads at close to 99% accuracy per run using the PacBio Sequel. Further, in our hands, the standard ONT 1D<sup>2</sup> protocol can generate one million 1D cDNA reads at 87% accuracy and 50,000 1D<sup>2</sup> reads at 95% accuracy in a single run. The ONT-based R2C2 sequencing method we developed takes advantage of this high throughput and increases ONT read accuracy. The R2C2 method we developed offers a compromise between PacBio and ONT technologies that generates on average 316,000 full-length cDNA reads at 94% accuracy in a single run. Further, because R2C2 relies on high-fidelity polymerases (Phi29 and KAPA HiFi polymerases are both reported to generate an error about 1/1,000,000 nucleotides), the accuracy of R2C2 consensus reads is almost entirely dependent on ONT-sequencing technology. Improvements in ONT MinION library preparation and sequencing kits will therefore directly benefit the R2C2 assay. Increasing read length and single pass base accuracy as well as combining R2C2 with an improved, more efficient 1D<sup>2</sup> library protocol will all increase R2C2 consensus read accuracy.</p><p>While the per-run cost of flow cells and reagents of PacBio and ONT are roughly comparable, the capital cost of the PacBio Sequel sequencer (&#x0223c;$300,000) vastly exceeds the cost of the ONT MinION (&#x0223c;$1,000). This effective lack of capital costs associated with the ONT-based R2C2 method results in much lower total cost of accurate full-length transcriptome analysis compared with the PacBio IsoSeq workflow (<ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/lookup/suppl/doi:10.1073/pnas.1806447115/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Table S2</ext-link>). Indeed, at its current throughput and accuracy and combined with the low cost of the ONT MinION we believe that R2C2 brings comprehensive full-length transcriptome analysis within reach of most molecular biology laboratories.</p><p>In the immediate future, the R2C2 method will be a suitable complement for short-read sequencing. To this end, the R2C2 can be easily adapted to any RNAseq library preparation protocol that produces full-length double-stranded cDNA molecules with known adapter/primer sequences at their ends. This includes standard Smart-seq2 and protocols requiring capped mRNA like the TeloPrime protocol (Lexogen) for bulk sample analysis. For single-cell analysis and in contrast to 1D reads, R2C2 reads will also likely be able to demultiplex reads in highly multiplexed cDNA pools generated by 10x Genomics and Drop-seq protocols.</p><p>Adapting R2C2 to these protocols only requires the generation of a compatible DNA splint by modifying the primers used for amplifying the DNA splint. The same cDNA pool can then be sequenced by both Illumina and R2C2 methods. However, cDNA generation protocols may have to be optimized to ensure R2C2 reads cover transcripts end-to-end. In this study, 80% of R2C2 reads generated from cDNA prepped with the Tn5Prime protocol from the (likely somewhat degraded) SIRV E2 mix aligned within 20 nt of both ends of SIRV transcripts and were therefore considered complete. Avoiding sample degradation, optimizing cDNA synthesis, and limiting amplification cycles is likely to increase this percentage.</p><p>We believe that R2C2 has the potential to replace short-read RNAseq and its shotgun approach to transcriptome analysis entirely, especially considering the impending wide release of the high-throughput ONT PromethION sequencer. This will be a significant advance, considering the strength of full-length transcriptome sequencing showcased here.</p><p>Using R2C2 we generated isoform-level transcriptomes for 96 B cells by analyzing a highly multiplexed pool of cDNA amplified using our Tn5Prime protocol. Generating isoform-level transcriptomes from these cells would have been possible using 1D reads and, to a more limited extent, short Illumina reads as well. However, this would have required each cell to be individually processed to introduce cellular indexes suitable for the respective technology. R2C2 therefore simplifies large-scale single-cell workflows by enabling the analysis of highly multiplexed full-length cDNA generated originally for Illumina-based transcript-end tag counting.</p><p>We used Mandalorion to analyze the R2C2 reads of the 96 B cells and identified several surface receptor isoforms of CD79B, CD37, and CD19 expressed by 96 distinct single human B cells. The CD19 RNA isoforms we identified in the single B cells may have implications regarding immunotherapy efficacy because they confirmed that the epitope targeted by FMC63-based CAR T cell therapy and located on exon 4 is not included in all CD19 transcript isoforms. This implies that even healthy individuals contain RNA isoform diversity for CD19, which may ultimately contribute to immunotherapy resistance when undergoing FMC63-based CAR T cell therapy (<xref rid="r10" ref-type="bibr">10</xref>, <xref rid="r11" ref-type="bibr">11</xref>). Going forward, full-length cDNA sequencing could be employed to identify truly constitutive exons and epitopes for targeting by immunotherapy.</p></sec><sec sec-type="materials|methods" id="s10"><title>Materials and Methods</title><p content-type="flushleft">All study protocols were approved by the Institutional Review Board at University of California, Santa Cruz (UCSC). A blood sample of a fully consented healthy adult was collected at UCSC. The sample was deidentified upon collection. B cells were isolated by FACS (<xref rid="r13" ref-type="bibr">13</xref>). RNA and cell lysates were amplified using the Tn5Prime (<xref rid="r13" ref-type="bibr">13</xref>) method, which represents a modification of the Smart-seq2 (<xref rid="r18" ref-type="bibr">18</xref>, <xref rid="r19" ref-type="bibr">19</xref>) method. Briefly, 100 pg of SIRV E2 (Lexogen) RNA or single B cell lysates were reverse-transcribed (RT) using Smartscribe Reverse Transcriptase (Clontech) in a 10-&#x003bc;L reaction including an oligo(dT) primer and a Nextera A TSO containing a 7-nt sample index (<ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/lookup/suppl/doi:10.1073/pnas.1806447115/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Table S3</ext-link>). RT was performed for 60 min at 42 &#x000b0;C. The resulting cDNA was treated with 1 &#x003bc;L of 1:10 dilutions of RNase A (Thermo) and Lambda Exonuclease New England Biolabs (NEB) for 30 min at 37 &#x000b0;C. The treated cDNA was then amplified using KAPA HiFi Readymix 2x (KAPA) and incubated at 95 &#x000b0;C for 3 min, followed by 15 cycles for SIRV RNA or 27 cycles (single B cells) of 98 &#x000b0;C for 20 s, 67 &#x000b0;C for 15 s, and 72 &#x000b0;C for 4 min, with a final extension at 72 &#x000b0;C for 5 min. cDNA amplification requires both the ISPCR primer and a Nextera A Index primer, which contains another 8-nt sample index.</p><sec id="s11"><title>SIRV RNA.</title><p>Eight SIRV E2 RNA aliquots were reverse-transcribed and amplified in separate reactions, adding distinct 7-nt TSO and 8-nt Nextera A indexes to each resulting cDNA aliquot. The separate aliquots were used directly as input into our R2C2 method or amplified using KAPA HiFi Readymix 2x (KAPA) (95 &#x000b0;C for 3 min, followed by 15 cycles; 98 &#x000b0;C for 20 s, 67 &#x000b0;C for 15 s, and 72 &#x000b0;C for 4 min), with a final extension at 72 &#x000b0;C for 5 min with ISPCR and Nextera_A_Universal primers and pooled at equal amounts for input into PacBio Iso-Seq pipeline at the University of Georgia sequencing core.</p></sec><sec id="s12"><title>Single B Cell Lysates.</title><p>Single B cells, each cell in a separate well of a 96-well plate, were reverse-transcribed using a distinct 7-nt TSO index for each row. Columns were then pooled and amplified using a distinct 8-nt Nextera A index for each pool. This resulted in the cDNA of all 96 cells carrying a unique combination of TSO and Nextera A index. This cDNA was then pooled for Illumina sequencing (HiSeq4000 2 &#x000d7; 150) (<xref rid="r13" ref-type="bibr">13</xref>) or amplified using KAPA HiFi Readymix 2x (KAPA) [95 &#x000b0;C for 3 min, followed by 15 cycles (98 &#x000b0;C for 20 s, 67 &#x000b0;C for 15 s, and 72 &#x000b0;C for 4 min)], with a final extension at 72 &#x000b0;C for 5 min with ISPCR and Nextera_A_Universal primers. The amplified cDNA was used for input into our R2C2 method.</p></sec><sec id="s13"><title>DNA Splint Amplification.</title><p>An &#x0223c;200-bp DNA splint to enable Gibson Assembly (<xref rid="r20" ref-type="bibr">20</xref>) circularization of cDNA was amplified from Lambda DNA using KAPA HiFi Readymix 2x (KAPA) (95 &#x000b0;C for 3 min, followed by 25 cycles; 98 &#x000b0;C for 20 s, 67 &#x000b0;C for 15 s, and 72 &#x000b0;C for 30 s) using primer Lambda_F_ISPCR (RC) and Lambda_R_NextA (RC) (<ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/lookup/suppl/doi:10.1073/pnas.1806447115/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Table S3</ext-link>). This generated a double-stranded DNA with matching overlaps to full-length cDNA.</p></sec><sec id="s14"><title>R2C2 Sample Preparation.</title><sec id="s15"><title>Circularization of cDNA.</title><p>Two hundred nanograms of cDNA was mixed with 200 ng of DNA splint. Volume was adjusted to 6 &#x003bc;L, and 6 &#x003bc;L of 2x NEBuilder HiFi DNA Assembly Master Mix (NEB) was added. The reaction was incubated for 60 min at 55 &#x000b0;C. Volume was adjusted to 20 &#x003bc;L, and noncircularized DNA was digested using 1 &#x003bc;L of 1:10 Exonuclease III and Lambda Exonuclease as well as 1 &#x003bc;L of Exonuclease I (all NEB). Circularized DNA was extracted using Solid Phase Reversible Immobilization (SPRI) beads with a size cutoff to eliminate DNA &#x0003c;500 bp (0.8 beads:1 sample) and eluted in 50 &#x003bc;L of ultrapure water.</p></sec><sec id="s16"><title>Rolling circle amplification.</title><p>Circularized DNA was split into five aliquots of 10 &#x003bc;L, and each aliquot was amplified in its own 50-&#x003bc;L reaction containing Phi29 polymerase (NEB) and exonuclease resistant random hexamers (Thermo) [5 &#x003bc;L of 10&#x000d7; Phi29 Buffer, 2.5 &#x003bc;L of 10 uM (each) dNTPs, 2.5 &#x003bc;L random hexamers (10 uM), 10 &#x003bc;L of DNA, 29 &#x003bc;L ultrapure water, 1 &#x003bc;L of Phi29]. Reactions were incubated at 30 &#x000b0;C overnight. All reactions were pooled, and volume was adjusted to 300 &#x003bc;L with ultrapure water. DNA was extracted using SPRI beads with a size cutoff to eliminate DNA &#x0003c;2,000 bp (0.5 beads:1 sample). A mix of 90 &#x003bc;L of ultrapure water, 10 &#x003bc;L NEB buffer 2, and 5 &#x003bc;L T7 Endonuclease was added to the beads to elute and debranch the DNA. Beads were incubated for 2 h on a thermal shaker at 37 &#x000b0;C under constant agitation. The tubes containing the beads were then placed on magnets, and supernatant was recovered. The DNA in the supernatant was then extracted again using SPRI beads with a size cutoff to eliminate DNA &#x0003c;2,000 bp (0.5 beads:1 sample) and eluted in 15 &#x003bc;L of ultrapure water.</p></sec><sec id="s17"><title>ONT sequencing.</title><p>SIRV E2 RCA product was sequenced using the ONT 1D sample prep kit and a single 9.5 flow cell according to manufacturer&#x02019;s instructions with the exception that DNA was not sheared before library preparation. Single B cell RCA product was sequenced using the ONT RAD4 kit and four 9.5 flow cells. The resulting raw data were base-called using the albacore (version 2.1.3) read_fast5_basecaller script.</p></sec></sec><sec id="s18"><title>C3POa Data Processing.</title><sec id="s19"><title>Preprocessing.</title><p>Base-called raw reads underwent preprocessing to shorten read names and remove short (&#x0003c;1,000 kb) and low-quality (Q &#x0003c; 9) reads. Raw reads were first analyzed using BLAT (<xref rid="r14" ref-type="bibr">14</xref>) to detect DNA splint sequences. If one or more splint sequences were detected in a raw read, the raw read underwent consensus calling.</p></sec><sec id="s20"><title>Consensus calling.</title><p>The following steps are performed to generate a consensus sequence:</p><p>(<italic>i</italic>) Tandem repeats in each raw read are detected using a modified EMBOSS WATER (<xref rid="r21" ref-type="bibr">21</xref><xref rid="r22" ref-type="bibr"/>&#x02013;<xref rid="r23" ref-type="bibr">23</xref>) Smith&#x02013;Waterman self-to-self alignment. (<italic>ii</italic>) Raw reads are then split into complete subreads containing full repeats and incomplete subreads containing partial repeats at the read ends. If there is more than one complete subread, a preliminary consensus of these complete subreads is computed using poaV2 (<xref rid="r15" ref-type="bibr">15</xref>). If only one complete subread is present in the raw read, its sequence is used as consensus in the following steps. (<italic>iii</italic>) Complete and incomplete subreads are aligned to the preliminary consensus sequence using minimap2 (<xref rid="r24" ref-type="bibr">24</xref>). (<italic>iv</italic>) These alignments are used as input to the racon (<xref rid="r16" ref-type="bibr">16</xref>) algorithm, which error-corrects the consensus. To speed up consensus calling, we divided raw reads into bins of 4,000 and used GNU Parallel (<xref rid="r25" ref-type="bibr">25</xref>) to run multiple instances of C3POa.py.</p></sec><sec id="s21"><title>Postprocessing.</title><p>ISPCR and Nextera Sequences are identified by BLAT, and the read is trimmed to their positions and reoriented to 5&#x02032; &#x02192; 3&#x02032;.</p></sec><sec id="s22"><title>Alignment.</title><p>Trimmed, full-length R2C2 reads and PacBio reads are aligned to the appropriate genomes and transcripts using minimap2. Percent identity of sequencing reads were calculated from minimap2 alignments. For isoform identification and visualization, SAM files were converted to PSL file format using the jvarkit sam2psl (<xref rid="r26" ref-type="bibr">26</xref>) script.</p></sec><sec id="s23"><title>Isoform identification and quantification.</title><p>Isoforms were identified and quantified using an updated version of the Mandalorion pipeline (EII)</p></sec><sec id="s24"><title>Availability.</title><p>C3POa and Mandalorion will be available at github under <ext-link ext-link-type="uri" xlink:href="https://github.com/rvolden/C3POa" xlink:show="new">https://github.com/rvolden/C3POa</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/rvolden/Mandalorion-Episode-II" xlink:show="new">https://github.com/rvolden/Mandalorion-Episode-II</ext-link>, respectively.</p><p>Raw read data will be available upon publication at the SRA under PRJNA448331 (SIRV E2) and PRJNA415475 (B cells).</p></sec></sec></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data"><label>Supplementary File</label><media xlink:href="pnas.1806447115.sapp.pdf"/></supplementary-material></sec></body><back><ack><p>We thank the Georgia Genomics and Bioinformatics Core (GGBC) for PacBio Sequencing Services. We acknowledge funding from the 2017 Hellman Fellowship (to C.V.) and the National Human Genome Research Institute/National Institute of Health Training Grant 1T32HG008345-01 (to A.B. and C.C.).</p></ack><fn-group><fn fn-type="COI-statement"><p>Conflict of interest statement: C.V., R.E.G., T.P., and R.V. have filed a provisional patent on the methodology described in the paper. The other authors have nothing to declare.</p></fn><fn fn-type="other"><p>This article is a PNAS Direct Submission.</p></fn><fn fn-type="other"><p>Data deposition: The sequences reported in this paper have been deposited in the Sequence Read Archive database (accession nos. <ext-link ext-link-type="NCBI:sra" xlink:href="PRJNA448331" xlink:show="new">PRJNA448331</ext-link> and <ext-link ext-link-type="NCBI:sra" xlink:href="PRJNA415475" xlink:show="new">PRJNA415475</ext-link>).</p></fn><fn fn-type="supplementary-material"><p>This article contains supporting information online at <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/lookup/suppl/doi:10.1073/pnas.1806447115/-/DCSupplemental" xlink:show="new">www.pnas.org/lookup/suppl/doi:10.1073/pnas.1806447115/-/DCSupplemental</ext-link>.</p></fn></fn-group><ref-list><ref id="r1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mortazavi</surname><given-names>A</given-names></name><name name-style="western"><surname>Williams</surname><given-names>BA</given-names></name><name name-style="western"><surname>McCue</surname><given-names>K</given-names></name><name name-style="western"><surname>Schaeffer</surname><given-names>L</given-names></name><name name-style="western"><surname>Wold</surname><given-names>B</given-names></name></person-group><year>2008</year><article-title>Mapping and quantifying mammalian transcriptomes by RNA-seq</article-title><source>Nat Methods</source><volume>5</volume><fpage>621</fpage><lpage>628</lpage><pub-id pub-id-type="pmid">18516045</pub-id></element-citation></ref><ref id="r2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tilgner</surname><given-names>H</given-names></name><etal/></person-group><year>2015</year><article-title>Comprehensive transcriptome analysis using synthetic long-read sequencing reveals molecular co-association of distant splicing events</article-title><source>Nat Biotechnol</source><volume>33</volume><fpage>736</fpage><lpage>742</lpage><pub-id pub-id-type="pmid">25985263</pub-id></element-citation></ref><ref id="r3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tilgner</surname><given-names>H</given-names></name><etal/></person-group><year>2017</year><article-title>Microfluidic isoform sequencing shows widespread splicing coordination in the human transcriptome</article-title><source>Genome Res</source><volume>28</volume><fpage>231</fpage><lpage>242</lpage><pub-id pub-id-type="pmid">29196558</pub-id></element-citation></ref><ref id="r4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sharon</surname><given-names>D</given-names></name><name name-style="western"><surname>Tilgner</surname><given-names>H</given-names></name><name name-style="western"><surname>Grubert</surname><given-names>F</given-names></name><name name-style="western"><surname>Snyder</surname><given-names>M</given-names></name></person-group><year>2013</year><article-title>A single-molecule long-read survey of the human transcriptome</article-title><source>Nat Biotechnol</source><volume>31</volume><fpage>1009</fpage><lpage>1014</lpage><pub-id pub-id-type="pmid">24108091</pub-id></element-citation></ref><ref id="r5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shi</surname><given-names>L</given-names></name><etal/></person-group><year>2016</year><article-title>Long-read sequencing and de novo assembly of a Chinese genome</article-title><source>Nat Commun</source><volume>7</volume><fpage>12065</fpage><pub-id pub-id-type="pmid">27356984</pub-id></element-citation></ref><ref id="r6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kuo</surname><given-names>RI</given-names></name><etal/></person-group><year>2017</year><article-title>Normalized long read RNA sequencing in chicken reveals transcriptome complexity similar to human</article-title><source>BMC Genomics</source><volume>18</volume><fpage>323</fpage><pub-id pub-id-type="pmid">28438136</pub-id></element-citation></ref><ref id="r7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Byrne</surname><given-names>A</given-names></name><etal/></person-group><year>2017</year><article-title>Nanopore long-read RNAseq reveals widespread transcriptional variation among the surface receptors of individual B cells</article-title><source>Nat Commun</source><volume>8</volume><fpage>16027</fpage><pub-id pub-id-type="pmid">28722025</pub-id></element-citation></ref><ref id="r8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Oikonomopoulos</surname><given-names>S</given-names></name><name name-style="western"><surname>Wang</surname><given-names>YC</given-names></name><name name-style="western"><surname>Djambazian</surname><given-names>H</given-names></name><name name-style="western"><surname>Badescu</surname><given-names>D</given-names></name><name name-style="western"><surname>Ragoussis</surname><given-names>J</given-names></name></person-group><year>2016</year><article-title>Benchmarking of the Oxford Nanopore MinION sequencing for quantitative and qualitative assessment of cDNA populations</article-title><source>Sci Rep</source><volume>6</volume><fpage>31602</fpage><pub-id pub-id-type="pmid">27554526</pub-id></element-citation></ref><ref id="r9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>C</given-names></name><etal/></person-group><year>2016</year><article-title>INC-seq: Accurate single molecule reads using nanopore sequencing</article-title><source>Gigascience</source><volume>5</volume><fpage>34</fpage><pub-id pub-id-type="pmid">27485345</pub-id></element-citation></ref><ref id="r10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sotillo</surname><given-names>E</given-names></name><etal/></person-group><year>2015</year><article-title>Convergence of acquired mutations and alternative splicing of CD19 enables resistance to CART-19 immunotherapy</article-title><source>Cancer Discov</source><volume>5</volume><fpage>1282</fpage><lpage>1295</lpage><pub-id pub-id-type="pmid">26516065</pub-id></element-citation></ref><ref id="r11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fischer</surname><given-names>J</given-names></name><etal/></person-group><year>2017</year><article-title>CD19 isoforms enabling resistance to CART-19 immunotherapy are expressed in B-ALL patients at initial diagnosis</article-title><source>J Immunother</source><volume>40</volume><fpage>187</fpage><lpage>195</lpage><pub-id pub-id-type="pmid">28441264</pub-id></element-citation></ref><ref id="r12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sommermeyer</surname><given-names>D</given-names></name><etal/></person-group><year>2017</year><article-title>Fully human CD19-specific chimeric antigen receptors for T-cell therapy</article-title><source>Leukemia</source><volume>31</volume><fpage>2191</fpage><lpage>2199</lpage><pub-id pub-id-type="pmid">28202953</pub-id></element-citation></ref><ref id="r13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cole</surname><given-names>C</given-names></name><name name-style="western"><surname>Byrne</surname><given-names>A</given-names></name><name name-style="western"><surname>Beaudin</surname><given-names>AE</given-names></name><name name-style="western"><surname>Forsberg</surname><given-names>EC</given-names></name><name name-style="western"><surname>Vollmers</surname><given-names>C</given-names></name></person-group><year>2018</year><article-title>Tn5Prime, a Tn5 based 5&#x02032; capture method for single cell RNA-seq</article-title><source>Nucleic Acids Res</source><volume>46</volume><fpage>e62</fpage><pub-id pub-id-type="pmid">29548006</pub-id></element-citation></ref><ref id="r14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kent</surname><given-names>WJ</given-names></name></person-group><year>2002</year><article-title>BLAT&#x02013;The BLAST-like alignment tool</article-title><source>Genome Res</source><volume>12</volume><fpage>656</fpage><lpage>664</lpage><pub-id pub-id-type="pmid">11932250</pub-id></element-citation></ref><ref id="r15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>C</given-names></name><name name-style="western"><surname>Grasso</surname><given-names>C</given-names></name><name name-style="western"><surname>Sharlow</surname><given-names>MF</given-names></name></person-group><year>2002</year><article-title>Multiple sequence alignment using partial order graphs</article-title><source>Bioinformatics</source><volume>18</volume><fpage>452</fpage><lpage>464</lpage><pub-id pub-id-type="pmid">11934745</pub-id></element-citation></ref><ref id="r16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vaser</surname><given-names>R</given-names></name><name name-style="western"><surname>Sovi&#x00107;</surname><given-names>I</given-names></name><name name-style="western"><surname>Nagarajan</surname><given-names>N</given-names></name><name name-style="western"><surname>&#x00160;iki&#x00107;</surname><given-names>M</given-names></name></person-group><year>2017</year><article-title>Fast and accurate de novo genome assembly from long uncorrected reads</article-title><source>Genome Res</source><volume>27</volume><fpage>737</fpage><lpage>746</lpage><pub-id pub-id-type="pmid">28100585</pub-id></element-citation></ref><ref id="r17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tardaguila</surname><given-names>M</given-names></name><etal/></person-group><year>2018</year><article-title>SQANTI: Extensive characterization of long read transcript sequences for quality control in full-length transcriptome identification and quantification</article-title><source>Genome Res</source><volume>28</volume><fpage>396</fpage><lpage>411</lpage></element-citation></ref><ref id="r18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Picelli</surname><given-names>S</given-names></name><etal/></person-group><year>2014</year><article-title>Full-length RNA-seq from single cells using Smart-seq2</article-title><source>Nat Protoc</source><volume>9</volume><fpage>171</fpage><lpage>181</lpage><pub-id pub-id-type="pmid">24385147</pub-id></element-citation></ref><ref id="r19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Picelli</surname><given-names>S</given-names></name><etal/></person-group><year>2014</year><article-title>Tn5 transposase and tagmentation procedures for massively scaled sequencing projects</article-title><source>Genome Res</source><volume>24</volume><fpage>2033</fpage><lpage>2040</lpage><pub-id pub-id-type="pmid">25079858</pub-id></element-citation></ref><ref id="r20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gibson</surname><given-names>DG</given-names></name><etal/></person-group><year>2009</year><article-title>Enzymatic assembly of DNA molecules up to several hundred kilobases</article-title><source>Nat Methods</source><volume>6</volume><fpage>343</fpage><lpage>345</lpage><pub-id pub-id-type="pmid">19363495</pub-id></element-citation></ref><ref id="r21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>W</given-names></name><etal/></person-group><year>2015</year><article-title>The EMBL-EBI bioinformatics web and programmatic tools framework</article-title><source>Nucleic Acids Res</source><volume>43</volume><fpage>W580</fpage><lpage>W584</lpage><pub-id pub-id-type="pmid">25845596</pub-id></element-citation></ref><ref id="r22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McWilliam</surname><given-names>H</given-names></name><etal/></person-group><year>2013</year><article-title>Analysis tool web services from the EMBL-EBI</article-title><source>Nucleic Acids Res</source><volume>41</volume><fpage>W597</fpage><lpage>W600</lpage><pub-id pub-id-type="pmid">23671338</pub-id></element-citation></ref><ref id="r23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rice</surname><given-names>P</given-names></name><name name-style="western"><surname>Longden</surname><given-names>I</given-names></name><name name-style="western"><surname>Bleasby</surname><given-names>A</given-names></name></person-group><year>2000</year><article-title>EMBOSS: The European molecular biology open software suite</article-title><source>Trends Genet</source><volume>16</volume><fpage>276</fpage><lpage>277</lpage><pub-id pub-id-type="pmid">10827456</pub-id></element-citation></ref><ref id="r24"><label>24</label><element-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name></person-group><year>2017</year><comment>Minimap2: Fast pairwise alignment for long nucleotide sequences. arXiv:1708.01492. Preprint, posted March 16, 2018</comment></element-citation></ref><ref id="r25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tange</surname><given-names>O</given-names></name><etal/></person-group><year>2011</year><article-title>Gnu parallel: The command-line power tool</article-title><source>USENIX Mag</source><volume>36</volume><fpage>42</fpage><lpage>47</lpage></element-citation></ref><ref id="r26"><label>26</label><element-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Lindenbaum</surname><given-names>P</given-names></name></person-group><year>2015</year><comment>Data from &#x0201c;JVarkit: Java-based utilities for bioinformatics.&#x0201d; Figshare. 10.6084/m9.figshare.1425030.v1</comment></element-citation></ref></ref-list></back></article>