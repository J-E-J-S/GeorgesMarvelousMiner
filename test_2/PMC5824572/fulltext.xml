<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id><journal-title-group><journal-title>BMC Genomics</journal-title></journal-title-group><issn pub-type="epub">1471-2164</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">5824572</article-id><article-id pub-id-type="publisher-id">4546</article-id><article-id pub-id-type="doi">10.1186/s12864-018-4546-8</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology Article</subject></subj-group></article-categories><title-group><article-title>A maximum likelihood algorithm for reconstructing 3D structures of human chromosomes from chromosomal contact data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Oluwadare</surname><given-names>Oluwatosin</given-names></name><address><email>oeow39@mail.missouri.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Yuxiang</given-names></name><address><email>yzmk7@mail.missouri.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Cheng</surname><given-names>Jianlin</given-names></name><address><email>chengji@missouri.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2162 3504</institution-id><institution-id institution-id-type="GRID">grid.134936.a</institution-id><institution>Electrical Engineering &#x00026; Computer Science Department, </institution><institution>University of Missouri, </institution></institution-wrap>Columbia, MO 65211 USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2162 3504</institution-id><institution-id institution-id-type="GRID">grid.134936.a</institution-id><institution>Informatics Institute, </institution><institution>University of Missouri, </institution></institution-wrap>Columbia, MO 65211 USA </aff></contrib-group><pub-date pub-type="epub"><day>23</day><month>2</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>23</day><month>2</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>19</volume><elocation-id>161</elocation-id><history><date date-type="received"><day>4</day><month>5</month><year>2017</year></date><date date-type="accepted"><day>13</day><month>2</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s). 2018</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p id="Par1">The development of chromosomal conformation capture techniques, particularly, the Hi-C technique, has made the analysis and study of the spatial conformation of a genome an important topic in bioinformatics and computational biology. Aided by high-throughput next generation sequencing techniques, the Hi-C technique can generate genome-wide, large-scale intra- and inter-chromosomal interaction data capable of describing in details the spatial interactions within a genome. These data can be used to reconstruct 3D structures of chromosomes that can be used to study DNA replication, gene regulation, genome interaction, genome folding, and genome function.</p></sec><sec><title>Results</title><p id="Par2">Here, we introduce a maximum likelihood algorithm called 3DMax to construct the 3D structure of a chromosome from Hi-C data.&#x000a0;3DMax employs a maximum likelihood approach to infer the 3D structures of a chromosome, while automatically re-estimating the conversion factor (&#x003b1;) for converting Interaction Frequency (IF) to distance. Our results show that the models generated by 3DMax from a simulated Hi-C dataset match the true models better than most of the existing methods. 3DMax is more robust to structural variability and noise. Compared on a real Hi-C dataset, 3DMax constructs chromosomal models that fit the data better than most methods, and it is faster than all other methods. The models reconstructed by 3DMax were consistent with fluorescent in situ hybridization (FISH) experiments and existing knowledge about the organization of human chromosomes, such as chromosome compartmentalization.</p></sec><sec><title>Conclusions</title><p id="Par3">3DMax is an effective approach to reconstructing 3D chromosomal models. The results, and the models generated for the simulated and real Hi-C datasets are available here: <ext-link ext-link-type="uri" xlink:href="http://sysbio.rnet.missouri.edu/bdm_download/3DMax/">http://sysbio.rnet.missouri.edu/bdm_download/3DMax/</ext-link>. The source code is available here: <ext-link ext-link-type="uri" xlink:href="https://github.com/BDM-Lab/3DMax">https://github.com/BDM-Lab/3DMax</ext-link>. A short video demonstrating how to use 3DMax can be found here: <ext-link ext-link-type="uri" xlink:href="https://youtu.be/ehQUFWoHwfo">https://youtu.be/ehQUFWoHwfo</ext-link>.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Hi-C</kwd><kwd>3D chromosome structure</kwd><kwd>Gradient ascent</kwd><kwd>Chromosome conformation capture</kwd><kwd>3D genome</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>DBI1149224</award-id><principal-award-recipient><name><surname>Cheng</surname><given-names>Jianlin</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p id="Par15">A set of all chromosomes within the nucleus of a eukaryotic cell constitutes its genome. Studies of the organization of chromosomes and genomes reveal that they are structurally organized within a cell [<xref ref-type="bibr" rid="CR1">1</xref>&#x02013;<xref ref-type="bibr" rid="CR3">3</xref>]. Studies find that this organization influences many biological mechanisms such as DNA replication, DNA repair, DNA translocation, gene regulation, transcription efficiency, genome interpretation, epigenetic modification, and genome stability maintenance [<xref ref-type="bibr" rid="CR1">1</xref>&#x02013;<xref ref-type="bibr" rid="CR4">4</xref>]. The fluorescent in situ hybridization (FISH) [<xref ref-type="bibr" rid="CR5">5</xref>] was often used in the investigation of the three-dimensional (3D) organization of a genome, but it cannot produce the layout of the genome structure at a large scale. The chromosome conformation capturing techniques such as 3C [<xref ref-type="bibr" rid="CR6">6</xref>], 4C [<xref ref-type="bibr" rid="CR7">7</xref>], 5C [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>], and Hi-C [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>] were developed to analyze the spatial organization of chromatin in a cell at a larger scale. The Hi-C technique can use next generation DNA sequencing to determine genome-wide spatial chromosomal interactions.</p><p id="Par16">Much progress has been made in recent years on the study of chromosome and genome 3D structure modeling. Several methods have been proposed to construct the structure of an individual chromosome or an entire genome from chromosome conformation capturing data [<xref ref-type="bibr" rid="CR12">12</xref>&#x02013;<xref ref-type="bibr" rid="CR24">24</xref>]. Some of these methods perform chromosome/genome 3D structure modeling in a two-step process, which involves converting interaction frequencies (IF) between fragment pairs in Hi-C data to distances between them, and then inferring the 3D structures that best satisfies the distances. Methods that implement this two-step process are known as distance restraint-based methods. Several of such methods have been proposed, each of which varies in restraint representation and optimization methods adopted [<xref ref-type="bibr" rid="CR14">14</xref>&#x02013;<xref ref-type="bibr" rid="CR24">24</xref>].</p><p id="Par17">In [<xref ref-type="bibr" rid="CR12">12</xref>], Duan et al. considered the genome 3D structure prediction problem as a constrained non-convex optimization problem, and hence used an optimization solver (open-source software) IPOPT [<xref ref-type="bibr" rid="CR25">25</xref>] to solve it. Bau et al. [<xref ref-type="bibr" rid="CR13">13</xref>] also treated the 3D modeling problem as an optimization problem, and used the Integrated Modeling Platform (IMP) [<xref ref-type="bibr" rid="CR26">26</xref>] to construct 3D structure models. The MCMC5C [<xref ref-type="bibr" rid="CR14">14</xref>] method designed a probabilistic model for the interaction frequency (contact) data, and thereafter used a Markov Chain Monte Carlo (MCMC) approach to generate a representative structure from the data. ChromSDE [<xref ref-type="bibr" rid="CR16">16</xref>] formulated the 3D structure modeling problem as a non-convex non-linear optimization problem, but then relaxed it as a semi-definite programming (SDP) problem. Bayesian 3D constructor (BACH) [<xref ref-type="bibr" rid="CR17">17</xref>] is another method that employs MCMC to infer the 3D structure by maximizing the likelihood of the observed Hi-C data following a Poisson regression approach. MOGEN [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] is a contact based method that is different from the rest, because it does not require the conversion of interaction frequencies to distances before structure construction. ShRec3D [<xref ref-type="bibr" rid="CR24">24</xref>] is a two-step algorithm that uses the shortest path algorithm to realize chromosome structure construction. LorDG [<xref ref-type="bibr" rid="CR27">27</xref>] uses a Lorentzian objective function to construct the 3D model of a chromosome or genome. Despite the significant progress made over the years, some of the distance-based chromosome structure modeling methods have several limitations: they may simply assume that the parameters used for converting interaction frequencies to distances are independent of input data and therefore are fixed for different datasets [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR19">19</xref>], they may converge slowly (common for Markov chain Monte Carlo (MCMC) approach [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]), and they sometimes require to adjust quite a few parameters [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR22">22</xref>], making it difficult to use.</p><p id="Par18">In this paper, we introduce a new method called 3DMax that uses a maximum likelihood approach to infer the 3D structures of a chromosome from Hi-C data. In the 3DMax algorithm, the conversion factor (&#x003b1;) parameter to convert IF to its distance equivalent is determined automatically from the data. We show that 3DMax is relatively faster than most of the existing methods, and it only depends on optimizing the structural coordinate of predicted models through the least square residuals. 3DMax is capable of translating contact data of a chromosome, or genome into an ensemble of probable 3D conformations to approximate the dynamic 3D genome structures of a population of cells of the same type. Our experiment also demonstrates how parameters such as the learning rate and the convergence constant (epsilon) can impact the performance of a constructed model. We also demonstrate the effect of using different normalization method on the different chromosome 3D structure prediction algorithms. We benchmarked 3DMax with several popular methods [<xref ref-type="bibr" rid="CR13">13</xref>&#x02013;<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR19">19</xref>], and the result showed that our method performed robustly in the presence of noise and structural variability. We applied our method to a synthetic chromosomal interaction dataset, and two experimentally generated Hi-C datasets: a karyotypically normal human lymphoblastic cell line (GM06990) and a malignant B-cell. We used the data from FISH experiments available for the cell lines as independent validations of the reconstructed 3D chromatin structures. We performed a comparative analysis of the performance of 3DMax and several existing 3D reconstruction methods on the Hi-C datasets normalized by three commonly used methods [<xref ref-type="bibr" rid="CR30">30</xref>&#x02013;<xref ref-type="bibr" rid="CR32">32</xref>]. These experiments show that 3DMax is an effective method for reconstructing 3D chromosomal structures from Hi-C data.</p></sec><sec id="Sec2"><title>Methods</title><p id="Par19">Generally, before Hi-C data [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>] are used for model construction, they are converted to a matrix form known as a contact matrix or a contact map.</p><sec id="Sec3"><title>Chromosome contact map</title><p id="Par20">A chromosome contact map is a N * N matrix, extracted from a Hi-C data, showing the number of interactions between chromosomal regions. The size of the matrix (N) is the number of equal-size regions of a chromosome. The length of equal-size regions (e.g. 1&#x000a0;Mb base pair) is called resolution. Each entry in the matrix contains a count of read pairs that connect two corresponding chromosome regions in a Hi-C experiment. Therefore, the chromosome contact matrix represents all the observed interactions between the regions (or bins) in a chromosome. The 3DMax algorithm takes as input a contact map to build the 3D structure of a chromosome.</p></sec><sec id="Sec4"><title>Structure initialization</title><p id="Par21">To structurally represent a chromosome, each of its regions (or bins) is represented by three coordinates (<italic>x, y, z</italic>) in 3D space. In 3DMax, the structure construction starts with a random initialization of the coordinates of all the regions such that they are in the range [&#x02212;&#x02009;0.5, 0.5] as in [<xref ref-type="bibr" rid="CR19">19</xref>].</p></sec><sec id="Sec5"><title>Maximum likelihood objective function of a chromosome structure</title><p id="Par22">We used a log likelihood function as an objective function to compute chromosome structures from a contact map.</p><p id="Par23">Let S stand for a 3D chromosome structure, and D represent the contact matrix data derived from a Hi-C dataset. The likelihood of S, P(D|S), can be expressed as the product of the probabilities of individual data points (interaction frequencies or distances) in D conditioned on the structure S, if the data points are conditionally independent of each other given a S. In 3DMax structure modeling, the input contact matrix is converted to spatial distances based on the assumption that the IF and the distance have an inverse relationship [<xref ref-type="bibr" rid="CR14">14</xref>&#x02013;<xref ref-type="bibr" rid="CR18">18</xref>]. The conversion method is explained in the Subsection &#x0201c;<italic>conversion of interaction frequency to spatial distance&#x0201d;</italic> later. By assuming that data points <italic>D</italic><sub><italic>i</italic></sub> in D are conditionally independent given a structure S, we defined the likelihood (L(S)) in Eq. (<xref rid="Equ1" ref-type="">1</xref>) as:</p><p id="Par24">
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{L}\left(\mathrm{S}\right)=\mathrm{P}\left(\mathrm{D}|\mathrm{S}\right)={\prod}_{i=1}^nP\left({D}_i|S\right) $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi mathvariant="normal">L</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">S</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>S</mml:mi></mml:mfenced></mml:math><graphic xlink:href="12864_2018_4546_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p><p id="Par25">where n represents the total number of data points to be considered, and <italic>D</italic><sub>i</sub> represents the i<sup>th</sup> data point (i.e., the distance between a pair of chromosomal regions derived from the contact matrix). Assumed that each data point i obeys the normal distribution, the probability of data point <italic>D</italic><sub><italic>i</italic></sub> can be described as:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{P}\left({\mathrm{D}}_{\mathrm{i}}|\mathrm{S}\right)\sim \frac{1}{\sigma \sqrt{2\uppi}}.\exp \left(-\frac{1}{2{\sigma}^2}{\left({D_i}^s-{D}_i\right)}^2\right) $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x0223c;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>&#x003c3;</mml:mi><mml:msqrt><mml:mn>2</mml:mn><mml:mrow><mml:mtext>&#x003c0;</mml:mtext></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>s</mml:mi></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12864_2018_4546_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par26">where <italic>D</italic><sub><italic>i</italic></sub><sup><italic>s</italic></sup> which is the actual Euclidean distance of the pair of regions corresponding to <italic>D</italic><sub><italic>i</italic></sub>, computed from (<italic>x,y,z</italic>) coordinates of the two regions in 3D structure S as in [<xref ref-type="bibr" rid="CR33">33</xref>]. <italic>&#x003c3;</italic><sup>2</sup> is the variance of the distance. By combining Eqs. (<xref rid="Equ1" ref-type="">1</xref>) and (<xref rid="Equ2" ref-type="">2</xref>), we obtain the likelihood estimate of a structure S:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L\ (S)={\left(\frac{1}{\sigma \sqrt{2\uppi}}\right)}^n.\exp \left(-\frac{1}{2{\sigma}^2}{\sum}_{i=1}^n{\left({D_i}^s-{D}_i\right)}^2\right) $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mi>L</mml:mi><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mi>S</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>&#x003c3;</mml:mi><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">&#x003c0;</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mfenced><mml:mi>n</mml:mi></mml:msup><mml:mo>.</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>&#x003c3;</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>s</mml:mi></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12864_2018_4546_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par27">By taking the logarithm of both sides of the Eq. (<xref rid="Equ3" ref-type="">3</xref>), we obtain the log likelihood objective function in Eq. (<xref rid="Equ4" ref-type="">4</xref>) for 3DMax chromosome structure reconstruction. Our goal is to find a structure S* that maximizes the likelihood function: L(S|D).</p><p id="Par28">
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L\ (S)=-\frac{\sum_{i=1}^n{\left({D_i}^s-{D}_i\right)}^2}{2{\sigma}^2}-n. log\sigma $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mi>L</mml:mi><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mi>S</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>s</mml:mi></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>&#x003c3;</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mi>n</mml:mi><mml:mo>.</mml:mo><mml:mtext mathvariant="italic">log&#x003c3;</mml:mtext></mml:math><graphic xlink:href="12864_2018_4546_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>
</p><p id="Par29">With the assumption that the data is normally distributed according to Eq. (<xref rid="Equ2" ref-type="">2</xref>), <italic>&#x003c3;</italic> is calculated as in Eq. (<xref rid="Equ5" ref-type="">5</xref>):<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \sigma =\sqrt{\frac{\sum_{i=1}^n{\left({Di}^s- Di\right)}^2}{n}} $$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mi>&#x003c3;</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi mathvariant="italic">Di</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>&#x02212;</mml:mo><mml:mi mathvariant="italic">Di</mml:mi></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:msqrt></mml:math><graphic xlink:href="12864_2018_4546_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par30">We eliminated the dependence of the objective function on <italic>&#x003c3;</italic> parameter by plugging Eq. (<xref rid="Equ5" ref-type="">5</xref>) into the log likelihood objective function in Eq. (<xref rid="Equ4" ref-type="">4</xref>). Hence, the resulting objective function L(S) can be represented as in Eq. (<xref rid="Equ6" ref-type="">6</xref>). The objective function in Eq. (<xref rid="Equ6" ref-type="">6</xref>) depends only on the (<italic>x,y,z</italic>) coordinates of regions in the structure.<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L\ (S)=-\frac{n}{2}-\mathrm{nlog}\sqrt{\frac{\sum_{i=1}^n{\left({Di}^s- Di\right)}^2}{n}} $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mi>L</mml:mi><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mi>S</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mtext>nlog</mml:mtext><mml:msqrt><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi mathvariant="italic">Di</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>&#x02212;</mml:mo><mml:mi mathvariant="italic">Di</mml:mi></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:msqrt></mml:math><graphic xlink:href="12864_2018_4546_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec6"><title>Gradient ascent optimization algorithm</title><p id="Par31">We used the gradient ascent method to optimize the objective function iteratively until the 3DMax algorithm converges. 3DMax algorithm is considered converged, if the difference between the newly calculated log likelihood L(S) function value obtained with updated (x, y, z) coordinates and old L(S) function value of the previous step is less than a small constant value (epsilon). The determination of the epsilon value is described in the <xref rid="Sec11" ref-type="sec">Results</xref> section.</p><p id="Par32">Gradient ascent is an iterative optimization algorithm that moves in the direction of the function gradient. Using Eq. (<xref rid="Equ6" ref-type="">6</xref>) as the base equation, we calculated the partial derivative of the log likelihood function with respect to a region&#x02019;s x, y, and z coordinates in a 3D structure.</p><p id="Par33">Once the partial derivative for each coordinate was obtained, we used the gradient ascent optimization method to adjust each coordinate to get a new structure S* that increases the likelihood. Equation (<xref rid="Equ7" ref-type="">7</xref>) shows how the update was done, where &#x003bb; is the learning rate, and S is the (x, y, z) coordinate vector in 3D space. If the learning rate is too small, it can result in a slow convergence to an optimal solution. But, if a larger learning rate is defined, the algorithm might oscillate around an optimal solution. There is no standard approach to choose &#x003bb; value, but it is common to set a larger learning rate at the beginning of the optimization, and reduce it as the optimization progresses. The result of using the different types of learning rate is described in the Subsection &#x0201c;<italic>choice of the learning rate</italic>&#x0201d; in the <xref rid="Sec11" ref-type="sec">Result</xref> section.<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {S}^{\left(t+1\right)}={S}^{(t)}+{\uplambda}^{(t)}\nabla L\left({S}^{(t)}\right) $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:msup><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="normal">&#x003bb;</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msup><mml:mi>&#x02207;</mml:mi><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msup></mml:mfenced><mml:mspace width="0.25em"/></mml:math><graphic xlink:href="12864_2018_4546_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par34">where <italic>t</italic> is an iteration index, <italic>S</italic><sup>(<italic>t</italic>)</sup> is the structure coordinate at an iteration index t,&#x000a0;&#x003bb;<sup>(<italic>t</italic>)</sup>&#x000a0;is a learning rate at t that may vary as the iteration proceeds, and <italic>&#x02207;L</italic>(<italic>S</italic><sup>(<italic>t</italic>)</sup>) is the partial derivative of the log likelihood with respect to the coordinates in the structure.</p><p id="Par35">In this work, we also implemented a variant of the 3DMax algorithm above, called 3DMax1, which performs an extra pre-processing and filtering of the input contact matrix when the input is noisy (e.g. having low IFs). Moreover, 3DMax1 uses a stochastic gradient ascent algorithm with per-parameter learning rate, which is called the adaptive Gradient algorithm (AdaGrad). The AdaGrad [<xref ref-type="bibr" rid="CR34">34</xref>] is a gradient-based optimization that can adapt the learning rate to each parameter, it performs larger updates for infrequent or sparse parameters and smaller updates for frequent or less sparse parameters. And it often improves convergence performance over standard stochastic gradient ascent when dealing with sparse parameters [<xref ref-type="bibr" rid="CR35">35</xref>]. Different from 3DMax that updates the values of all the structure parameters in <italic>S</italic> at once with the same learning rate &#x003bb;, AdaGrad in 3DMax1 uses a different learning rate for every parameter in <italic>S</italic> at every time <italic>t</italic> . Let Eq. (<xref rid="Equ8" ref-type="">8</xref>) represent the gradient of the log likelihood for a parameter&#x000a0;<italic>S</italic><sub><italic>i</italic></sub> at a time step t. Hence, the stochastic Gradient ascent in Eq. (<xref rid="Equ7" ref-type="">7</xref>) can be written as in Eq. (<xref rid="Equ9" ref-type="">9</xref>) for a parameter <italic>S</italic><sub><italic>i</italic></sub> in <italic>S</italic>.<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {g}_{t,i}=\nabla L\left({S_i}^{(t)}\right) $$\end{document}</tex-math><mml:math id="M16" display="block"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>&#x02207;</mml:mi><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msup></mml:mfenced></mml:math><graphic xlink:href="12864_2018_4546_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {S_i}^{\left(t+1\right)}={S_i}^{(t)}+{\uplambda}^{(t)}.{g}_{t,i} $$\end{document}</tex-math><mml:math id="M18" display="block"><mml:msup><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="normal">&#x003bb;</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msup><mml:mo>.</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="12864_2018_4546_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par36">In the update rule for AdaGrad, it modifies the learning rate &#x003bb; at each time step for every parameter <italic>S</italic><sub><italic>i</italic></sub> based on the previously computed gradient for the parameter <italic>S</italic><sub><italic>i</italic></sub>. according to Eq. (<xref rid="Equ10" ref-type="">10</xref>)<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {S_i}^{\left(t+1\right)}={S_i}^{(t)}+\kern0.5em \frac{\uplambda}{\sqrt{G_{t, ii}+\varepsilon }}.{g}_{t,i} $$\end{document}</tex-math><mml:math id="M20" display="block"><mml:msup><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msup><mml:mo>+</mml:mo><mml:mspace width="0.5em"/><mml:mfrac><mml:mi mathvariant="normal">&#x003bb;</mml:mi><mml:msqrt><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">ii</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>&#x003b5;</mml:mi></mml:mrow></mml:msqrt></mml:mfrac><mml:mo>.</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="12864_2018_4546_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par37">Here, <italic>G</italic><sub><italic>t</italic></sub> is a diagonal matrix where each diagonal element <italic>i</italic>, <italic>i</italic> is the sum of the squares of the gradients w.r.t.&#x000a0;<italic>S</italic><sub><italic>i</italic></sub> up to time step t according to Eq. (<xref rid="Equ11" ref-type="">11</xref>). While <italic>&#x003b5;</italic> is a smoothing term that avoids division by zero (usually on the order of 1e&#x000a0;&#x02212;&#x000a0;6).<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {G}_t={\sum}_{i=1}^t\left({g}_i{g}_i\right) $$\end{document}</tex-math><mml:math id="M22" display="block"><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12864_2018_4546_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par38">In essence, <italic>G</italic><sub><italic>t</italic></sub> contains the sum of the squares of the past gradients for all the parameters in <italic>S</italic> along its diagonal. One of AdaGrad&#x02019;s main benefits is that it eliminates the need to manually tune the learning rate at each iteration.</p></sec><sec id="Sec7"><title>Normalization of Hi-C data</title><p id="Par39">Data normalization is necessary for Hi-C datasets, because there is a lot of noise in them. In this study, we used the iterative correction and eigenvector decomposition (ICE) technique [<xref ref-type="bibr" rid="CR31">31</xref>] as the default technique to normalize the Hi-C data. The ICE technique was used to normalize the contact map derived from both the synthetic data and the experimental Hi-C data. The GM06990 Hi-C data was also normalized using the Yaffe and Tanay normalization technique [<xref ref-type="bibr" rid="CR30">30</xref>]. The Yaffe and Tanay normalization technique normalizes the observed read counts by the expected read counts between the regions in a contact matrix. The other technique used to normalize the GM06990 Hi-C data is the Sequential Component Normalization (SCN) technique [<xref ref-type="bibr" rid="CR32">32</xref>]. The results obtained by the three methods above are presented in the <xref rid="Sec11" ref-type="sec">Results</xref> section.</p></sec><sec id="Sec8"><title>Conversion of interaction frequency to spatial distance</title><p id="Par40">An important aspect of most distance restraint-based modeling approaches including 3DMax is to convert the interaction frequency (IF<sub>ij</sub>) between two regions (i, j) in a contact matrix to a hypothetical Euclidean distance. An inverse relationship is assumed to exist between them. The relationship is usually defined as 1/IF<sup>&#x003b1;</sup>, where IF is the interaction frequency, and &#x003b1; is called the conversion factor. According to [<xref ref-type="bibr" rid="CR16">16</xref>], &#x003b1; cannot be too small because the spatial distance becomes independent of the interaction frequency as &#x003b1; approaches zero. And &#x003b1; also cannot be too large because in this situation a small change in interaction frequency could produce a significant difference in the spatial distances. Therefore, choosing a conversion factor that correctly represents the relationship between distance and interaction frequency (IF) is important. For 3DMax, we assume that the optimal &#x003b1; will be in the range [0.1, 2], which is consistent with the previous study [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>].</p></sec><sec id="Sec9"><title>Measurement of model similarity and accuracy</title><p id="Par41">We used the Pearson correlation coefficient (PCC), the Spearman&#x02019;s correlation coefficient (SCC), and the root mean square error (RMSE) to measure the similarities between chromosomal structures, and assess the accuracy of the constructed structures as in the previous studies [<xref ref-type="bibr" rid="CR12">12</xref>&#x02013;<xref ref-type="bibr" rid="CR20">20</xref>]. When these assessment methods are applied on a distance representation of a model, or a distance representation of Hi-C data, they are sometimes called the distance Pearson Correlation Coefficient (dPCC), the distance Spearman Correlation Coefficient (dSCC), and the distance Root Mean Square error (dRMSE), respectively. For instance, if we have two pairwise distance dataset from two models, {d<sub>i</sub>, &#x02026;, d<sub>n</sub>} containing n values, and another pairwise distance dataset {D<sub>i</sub>, &#x02026;, D<sub>n</sub>} containing n values, the dPCC, the dSCC and the dRMSE can be computed using the formulas given below.<list list-type="order"><list-item><p id="Par42">The distance Pearson correlation coefficient (dPCC) is defined as,<disp-formula id="Equa"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{dPCC}=\frac{\sum_{i=1}^n\left({d}_i-\overline{d}\right)\left({D}_i-\overline{D}\right)}{\sqrt{\sum_{i=1}^n{\left({d}_i-\overline{d}\right)}^2{\sum}_{i=1}^n{\left({D}_i-\overline{D}\right)}^2}} $$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mtext>dPCC</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac></mml:math><graphic xlink:href="12864_2018_4546_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list>where:</p><p id="Par43">
<list list-type="bullet"><list-item><p id="Par44"><italic>d</italic><sub><italic>i</italic></sub> and <italic>D</italic><sub><italic>i</italic></sub> are single distance samples indexed with i,</p></list-item><list-item><p id="Par45"><italic>n</italic> is the number of pairwise distance.</p></list-item><list-item><p id="Par46"><inline-formula id="IEq1"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overline{d} $$\end{document}</tex-math><mml:math id="M26" display="inline"><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2018_4546_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overline{D} $$\end{document}</tex-math><mml:math id="M28" display="inline"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="12864_2018_4546_Article_IEq2.gif"/></alternatives></inline-formula>represent sample means. <inline-formula id="IEq3"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overline{d}=\frac{1}{n}\sum \limits_{i=1}^n{d}_i $$\end{document}</tex-math><mml:math id="M30"><mml:mover><mml:mi>d</mml:mi><mml:mo accent="false">&#x000af;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12864_2018_4546_Article_IEq3.gif"/></alternatives></inline-formula>, <inline-formula id="IEq4"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overline{D}=\frac{1}{n}\sum \limits_{i=1}^n{D}_i $$\end{document}</tex-math><mml:math id="M32" display="inline"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12864_2018_4546_Article_IEq4.gif"/></alternatives></inline-formula> .</p></list-item></list>
<list list-type="simple"><list-item><label>(2)</label><p id="Par47">The distance Spearman&#x02019;s correlation coefficient (dSCC) is defined as<disp-formula id="Equb"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{dSCC}=\frac{\sum_{i=1}^n\left({X}_i-\overline{X}\right)\left({Y}_i-\overline{Y}\right)}{\sqrt{\sum_{i=1}^n{\left({X}_i-\overline{X}\right)}^2{\sum}_{i=1}^n{\left({Y}_i-\overline{Y}\right)}^2}} $$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mtext>dSCC</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac></mml:math><graphic xlink:href="12864_2018_4546_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list>
</p><p id="Par48">dSCC is calculated by converting distance variable <italic>d</italic><sub><italic>i</italic></sub> and <italic>D</italic><sub><italic>i</italic></sub> into ranked variables <italic>X</italic><sub><italic>i</italic></sub> and <italic>Y</italic><sub><italic>i</italic></sub>, and then, computing the dPCC between the ranked variables.</p><p id="Par49">where:<list list-type="bullet"><list-item><p id="Par50"><italic>X</italic><sub><italic>i</italic></sub> and <italic>Y</italic><sub><italic>i</italic></sub> is the rank of two distance <italic>d</italic><sub><italic>i</italic></sub> and <italic>D</italic><sub><italic>i</italic></sub> respectively. Hence, X and Y is a vector of distance rank of the distance vector <italic>d</italic> and <italic>D respectively</italic>.</p></list-item><list-item><p id="Par51"><inline-formula id="IEq5"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overline{X} $$\end{document}</tex-math><mml:math id="M36" display="inline"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2018_4546_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overline{Y} $$\end{document}</tex-math><mml:math id="M38" display="inline"><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2018_4546_Article_IEq6.gif"/></alternatives></inline-formula> represent sample means of rank. <inline-formula id="IEq7"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overline{X}=\frac{1}{n}\sum \limits_{i=1}^n{X}_i $$\end{document}</tex-math><mml:math id="M40"><mml:mover><mml:mi>X</mml:mi><mml:mo accent="false">&#x000af;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12864_2018_4546_Article_IEq7.gif"/></alternatives></inline-formula>, <inline-formula id="IEq8"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overline{Y}=\frac{1}{n}\sum \limits_{i=1}^n{Y}_i $$\end{document}</tex-math><mml:math id="M42" display="inline"><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12864_2018_4546_Article_IEq8.gif"/></alternatives></inline-formula> .</p></list-item></list></p><p id="Par52">
<list list-type="simple"><list-item><label>(3)</label><p id="Par53">The distance Root Mean Square Error (dRMSE) is defined as,<disp-formula id="Equc"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{dRMSE}=\sqrt{\frac{1}{n}\sum {\left({d}_{ij}-{D}_{ij}\right)}^2} $$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mtext>dRMSE</mml:mtext><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo>&#x02211;</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:math><graphic xlink:href="12864_2018_4546_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list>
<list list-type="bullet"><list-item><p id="Par54">where <italic>d</italic><sub><italic>ij</italic></sub> and <italic>D</italic><sub><italic>ij</italic></sub> are the distance vector between regions i and j for the first model, and second model respectively.</p></list-item><list-item><p id="Par55"><italic>n</italic> is the number of pairwise distance.</p></list-item></list>
</p><p id="Par56">The dSCC measures the similarity of the distance profiles of two 3D structures. The dSCC value varies between &#x02212;&#x02009;1.0 and 1.0; the higher the dSCC value is, the more similar the two structures are. It is worth noting that, to determine the dRMSE of two structures, the structures must be compared at the same scale. For instance, assuming two structures are represented with coordinates S<bold>&#x02032;</bold> and S &#x02208; R <sup>n &#x000d7;&#x02009;3</sup>, where S<bold>&#x02032;</bold> is the model constructed by 3DMax, S is the known model from a simulated data, and n is the number of regions representing a chromosome. To calculate the dRMSE value, we performed linear transformations that includes translation, orthogonal rotation, and rescaling of the points in the matrix R<sup>3 x n</sup> of structure S<bold>&#x02032;</bold> in order to best match them with the points in matrix R<sup>3 x n</sup> of structure S. The Procrustes function library defined in MATLAB [<xref ref-type="bibr" rid="CR36">36</xref>&#x02013;<xref ref-type="bibr" rid="CR39">39</xref>] is used to do the transformation of the dimensions. After the transformation, the dRMSE value between the scaled structure S&#x02033; and the original structure S is calculated.</p></sec><sec id="Sec10"><title>Datasets</title><p id="Par57">The synthetic dataset from Trussart et al., 2015 [<xref ref-type="bibr" rid="CR15">15</xref>] is a series of simulated Hi-C contact matrices where the genomic architectures are pre-defined and the noise level and structural variability (SV) are both simulated. The contact maps, the original models and their reconstructed models used in this study were downloaded from <ext-link ext-link-type="uri" xlink:href="http://sgt.cnag.cat/3dg/datasets/">http://sgt.cnag.cat/3dg/datasets/</ext-link>.</p><p id="Par58">The real Hi-C data used in this study is from a normal GM06990 cell line and a malignant B-cell line. The normal GM06990 dataset was downloaded from the Gene Expression Omnibus (GEO) repository under the accession number GSE18199. Its raw and normalized interaction frequency matrices at 1-MB resolution [<xref ref-type="bibr" rid="CR10">10</xref>] were downloaded from [<xref ref-type="bibr" rid="CR40">40</xref>]. We used the normalization pipeline described in [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>] to obtain normalized contact matrices. The raw contact matrices of the malignant B-cell 1-MB resolution were obtained from [<xref ref-type="bibr" rid="CR41">41</xref>]. We used the pipeline [<xref ref-type="bibr" rid="CR31">31</xref>] to normalize them. The fluorescence in-situ hybridization (FISH) data of the GM06990 cell line is from [<xref ref-type="bibr" rid="CR10">10</xref>]. Its FISH distances and contact maps were obtained from [<xref ref-type="bibr" rid="CR21">21</xref>].</p></sec></sec><sec id="Sec11"><title>Results</title><p id="Par59">We evaluated our method using a synthetic dataset (Trussart et al., 2015) [<xref ref-type="bibr" rid="CR15">15</xref>] and two real Hi-C datasets of the two cell lines: a karyotypically normal human lymphoblastic cell line (GM06990) [<xref ref-type="bibr" rid="CR10">10</xref>] and the malignant B-cell of an acute lymphoblastic leukemia patient [<xref ref-type="bibr" rid="CR41">41</xref>].</p><sec id="Sec12"><title>Parameter estimation</title><p id="Par60">To use 3DMax, the conversion faction (&#x003b1;) needs to be defined. As the default, we set the &#x003b1; value to be in the range [0.1, 2] as explained in the <xref rid="Sec2" ref-type="sec">Methods</xref> section. Another parameter we defined in 3DMax is the convergence constant called epsilon. To estimate the best epsilon value to use, we experimented on the GM06990_HindIII cell line dataset using six epsilon values, i.e., 1, 0.5, 0.1, 0.01, 0.0001, and 0.00001(Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>). According to our experiment, although the different epsilons produced comparable dSCC average, the epsilon&#x02009;=&#x02009;0.0001&#x000a0;has the highest average dSCC score. Hence, we set it as the default epsilon value for 3DMax. The number of ensemble structures (N) to generate per conversion factor is another parameter to be tuned. Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref> shows the performance changes by setting different numbers of ensemble structures (NUM_STR). It is observed that a higher N value does not guarantee a significant increase in the accuracy. We set the default N to 5 in our implementation.<table-wrap id="Tab1"><label>Table 1</label><caption><p>The determination of the convergence constant (epsilon) values for the 3DMax algorithm</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Chromosome</th><th>epsilon&#x02009;=&#x02009;1</th><th>epsilon&#x02009;=&#x02009;0.5</th><th>epsilon&#x02009;=&#x02009;0.1</th><th>epsilon&#x02009;=&#x02009;0.01</th><th>epsilon&#x02009;=&#x02009;0.0001</th><th>epsilon&#x02009;=&#x02009;0.00001</th></tr></thead><tbody><tr><td>1</td><td>0.8087</td><td>0.8088</td><td>0.8087</td><td>0.8087</td><td>0.8088</td><td>0.8087</td></tr><tr><td>2</td><td>0.8149</td><td>0.8149</td><td>0.8149</td><td>0.8149</td><td>0.8149</td><td>0.8149</td></tr><tr><td>3</td><td>0.8306</td><td>0.8306</td><td>0.8306</td><td>0.8306</td><td>0.8306</td><td>0.8306</td></tr><tr><td>4</td><td>0.8716</td><td>0.8716</td><td>0.8714</td><td>0.8663</td><td>0.8735</td><td>0.8714</td></tr><tr><td>5</td><td>0.8645</td><td>0.8645</td><td>0.8645</td><td>0.8646</td><td>0.8654</td><td>0.8645</td></tr><tr><td>6</td><td>0.8477</td><td>0.8479</td><td>0.848</td><td>0.8478</td><td>0.848</td><td>0.848</td></tr><tr><td>7</td><td>0.8302</td><td>0.8302</td><td>0.83</td><td>0.8302</td><td>0.831</td><td>0.8301</td></tr><tr><td>8</td><td>0.8701</td><td>0.8701</td><td>0.8701</td><td>0.8702</td><td>0.8701</td><td>0.8701</td></tr><tr><td>9</td><td>0.853</td><td>0.853</td><td>0.8495</td><td>0.8521</td><td>0.8532</td><td>0.8508</td></tr><tr><td>10</td><td>0.8538</td><td>0.8542</td><td>0.8541</td><td>0.8538</td><td>0.8538</td><td>0.8538</td></tr><tr><td>11</td><td>0.8431</td><td>0.8431</td><td>0.8431</td><td>0.8431</td><td>0.8433</td><td>0.8432</td></tr><tr><td>12</td><td>0.8576</td><td>0.8576</td><td>0.8578</td><td>0.8577</td><td>0.8578</td><td>0.8578</td></tr><tr><td>13</td><td>0.8581</td><td>0.8553</td><td>0.8582</td><td>0.8582</td><td>0.8584</td><td>0.8582</td></tr><tr><td>14</td><td>0.8785</td><td>0.8796</td><td>0.8797</td><td>0.8797</td><td>0.8797</td><td>0.8797</td></tr><tr><td>15</td><td>0.8593</td><td>0.8563</td><td>0.8588</td><td>0.8595</td><td>0.8565</td><td>0.8592</td></tr><tr><td>16</td><td>0.8441</td><td>0.8459</td><td>0.8458</td><td>0.8459</td><td>0.8458</td><td>0.8458</td></tr><tr><td>17</td><td>0.8359</td><td>0.836</td><td>0.8362</td><td>0.8362</td><td>0.8362</td><td>0.8361</td></tr><tr><td>18</td><td>0.8521</td><td>0.8537</td><td>0.8536</td><td>0.8535</td><td>0.8535</td><td>0.8534</td></tr><tr><td>19</td><td>0.8629</td><td>0.8669</td><td>0.8663</td><td>0.8665</td><td>0.8665</td><td>0.8664</td></tr><tr><td>20</td><td>0.8853</td><td>0.884</td><td>0.8842</td><td>0.8865</td><td>0.8867</td><td>0.8867</td></tr><tr><td>21</td><td>0.9019</td><td>0.8995</td><td>0.9016</td><td>0.9016</td><td>0.9017</td><td>0.9018</td></tr><tr><td>22</td><td>0.8657</td><td>0.8658</td><td>0.8672</td><td>0.8658</td><td>0.8659</td><td>0.8659</td></tr><tr><td>Average dSCC</td><td>0.8541</td><td>0.8541</td><td>0.8543</td><td>0.8542</td><td>
<bold>0.8546</bold>
</td><td>0.8544</td></tr></tbody></table><table-wrap-foot><p>The dSCC value between the input distance matrix and the representative model for chromosome 1 &#x02013; 22 of the GM06990 cell line using convergence constant (epsilon): 1, 0.5, 0.1, 0.01, 0.0001, and 0.00001 respectively. The average dSCC values across the chromosomes show that the results are highly comparable. The epsilon&#x02009;=&#x02009;0.0001&#x000a0;has the highest average dSCC score, hence, we set it as the default epsilon value for 3DMax. The bold text represents the highest dSCC value</p></table-wrap-foot></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>The comparison of the performance when a constant learning rate and a decreasing learning rate are applied</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th colspan="2">Constant Learning Rate</th><th colspan="2">Decreasing Learning Rate</th></tr><tr><th>Input Parameters</th><th>Running Time</th><th>Accuracy<break/>(Average dSCC)</th><th>Running Time</th><th>Accuracy<break/>(Average dSCC)</th></tr></thead><tbody><tr><td>CHR&#x02009;=&#x02009;1-22, NUM_STR&#x02009;=&#x02009;1, ALPHA&#x02009;=&#x02009;constant</td><td>4&#x000a0;min</td><td>0.821</td><td>13&#x000a0;s</td><td>0.8493</td></tr><tr><td>CHR&#x02009;=&#x02009;1-22, NUM_STR&#x02009;=&#x02009;1, ALPHA&#x02009;=&#x02009;[0.1, 2]</td><td>1&#x000a0;h, 30&#x000a0;min</td><td>0.8456</td><td>3&#x000a0;min</td><td>0.8536</td></tr><tr><td>CHR&#x02009;=&#x02009;1-22, NUM_STR&#x02009;=&#x02009;5, ALPHA&#x02009;=&#x02009;[0.1, 2]</td><td>7&#x000a0;h</td><td>0.8546</td><td>20&#x000a0;min</td><td>0.8546</td></tr><tr><td>CHR&#x02009;=&#x02009;1, NUM_STR&#x02009;=&#x02009;1, ALPHA&#x02009;=&#x02009;constant</td><td>37&#x000a0;s</td><td>0.7556</td><td>2&#x000a0;s</td><td>0.8088</td></tr><tr><td>CHR&#x02009;=&#x02009;1, NUM_STR&#x02009;=&#x02009;5, ALPHA&#x02009;=&#x02009;[0.1, 2]</td><td>1&#x000a0;h</td><td>0.7841</td><td>3&#x000a0;min</td><td>0.8088</td></tr><tr><td>CHR&#x02009;=&#x02009;21, NUM_STR&#x02009;=&#x02009;1, ALPHA&#x02009;=&#x02009;constant</td><td>0.7&#x000a0;s</td><td>0.8969</td><td>0.2&#x000a0;s</td><td>0.8995</td></tr><tr><td>CHR&#x02009;=&#x02009;21, NUM_STR&#x02009;=&#x02009;5, ALPHA&#x02009;=&#x02009;[0.1, 2]</td><td>36&#x000a0;s</td><td>0.9018</td><td>2&#x000a0;s</td><td>0.9018</td></tr><tr><td>CHR&#x02009;=&#x02009;21, NUM_STR&#x02009;=&#x02009;30, ALPHA&#x02009;=&#x02009;[0.1, 2]</td><td>4&#x000a0;min</td><td>0.9018</td><td>12&#x000a0;s</td><td>0.9018</td></tr><tr><td>CHR&#x02009;=&#x02009;21, NUM_STR&#x02009;=&#x02009;50, ALPHA&#x02009;=&#x02009;[0.1, 2]</td><td>6&#x000a0;min</td><td>0.9021</td><td>18&#x000a0;s</td><td>0.9018</td></tr><tr><td>CHR&#x02009;=&#x02009;21, NUM_STR&#x02009;=&#x02009;100, ALPHA&#x02009;=&#x02009;[0.1, 2]</td><td>12&#x000a0;min</td><td>0.9020</td><td>37&#x000a0;s</td><td>0.9020</td></tr><tr><td>CHR&#x02009;=&#x02009;21, NUM_STR&#x02009;=&#x02009;200, ALPHA&#x02009;=&#x02009;[0.1, 2]</td><td>24&#x000a0;min</td><td>0.9022</td><td>83&#x000a0;s</td><td>0.9020</td></tr><tr><td>CHR&#x02009;=&#x02009;21, NUM_STR&#x02009;=&#x02009;500, ALPHA&#x02009;=&#x02009;[0.1, 2]</td><td>1&#x000a0;h</td><td>0.9022</td><td>3&#x000a0;min</td><td>0.9021</td></tr></tbody></table><table-wrap-foot><p>The comparison of the computing time and the average dSCC value obtained by using a constant or a decreasing learning rate for different input parameters for the chromosome 1 &#x02013; 22 of the GM06990 cell line. We used the constant learning rate 0.0001, and we defined the&#x000a0;initial_&#x003bb;&#x02002;= 0.01 for the decreasing learning rate. CHR represents the chromosome number, and NUM_STR represents the number of ensemble structures generated per conversion factor(&#x003b1;), ALPHA represents the conversion factor. The decreasing learning rate achieved a better computing speed in all the cases</p></table-wrap-foot></table-wrap></p><p id="Par61">We executed all the other methods following the directions for parameter settings by their authors. All the parameters used to produce all the results are made available in the &#x0201c;parameters&#x0201d; directory of each method in the 3DMax website (<ext-link ext-link-type="uri" xlink:href="http://sysbio.rnet.missouri.edu/bdm_download/3DMax/">http://sysbio.rnet.missouri.edu/bdm_download/3DMax/</ext-link>). For instance, to evaluate the MOGEN program, we used the parameters that produced the best result after trying multiple settings for the parameters required by the algorithm. The different parameters used to generate the MOGEN models, the input data, and the outputs for the three normalization methods for the GM06990 cell line are all available at the 3DMax website.</p></sec><sec id="Sec13"><title>Choice of the learning rate</title><p id="Par62">As mentioned in the <xref rid="Sec2" ref-type="sec">Methods</xref> section, the choice of the best learning rate can sometimes be a difficult task. However, it is common practice to use either a preferable constant learning rate, or a decreasing learning rate.</p><p id="Par63"><italic>The constant learning rate</italic> uses a constant &#x003bb; value through all the epoch steps for an algorithm. By experimenting with a range of learning rates in our work, Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> shows the model accuracy for different constant learning rates for GM06990_HindIII cell chromosome 1 to 22 datasets. The result shows the impact of using the different learning rates for structure modeling. We observed that &#x003bb;&#x02009;=&#x02009;0.0001, 0.001, and 0.005 shows a consistent better performance than the other &#x003bb; values across all the chromosomes. As observed in the Figure, the larger learning rate (&#x003bb; =0.01) had the advantage of faster convergence in some chromosomes, but suffered fluctuations or even decreased performance at some point (Chromosome 5,11, and 20). The smaller learning rates resulted in slow convergence and sometimes does not converge with a good model accuracy as in the case of &#x003bb;&#x02009;=&#x02009;0.00001 (Chromosome 3,11,13,15,16-18, and 21).<fig id="Fig1"><label>Fig. 1</label><caption><p>The comparison of the step by step model accuracy for different constant learning rate. The comparison of the dSCC model accuracy for five constant learning rates for GM06990_HindIII cell chromosome 1 to 22 dataset. We show the step by step dSCC till convergence for &#x003bb;&#x02009;=&#x02009;0.00001,0.0001, 0.001, 0.005 and 0.01 respectively for all the GM06990_cell chromosomes. The result shows that &#x003bb;&#x02009;=&#x02009;0.0001,0.001, and 0.005 had less fluctuations, and achieved a higher or similar dSCC value in cell chromosomes. Overall, the performance of 3DMax is comparable for each of the &#x003bb; values. A higher dSCC value means the better accuracy</p></caption><graphic xlink:href="12864_2018_4546_Fig1_HTML" id="MO1"/></fig></p><p id="Par64">Conversely, for <italic>the decreasing learning rate</italic>, a typical way to implement it is to choose a starting learning rate, and drop the learning rate by half every 70 epochs (in our algorithm). This approach is termed the step based learning rate decay schedule. It takes the mathematical form below:<disp-formula id="Equd"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \uplambda =\mathrm{initial}\_\uplambda \ast {0.5}^{\frac{1+ epoch}{70}} $$\end{document}</tex-math><mml:math id="M46" display="block"><mml:mi mathvariant="normal">&#x003bb;</mml:mi><mml:mo>=</mml:mo><mml:mtext>initial</mml:mtext><mml:mo>_</mml:mo><mml:mi mathvariant="normal">&#x003bb;</mml:mi><mml:mo>&#x02217;</mml:mo><mml:msup><mml:mn>0.5</mml:mn><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">epoch</mml:mtext></mml:mrow><mml:mn>70</mml:mn></mml:mfrac></mml:msup></mml:math><graphic xlink:href="12864_2018_4546_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par65">In this work, we compared the result obtained by using the constant learning rate (&#x003bb; =0.0001), and the decreasing learning rate methods in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>. Interestingly, the results show that both methods achieved a comparable accuracy for all the chromosomes. However, in terms of the computing speed, 3DMax is faster when the decreasing learning rate is used than when the constant learning rate is used. The running time and accuracy of the two methods of setting learning rates are reported in Table <xref rid="Tab2" ref-type="table">2</xref>. In 3DMax, we made the decreasing learning rate approach the default because it converges faster.<fig id="Fig2"><label>Fig. 2</label><caption><p>The comparison of the performance of 3DMax for constant and decreasing learning rates. Comparison of the result obtained by using the constant learning rate, and the decreasing learning rate shows that both methods achieved a comparable accuracy for all the chromosomes. A higher dSCC value means the better accuracy</p></caption><graphic xlink:href="12864_2018_4546_Fig2_HTML" id="MO2"/></fig></p></sec><sec id="Sec14"><title>Assessment on simulated datasets</title><p id="Par66">The synthetic dataset includes a series of Hi-C matrices simulated from the pre-defined chromosome structures with different noise levels and structural variability (SV) level. Each worm like chain chromosome structure has ~&#x02009;1&#x000a0;Mb base pairs and is represented by 202 regions of 5 Kb base pairs each. The simulated data can be classified into two categories based on the different architectures of the chromosome structures: Topological Associated Domains (TAD)-like architecture and Non-Topological Associated Domains (Non-TAD)-like architecture [<xref ref-type="bibr" rid="CR42">42</xref>&#x02013;<xref ref-type="bibr" rid="CR45">45</xref>]. Each of these architectures has three structural density levels (40&#x000a0;bp/nm, 75&#x000a0;bp/nm and 150&#x000a0;bp/nm), resulting in six density-architecture combinations. The entire synthetic dataset contains 168 simulated Hi-C matrices in total, i.e., six different combinations of density and architectures times seven levels of structural variability (SV) (denoted as 0, 1, 2, 3, 4, 5, 6) times four noise levels (i.e. 50, 100, 150 and 200). There are 28 simulated Hi-C contact matrices for each of the six density-architecture combinations. According to [<xref ref-type="bibr" rid="CR14">14</xref>], the most difficult architecture to reconstruct is the 150&#x000a0;bp/nm density with no TAD-like features because of its higher resolution and lack of regular TAD sub-structures.</p><p id="Par67">We evaluated 3DMax on the 28 contact matrices (7 levels of structural variability with four noise levels each) of the synthetic dataset with resolution 150&#x000a0;bp/nm for both TAD and non-TAD like feature architecture, respectively. The matrices were normalized with the ICE technique before they were used as input for 3DMax. To determine the best conversion factor (&#x003b1;) for model reconstruction, the dSCC value between the distance matrix generated from the input contact matrix and the Euclidean distance of the representative chromosomal model is computed. To determine the representative structure for an input matrix, we generated an ensemble of 50 structures and calculated the similarity between each structure in the ensemble with the input distance matrix. The structure with the highest dSCC value in the ensemble was chosen as the representative structure for the input contact matrix. We then computed the average dSCC value across the 28 contact matrices of the simulated data, with resolution 150&#x000a0;bp/nm and TAD like feature architecture, for the conversion factor (&#x003b1;) in the range [0.1, 2] (Table&#x000a0;<xref rid="Tab3" ref-type="table">3</xref>). The result shows that &#x003b1; value 0.3 has the highest average dSCC value. We computed the average dSCC value between the models reconstructed by 3DMax and the true structures (i.e., a set of 100 true structures for each structural variability level in the simulated dataset) for the &#x003b1; values in the range [0.1, 2] for the simulated data with resolution 150&#x000a0;bp/nm and TAD like feature architecture (Table&#x000a0;<xref rid="Tab4" ref-type="table">4</xref>). The result also shows that the structures generated at &#x003b1;&#x02009;=&#x02009;0.3 have the higher similarity to the true structures from simulated dataset than other &#x003b1; values. To compute the accuracy of 3DMax, we compared each structure in the generated ensemble with the true structures (i.e., a set of 100 true structures for each structural variability level) by using the spearman correlation coefficient. We thereafter selected the reconstructed structure closest to a true structure from the ensemble. The spearman correlation coefficient of the selected structure and the true structure was averaged and used as the dSCC accuracy for the ensemble of generated 3DMax structures. The reconstruction accuracy (dSCC) for 3DMax at different levels of noise and structural variability (SV) for &#x003b1;&#x02009;=&#x02009;0.3 shows that the accuracy of reconstructed models decreased as the structural variability level increased for each noise level (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>). The reconstruction accuracy of structures generated by 3DMax is relatively high for different noise levels when the structural variability (SV) is low, while the average accuracy of structures decreases noticeably as the level of SV increases.<table-wrap id="Tab3"><label>Table 3</label><caption><p>The average dSCC value between the distance matrix and the representative model for 28 contact matrices with different conversion factor (&#x003b1;) values</p></caption><table frame="hsides" rules="groups"><tbody><tr><td>Conversion factor(&#x003b1;)</td><td>0.1</td><td>0.3</td><td>0.5</td><td>1.0</td><td>1.5</td><td>2.0</td></tr><tr><td>dSCC</td><td>0.759</td><td>
<bold>0.768</bold>
</td><td>0.758</td><td>0.695</td><td>0.638</td><td>0.559</td></tr></tbody></table><table-wrap-foot><p>The average dSCC value between the input distance matrix and the representative model for 28 contact matrices (7 levels of structural variability with four noise levels each) for the conversion factor (&#x003b1;): 0.1, 0.3, 0.5, 1.0, 1.5 and 2.0 respectively. The dataset has resolution 150&#x000a0;bp/nm and TAD like feature architecture. The bold text represents the highest dSCC value</p></table-wrap-foot></table-wrap><table-wrap id="Tab4"><label>Table 4</label><caption><p>The average dSCC value for the dataset with resolution 150&#x000a0;bp/nm and TAD like feature architecture</p></caption><table frame="hsides" rules="groups"><tbody><tr><td>Conversion factor(&#x003b1;)</td><td>0.1</td><td>0.3</td><td>0.5</td><td>1.0</td><td>1.5</td><td>2.0</td></tr><tr><td>dSCC</td><td>0.564</td><td>
<bold>0.720</bold>
</td><td>0.697</td><td>0.650</td><td>0.650</td><td>0.495</td></tr></tbody></table><table-wrap-foot><p>The average dSCC value between 3DMax model and the known structure for 28 contact matrices (7 levels of structural variability with four noise levels each) for the conversion factor (&#x003b1;): 0.1, 0.3, 0.5, 1.0, 1.5 and 2.0 respectively. The dataset has resolution 150&#x000a0;bp/nm and TAD like feature architecture. The bold text represents the highest dSCC value</p></table-wrap-foot></table-wrap><fig id="Fig3"><label>Fig. 3</label><caption><p>The dSCC accuracy of the structures generated by 3DMax for the synthetic data. The dSCC accuracy of the structures generated by 3DMax at different levels of noise and structural variability for conversion factor (&#x003b1;)&#x02009;=&#x02009;0.3. The dataset has resolution 150&#x000a0;bp/nm and TAD like feature architecture. Y-axis denotes the distance Spearman correlation coefficient (dSCC) score in the range [&#x02212;&#x02009;1,1] and the X-axis denotes the noise level. Set 0-6 denotes seven different levels of structural variability in the increasing order. A higher dSCC value means the better accuracy</p></caption><graphic xlink:href="12864_2018_4546_Fig3_HTML" id="MO3"/></fig></p><p id="Par68">Similarly, we evaluated 3DMax on 28 contact matrices of the synthetic dataset with resolution 150&#x000a0;bp/nm and non-TAD like feature architecture. Table&#x000a0;<xref rid="Tab5" ref-type="table">5</xref> shows the performance of 3DMax for different &#x003b1; values.<table-wrap id="Tab5"><label>Table 5</label><caption><p>The average dSCC value for the dataset with resolution 150&#x000a0;bp/nm and non-TAD like feature architecture</p></caption><table frame="hsides" rules="groups"><tbody><tr><td>Conversion factor(&#x003b1;)</td><td>0.1</td><td>0.3</td><td>0.5</td><td>1.0</td><td>1.5</td><td>2.0</td></tr><tr><td>dSCC</td><td>0.583</td><td>
<bold>0.658</bold>
</td><td>0.634</td><td>0.566</td><td>0.518</td><td>0.429</td></tr></tbody></table><table-wrap-foot><p>The average dSCC value between 3DMax model and the known structure for 28 contact matrices (7 levels of structural variability with four noise levels each) for the conversion factor (&#x003b1;): 0.1, 0.3, 0.5, 1.0, 1.5 and 2.0 respectively. The dataset has resolution 150&#x000a0;bp/nm and non-TAD like feature architecture. The bold text represents the highest dSCC value</p></table-wrap-foot></table-wrap></p></sec><sec id="Sec15"><title>Comparison with existing methods on the simulated data</title><p id="Par69">We compared 3DMax with three existing methods: MCMC5C [<xref ref-type="bibr" rid="CR14">14</xref>], MOGEN [<xref ref-type="bibr" rid="CR19">19</xref>], and ShRec3D [<xref ref-type="bibr" rid="CR24">24</xref>]. We used each method to generate an ensemble of 50 structures for each input matrix. We compared each structure in the ensemble with the true structures (i.e., a set of 100 true structures for each structural variability level) using spearman correlation coefficient to select the reconstructed structure closest to a true structure from the ensemble. The spearman correlation coefficient of the selected structure and the true structures is averaged and used as the dSCC accuracy for the method. For clarity, the comparison is grouped based on the noise level of the simulated data from 50 to 200. For the different noise levels, 3DMax is comparable to the top method - MOGEN when structural variability (sets 0-1) is low. And as the variability increases (especially sets 3-6), it outperforms all the other methods (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>) most time. Table&#x000a0;<xref rid="Tab6" ref-type="table">6</xref> shows a tabular representation of the dSCC values visualized in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, to show the dSCC values generated by all the algorithms.<fig id="Fig4"><label>Fig. 4</label><caption><p>A comparison of the reconstruction accuracy of different methods on the synthetic dataset. The reconstruction accuracy for 3DMax, MOGEN, ShRec3D, and MCMC5C at different levels of noise and structural variability. The dataset has resolution 150&#x000a0;bp/nm and TAD like feature architecture. Top-Left: comparison at Noise Level 50, Top-Right: comparison at Noise Level 100, Bottom-Left: comparison at Noise Level 150, Bottom-Right: comparison at Noise Level 200. Y-axis denotes the distance Spearman correlation coefficient (dSCC) score in the range [&#x02212;&#x02009;1,1] and the X-axis denotes the structural variability level. Set 0-6 denotes seven different levels of structural variability in the increasing order. A higher dSCC value means the better accuracy</p></caption><graphic xlink:href="12864_2018_4546_Fig4_HTML" id="MO4"/></fig><table-wrap id="Tab6"><label>Table 6</label><caption><p>A comparison of the reconstruction accuracy spread of the different methods on the synthetic dataset</p></caption><table frame="hsides" rules="groups"><tbody><tr><td>SV</td><td colspan="4">Noise Level 50</td></tr><tr><td/><td>3DMax</td><td>MOGEN</td><td>ShRec3D</td><td>MCMC5C</td></tr><tr><td>&#x02003;set0</td><td>0.9708</td><td>0.9755</td><td>0.7928</td><td>0.0481</td></tr><tr><td>&#x02003;set1</td><td>0.9552</td><td>0.9648</td><td>0.8188</td><td>0.0779</td></tr><tr><td>&#x02003;set2</td><td>0.8405</td><td>0.8625</td><td>0.7175</td><td>0.1477</td></tr><tr><td>&#x02003;set3</td><td>0.6505</td><td>0.6406</td><td>0.5722</td><td>0.1201</td></tr><tr><td>&#x02003;set4</td><td>0.5302</td><td>0.5135</td><td>0.502</td><td>0.1916</td></tr><tr><td>&#x02003;set5</td><td>0.5211</td><td>0.4945</td><td>0.4938</td><td>0.1614</td></tr><tr><td>&#x02003;set6</td><td>0.5303</td><td>0.5211</td><td>0.4767</td><td>0.1938</td></tr><tr><td>SV</td><td colspan="4">Noise Level 100</td></tr><tr><td/><td>3DMax</td><td>MOGEN</td><td>ShRec3D</td><td>MCMC5C</td></tr><tr><td>&#x02003;set0</td><td>0.9753</td><td>0.9835</td><td>0.9239</td><td>0.3514</td></tr><tr><td>&#x02003;set1</td><td>0.963</td><td>0.968</td><td>0.9133</td><td>0.2642</td></tr><tr><td>&#x02003;set2</td><td>0.8578</td><td>0.8527</td><td>0.8072</td><td>0.3792</td></tr><tr><td>&#x02003;set3</td><td>0.6555</td><td>0.6039</td><td>0.6338</td><td>0.2068</td></tr><tr><td>&#x02003;set4</td><td>0.5703</td><td>0.4991</td><td>0.532</td><td>0.2456</td></tr><tr><td>&#x02003;set5</td><td>0.5342</td><td>0.4728</td><td>0.5183</td><td>0.1299</td></tr><tr><td>&#x02003;set6</td><td>0.5535</td><td>0.47</td><td>0.5026</td><td>0.1578</td></tr><tr><td>SV</td><td colspan="4">Noise Level 150</td></tr><tr><td/><td>3DMax</td><td>MOGEN</td><td>ShRec3D</td><td>MCMC5C</td></tr><tr><td>&#x02003;set0</td><td>0.976</td><td>0.9734</td><td>0.876</td><td>0.1933</td></tr><tr><td>&#x02003;set1</td><td>0.959</td><td>0.96</td><td>0.8613</td><td>0.2275</td></tr><tr><td>&#x02003;set2</td><td>0.8612</td><td>0.8485</td><td>0.7572</td><td>0.1016</td></tr><tr><td>&#x02003;set3</td><td>0.6821</td><td>0.6362</td><td>0.6546</td><td>0.0791</td></tr><tr><td>&#x02003;set4</td><td>0.5713</td><td>0.4915</td><td>0.5475</td><td>0.1146</td></tr><tr><td>&#x02003;set5</td><td>0.5285</td><td>0.4835</td><td>0.5268</td><td>0.0858</td></tr><tr><td>&#x02003;set6</td><td>0.5601</td><td>0.4318</td><td>0.5009</td><td>0.1106</td></tr><tr><td>SV</td><td colspan="4">Noise Level 200</td></tr><tr><td/><td>3DMax</td><td>MOGEN</td><td>ShRec3D</td><td>MCMC5C</td></tr><tr><td>&#x02003;set0</td><td>0.9771</td><td>0.9655</td><td>0.8499</td><td>0.0481</td></tr><tr><td>&#x02003;set1</td><td>0.9627</td><td>0.9533</td><td>0.8481</td><td>0.0779</td></tr><tr><td>&#x02003;set2</td><td>0.8634</td><td>0.8514</td><td>0.7743</td><td>0.1477</td></tr><tr><td>&#x02003;set3</td><td>0.6724</td><td>0.6606</td><td>0.6726</td><td>0.1201</td></tr><tr><td>&#x02003;set4</td><td>0.5679</td><td>0.5131</td><td>0.5559</td><td>0.1916</td></tr><tr><td>&#x02003;set5</td><td>0.5435</td><td>0.4886</td><td>0.5292</td><td>0.1614</td></tr><tr><td>&#x02003;set6</td><td>0.5487</td><td>0.4554</td><td>0.4992</td><td>0.1938</td></tr></tbody></table><table-wrap-foot><p>The reconstruction accuracy for 3DMax, MOGEN, ShRec3D, and MCMC5C at different levels of noise and structural variability. The dataset has resolution 150&#x000a0;bp/nm and TAD like feature architecture. Noise Level 50: comparison of dSCC value at Noise Level 50, Noise Level 100: comparison of dSCC value at Noise Level 100, Noise Level 150: comparison of dSCC value at Noise Level 150, Noise Level 200: comparison of dSCC value at Noise Level 200. The table values denote the distance Spearman correlation coefficient (dSCC) score in the range [&#x02212;1,1] and the SV denotes the structural variability level. Set 0-6 denotes seven different levels of structural variability in the increasing order. A higher dSCC value means the better accuracy</p></table-wrap-foot></table-wrap></p></sec><sec id="Sec16"><title>Assessment on real Hi-C data</title><p id="Par70">We applied 3DMax to a 1&#x000a0;MB resolution Hi-C dataset of GM06990 cell line [<xref ref-type="bibr" rid="CR10">10</xref>]. The Hi-C data for this cell line was generated with two different restriction enzymes: Ncol and HindIII. For comparison, we applied seven structure prediction methods 3DMax, 3DMax1 based on AdaGrad optimization algorithm, ShRec3D, ChromSDE, MCMC5C, MOGEN, and LorDG [<xref ref-type="bibr" rid="CR27">27</xref>] to predict the 3D structure of chromosomes of this cell line. All the methods take as input an interaction frequency matrix normalized by using the normalization pipeline in [<xref ref-type="bibr" rid="CR29">29</xref>]. We used the distance Spearman Correlation Coefficient (dSCC) and the distance Pearson Correlation Coefficient (dPCC) to assess the accuracy of these methods. The accuracy is determined by computing the dSCC value between the distance matrix of the normalized frequency input matrix and the Euclidean distance calculated from the predicted 3D structures. Figure&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>(<xref rid="Fig5" ref-type="fig">a</xref>) shows that 3DMax outperforms the other methods by at least 4% across 22 pairs of non-sex chromosomes of the cell line. 3DMax obtained an average spearman correlation coefficient of 0.85 across all the chromosomes while the second highest among the other methods has the coefficient of 0.82. Figure <xref rid="Fig5" ref-type="fig">5</xref>(<xref rid="Fig5" ref-type="fig">b</xref>) shows the Pearson correlation coefficient on the GM06990_HindIII cell. 3DMax obtained the highest average Pearson correlation coefficient of 0.795, which is better than the other methods.<fig id="Fig5"><label>Fig. 5</label><caption><p>A comparison of the accuracy of different methods on real Hi-C datasets. <bold>a</bold> The Spearman Correlation Coefficient of 3DMax, 3DMax1, MOGEN, ChromSDE, ShRec3D, MCMC5C, and LorDG on the normalized contact maps of GM06990_HindIII cell. <bold>b</bold> The Pearson Correlation Coefficient of 3DMax, 3DMax1, MOGEN, ChromSDE, ShRec3D, MCMC5C, and LorDG on the normalized contact maps of GM06990_HindIII cell. <bold>c</bold> The Comparison of 3DMax, 3DMax1, ChromSDE and ShRec3D on the normalized contact maps of GM06990 HindIII and Ncol cell. Y-axis denotes either the distance Spearman correlation coefficient (dSCC) score in the range [&#x02212;&#x02009;1,1] or the distance Pearson correlation coefficient score (dPCC) in the range [&#x02212;&#x02009;1,1]. X-axis denotes the Chromosome number. A higher dSCC value means the better accuracy</p></caption><graphic xlink:href="12864_2018_4546_Fig5_HTML" id="MO5"/></fig></p><p id="Par71">In Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>(<xref rid="Fig5" ref-type="fig">c</xref>) we compared the spearman correlation values of ShRec3D, ChromSDE, 3DMax, and 3DMax1 for the contact maps of GM06990 cell line with NcoI and HindIII restriction enzymes. 3DMax has the highest average dSCC value of 0.88 across the chromosomes of the cell line. Table&#x000a0;<xref rid="Tab7" ref-type="table">7</xref> shows a tabular representation of the model accuracy comparison visualized in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.<table-wrap id="Tab7"><label>Table 7</label><caption><p>A comparison of the accuracy spread of the different methods on real Hi-C datasets</p></caption><table frame="hsides" rules="groups"><tbody><tr><td/><td colspan="8">Spearman Correlation</td></tr><tr><td>Chromosome</td><td colspan="2">3DMax</td><td>3DMax1</td><td>MOGEN</td><td>ChromSDE</td><td>Shrec3D</td><td>MCMC5C</td><td>LorDG</td></tr><tr><td>1</td><td colspan="2">0.8088</td><td>0.8062</td><td>0.7662</td><td>0.7845</td><td>0.2951</td><td>0.463</td><td>0.7101</td></tr><tr><td>2</td><td colspan="2">0.8149</td><td>0.8126</td><td>0.7526</td><td>0.7245</td><td>0.4482</td><td>0.4143</td><td>0.7275</td></tr><tr><td>3</td><td colspan="2">0.8306</td><td>0.828</td><td>0.8044</td><td>0.814</td><td>0.4827</td><td>0.1564</td><td>0.7459</td></tr><tr><td>4</td><td colspan="2">0.8736</td><td>0.8715</td><td>0.8245</td><td>0.8636</td><td>0.8203</td><td>0.3595</td><td>0.8607</td></tr><tr><td>5</td><td colspan="2">0.8653</td><td>0.8631</td><td>0.8266</td><td>0.8551</td><td>0.7762</td><td>0.3813</td><td>0.8317</td></tr><tr><td>6</td><td colspan="2">0.848</td><td>0.845</td><td>0.8104</td><td>0.8303</td><td>0.7465</td><td>0.4078</td><td>0.8002</td></tr><tr><td>7</td><td colspan="2">0.831</td><td>0.8278</td><td>0.7925</td><td>0.8144</td><td>0.4087</td><td>0.5402</td><td>0.7536</td></tr><tr><td>8</td><td colspan="2">0.8701</td><td>0.8675</td><td>0.8236</td><td>0.857</td><td>0.8152</td><td>0.5584</td><td>0.8317</td></tr><tr><td>9</td><td colspan="2">0.851</td><td>0.846</td><td>0.7339</td><td>0.8184</td><td>0.421</td><td>0.5584</td><td>0.2972</td></tr><tr><td>10</td><td colspan="2">0.854</td><td>0.8505</td><td>0.8129</td><td>0.8392</td><td>0.6561</td><td>0.4967</td><td>0.7759</td></tr><tr><td>11</td><td colspan="2">0.8433</td><td>0.8398</td><td>0.8003</td><td>0.823</td><td>0.6936</td><td>0.5559</td><td>0.7896</td></tr><tr><td>12</td><td colspan="2">0.8558</td><td>0.8544</td><td>0.8259</td><td>0.8413</td><td>0.7332</td><td>0.3907</td><td>0.803</td></tr><tr><td>13</td><td colspan="2">0.8584</td><td>0.8537</td><td>0.8242</td><td>0.8381</td><td>0.6917</td><td>0.4437</td><td>0.8007</td></tr><tr><td>14</td><td colspan="2">0.8799</td><td>0.8754</td><td>0.8425</td><td>0.8605</td><td>0.7123</td><td>0.7065</td><td>0.7879</td></tr><tr><td>15</td><td colspan="2">0.8592</td><td>0.8488</td><td>0.8255</td><td>0.8346</td><td>0.6432</td><td>0.5246</td><td>0.7725</td></tr><tr><td>16</td><td colspan="2">0.8466</td><td>0.8397</td><td>0.7854</td><td>0.8188</td><td>0.6621</td><td>0.6208</td><td>0.7345</td></tr><tr><td>17</td><td colspan="2">0.837</td><td>0.8298</td><td>0.8127</td><td>0.8083</td><td>0.6732</td><td>0.557</td><td>0.719</td></tr><tr><td>18</td><td colspan="2">0.8537</td><td>0.8475</td><td>0.8139</td><td>0.8185</td><td>0.3717</td><td>0.6197</td><td>0.7492</td></tr><tr><td>19</td><td colspan="2">0.8668</td><td>0.8579</td><td>0.8077</td><td>0.8397</td><td>0.73</td><td>0.5362</td><td>0.8152</td></tr><tr><td>20</td><td colspan="2">0.8392</td><td>0.869</td><td>0.8146</td><td>0.8527</td><td>0.6291</td><td>0.6361</td><td>0.7779</td></tr><tr><td>21</td><td colspan="2">0.9017</td><td>0.8925</td><td>0.8421</td><td>0.8704</td><td>0.7831</td><td>0.841</td><td>0.8532</td></tr><tr><td>22</td><td colspan="2">0.866</td><td>0.8542</td><td>0.7977</td><td>0.8264</td><td>0.1065</td><td>0.6554</td><td>0.5639</td></tr><tr><td/><td colspan="8">Pearson Correlation</td></tr><tr><td>Chromosome</td><td colspan="2">3DMax</td><td>3DMax1</td><td>MOGEN</td><td>ChromSDE</td><td>Shrec3D</td><td>MCMC5C</td><td>LorDG</td></tr><tr><td>1</td><td colspan="2">0.7611</td><td>0.7491</td><td>0.7697</td><td>0.2352</td><td>0.2125</td><td>0.3497</td><td>0.2922</td></tr><tr><td>2</td><td colspan="2">0.7511</td><td>0.7401</td><td>0.7544</td><td>0.0042</td><td>0.3154</td><td>0.314</td><td>0.3187</td></tr><tr><td>3</td><td colspan="2">0.7603</td><td>0.7532</td><td>0.7938</td><td>0.7238</td><td>0.3539</td><td>0.1368</td><td>0.5597</td></tr><tr><td>4</td><td colspan="2">0.7813</td><td>0.7691</td><td>0.7739</td><td>0.8016</td><td>0.5922</td><td>0.2758</td><td>0.6675</td></tr><tr><td>5</td><td colspan="2">0.779</td><td>0.7661</td><td>0.8021</td><td>0.7215</td><td>0.5732</td><td>0.2673</td><td>0.6845</td></tr><tr><td>6</td><td colspan="2">0.7834</td><td>0.7709</td><td>0.7883</td><td>0.7422</td><td>0.5361</td><td>0.2705</td><td>0.5945</td></tr><tr><td>7</td><td colspan="2">0.7471</td><td>0.7334</td><td>0.7549</td><td>0.4693</td><td>0.2961</td><td>0.405</td><td>0.3044</td></tr><tr><td>8</td><td colspan="2">0.7994</td><td>0.794</td><td>0.7988</td><td>0.7533</td><td>0.5895</td><td>0.4138</td><td>0.6126</td></tr><tr><td>9</td><td colspan="2">0.8046</td><td>0.8063</td><td>0.6852</td><td>0.3711</td><td>0.3253</td><td>0.4446</td><td>0.017</td></tr><tr><td>10</td><td colspan="2">0.7836</td><td>0.7793</td><td>0.7965</td><td>0.6214</td><td>0.4614</td><td>0.3436</td><td>0.6428</td></tr><tr><td>11</td><td colspan="2">0.7628</td><td>0.7542</td><td>0.7852</td><td>0.7624</td><td>0.4761</td><td>0.39</td><td>0.6636</td></tr><tr><td>12</td><td colspan="2">0.8098</td><td>0.7856</td><td>0.813</td><td>0.7533</td><td>0.5106</td><td>0.2941</td><td>0.6727</td></tr><tr><td>13</td><td colspan="2">0.8037</td><td>0.7887</td><td>0.7989</td><td>0.7875</td><td>0.4544</td><td>0.2824</td><td>0.6483</td></tr><tr><td>14</td><td colspan="2">0.8411</td><td>0.8316</td><td>0.8357</td><td>0.7928</td><td>0.4855</td><td>0.518</td><td>0.6965</td></tr><tr><td>15</td><td colspan="2">0.8137</td><td>0.7892</td><td>0.8165</td><td>0.7948</td><td>0.4078</td><td>0.3745</td><td>0.179</td></tr><tr><td>16</td><td colspan="2">0.8075</td><td>0.804</td><td>0.7845</td><td>0.6925</td><td>0.4726</td><td>0.4489</td><td>0.6899</td></tr><tr><td>17</td><td colspan="2">0.8069</td><td>0.7981</td><td>0.8164</td><td>0.768</td><td>0.4662</td><td>0.3793</td><td>0.6879</td></tr><tr><td>18</td><td colspan="2">0.82</td><td>0.8079</td><td>0.7931</td><td>0.5246</td><td>0.2697</td><td>0.468</td><td>0.1519</td></tr><tr><td>19</td><td colspan="2">0.847</td><td>0.8356</td><td>0.8204</td><td>0.7674</td><td>0.5972</td><td>0.3881</td><td>0.7552</td></tr><tr><td>20</td><td colspan="2">0.7096</td><td>0.8347</td><td>0.8049</td><td>0.6113</td><td>0.3825</td><td>0.4039</td><td>0.731</td></tr><tr><td>21</td><td colspan="2">0.8892</td><td>0.8784</td><td>0.8561</td><td>0.802</td><td>0.5</td><td>0.5663</td><td>0.7509</td></tr><tr><td>22</td><td colspan="2">0.8396</td><td>0.8181</td><td>0.7486</td><td>0.7958</td><td>&#x02212;0.067</td><td>0.5262</td><td>0.0737</td></tr><tr><td/><td colspan="8">Spearman Correlation Of GM06990 (HINDIII &#x00026;NCOL) Cell</td></tr><tr><td>Chromosome</td><td>3DMax_HindIII</td><td>3DMax_Ncol</td><td>3DMax1_HindIII</td><td>3DMax1_Ncol</td><td>Shrec3D_HindIII</td><td>Shrec3D_Ncol</td><td>ChromSDE_HindIII</td><td>ChromSDE_Ncol</td></tr><tr><td>1</td><td>0.8088</td><td>0.8432</td><td>0.8062</td><td>0.8412</td><td>0.2951</td><td>0.3043</td><td>0.7845</td><td>0.1085</td></tr><tr><td>2</td><td>0.8149</td><td>0.8387</td><td>0.8126</td><td>0.8367</td><td>0.4482</td><td>0.2797</td><td>0.7245</td><td>0.8228</td></tr><tr><td>3</td><td>0.8306</td><td>0.8447</td><td>0.828</td><td>0.8425</td><td>0.4827</td><td>0.403</td><td>0.814</td><td>0.8271</td></tr><tr><td>4</td><td>0.8736</td><td>0.874</td><td>0.8715</td><td>0.872</td><td>0.8203</td><td>0.796</td><td>0.8636</td><td>0.8624</td></tr><tr><td>5</td><td>0.8653</td><td>0.8836</td><td>0.8631</td><td>0.8816</td><td>0.7762</td><td>0.8077</td><td>0.8551</td><td>0.872</td></tr><tr><td>6</td><td>0.848</td><td>0.8701</td><td>0.845</td><td>0.8677</td><td>0.7465</td><td>0.556</td><td>0.8303</td><td>0.8539</td></tr><tr><td>7</td><td>0.831</td><td>0.8509</td><td>0.8278</td><td>0.8483</td><td>0.4087</td><td>0.3147</td><td>0.8144</td><td>0.3709</td></tr><tr><td>8</td><td>0.8701</td><td>0.8509</td><td>0.8675</td><td>0.8924</td><td>0.8152</td><td>0.8559</td><td>0.857</td><td>0.8832</td></tr><tr><td>9</td><td>0.851</td><td>0.8732</td><td>0.846</td><td>0.8721</td><td>0.421</td><td>0.2899</td><td>0.8184</td><td>0.0239</td></tr><tr><td>10</td><td>0.854</td><td>0.8753</td><td>0.8505</td><td>0.8723</td><td>0.6561</td><td>0.4865</td><td>0.8392</td><td>0.8603</td></tr><tr><td>11</td><td>0.8433</td><td>0.876</td><td>0.8398</td><td>0.8731</td><td>0.6936</td><td>0.76</td><td>0.823</td><td>0.8603</td></tr><tr><td>12</td><td>0.8558</td><td>0.873</td><td>0.8544</td><td>0.8698</td><td>0.7332</td><td>0.7819</td><td>0.8413</td><td>0.8531</td></tr><tr><td>13</td><td>0.8584</td><td>0.8665</td><td>0.8537</td><td>0.8621</td><td>0.6917</td><td>0.8064</td><td>0.8381</td><td>0.8457</td></tr><tr><td>14</td><td>0.8799</td><td>0.9</td><td>0.8754</td><td>0.8965</td><td>0.7123</td><td>0.6141</td><td>0.8605</td><td>0.887</td></tr><tr><td>15</td><td>0.8592</td><td>0.8842</td><td>0.8488</td><td>0.879</td><td>0.6432</td><td>0.715</td><td>0.8346</td><td>0.8707</td></tr><tr><td>16</td><td>0.8466</td><td>0.8975</td><td>0.8397</td><td>0.8921</td><td>0.6621</td><td>0.7156</td><td>0.8188</td><td>0.8856</td></tr><tr><td>17</td><td>0.837</td><td>0.8858</td><td>0.8298</td><td>0.8473</td><td>0.6732</td><td>0.6988</td><td>0.8083</td><td>0.866</td></tr><tr><td>18</td><td>0.8537</td><td>0.8701</td><td>0.8475</td><td>0.865</td><td>0.3717</td><td>0.7055</td><td>0.8185</td><td>0.8407</td></tr><tr><td>19</td><td>0.8668</td><td>0.936</td><td>0.8579</td><td>0.9324</td><td>0.73</td><td>0.7613</td><td>0.8397</td><td>0.925</td></tr><tr><td>20</td><td>0.8392</td><td>0.9133</td><td>0.869</td><td>0.9037</td><td>0.6291</td><td>0.7128</td><td>0.8527</td><td>0.8878</td></tr><tr><td>21</td><td>0.9017</td><td>0.9382</td><td>0.8925</td><td>0.9274</td><td>0.7831</td><td>0.873</td><td>0.8704</td><td>0.8688</td></tr><tr><td>22</td><td>0.866</td><td>0.9414</td><td>0.8542</td><td>0.9359</td><td>0.1065</td><td>0.7311</td><td>0.8264</td><td>0.922</td></tr></tbody></table><table-wrap-foot><p>Top: The Spearman Correlation Coefficient of 3DMax, 3DMax1, MOGEN, ChromSDE, ShRec3D, MCMC5C, and LorDG on the normalized contact maps of GM06990_HindIII cell, and the Pearson Correlation Coefficient of 3DMax, 3DMax1, MOGEN, ChromSDE, ShRec3D, MCMC5C, and LorDG on the normalized contact maps of GM06990_HindIII cell. Bottom: The Comparison of dSCC values of 3DMax, 3DMax1, ChromSDE and ShRec3D on the normalized contact maps of GM06990 HindIII and Ncol cell</p><p>The values denote the distance Spearman correlation coefficient (dSCC) score in the range [&#x02212;1,1] or the distance Pearson correlation coefficient score (dPCC) in the range [&#x02212;1,1]</p></table-wrap-foot></table-wrap></p><p id="Par72">On average, 3DMax&#x02019;s accuracy is at least 3% higher than the other methods. In addition, since each Hi-C data obtained with a restriction enzyme is an independent observation of the GM06690 cell, we checked the robustness of our method by comparing the predicted structure from Ncol with one from the HindIII enzyme. We compared the predicted structure of chromosome 19 of HindIII data and NcoI replicate data. The dSCC and dRMSE value of the comparison were 0.9 and 0.0064 respectively, suggesting the two models are very similar.</p></sec><sec id="Sec17"><title>Consistency checking of models in ensembles</title><p id="Par73">To assess the consistency of the structures generated by 3DMax, we compared 50 structures generated at the optimal &#x003b1; value for each chromosome for the GM06990_HindIII cell and the malignant B-cell, respectively. We used the dSCC value to measure the similarity between these structures. Figure&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> shows the average dSCC for each chromosome for Hi-C data of the GM06990_HindIII cell and the malignant B-cell respectively. The average dSCC between the models is &#x0003e;&#x02009;0.9 for all the chromosomes, indicating chromosomal models generated by 3DMax are quite similar to each other.<fig id="Fig6"><label>Fig. 6</label><caption><p>The similarity between structures generated by 3DMax. The average similarity for an ensemble of structures generated for the GM06990_HindIII cell and the malignant B-cell chromosomes using the optimal &#x003b1; value for each chromosome</p></caption><graphic xlink:href="12864_2018_4546_Fig6_HTML" id="MO6"/></fig></p></sec><sec id="Sec18"><title>Comparative analysis of the performance of 3DMax, 3DMax1, MOGEN, ChromSDE, ShRec3D, MCMC5C, and LorDG on Hi-C data normalized with three popular normalization methods</title><p id="Par74">Due to biases in Hi-C experiments, Hi-C data is generally noisy. Some of these biases are associated with cutting frequencies of restriction enzymes, GC content and sequence uniqueness [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR30">30</xref>&#x02013;<xref ref-type="bibr" rid="CR32">32</xref>]. In order reduce the effects of these biases, the Hi-C data contact matrix is normalized to reflect the strength of the underlying chromosomal interactions more accurately.</p><p id="Par75">We performed a comparative study of the performance of different 3D modeling methods when each of the three commonly used normalization techniques: Yaffe and Tanay [<xref ref-type="bibr" rid="CR30">30</xref>] normalization technique, ICE (iterative correction and eigenvector decomposition) technique [<xref ref-type="bibr" rid="CR31">31</xref>], and Sequential Component Normalization (SCN) technique [<xref ref-type="bibr" rid="CR32">32</xref>] is applied. Figure <xref rid="Fig5" ref-type="fig">5</xref>(<xref rid="Fig5" ref-type="fig">a</xref>) shows the result obtained by using the Yaffe and Tanay normalization technique, where 3DMax outperformed the other methods. Table&#x000a0;<xref rid="Tab8" ref-type="table">8</xref> shows the average dSCC value for different chromosomes for each of the normalization technique. 3DMax and 3DMax1 produces the best performance when the Yaffe and Tanay normalization technique is used, and the 3DMax1 produces the best performances when the ICE and SCN normalization method are used respectively. It is evident from the results that the normalization techniques have a significant impact on the performance of some 3D modeling methods.<table-wrap id="Tab8"><label>Table 8</label><caption><p>The average dSCC score of the chromosomal models of the GM06990 cell line reconstructed with three normalization techniques</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>3DMax</th><th>3DMax1</th><th>MOGEN</th><th>ChromSDE</th><th>Shrec3D</th><th>MCMC5C</th><th>LorDG</th></tr></thead><tbody><tr><td>Yaffe &#x00026;Tanay</td><td>
<bold>0.85</bold>
</td><td>
<bold>0.85</bold>
</td><td>0.81</td><td>0.82</td><td>0.60</td><td>0.52</td><td>0.75</td></tr><tr><td>ICE</td><td>0.75</td><td>
<bold>0.85</bold>
</td><td>0.61</td><td>
<bold>0.83</bold>
</td><td>0.60</td><td>0.032</td><td>0.78</td></tr><tr><td>SCN</td><td>0.72</td><td>
<bold>0.85</bold>
</td><td>0.58</td><td>
<bold>0.83</bold>
</td><td>0.71</td><td>0.028</td><td>0.79</td></tr></tbody></table><table-wrap-foot><p>The average dSCC scores of chromosomal models of the GM06990 cell line reconstructed by 3DMax, 3DMax1, MOGEN, ChromSDE, ShRec3D, MCMC5C, and LorDG with the three normalization methods. The top 2&#x000a0;scores for each normalization technique are highlighted in bold text</p></table-wrap-foot></table-wrap></p></sec></sec><sec id="Sec19"><title>Discussion</title><sec id="Sec20"><title>Comparison of the computing performance of the different methods</title><p id="Par76">To improve the computing performance and the usability of our algorithm, we also implemented the 3DMax algorithm in the Java programming language (available via <ext-link ext-link-type="uri" xlink:href="https://github.com/BDM-Lab/3DMax/releases">https://github.com/BDM-Lab/3DMax/releases</ext-link>). The performance comparison of the MATLAB and the Java programming versions for a GM06990_HindIII cell line dataset is shown in Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>. As shown in the Figure, the result produced by two separate Java implementation runs is consistent with those of the MATLAB implementation. We tested 3DMax and all other methods on an Intel Core i5-2400 3.10GHz computer with 8GB RAM.<fig id="Fig7"><label>Fig. 7</label><caption><p>A comparison of the performance of 3DMax algorithm MATLAB and Java programing language implementation. The performance comparison of the MATLAB and the Java 3DMax implementation for a GM06990_HindIII cell line dataset. The Figure shows two different runs of the Java implementation compared against the MATLAB implementation. Models produced by both implementations are comparable with a similar accuracy. Y-axis denotes either the distance Spearman correlation coefficient (dSCC) score in the range [&#x02212;&#x02009;1,1]. X-axis denotes the Chromosome number. A higher dSCC value means the better accuracy</p></caption><graphic xlink:href="12864_2018_4546_Fig7_HTML" id="MO7"/></fig></p><p id="Par77">We compared 3DMax algorithm with the other algorithms mentioned above in terms of computation speed, and the memory cost. To do this, we benchmarked them against the chromosomes of GM06990_HindIII cell data. It takes 3DMax java implementation about 13&#x000a0;s to predict the structure for all the chromosomes of the entire genome when it uses a single conversion factor (&#x003b1;), while it generates a single structure for each chromosome. 3DMax uses about 20&#x000a0;min to generate the representative structures for the entire cell when it estimates the optimal conversion factor (&#x003b1;) in the range [0.1, 2].</p><p id="Par78">Though ChromSDE produced one of the best results, it was memory intensive and slow to generate large structures. ChromSDE could not handle efficiently input data with &#x0003e;&#x02009;400 bins on our machine with 8&#x000a0;GB RAM. We were only able to use ChromSDE to create structure on our server machine with 65GB RAM. It takes ChromSDE 20-25&#x000a0;h to generate structure for the entire GM06990_HindIII cell data. MOGEN uses over 2&#x000a0;h to generate the models for the cell line. It takes LorDG about 1&#x000a0;h and 7&#x000a0;min to process the whole cell line. MCMC5C with the default parameters uses 1&#x000a0;h and 19&#x000a0;min to generate the models. But to obtain better accuracy by increasing the number of iterations and the number of structures generated, the MCMC5C algorithm could run for &#x0003e;&#x02009;18&#x000a0;h before it converges.</p></sec><sec id="Sec21"><title>Validation using FISH data</title><p id="Par79">We validated the model of Chromosome 22 reconstructed by 3DMax with an independent FISH data for GM06990_HindIII cell. Four 3D FISH probes for four loci (L5, L6, L7, L8) of the consecutive positions alternate between two chromosome compartments (A and B) [<xref ref-type="bibr" rid="CR10">10</xref>]. That is, locus L5 and locus L7 are in Compartment A, and locus L6 and locus L8 are in Compartment B. According to the FISH data, L7 is spatially closer to L5 than to L6, though L6 lies between L5 and L7 on the chromosome sequence. Likewise, L6 is spatially closer to L8 than to L7. To check if this holds in the reconstructed 3D model, we measured the distance between these loci on the predicted structure. Figure&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref> shows a model constructed by 3DMax with the four probes L5, L6&#x000a0;L7, L8 colored green, blue, yellow, magenta respectively. The distances between these loci: L5 &#x02013; L6, L5 &#x02013; L7, L6 &#x02013; L7, L6-L8 are reported. Indeed, the distance L5 &#x02013; L7 was shorter than L5 &#x02013; L6 and the distance L6 - L8 was shorter than L6 &#x02013; L7. The 3D structure was visualized with Pymol [<xref ref-type="bibr" rid="CR46">46</xref>].<fig id="Fig8"><label>Fig. 8</label><caption><p>Validation with FISH data. Distances between four fluorescence in situ hybridization (FISH) probes in the model of Chromosome 22 reconstructed by 3DMax. L5, L6, L7 and L8 denote four probes. The distances between the probes are labelled along the virtual line segments connecting the probes</p></caption><graphic xlink:href="12864_2018_4546_Fig8_HTML" id="MO8"/></fig></p></sec></sec><sec id="Sec22"><title>Conclusions</title><p id="Par80">We developed a new method (3DMax) based on the maximum likelihood inference to reconstruct the 3D structure of chromosomes from Hi-C data.&#x000a0;3DMax combines a maximum likelihood algorithm and a gradient ascent method to generate optimized structures for chromosomes. The results on synthetic datasets show that the method performs robustly in the presence of noise and structural variability. This method provides a way to automatically determine the best conversion factor (&#x003b1;) for any Hi-C contact data. The results on the real Hi-C datasets reveals that 3DMax can effectively reconstruct chromosomal models from Hi-C contact matrices normalized by different methods. We also show that a major strength of the 3DMax algorithm is that it is faster and has a low memory requirement compared to some other methods.</p></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>3C</term><def><p id="Par4">Chromosome Conformation Capture</p></def></def-item><def-item><term>3DMax</term><def><p id="Par5">Three dimensional structure modeling using a maximum likelihood approach.</p></def></def-item><def-item><term>3DMax1</term><def><p id="Par6">A variant of 3DMax</p></def></def-item><def-item><term>ICE</term><def><p id="Par7">Iterative Correction and Eigenvector decomposition</p></def></def-item><def-item><term>IF</term><def><p id="Par8">Interaction Frequency</p></def></def-item><def-item><term>PCC</term><def><p id="Par9">Pearson Correlation Coefficient</p></def></def-item><def-item><term>RMSE</term><def><p id="Par10">Root Mean Square Error</p></def></def-item><def-item><term>SCC</term><def><p id="Par11">Spearman&#x02019;s correlation coefficient</p></def></def-item><def-item><term>SCN</term><def><p id="Par12">Sequential Component Normalization</p></def></def-item><def-item><term>SV</term><def><p id="Par13">Structural Variability</p></def></def-item><def-item><term>TAD</term><def><p id="Par14">Topological Associating Domain</p></def></def-item></def-list></glossary><ack><title>Acknowledgements</title><p>Not applicable.</p><sec id="FPar1"><title>Funding</title><p id="Par81">This work was supported by the National Science Foundation (NSF) CAREER award (grant no: DBI1149224) to JC.</p></sec><sec id="FPar2"><title>Availability of data and materials</title><p id="Par82">The GM06990 cell datasets, the Malignant B-cell datasets, the models generated, and the datasets generated during and analysed during the current study are available at <ext-link ext-link-type="uri" xlink:href="http://sysbio.rnet.missouri.edu/bdm_download/3DEM/">http://sysbio.rnet.missouri.edu/bdm_download/3DMax/</ext-link>.</p><p id="Par83">The synthetic datasets used in this study can be downloaded from here: <ext-link ext-link-type="uri" xlink:href="http://sgt.cnag.cat/3dg/datasets/">http://sgt.cnag.cat/3dg/datasets/</ext-link>.</p><p id="Par84">The MATLAB, and the Java source codes for 3DMax are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/BDM-Lab/3DMax">https://github.com/BDM-Lab/3DMax</ext-link>.</p><p id="Par85">A video demonstration of how to use 3DMax is available at <ext-link ext-link-type="uri" xlink:href="https://youtu.be/ehQUFWoHwfo">https://youtu.be/ehQUFWoHwfo</ext-link>.</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>JC conceived the project. YZ and OO designed the algorithm. OO implemented the algorithm. OO performed the statistical and simulation analyses. YZ, OO and JC evaluated the results, and wrote the manuscripts. All authors reviewed the manuscript. All authors read and approved the final manuscript.</p></notes><notes notes-type="COI-statement"><sec id="FPar3"><title>Ethics approval and consent to participate</title><p id="Par86">Not applicable.</p></sec><sec id="FPar4"><title>Consent for publication</title><p id="Par87">Not applicable.</p></sec><sec id="FPar5"><title>Competing interests</title><p id="Par88">The authors declare that they have no competing interests.</p></sec><sec id="FPar6"><title>Publisher&#x02019;s Note</title><p id="Par89">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dekker</surname><given-names>J</given-names></name></person-group><article-title>Gene regulation in the third dimension</article-title><source>Science</source><year>2008</year><volume>319</volume><fpage>1793</fpage><lpage>1794</lpage><pub-id pub-id-type="doi">10.1126/science.1152850</pub-id><?supplied-pmid 18369139?><pub-id pub-id-type="pmid">18369139</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fraser</surname><given-names>P</given-names></name><name><surname>Bickmore</surname><given-names>W</given-names></name></person-group><article-title>Nuclear organization of the genome and the potential for gene regulation</article-title><source>Nature</source><year>2007</year><volume>447</volume><fpage>413</fpage><lpage>417</lpage><pub-id pub-id-type="doi">10.1038/nature05916</pub-id><?supplied-pmid 17522674?><pub-id pub-id-type="pmid">17522674</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miele</surname><given-names>A</given-names></name><name><surname>Dekker</surname><given-names>J</given-names></name></person-group><article-title>Long-range chromosomal interactions and gene regulation</article-title><source>Mol BioSyst</source><year>2008</year><volume>4</volume><fpage>1046</fpage><lpage>1057</lpage><pub-id pub-id-type="doi">10.1039/b803580f</pub-id><?supplied-pmid 18931780?><pub-id pub-id-type="pmid">18931780</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Misteli</surname><given-names>T</given-names></name></person-group><article-title>Beyond the sequence: cellular organization of genome function</article-title><source>Cell</source><year>2007</year><volume>128</volume><fpage>787</fpage><lpage>800</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2007.01.028</pub-id><?supplied-pmid 17320514?><pub-id pub-id-type="pmid">17320514</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="other">Van Steensel B, and Job Dekker. "Genomics tools for unraveling chromosome architecture." Nat Biotechnol 28.10 (2010): 1089-1095.</mixed-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dekker</surname><given-names>J</given-names></name><name><surname>Rippe</surname><given-names>K</given-names></name><name><surname>Dekker</surname><given-names>M</given-names></name><name><surname>Kleckner</surname><given-names>N</given-names></name></person-group><article-title>Capturing chromosome conformation</article-title><source>Science</source><year>2002</year><volume>295</volume><issue>5558</issue><fpage>1306</fpage><lpage>1311</lpage><pub-id pub-id-type="doi">10.1126/science.1067799</pub-id><?supplied-pmid 11847345?><pub-id pub-id-type="pmid">11847345</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simonis</surname><given-names>M</given-names></name><name><surname>Klous</surname><given-names>P</given-names></name><name><surname>Splinter</surname><given-names>E</given-names></name><name><surname>Moshkin</surname><given-names>Y</given-names></name><name><surname>Willemsen</surname><given-names>R</given-names></name><name><surname>de Wit</surname><given-names>E</given-names></name><name><surname>van Steensel</surname><given-names>B</given-names></name><name><surname>de Laat</surname><given-names>W</given-names></name></person-group><article-title>Nuclear organization of active and inactive chromatin domains uncovered by chromosome conformation capture-on-ChIP (4C)</article-title><source>Nat Genet</source><year>2006</year><volume>38</volume><fpage>1348</fpage><lpage>1354</lpage><pub-id pub-id-type="doi">10.1038/ng1896</pub-id><?supplied-pmid 17033623?><pub-id pub-id-type="pmid">17033623</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>Z</given-names></name><name><surname>Tavoosidana</surname><given-names>G</given-names></name><name><surname>Sj&#x000f6;linder</surname><given-names>M</given-names></name><name><surname>G&#x000f6;nd&#x000f6;r</surname><given-names>A</given-names></name><name><surname>Mariano</surname><given-names>P</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Kanduri</surname><given-names>C</given-names></name><name><surname>Lezcano</surname><given-names>M</given-names></name><name><surname>Sandhu</surname><given-names>KS</given-names></name><name><surname>Singh</surname><given-names>U</given-names></name><name><surname>Pant</surname><given-names>V</given-names></name><name><surname>Tiwari</surname><given-names>V</given-names></name><name><surname>Kurukuti</surname><given-names>S</given-names></name><name><surname>Ohlsson</surname><given-names>R</given-names></name></person-group><article-title>Circular chromosome conformation capture (4C) uncovers extensive networks of epigenetically regulated intra- and interchromosomal interactions</article-title><source>Nat Genet</source><year>2006</year><volume>38</volume><fpage>1341</fpage><lpage>1347</lpage><pub-id pub-id-type="doi">10.1038/ng1891</pub-id><?supplied-pmid 17033624?><pub-id pub-id-type="pmid">17033624</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dostie</surname><given-names>J</given-names></name><name><surname>Dekker</surname><given-names>J</given-names></name></person-group><article-title>Mapping networks of physical interactions between genomic elements using 5C technology</article-title><source>Nat Protoc</source><year>2007</year><volume>2</volume><fpage>988</fpage><lpage>1002</lpage><pub-id pub-id-type="doi">10.1038/nprot.2007.116</pub-id><?supplied-pmid 17446898?><pub-id pub-id-type="pmid">17446898</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lieberman-Aiden</surname><given-names>E</given-names></name><name><surname>Van Berkum</surname><given-names>NL</given-names></name><name><surname>Williams</surname><given-names>L</given-names></name><name><surname>Imakaev</surname><given-names>M</given-names></name><name><surname>Ragoczy</surname><given-names>T</given-names></name><name><surname>Telling</surname><given-names>A</given-names></name><name><surname>Amit</surname><given-names>I</given-names></name><name><surname>Lajoie</surname><given-names>BR</given-names></name><name><surname>Sabo</surname><given-names>PJ</given-names></name><name><surname>Dorschner</surname><given-names>MO</given-names></name><name><surname>Sandstrom</surname><given-names>R</given-names></name></person-group><article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title><source>Science</source><year>2009</year><volume>326</volume><issue>5950</issue><fpage>289</fpage><lpage>293</lpage><pub-id pub-id-type="doi">10.1126/science.1181369</pub-id><?supplied-pmid 19815776?><pub-id pub-id-type="pmid">19815776</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="other">Rao SS, Huntley MH, Durand NC, Stamenova EK, Bochkov ID, Robinson JT, Sanborn AL, Machol I, Omer AD, Lander ES, Aiden EL. A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping. Cell. 2014;159(7):1665-80.</mixed-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duan</surname><given-names>Z</given-names></name><name><surname>Andronescu</surname><given-names>M</given-names></name><name><surname>Schutz</surname><given-names>K</given-names></name><name><surname>McIlwain</surname><given-names>S</given-names></name><name><surname>Kim</surname><given-names>YJ</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Shendure</surname><given-names>J</given-names></name><name><surname>Fields</surname><given-names>S</given-names></name><name><surname>Blau</surname><given-names>CA</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name></person-group><article-title>A three-dimensional model of the yeast genome</article-title><source>Nature</source><year>2010</year><volume>465</volume><issue>7296</issue><fpage>363</fpage><lpage>367</lpage><pub-id pub-id-type="doi">10.1038/nature08973</pub-id><?supplied-pmid 20436457?><pub-id pub-id-type="pmid">20436457</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ba&#x000f9;</surname><given-names>D</given-names></name><name><surname>Marti-Renom</surname><given-names>MA</given-names></name></person-group><article-title>Genome structure determination via 3C-based data integration by the integrative modeling platform</article-title><source>Methods</source><year>2012</year><volume>58</volume><issue>3</issue><fpage>300</fpage><lpage>306</lpage><pub-id pub-id-type="doi">10.1016/j.ymeth.2012.04.004</pub-id><?supplied-pmid 22522224?><pub-id pub-id-type="pmid">22522224</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rousseau</surname><given-names>M</given-names></name><name><surname>Fraser</surname><given-names>J</given-names></name><name><surname>Ferraiuolo</surname><given-names>MA</given-names></name><name><surname>Dostie</surname><given-names>J</given-names></name><name><surname>Blanchette</surname><given-names>M</given-names></name></person-group><article-title>Three-dimensional modeling of chromatin structure from interaction frequency data using Markov chain Monte Carlo sampling</article-title><source>BMC Bioinformatics</source><year>2011</year><volume>12</volume><issue>1</issue><fpage>414</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-12-414</pub-id><?supplied-pmid 22026390?><pub-id pub-id-type="pmid">22026390</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trussart</surname><given-names>M</given-names></name><name><surname>Serra</surname><given-names>F</given-names></name><name><surname>Ba&#x000f9;</surname><given-names>D</given-names></name><name><surname>Junier</surname><given-names>I</given-names></name><name><surname>Serrano</surname><given-names>L</given-names></name><name><surname>Marti-Renom</surname><given-names>MA</given-names></name></person-group><article-title>Assessing the limits of restraint-based 3D modeling of genomes and genomic domains</article-title><source>Nucleic Acids Res</source><year>2015</year><volume>43</volume><issue>7</issue><fpage>3465</fpage><lpage>3477</lpage><pub-id pub-id-type="doi">10.1093/nar/gkv221</pub-id><?supplied-pmid 25800747?><pub-id pub-id-type="pmid">25800747</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>G</given-names></name><name><surname>Toh</surname><given-names>KC</given-names></name><name><surname>Sung</surname><given-names>WK</given-names></name></person-group><article-title>Inference of spatial organizations of chromosomes using semi-definite embedding approach and hi-C data</article-title><source>Annual international conference on research in computational molecular biology</source><year>2013</year><publisher-loc>Berlin Heidelberg</publisher-loc><publisher-name>Springer</publisher-name><fpage>317</fpage><lpage>332</lpage></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>M</given-names></name><name><surname>Deng</surname><given-names>K</given-names></name><name><surname>Qin</surname><given-names>Z</given-names></name><name><surname>Dixon</surname><given-names>J</given-names></name><name><surname>Selvaraj</surname><given-names>S</given-names></name><name><surname>Fang</surname><given-names>J</given-names></name><name><surname>Ren</surname><given-names>B</given-names></name><name><surname>Liu</surname><given-names>JS</given-names></name></person-group><article-title>Bayesian inference of spatial organizations of chromosomes</article-title><source>PLoS Comput Biol</source><year>2013</year><volume>9</volume><issue>1</issue><fpage>e1002893</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002893</pub-id><?supplied-pmid 23382666?><pub-id pub-id-type="pmid">23382666</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Varoquaux</surname><given-names>N</given-names></name><name><surname>Ay</surname><given-names>F</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name><name><surname>Vert</surname><given-names>JP</given-names></name></person-group><article-title>A statistical approach for inferring the 3D structure of the genome</article-title><source>Bioinformatics</source><year>2014</year><volume>30</volume><issue>12</issue><fpage>i26</fpage><lpage>i33</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu268</pub-id><?supplied-pmid 24931992?><pub-id pub-id-type="pmid">24931992</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trieu</surname><given-names>T</given-names></name><name><surname>Cheng</surname><given-names>J</given-names></name></person-group><article-title>MOGEN: a tool for reconstructing 3D models of genomes from chromosomal conformation capturing data</article-title><source>Bioinformatics</source><year>2016</year><volume>32</volume><issue>9</issue><fpage>1286</fpage><lpage>1292</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv754</pub-id><?supplied-pmid 26722115?><pub-id pub-id-type="pmid">26722115</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Zeng</surname><given-names>J</given-names></name></person-group><article-title>Inferential modeling of 3D chromatin structure</article-title><source>Nucleic Acids Res</source><year>2015</year><volume>43</volume><issue>8</issue><fpage>e54</fpage><pub-id pub-id-type="doi">10.1093/nar/gkv100</pub-id><?supplied-pmid 25690896?><pub-id pub-id-type="pmid">25690896</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zou</surname><given-names>C</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Ouyang</surname><given-names>Z</given-names></name></person-group><article-title>HSA: integrating multi-track hi-C data for genome-scale reconstruction of 3D chromatin structure</article-title><source>Genome Biol</source><year>2016</year><volume>17</volume><issue>1</issue><fpage>40</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-0896-1</pub-id><?supplied-pmid 26936376?><pub-id pub-id-type="pmid">26936376</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="other">Trieu T, Cheng J. Large-scale reconstruction of 3D structures of human chromosomes from chromosomal contact data. Nucleic Acids Res. 2014; 10.1093/nar/gkt1411.</mixed-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nowotny</surname><given-names>J</given-names></name><name><surname>Ahmed</surname><given-names>S</given-names></name><name><surname>Xu</surname><given-names>L</given-names></name><name><surname>Oluwadare</surname><given-names>O</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Hensley</surname><given-names>N</given-names></name><name><surname>Trieu</surname><given-names>T</given-names></name><name><surname>Cao</surname><given-names>R</given-names></name><name><surname>Cheng</surname><given-names>J</given-names></name></person-group><article-title>Iterative reconstruction of three-dimensional models of human chromosomes from chromosomal contact data</article-title><source>BMC Bioinformatics</source><year>2015</year><volume>16</volume><issue>1</issue><fpage>1</fpage><pub-id pub-id-type="doi">10.1186/s12859-015-0772-0</pub-id><pub-id pub-id-type="pmid">25591917</pub-id></element-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="other">Lesne, Annick, et al. "3D genome reconstruction from chromosomal contacts." Nat Methods 11.11 (2014): 1141-1143.</mixed-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wachter</surname><given-names>A</given-names></name><name><surname>Biegler</surname><given-names>LT</given-names></name></person-group><article-title>On the implementation of an interior-point filter line-search algorithm for large-scale nonlinear programming</article-title><source>Math Program</source><year>2006</year><volume>106</volume><fpage>25</fpage><lpage>27</lpage><pub-id pub-id-type="doi">10.1007/s10107-004-0559-y</pub-id></element-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Russel</surname><given-names>D</given-names></name><name><surname>Lasker</surname><given-names>K</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name><name><surname>Vel&#x000e1;zquez-Muriel</surname><given-names>J</given-names></name><name><surname>Tjioe</surname><given-names>E</given-names></name><name><surname>Schneidman-Duhovny</surname><given-names>D</given-names></name><name><surname>Peterson</surname><given-names>B</given-names></name><name><surname>Sali</surname><given-names>A</given-names></name></person-group><article-title>Putting the pieces together: integrative modeling platform software for structure determination of macromolecular assemblies</article-title><source>PLoS Biol</source><year>2012</year><volume>10</volume><issue>1</issue><fpage>e1001244</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.1001244</pub-id><?supplied-pmid 22272186?><pub-id pub-id-type="pmid">22272186</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="other">Trieu, Tuan, and Jianlin Cheng. "3D genome structure modeling by Lorentzian objective function." Nucleic Acids Res 45.3 (2017): 1049-1058.</mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="other">Mossel E, Vigoda E. Limitations of Markov chain Monte Carlo algorithms for Bayesian inference of phylogeny. Ann Appl Probab. 2006:2215&#x02013;34.</mixed-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cole</surname><given-names>SR</given-names></name><name><surname>Chu</surname><given-names>H</given-names></name><name><surname>Greenland</surname><given-names>S</given-names></name><name><surname>Hamra</surname><given-names>G</given-names></name><name><surname>Richardson</surname><given-names>DB</given-names></name></person-group><article-title>Bayesian posterior distributions without Markov chains</article-title><source>Am J Epidemiol</source><year>2012</year><volume>175</volume><issue>5</issue><fpage>368</fpage><lpage>375</lpage><pub-id pub-id-type="doi">10.1093/aje/kwr433</pub-id><?supplied-pmid 22306565?><pub-id pub-id-type="pmid">22306565</pub-id></element-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yaffe</surname><given-names>E</given-names></name><name><surname>Tanay</surname><given-names>A</given-names></name></person-group><article-title>Probabilistic modeling of hi-C contact maps eliminates systematic biases to characterize global chromosomal architecture</article-title><source>Nat Genet</source><year>2011</year><volume>43</volume><fpage>1059</fpage><lpage>1065</lpage><pub-id pub-id-type="doi">10.1038/ng.947</pub-id><?supplied-pmid 22001755?><pub-id pub-id-type="pmid">22001755</pub-id></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Imakaev</surname><given-names>M</given-names></name><name><surname>Fudenberg</surname><given-names>G</given-names></name><name><surname>McCord</surname><given-names>RP</given-names></name><name><surname>Naumova</surname><given-names>N</given-names></name><name><surname>Goloborodko</surname><given-names>A</given-names></name><name><surname>Lajoie</surname><given-names>BR</given-names></name><etal/></person-group><article-title>Iterative correction of hi-C data reveals hallmarks of chromosome organization</article-title><source>Nat Methods</source><year>2012</year><volume>9</volume><issue>10</issue><fpage>999</fpage><lpage>1003</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2148</pub-id><?supplied-pmid 22941365?><pub-id pub-id-type="pmid">22941365</pub-id></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cournac</surname><given-names>A</given-names></name><name><surname>Marie-Nelly</surname><given-names>H</given-names></name><name><surname>Marbouty</surname><given-names>M</given-names></name><name><surname>Koszul</surname><given-names>R</given-names></name><name><surname>Mozziconacci</surname><given-names>J</given-names></name></person-group><article-title>Normalization of a chromosomal contact map</article-title><source>BMC Genomics</source><year>2012</year><volume>13</volume><issue>1</issue><fpage>436</fpage><pub-id pub-id-type="doi">10.1186/1471-2164-13-436</pub-id><?supplied-pmid 22935139?><pub-id pub-id-type="pmid">22935139</pub-id></element-citation></ref><ref id="CR33"><label>33.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Deza</surname><given-names>MM</given-names></name><name><surname>Deza</surname><given-names>E</given-names></name></person-group><source>Encyclopedia of distances. Encyclopedia of distances</source><year>2009</year><publisher-loc>Berlin Heidelberg</publisher-loc><publisher-name>Springer</publisher-name><fpage>1</fpage><lpage>583</lpage></element-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="other">Duchi J, Hazan E, Singer Y. Adaptive subgradient methods for online learning and stochastic optimization. Journal of Machine Learning Research. 2011;12:2121-59.</mixed-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="other">Dean J, Corrado G, Monga R, Chen K, Devin M, Mao M, Senior A, Tucker P, Yang K, Le QV, Ng AY. Large scale distributed deep networks. In Advances in neural information processing systems. 2012;1223-31.</mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="other">Kendall DG. A survey of the statistical theory of shape. Stat Sci. 1989:87&#x02013;99.</mixed-citation></ref><ref id="CR37"><label>37.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bookstein</surname><given-names>FL</given-names></name></person-group><source>Morphometric tools for landmark data</source><year>1991</year><publisher-loc>Cambridge, UK</publisher-loc><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Seber</surname><given-names>GAF</given-names></name></person-group><source>Multivariate observations</source><year>1984</year><publisher-loc>Hoboken, NJ</publisher-loc><publisher-name>John Wiley &#x00026; Sons, Inc.</publisher-name></element-citation></ref><ref id="CR39"><label>39.</label><mixed-citation publication-type="other">MATLAB version 7.10.0. Natick, Massachusetts: The MathWorks Inc.; 2010.</mixed-citation></ref><ref id="CR40"><label>40.</label><mixed-citation publication-type="other">GM, 06990 Normalized HiC Data. <ext-link ext-link-type="uri" xlink:href="http://compgenomics.weizmann.ac.il/tanay/?page_id=283">http://compgenomics.weizmann.ac.il/tanay/?page_id=283</ext-link>. Accessed 17 Feb 2018.</mixed-citation></ref><ref id="CR41"><label>41.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Cao</surname><given-names>R</given-names></name><name><surname>Taylor</surname><given-names>K</given-names></name><name><surname>Briley</surname><given-names>A</given-names></name><name><surname>Caldwell</surname><given-names>C</given-names></name><name><surname>Cheng</surname><given-names>J</given-names></name></person-group><article-title>The properties of genome conformation and spatial gene interaction and regulation networks of normal and malignant human cell types</article-title><source>PLoS One</source><year>2013</year><volume>8</volume><issue>3</issue><fpage>e58793</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0058793</pub-id><?supplied-pmid 23536826?><pub-id pub-id-type="pmid">23536826</pub-id></element-citation></ref><ref id="CR42"><label>42.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dixon</surname><given-names>JR</given-names></name><name><surname>Selvaraj</surname><given-names>S</given-names></name><name><surname>Yue</surname><given-names>F</given-names></name><name><surname>Kim</surname><given-names>A</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Shen</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>M</given-names></name><name><surname>Liu</surname><given-names>JS</given-names></name><name><surname>Ren</surname><given-names>B</given-names></name></person-group><article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title><source>Nature</source><year>2012</year><volume>485</volume><issue>7398</issue><fpage>376</fpage><lpage>380</lpage><pub-id pub-id-type="doi">10.1038/nature11082</pub-id><?supplied-pmid 22495300?><pub-id pub-id-type="pmid">22495300</pub-id></element-citation></ref><ref id="CR43"><label>43.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>L&#x000e9;vy-Leduc</surname><given-names>C</given-names></name><name><surname>Delattre</surname><given-names>M</given-names></name><name><surname>Mary-Huard</surname><given-names>T</given-names></name><name><surname>Robin</surname><given-names>S</given-names></name></person-group><article-title>Two-dimensional segmentation for analyzing hi-C data</article-title><source>Bioinformatics</source><year>2014</year><volume>30</volume><issue>17</issue><fpage>i386</fpage><lpage>i392</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu443</pub-id><?supplied-pmid 25161224?><pub-id pub-id-type="pmid">25161224</pub-id></element-citation></ref><ref id="CR44"><label>44.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Gao</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>MQ</given-names></name></person-group><article-title>A novel method to identify topological domains using hi-C data</article-title><source>Quant Biol</source><year>2015</year><volume>3</volume><issue>2</issue><fpage>81</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1007/s40484-015-0047-9</pub-id></element-citation></ref><ref id="CR45"><label>45.</label><mixed-citation publication-type="other">Shin H, Shi Y, Dai C, Tjong H, Gong K, Alber F, Zhou XJ. TopDom: an efficient and deterministic method for identifying topological domains in genomes. Nucleic Acids Res. 2015:gkv1505.</mixed-citation></ref><ref id="CR46"><label>46.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schrodinger</surname><given-names>LLC</given-names></name></person-group><source>The PyMol molecular graphics system, version 1.3</source><year>2010</year></element-citation></ref></ref-list></back></article>