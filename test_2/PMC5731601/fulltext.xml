<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id><journal-title-group><journal-title>BMC Genomics</journal-title></journal-title-group><issn pub-type="epub">1471-2164</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">5731601</article-id><article-id pub-id-type="publisher-id">4273</article-id><article-id pub-id-type="doi">10.1186/s12864-017-4273-6</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>Higher recall in metagenomic sequence classification exploiting overlapping reads</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Girotto</surname><given-names>Samuele</given-names></name><address><email>samuele.girotto@gmail.com</email></address><xref ref-type="aff" rid="Aff1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Comin</surname><given-names>Matteo</given-names></name><address><email>comin@dei.unipd.it</email></address><xref ref-type="aff" rid="Aff1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Pizzi</surname><given-names>Cinzia</given-names></name><address><email>cinzia.pizzi@dei.unipd.it</email></address><xref ref-type="aff" rid="Aff1"/></contrib><aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1757 3470</institution-id><institution-id institution-id-type="GRID">grid.5608.b</institution-id><institution>Department of Information Engineering, </institution><institution>University of Padova, </institution></institution-wrap>via Gradenigo 6/A, Padova, 35131 Italy </aff></contrib-group><pub-date pub-type="epub"><day>6</day><month>12</month><year>2017</year></pub-date><pub-date pub-type="pmc-release"><day>6</day><month>12</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>18</volume><issue>Suppl 10</issue><issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. The Supplement Editors declare that they have no competing interests.</issue-sponsor><elocation-id>917</elocation-id><permissions><copyright-statement>&#x000a9; The Author(s) 2017</copyright-statement><license license-type="OpenAccess"><license-p>
<bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p>In recent years several different fields, such as ecology, medicine and microbiology, have experienced an unprecedented development due to the possibility of direct sequencing of microbioimic samples. Among problems that researchers in the field have to deal with, taxonomic classification of metagenomic reads is one of the most challenging. State of the art methods classify single reads with almost 100% precision. However, very often, the performance in terms of recall falls at about 50%. As a consequence, state-of-the-art methods are indeed capable of correctly classify only half of the reads in the sample. How to achieve better performances in terms of overall quality of classification remains a largely unsolved problem.</p></sec><sec><title>Results</title><p>In this paper we propose a method for metagenomics CLassification Improvement with Overlapping Reads (CLIOR), that exploits the information carried by the overlapping reads graph of the input read dataset to improve recall, f-measure, and the estimated abundance of species. In this work, we applied CLIOR on top of the classification produced by the classifier Clark-l. Experiments on simulated and synthetic metagenomes show that CLIOR can lead to substantial improvement of the recall rate, sometimes doubling it. On average, on simulated datasets, the increase of recall is paired with an higher precision too, while on synthetic datasets it comes at expenses of a small loss of precision. On experiments on real metagenomes CLIOR is able to assign many more reads while keeping the abundance ratios in line with previous studies.</p></sec><sec><title>Conclusions</title><p>Our results showed that with CLIOR is possible to boost the recall of a state-of-the-art metagenomic classifier by inferring and/or correcting the assignment of reads with missing or erroneous labeling. CLIOR is not restricted to the reads classification algorithm used in our experiments, but it may be applied to other methods too. Finally, CLIOR does not need large computational resources, and it can be run on a laptop.</p></sec><sec><title>Electronic supplementary material</title><p>The online version of this article (doi:10.1186/s12864-017-4273-6) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Metagenomics reads classification</kwd><kwd>Boosting by overlapping reads</kwd></kwd-group><conference xlink:href="http://www.iccabs.org/2016/"><conf-name>6th IEEE International Conference on Computational Advances in Bio and Medical Sciences (ICCABS)</conf-name><conf-loc>Atlanta, GA, USA</conf-loc><conf-date>13-15 October 2016</conf-date></conference><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2017</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p>Metagenomics is the study of genomic sequences obtained from an environment such as, for example, water, saliva, soil, etc. [<xref ref-type="bibr" rid="CR1">1</xref>]. A metagenomic sample is processed by extracting and studying the genetic material in order to detect the microorganisms that are present in each sample. Metagenomics is transforming ecology, medicine, microbiology, and other research areas investigating various microbiomes [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>], by enabling for the first time the genomic study of environmental samples, given the difficulty or impossibility to culture most bacteria. For example, the diversity of microbes in humans is found to be associated with diseases such as inflammatory bowel disease (IBD) [<xref ref-type="bibr" rid="CR2">2</xref>] and colorectal cancer [<xref ref-type="bibr" rid="CR3">3</xref>]. Metagenomics allows the identification and characterization of bacterial and viral genomes at a level of detail not previously possible. Moreover it can be used to detect previously unknown species.</p><p>Taxonomic classification of metagenomics reads can help the identification of functional potential of the microbes. In general, there are two methods to detect the taxonomic content of environmental samples: (1) sequencing phylogenetic marker genes, e.g. 16S rRNA, that requires PCR amplicons analysis; (2) Next Generation Sequencing, where all the genomic material of the sample is sequenced.</p><p>The assignment of the correct taxa using marker genes is a relative simple step. However, this method suffers the drawback of potentially biased amplification steps. Furthermore, not all taxa can be captured by traditional 16S sequencing, because of its divergent gene sequences [<xref ref-type="bibr" rid="CR4">4</xref>].</p><p>With the continuing decrease in cost of sequencing, approaches based on Next-Generation Sequencing are becoming the most common ones. The advantages include the ability to gain insights of the genomic content of a microbiome through functional classification, without the need to culture bacteria or of biased preprocessing steps. However, the short length of NGS reads poses a number challenges for the correct taxonomical classification of each read.</p><p>Many computational methods have been developed to classify metagenomic reads. These methods can be broadly divided into three categories, reflecting their different strategies: (1) sequence similarity based methods, like MegaBlast [<xref ref-type="bibr" rid="CR5">5</xref>] and Megan [<xref ref-type="bibr" rid="CR6">6</xref>], in which reads are searched for in reference databases through sequence similarity; (2) marker-based methods, like [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>], where certain specific marker sequences are used to identify the species. Some of these methods are based on universal genes, others, like MetaPhlAn [<xref ref-type="bibr" rid="CR9">9</xref>], utilizes marker genes that are clade specific; (3) sequence composition based methods, which are based on characteristics of their nucleotide composition (e.g. <italic>k</italic>-mers presence).</p><p>The fastest approaches are sequence composition based methods. They generate models from the reference organisms genomes, usually based on <italic>k</italic>-mers counts. Then the input reads are classified based on which model fit. In this category the most representative methods are Kraken [<xref ref-type="bibr" rid="CR10">10</xref>], Clark [<xref ref-type="bibr" rid="CR11">11</xref>] and Lmat [<xref ref-type="bibr" rid="CR12">12</xref>], in which reads are queried against reference databases and the origin of the hit sequences is used to classify reads. These methods are able to achieve a precision in the classification task as good as MegaBlast, but they are much faster and they can handle larger datasets.</p><p>All these tools focus on the improvement of the correct assignment of reads to the taxa they belong in terms of precision. Indeed they have reached very high levels, e.g. Clark [<xref ref-type="bibr" rid="CR11">11</xref>] reports precisions above 95% on many datasets. On the other hand, in terms of recall, i.e. the percentage of reads actually classified, both Clark and Kraken usually show performances between 50% and 60%, and sometimes on real metagenomes just 20% of reads can be assigned to some taxa.</p><p>The literature in this field is growing very rapidly (see, for example, [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR9">9</xref>&#x02013;<xref ref-type="bibr" rid="CR14">14</xref>]) with a focus on improving the classification precision. Instead, in this study we aim to improve the recall in order to reduce the number of unclassified reads, that is one of the major issues when analyzing real microbiome datasets.</p><p>Recently, we have develop MetaProb [<xref ref-type="bibr" rid="CR14">14</xref>] a method for binning metagenomic reads. MetaProb is able to effectively group reads together to form bins of reads that represent candidate species. As several other binning tools like MetaCluster [<xref ref-type="bibr" rid="CR15">15</xref>] and BiMeta [<xref ref-type="bibr" rid="CR16">16</xref>], MetaProb is based on the construction of the reads overlap graph [<xref ref-type="bibr" rid="CR17">17</xref>] to mimic the assembly process. However, MetaProb does not rely on a reference database and it cannot taxonomically annotate reads, or bins. In this paper we introduce a novel boosting method for CLassification Improvement with Overlapping Reads (CLIOR), that relies on the definition of overlapping reads graph, and it uses as input the taxonomic label assignments given by Clark, a standard single reads classifier. The problem with many single reads classifiers is that reads that share a considerable overlap might be assigned to different taxa. Our method considers groups of overlapping reads as originating from a same species, thus all the reads that belong to a given group will be labeled with the same taxa, leading to an improvement of classification performances.</p><p>The proposed CLIOR approach is characterized by four distinctive features: i) a pipeline that combines reads overlaps together with theirs taxonomic labels; ii) the introduction of a classification correction, that will reduce the problem of unassigned reads, and correct misclassified reads; iii) CLIOR does not depend on a specific algorithm for the classification of single reads, e.g. we used Clark, but it can applied to other methods too; iv) the ability of CLIOR to improve reads annotations increases as the size of datasets grows.</p></sec><sec id="Sec2"><title>Methods</title><p>In this section we will describe the CLIOR approach to improve the overall quality of classification of metagenomic samples. With reference to Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> we will describe the main steps of our approach, namely: i) initial classification of the input read datasets with a state-of-the-art classifier; ii) partitioning of the reads into homogeneous groups; iii) adopt a voting strategy and apply it to each group to obtain the final classification.
<fig id="Fig1"><label>Fig. 1</label><caption><p>CLIOR pipeline. The tree main phases of CLIOR: classification; grouping; voting. In black the reads that are not assigned; in blue the reads assigned to species A&#x02019; in red those assigned to species B, and in green those assigned to species C</p></caption><graphic xlink:href="12864_2017_4273_Fig1_HTML" id="MO1"/></fig>
</p><sec id="Sec3"><title>Initial classification of reads</title><p>The set of reads obtained from a metagenomic sample is given in input to a classifier that will try to assign a label to each read.</p><p>After this step a read is assigned a label at the taxonomy level for which the software is run if, according to the classifier-specific strategies, the confidence level of the call is above a given threshold. Otherwise the read remains unlabeled. The comparison of different metagenomic classification methods is a non-trival problem and it is not the scope this paper. We chose Clark [<xref ref-type="bibr" rid="CR11">11</xref>] as one of the most promising tools in terms of both similarity to the correct answer and the fraction of reads classified [<xref ref-type="bibr" rid="CR18">18</xref>]. However, CLIOR is of general use and it can take in input the taxonomic annotations produced by any other tool.</p><p>The next steps in our approach have the objective of both reducing the cardinality of the set of unlabeled reads, and correcting labels that could have been erroneously assigned to some reads.</p></sec><sec id="Sec4"><title>Grouping reads based on overlaps</title><p>In this step of our pipeline, the set of reads is partitioned into groups, based on the extent of their overlap. Ideally the overlap would be computed using a reads overlap graph [<xref ref-type="bibr" rid="CR17">17</xref>], but this approach is highly demanding in terms of RAM. Instead we use an alignment-free technique used in de-novo genome assembly, and that has been also successfully applied as an intermediate step in several metagenomic binning studies [<xref ref-type="bibr" rid="CR14">14</xref>&#x02013;<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR19">19</xref>].</p><p>The overlap between reads is estimated by considering the amount of shared <italic>k</italic>-mers between reads. This technique relies on the assumption that, by choosing a sufficiently large value for <italic>k</italic>, the probability that two <italic>k</italic>-mers are shared by different genomes is low. For example, a study presented in [<xref ref-type="bibr" rid="CR16">16</xref>] shows that the average ratio of common <italic>k</italic>-mers between pairs of bacterial genomes is less than 1.02% when <italic>k</italic>=30. Therefore, the presence of a shared <italic>k</italic>-mer between two reads should indicate that the two reads belong to the same species. Moreover, if several such <italic>k</italic>-mers are shared, they are also actually likely to be overlapping reads. This strengthens the probability to meet our goal of having in the same group only reads from the same species.</p><p>The partitioning of the set of reads into groups is obtained as follows. The input reads are scanned one at the time, and a global inverted index is built to store for each <italic>k</italic>-mer the list of reads in which it occurs. Then an approximate reads overlap graph is built, in which a node represents a read, and an edge is inserted between two reads <italic>if and only if</italic> the dot product of their <italic>k</italic>-mer vectors is greater than a pre-defined threshold <italic>m</italic>. In fact, when analyzing datasets with millions of reads, it is crucial to store only qualifying edges, rather than the full graph, in order to limit the RAM usage. This approach allows us to analyze datasets an order of magnitude larger than the full graph approach.</p><p>Given a read <italic>R</italic>
<sub><italic>i</italic></sub>, its composition vector is a vector <italic>V</italic>
<sub><italic>i</italic></sub> of size 4<sup><italic>k</italic></sup> where the entry <italic>V</italic>
<sub><italic>i</italic></sub>[<italic>t</italic>] holds the number of occurrences of the <italic>t</italic>-th <italic>k</italic>-mer in lexicographic order.</p><p>In order to compute such a dot product without actually build the 4<sup><italic>k</italic></sup> sized vectors, we proceed as follows. Consider a read <italic>R</italic>
<sub><italic>i</italic></sub> and its set of <italic>k</italic>-mers <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$K_{R_{i}}$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2017_4273_Article_IEq1.gif"/></alternatives></inline-formula>. For each <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$w \in K_{R_{i}}$\end{document}</tex-math><mml:math id="M4"><mml:mi>w</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2017_4273_Article_IEq2.gif"/></alternatives></inline-formula> we query the inverted index to get the corresponding list <italic>L</italic>
<sub><italic>w</italic></sub> of reads that share the <italic>k</italic>-mer <italic>w</italic>. For each read <italic>R</italic>
<sub><italic>j</italic></sub>&#x02208;<italic>L</italic>
<sub><italic>w</italic></sub>, we count its multiplicity in the list and multiply this value by the multiplicity of <italic>w</italic> in <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$K_{R_{i}}$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2017_4273_Article_IEq3.gif"/></alternatives></inline-formula>. This value is kept in a variable <italic>W</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> that stores the partial weight of the edge between <italic>R</italic>
<sub><italic>i</italic></sub> and <italic>R</italic>
<sub><italic>j</italic></sub>. We then proceed with the next <italic>k</italic>-mer in <italic>R</italic>
<sub><italic>i</italic></sub> and if <italic>R</italic>
<sub><italic>j</italic></sub> is found again in the corresponding list, then the result of the multiplication is added to <italic>W</italic>
<sub><italic>i</italic>,<italic>j</italic></sub>. Note that, while processing read <italic>R</italic>
<sub><italic>i</italic></sub>, we do not need to keep all the variables <italic>W</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> in memory for all <italic>j</italic>, because only few reads <italic>R</italic>
<sub><italic>j</italic></sub> will share some <italic>k</italic>-mers. Since <italic>W</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> is a sparse vector, we use an unordered map to store only the required fields. When all the <italic>k</italic>-mers of <italic>R</italic>
<sub><italic>i</italic></sub> have been considered, we check the computed weights and insert an edge between <italic>R</italic>
<sub><italic>i</italic></sub> and <italic>R</italic>
<sub><italic>j</italic></sub> if and only if <italic>W</italic>
<sub><italic>i</italic>,<italic>j</italic></sub>&#x02265;<italic>m</italic>, for a given threshold <italic>m</italic>. We then proceed with the next read to be processed. The values of the read length (about 100 bases) and of the <italic>k</italic>-mer length (<italic>k</italic>=30) are usually such that the dot product we compute often coincides with the number of shared <italic>k</italic>-mers between two reads. In fact its very unlikely that a short read contains the same 30-mer twice.</p><p>Once the overlap graph has been set up, the grouping phase begins. Initially, each read is considered as a group, and groups are progressively merged until a stopping criteria is met. Starting from a node, we explore its outgoing edges, and include in its group the node among its neighbors that shares with the group the highest number of edges. Then the new frontier is considered and we iterate the process until the size of the group has reached a threshold <italic>T</italic>. The role of this threshold is to avoid that, by growing too large, the groups might end up including reads from two different species linked by few, but sufficient, common reads. However, when computing the size of a group, it is not enough to sum the lengths of its reads, because overlaps between reads should not be counted more than once. To avoid overcounting these overlaps, while building a group we also select a subset of independent reads within the group. An independent set, defined on a graph, is a set of vertices which does not contain adjacent vertices, thus they do not overlap. Since the problem of finding the maximum independent set <italic>I</italic>(<italic>G</italic>) of a group <italic>G</italic> is known to be NP-hard, we adopt a greedy solution. If the read chosen for extension is not adjacent to any read in <italic>I</italic>(<italic>G</italic>), then this is a new independent read and we add <italic>x</italic> to <italic>I</italic>(<italic>G</italic>). The stopping criteria is met when the length of the reads in <italic>I</italic>(<italic>G</italic>), which by definition do not overlap, reaches a predefined value <italic>T</italic>.</p><p>When we cannot add further nodes, the group is defined, and all the nodes in it are marked as visited. The process is repeated starting from an unvisited node until the whole graph has been explored.</p></sec><sec id="Sec5"><title>Voting groups of reads</title><p>The method described above, with conservative parameters <italic>k</italic>=30 and <italic>T</italic>=9000 (see &#x0201c;<xref rid="Sec9" ref-type="sec">Parameters and evaluation metrics</xref>&#x0201d; subsection), is able to cluster reads into several small groups. Note that each species is not completely contained in a group, but in general it is scattered across different groups. With reference to Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>, this situation is represented by the species labeled in red. However, the groups are characterized by a very high precision, in fact on simulated datasets about 99.9% of groups contains reads from one species. Therefore, we expect the reads within a group to be assigned a same label. However, most classifiers ([<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]) leave many reads unassigned. Here is where our approach can be successfully exploited. When inspecting the label assignment within a group, if there are unassigned reads, or if several different labels are present, we proceed with a re-assignment following a majority consensus vote. Experiments where we do not re-assign labels if the reads have already been classified by Clark showed similar, but slightly lower, performances than the ones we obtained with re-assignment (see Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>).</p><p>In case of ties, we proceed by randomly picking a winner label and assigning that to all the reads in the group. While this solution could potentially end up in the re-assignment of reads that were initially correctly classified, we argue that the impact in such a case is indeed limited. In fact, in order to have a relevant impact we should have ties in big groups. However, exact ties in big groups are quite unlikely to happen, because of the high precision of groups. For small groups we have an higher probability, but the effect of wrong re-labeling is also limited to a small number of reads, thus not affecting substantially the final results. In terms of numbers over all experiments, at species level, 1.8% of groups have ties. The percentage of reads whose labeling is affected by the random choice of the winner is about 0.6%. At genus level, 0.61% of groups have ties, and only than 0.13% of the reads are affected.</p></sec></sec><sec id="Sec6"><title>Results and discussion</title><p>We used several metagenomic datasets to test the performance of CLIOR on different simulated and real communities. The simulated and real datasets used come from other papers ([<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]) and we summarize them in the next section.</p><sec id="Sec7"><title>Simulated and synthetic metagenomes</title><p>For our test we used 16 sets of <italic>simulated</italic> short read datasets used also in [<xref ref-type="bibr" rid="CR16">16</xref>]. These are generated with MetaSim software and they can be partitioned in two groups: S and L. Each dataset comprises paired-end short reads (length of approximately 80 bp) generated according to the Illumina error profile with an error rate of 1%. The six datasets in L are built over the genomes of two species, <italic>Eubacterium eligens</italic> and <italic>Lactobacillus amylovorus</italic>, but they are characterized by a different abundance ratio between the two species. The ten datasets in S are much more varied in terms of number of species (up to 30), abundance ratio (balanced/unbalanced), and phylogenetic distance (details on [<xref ref-type="bibr" rid="CR16">16</xref>]).</p><p>We included in our tests also five mock communities (<italic>synthetic</italic> datasets) that are constructed from real sequencing data, called: MiSeq, HiSeq, MK_a1 and MK_a2, simBA5. The MiSeq and HiSeq metagenomes were built using 10 sets of bacterial whole-genome shotgun reads, as in Kraken [<xref ref-type="bibr" rid="CR10">10</xref>]. We use the dataset of short-reads Illumina HiSeq, to create the MK_a1 and MK_a2 datasets with two abundance profiles.</p><p>The datasets HiSeq and MiSeq contain 10000000 and 4000000 single-end reads respectively, MK_a1 and MK_a2 have 1000000 paired-end reads for a total 2000000 reads to classify. The MiSeq dataset is particularly difficult to analyze because it contains five genomes from the <italic>Enterobacteriaceae</italic> family (C<italic>itrobacter, Enterobacter, Klebsiella, Proteus and Salmonella</italic>). This can make the classification step of these taxa more difficult because these species have an high sequence similarity [<xref ref-type="bibr" rid="CR10">10</xref>].</p><p>As described in [<xref ref-type="bibr" rid="CR10">10</xref>] simBA5 metagenome was created by simulating reads from the complete set of bacterial and archaeal genomes in RefSeq, for a total of 1216 species. It was created with an high error rate, to evaluate the performance on data that contain many errors or have strong differences from the genomic library available (for more details see [<xref ref-type="bibr" rid="CR10">10</xref>]).</p><p>Since our algorithm used Clark, we needed to compute the reference database based on the NCBI RefSeq. However, this collection is not complete and we have some reads which cannot be correctly identified. Examples are the reads in HiSeq metagenomes with the <italic>Pelosinus fermentans</italic> species and in MiSeq metagenome with <italic>Proteus vulgaris</italic>, that are incorrectly classified for the same reason [<xref ref-type="bibr" rid="CR11">11</xref>].</p></sec><sec id="Sec8"><title>Real data</title><p>To evaluate the performance of our algorithm we also analyzed five real experiments taken from NCBI and that were also used for the evaluation of Clark and Kraken. We created all datasets filtering human reads and sampling in a uniform manner so as not to change the characteristics of the datasets. As in [<xref ref-type="bibr" rid="CR11">11</xref>] we used SRS015072 (mid-vagina, two runs, SRR062276 with 698428 reads and SRR062301 with 692906 reads), SRS019120 (saliva, two runs, SRR062415 and SRR062462 both with 2000000 reads) and SRS023847 (anterior nares, one run, SRR061942 with 600000 reads).</p></sec><sec id="Sec9"><title>Parameters and evaluation metrics</title><p>In this paper we used CLIOR to boost the performance of Clark-l, so we need to set the parameters for both. Among the available versions of Clark, we used Clark-l, the <italic>light</italic> version of Clark, with all default parameters. This choice is motivated by our objective to obtain performances comparable or better than the state-of-the art algorithms, but using much less computational resources. In fact Clark-l can be run on a laptop. As for CLIOR, we set the threshold <italic>m</italic> (minimum threshold of shared <italic>k</italic>-mer, <italic>k</italic>=30) in different ways on the basis of the properties of datasets. Several previous work (e.g. [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]) showed that a good value for <italic>m</italic>, for short reads, is <italic>m</italic>=5. Ideally we would have run all our experiments with this value. However, HiSeq and MiSeq are big datasets (10M and 4M reads, respectively). In order to be able to analyze these datasets we had to increase the threshold to <italic>m</italic>. In fact, smaller values of <italic>m</italic> correspond to denser graphs, thus increasing the memory requirements. The choice of <italic>m</italic> reflects a trade-off between precision and available computational resources. In our experiments the parameter <italic>m</italic> of CLIOR was set to 45 for the HiSeq and MiSeq datasets, and <italic>m</italic>=5 for all other tests. The parameter <italic>T</italic> of CLIOR was set to 9000, similarly to other studies [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>].</p><p>In order to compare the results of CLIOR with Clark-l, we used precision, recall and F-measure metrics with definitions as in [<xref ref-type="bibr" rid="CR11">11</xref>]. Given <italic>N</italic> the number of reads, <italic>Y</italic> the number of reads classified and <italic>X</italic> the number of correctly classified reads, we can define precision as <italic>P</italic>=<italic>X</italic>/<italic>Y</italic>, that is the fraction of correct assignments over the total number of assignments, and recall as <italic>R</italic>=<italic>X</italic>/<italic>N</italic>, that is the ratio between the number of correct assignments and the number of reads to be classified. The F-measure emphasizes comprehensively on both precision and recall, being defined as <italic>F</italic>=2<italic>P</italic>
<italic>R</italic>/(<italic>P</italic>+<italic>R</italic>). The aim of this study is to improve the classification quality, in particular by increasing the recall without affecting the performances of the others metrics.</p><p>In our algorithm the processing of reads, to create the overlap graph, is the most demanding phase and it requires RAM to store the <italic>k</italic>-mers and the graph edges. With our setup we were able to run CLIOR on all tests in a PC with a Intel core i7-4510U CPU @ 2.00 GHz x 4 with 16 GB of RAM and 10 GB of swap partition, with a maximum amount of memory needed of 24 GB.</p></sec><sec id="Sec10"><title>Results on simulated and synthetic metagenomes</title><p>In our experiments we evaluated the performances of CLIOR and Clark-l at both species and genus level of classification. We report in Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref> a summary of the resulting average precision, recall and f-measure on both simulated and synthetic metagenomes at both species and genus level. A detailed comparison on each dataset is shown in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> for the analysis at species level, and in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> for the analysis at genus level. Note that in Figs.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>, <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref>, and <xref rid="Fig5" ref-type="fig">5</xref> adjacent points are not related, therefore the role of the lines between them is purely that of enhancing the visualization. The corresponding full tables are shown in the Additional file&#x000a0;<xref rid="MOESM2" ref-type="media">2</xref>.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Precision and recall at species level. Comparison between Clark-l and CLIOR precision and recall on simulated and synthetic datasets. In blue Clark-l precision, in yellow Clark-l recall. In red CLIOR precision, in green CLIOR recall</p></caption><graphic xlink:href="12864_2017_4273_Fig2_HTML" id="MO2"/></fig>
<fig id="Fig3"><label>Fig. 3</label><caption><p>Precision and recall at genus level. Comparison between Clark-l and CLIOR precision and recall on simulated and synthetic datasets. In blue Clark-l precision, in yellow Clark-l recall. In red CLIOR precision, in green CLIOR recall</p></caption><graphic xlink:href="12864_2017_4273_Fig3_HTML" id="MO3"/></fig>
<fig id="Fig4"><label>Fig. 4</label><caption><p>Pearson correlation at species level. Comparison between Clark-l and CLIOR on simulated and synthetic datasets. In blue Clark-l, in red CLIOR</p></caption><graphic xlink:href="12864_2017_4273_Fig4_HTML" id="MO4"/></fig>
<fig id="Fig5"><label>Fig. 5</label><caption><p>Pearson correlation at genus level. Comparison between Clark-l and CLIOR on simulated and synthetic datasets. In blue Clark-l, in red CLIOR</p></caption><graphic xlink:href="12864_2017_4273_Fig5_HTML" id="MO5"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Genus-level and species-level average accuracy of CLIOR and Clark-l, for various simulated (<italic>N</italic>=16) and synthetic (<italic>N</italic>=5) metagenomes</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">Tool</th><th align="left" colspan="3">Species</th><th align="left" colspan="3">Genus</th></tr><tr><th align="left"/><th align="left"/><th align="left">Prec</th><th align="left">Rec</th><th align="left">F-m</th><th align="left">Prec</th><th align="left">Rec</th><th align="left">F-m</th></tr></thead><tbody><tr><td align="left">
<bold>Simulated</bold>
</td><td align="left">Clark-l</td><td align="left">0.869</td><td align="left">0.555</td><td align="left">0.670</td><td align="left">0.988</td><td align="left">0.629</td><td align="left">0.762</td></tr><tr><td align="left"/><td align="left">CLIOR</td><td align="left">0.978</td><td align="left">0.973</td><td align="left">0.976</td><td align="left">0.992</td><td align="left">0.986</td><td align="left">0.989</td></tr><tr><td align="left"/><td align="left">Diff</td><td align="left">
<bold>0.109</bold>
</td><td align="left">
<bold>0.419</bold>
</td><td align="left">
<bold>0.306</bold>
</td><td align="left">
<bold>0.004</bold>
</td><td align="left">
<bold>0.357</bold>
</td><td align="left">
<bold>0.227</bold>
</td></tr><tr><td align="left">
<bold>Synthetic</bold>
</td><td align="left">Clark-l</td><td align="left">0.740</td><td align="left">0.425</td><td align="left">0.537</td><td align="left">0.902</td><td align="left">0.522</td><td align="left">0.656</td></tr><tr><td align="left"/><td align="left">CLIOR</td><td align="left">0.714</td><td align="left">0.536</td><td align="left">0.607</td><td align="left">0.892</td><td align="left">0.680</td><td align="left">0.765</td></tr><tr><td align="left"/><td align="left">Diff</td><td align="left">
<bold>-0.026</bold>
</td><td align="left">
<bold>0.110</bold>
</td><td align="left">
<bold>0.070</bold>
</td><td align="left">
<bold>-0.010</bold>
</td><td align="left">
<bold>0.159</bold>
</td><td align="left">
<bold>0.109</bold>
</td></tr></tbody></table><table-wrap-foot><p>Diff is the difference between the corresponding CLIOR and Clark-l performances</p></table-wrap-foot></table-wrap>
</p><p>First of all, if we compare the overall results obtained at species and genus level, we can see that, for both CLIOR and Clark-l, the performances at genus level are better than those at species level. This was indeed expected. In fact, in the taxonomy tree, when the classification level is more specific, the label assignment is more difficult. Moreover, it is possible that, although at species level a read is assigned a wrong label, at genus level the same label is indeed correct, thus making genus level classification relatively less difficult.</p><p>By observing more in detail the performances of CLIOR, we can see that there is a generalized improvement in terms of recall. An important aspect is that this does not come at great expense of precision. On the contrary, on average, among the simulated datasets we have an improvement also for what concern the precision. In the simulated dataset the gain in precision is on average 10% and 0.4%, for the two different levels of classification.</p><p>For what concerns the recall, the average increments are 41.86% and 35.72% for simulated datasets, at species and genus level, and 11.03% and 15.88% for synthetic datasets at the same two levels. The major recall increment is on the dataset S3, both for species (about 57%) and for genus level accuracy (about 58%).</p><p>One of the most difficult datasets is the synthetic metagenome MiSeq, that contains five genomes from the same family. Five species of the same family and high sequence similarity may influence the performances of Clark-l. In fact, for the MiSeq metagenome, Clark-l classified correctly only 21% and 25.56% of reads at the species and genus level. Moreover, its precision is the lowest among all the datasets that we analyzed, specifically 52% and 63%. On this difficult dataset CLIOR is still able to improve the recall by 16% and 17%, whereas the precision decreases by 1% and 6% for different target levels.</p><p>When analyzing precision and recall values, it is of interest to have also the actual number of reads correctly assigned, in order to have a complete picture. We report in Additional file&#x000a0;<xref rid="MOESM3" ref-type="media">3</xref> the number of reads correctly classified and the number of assignments for species and genus level classification. These absolute numbers show that for the MiSeq dataset, although we have a moderate loss of precision, still the number of reads correctly classified grows from 5369370 (Clark-l) to 5871490 (CLIOR) at the species-level and from 6242990 (Clark-l) to 7022260 (CLIOR) at genus-level. Similar observations hold also for the datasets MK_a1, that is the one with the highest drop of precision, we have that Clark-l classify correctly 1051590 reads at species-level, whereas CLIOR 1135770 reads; at the genus-level we have 1406490 (Clark-l) and 1806830 (CLIOR) correct reads. Note that the number of reads correctly assigned to a species plays a crucial role for the robust identification of the species in a sample.</p></sec><sec id="Sec11"><title>Estimating the species abundance</title><p>An interesting question is to which extent the abundance of a given species (or genus), predicted by our method CLIOR, resembles the actual abundance of that species (or genus) in the input dataset. To answer this question, in line with other studies [<xref ref-type="bibr" rid="CR18">18</xref>], we compute the Pearson correlation coefficient between abundance, predicted by CLIOR and Clark-l, and the actual composition of species and genera in the datasets. The results are shown in Figs.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref> for species and genus analysis respectively.</p><p>In both cases the Pearson correlation coefficient for CLIOR is equal or close to <italic>r</italic>=1 in many cases, showing that the predicted abundances are highly correlated with the actual dataset composition. Since the result for the dataset MK_a1 showed a behavior that is not in line with the others, we further investigate this case. Figure&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> shows that, at species level, CLIOR improves the predicted abundance of most species (see Additional file&#x000a0;<xref rid="MOESM2" ref-type="media">2</xref> for more details).
<fig id="Fig6"><label>Fig. 6</label><caption><p>Predicted abundance at species level. Analysis on the dataset MK_a1. In light-blue the ground truth, in blue CLIOR, in orange Clark-l</p></caption><graphic xlink:href="12864_2017_4273_Fig6_HTML" id="MO6"/></fig>
</p><p>The cases of <italic>Xanthomonas axonopodis</italic> and <italic>Bacillus cereus</italic> deserve an ad-hoc discussion, as both Clark-l and CLIOR basically miss the species. The difficulty Clark-l has in the identification of these species is possibly due to the fact that, in the dictionary, several closely related species are present, thus making it difficult the call for <italic>Xanthomonas axonopodis</italic> and <italic>Bacillus cereus</italic>. In these particular cases, we speculate that CLIOR is probably mislead by the presence of these other labels, that although &#x0201c;close&#x0201d; are not correct, and extend them to other <italic>Xanthomonas axonopodis</italic> and <italic>Bacillus cereus</italic> reads. This explanation is supported by the data shown in Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref> (see Additional file&#x000a0;<xref rid="MOESM2" ref-type="media">2</xref>), where the abundance prediction at genus level, which will aggregate close species labels under the same genus label, is correct, and CLIOR is able to improve, with respect to Clark-l, even for genus <italic>Xanthomonas</italic> and <italic>Bacillus</italic>.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Predicted abundance at genus level. Analysis on the dataset MK_a1. In light-blue the ground truth, in blue CLIOR, in orange Clark-l</p></caption><graphic xlink:href="12864_2017_4273_Fig7_HTML" id="MO7"/></fig>
</p><p>Similarly, we investigated further on the actual distribution of abundances for the dataset MK_a2, for which we have the best improvement in terms of Pearson correlation. The results are shown in Figs.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref> and <xref rid="Fig9" ref-type="fig">9</xref> for species and genus level of classification, respectively.
<fig id="Fig8"><label>Fig. 8</label><caption><p>Predicted abundance at species level. Analysis on the dataset MK_a2. In light-blue the ground truth, in blue CLIOR, in orange Clark-l</p></caption><graphic xlink:href="12864_2017_4273_Fig8_HTML" id="MO8"/></fig>
<fig id="Fig9"><label>Fig. 9</label><caption><p>Predicted abundance at genus level. Analysis on the dataset MK_a2. In light-blue the ground truth, in blue CLIOR, in orange Clark-l</p></caption><graphic xlink:href="12864_2017_4273_Fig9_HTML" id="MO9"/></fig>
</p><p>Of particular interest is the species <italic>Aeromonas hydrophila</italic>, where Clark-l predicts 14.84%, CLIOR 32.80%, and the real abundance is 32.06%. The <italic>Xanthomonas axonopodis</italic> and <italic>Bacillus cereus</italic> are the most difficult species to correctly predict for both classifiers. However, similarly to what we discussed for the MK_a1 dataset, at genus level this effect disappear and the predictions are much closer to the ground truth. This indicates that several closely related species are present in the dictionary, thus affecting the labeling of Clark-l and thus of CLIOR. Overall we see that for most species the prediction made by CLIOR is actually closer to the ground truth, independently from the fact that Clark-l underestimates or overestimates the true abundance.</p></sec><sec id="Sec12"><title>Impact of the dataset size</title><p>An important feature of our approach is that the larger the read dataset in input, the better the classification. This is because the grouping phase benefits of the presence of more reads that allows in turn to better characterize the groups.</p><p>For this experiment we took subsamples of increasing size from the MK_a2 dataset, which contains 1M paired end reads (i.e. 2M reads in total). Figure&#x000a0;<xref rid="Fig10" ref-type="fig">10</xref> shows precision and recall at species level, as a function of the size of the dataset.
<fig id="Fig10"><label>Fig. 10</label><caption><p>Precision and Recall as a function of the size of the input. In blue Clark-l precision, in yellow Clark-l recall. In red CLIOR precision, in green CLIOR recall</p></caption><graphic xlink:href="12864_2017_4273_Fig10_HTML" id="MO10"/></fig>
</p><p>The same considerations holds for the Pearson correlation, as shown in Fig.&#x000a0;<xref rid="Fig11" ref-type="fig">11</xref>.
<fig id="Fig11"><label>Fig. 11</label><caption><p>Pearson correlation as a function of the size of the input. In blue Clark-l, in red CLIOR</p></caption><graphic xlink:href="12864_2017_4273_Fig11_HTML" id="MO11"/></fig>
</p><p>In terms of time performances, the total time depends, obviously, on the dataset size. Figure&#x000a0;<xref rid="Fig12" ref-type="fig">12</xref> shows the total time needed to complete the classification process as a function of the input size. It can be seen how the time slightly increases, taking less than 5 min to analyse 2M reads.
<fig id="Fig12"><label>Fig. 12</label><caption><p>Time needed for the overall classification task. The total time to obtain the final classification. Time is shown as a function of the dataset size on subsets of increasing size for MK_a2, which contains 1M paired end reads, i.e. 2M read in total</p></caption><graphic xlink:href="12864_2017_4273_Fig12_HTML" id="MO12"/></fig>
</p><p>The size of the dataset also affects the quality of the classification itself. In fact, the larger the number of reads available, the better is the quality of the groups created by CLIOR.</p></sec><sec id="Sec13"><title>Results on real metagenomes</title><p>We tested CLIOR also on real datasets in order to validate the performances of the classification process on real metagenomic samples for which the ground truth is not known. We used Clark-l and CLIOR to classify Human Microbiome Project reads, also used in [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>], in order to compare the number of assigned reads (see Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>).
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Number of assigned reads on real samples: comparison between Clark-l and CLIOR</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Datasets</th><th align="left">Tool</th><th align="left">Species</th><th align="left">Genus</th></tr></thead><tbody><tr><td align="left">SRR062276</td><td align="left">Clark-l</td><td align="left">0.220</td><td align="left">0.221</td></tr><tr><td align="left"/><td align="left">CLIOR</td><td align="left">0.523</td><td align="left">0.523</td></tr><tr><td align="left">SSR062301</td><td align="left">Clark-l</td><td align="left">0.220</td><td align="left">0.220</td></tr><tr><td align="left"/><td align="left">CLIOR</td><td align="left">0.527</td><td align="left">0.527</td></tr><tr><td align="left">SSR061942</td><td align="left">Clark-l</td><td align="left">0.229</td><td align="left">0.229</td></tr><tr><td align="left"/><td align="left">CLIOR</td><td align="left">0.469</td><td align="left">0.469</td></tr><tr><td align="left">SSR062415</td><td align="left">Clark-l</td><td align="left">0.170</td><td align="left">0.170</td></tr><tr><td align="left"/><td align="left">CLIOR</td><td align="left">0.266</td><td align="left">0.302</td></tr><tr><td align="left">SSR062462</td><td align="left">Clark-l</td><td align="left">0.171</td><td align="left">0.171</td></tr><tr><td align="left"/><td align="left">CLIOR</td><td align="left">0.267</td><td align="left">0.302</td></tr></tbody></table></table-wrap>
</p><p>From our classifications tests, we found that on the mid-vagina samples (SRR062276 and SRR062301), Clark-l classifies 22% of reads, while CLIOR classified 52.3% of reads, more than double the reads assigned by Clark-l at species and genus levels. A similar performance was observed on the anterior nares (SRR061942) datasets, where Clark-l classifies only 23% of reads and CLIOR classified twice as many reads, about 47% at both levels. For the saliva samples (SRR062415 and SRR062462), Clark-l classifies 17% both at the species and genus level, whereas CLIOR assigned 26.6% and 30.2%, respectively. In this case the increment is about 9% at species level and 13% at genus level.</p><p>The species and genera found in these real samples can be investigated further by comparing the abundance ratios. For example in the saliva dataset (SRR062415) the top five genera found by CLIOR are <italic>Streptococcus, Haemophilus, Prevotella, Azotobacter</italic> and <italic>Neisseria</italic> as shown in Fig.&#x000a0;<xref rid="Fig13" ref-type="fig">13</xref>. These genera have been also reported as the most abundant by [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], with similar ratios. Similar observations can be drawn from the other real samples (see Additional file&#x000a0;<xref rid="MOESM4" ref-type="media">4</xref>). In summary, CLIOR is able to double the number of reads assigned to some species also in real datasets. This is important because the classification of more reads allows a more robust identification of species in a sample. Moreover, the resulting abundance ratios of the species are in line with previous studies.
<fig id="Fig13"><label>Fig. 13</label><caption><p>Analysis on real data. Top 5 genera detected by CLIOR in the saliva datasets SRR062415: Streptococcus (blue), Haemophilus (orange), Prevotella (yellow), Azotobacter (green), Neisseria (maroon), Others (light blue)</p></caption><graphic xlink:href="12864_2017_4273_Fig13_HTML" id="MO13"/></fig>
</p></sec></sec><sec id="Sec14" sec-type="conclusion"><title>Conclusions</title><p>In this paper we have introduced CLIOR (CLassification Improvement with Overlapping Reads), a metagenomic classification booster that is based on the overlapping reads graph. CLIOR is not restricted to the single reads classification algorithm, e.g. Clark-l, and it may be applied to other methods such as, for example, Kraken. Results on several simulated metagenomes show that CLIOR is able to improve both the recall and the precision with respect to Clark-l: at species level, on average, the increment is 41.9% and 10.9% respectively, while at genus level it is 35.7% and 0.4% respectively. Results on more realistic synthetic metagenomes confirmed that CLIOR can improve the recall substantially (on average, 11% at species level and 15.9% at genus level) at a cost of a small loss in terms of precision (on average, 2.6% at species level, and 1% at genus level). Moreover, on real samples CLIOR was able to classify a substantially larger number of reads than Clark-l, most of the time, doubling the recall. CLIOR does not need large computational resources and it can be run on a laptop.</p></sec><sec sec-type="supplementary-material"><title>Additional files</title><sec id="Sec15"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="12864_2017_4273_MOESM1_ESM.pdf"><label>Additional file 1</label><caption><p>Results without re-assignment (PDF file). The file contains tables showing the precision and recall at species and genus level without re-labeling for simulated and synthetic dataset, respectively. (PDF 48 kb).</p></caption></media></supplementary-material>
</p><p>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="12864_2017_4273_MOESM2_ESM.pdf"><label>Additional file 2</label><caption><p>Details of classification for the dataset MK_a1 (PDF file) The file contains tables showing the details of the classification at species and genus level, respectively, for the dataset MK_a1. (PDF 37 kb)</p></caption></media></supplementary-material>
</p><p>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="12864_2017_4273_MOESM3_ESM.pdf"><label>Additional file 3</label><caption><p>The file contains tables showing the detailed values of precision, recall, and f-measure, both at species and genus level, for Clark-l and Clior on simulated and synthetic datasets, respectively; and tables showing the number of reads that have been classified at species and genus level, respectively. (PDF 72 kb)</p></caption></media></supplementary-material>
</p><p>
<supplementary-material content-type="local-data" id="MOESM4"><media xlink:href="12864_2017_4273_MOESM4_ESM.pdf"><label>Additional file 4</label><caption><p>This file contains figures showing the top 5 dominant species in several real samples. In SRS015072 (mid-vagina) we found that Lactobacillus is dominant, as in [<xref ref-type="bibr" rid="CR11">11</xref>] and other studies cited by the same paper. Pseudomonas and Desulfotomaculum were detected as in [<xref ref-type="bibr" rid="CR11">11</xref>] but we also found Azotobacter, Streptococcus [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] and Mycoplasma that do not appear in [<xref ref-type="bibr" rid="CR11">11</xref>]. In SRS019120 (saliva) we found Streptococcus, Haemophilus, Prevotella and Neisseria that appear also in [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] and also the Azotobacter genus as in mid-vagina datasets. In SRS023847 (anterior nares) the Propionibacterium and Staphylococcus is present as in [<xref ref-type="bibr" rid="CR11">11</xref>], but with a different percentage (Propionibacterium from 61.5% in [<xref ref-type="bibr" rid="CR11">11</xref>] to 46,10% in CLIOR). Mycoplasma appears in the result of SRS023847 with about the same abundance of Propionibacterium. This genus is not present in [<xref ref-type="bibr" rid="CR11">11</xref>] and in our experiments with Clark-l is present in a small percentage (only about 0,42%). We can guess that there are some reads that overlap for this genus so they create some groups and the winner take all method allows to find them. In SRS023847 appear also Azotobacter, as in the previous datasets, and Bacillus, which do not appear in [<xref ref-type="bibr" rid="CR11">11</xref>] but is an important pesticide and easily inhalable. (PDF 385 kb)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><fn-group><fn><p><bold>Electronic supplementary material</bold></p><p>The online version of this article (doi:10.1186/s12864-017-4273-6) contains supplementary material, which is available to authorized users.</p></fn></fn-group><ack><sec id="d29e1707"><title>Funding</title><p>This work and publication costs were supported by the Italian MIUR project &#x0201c;Compositional Approaches for the Characterization and Mining of Omics Data&#x0201d; (PRIN20122F87B2).</p></sec><sec id="d29e1712"><title>Availability of data and materials</title><p>The software CLIOR is freely available for academic use at https://bitbucket.org/samu661/clior/overview. The datasets used in this work are also available at the same address.</p></sec><sec id="d29e1717"><title>About this supplement</title><p>This article has been published as part of <italic>BMC Genomics</italic> Volume 18 Supplement 10, 2017: Selected articles from the 6th IEEE International Conference on Computational Advances in Bio and Medical Sciences (ICCABS): genomics. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcgenomics.biomedcentral.com/articles/supplements/volume-18-supplement-10">https://bmcgenomics.biomedcentral.com/articles/supplements/volume-18-supplement-10</ext-link>.</p></sec><sec id="d29e1730"><title>Authors&#x02019; contributions</title><p>All authors contributed to the design of the approach, the analysis of the results, and the writing of the paper. CP and MC conceived the study. SG implemented the approach and performed the experiments. CP coordinated and supervised the work. All authors have read and approved the manuscript for publication.</p></sec><sec id="d29e1735"><title>Ethics approval and consent to participate</title><p>Not applicable.</p></sec><sec id="d29e1740"><title>Consent for publication</title><p>Not applicable.</p></sec><sec id="d29e1745"><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec id="d29e1750"><title>Publisher&#x02019;s Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></sec></ack><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mande</surname><given-names>SS</given-names></name><name><surname>Mohammed</surname><given-names>MH</given-names></name><name><surname>Ghosh</surname><given-names>TS</given-names></name></person-group><article-title>Classification of metagenomic sequences: methods and challenges</article-title><source>Brief Bioinform</source><year>2012</year><volume>13</volume><issue>6</issue><fpage>669</fpage><lpage>81</lpage><pub-id pub-id-type="doi">10.1093/bib/bbs054</pub-id><?supplied-pmid 22962338?><pub-id pub-id-type="pmid">22962338</pub-id></element-citation></ref><ref id="CR2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qin</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>R</given-names></name><name><surname>Raes</surname><given-names>J</given-names></name><etal/></person-group><article-title>A human gut microbial gene catalogue established by metagenomic sequencing</article-title><source>Nature</source><year>2010</year><volume>464</volume><issue>7285</issue><fpage>59</fpage><lpage>65</lpage><pub-id pub-id-type="doi">10.1038/nature08821</pub-id><?supplied-pmid 20203603?><pub-id pub-id-type="pmid">20203603</pub-id></element-citation></ref><ref id="CR3"><label>3</label><mixed-citation publication-type="other">Zeller G, Tap J, Voigt AY, Sunagawa S, Kultima JR, Costea PI, et al. Potential of fecal microbiota for early-stage detection of colorectal cancer. Mol Syst Biol. 2014;10(11). Available from: <ext-link ext-link-type="uri" xlink:href="http://msb.embopress.org/content/10/11/766">http://msb.embopress.org/content/10/11/766</ext-link>.</mixed-citation></ref><ref id="CR4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>C</given-names></name><name><surname>Hug</surname><given-names>L</given-names></name><name><surname>Thomas</surname><given-names>B</given-names></name><name><surname>Sharon</surname><given-names>I</given-names></name><name><surname>Castelle</surname><given-names>C</given-names></name><name><surname>Singh</surname><given-names>AEA</given-names></name></person-group><article-title>Unusual biology across a group comprising more than 15% of domain Bacteria</article-title><source>Nature</source><year>2015</year><volume>523</volume><issue>7559</issue><fpage>208</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1038/nature14486</pub-id><?supplied-pmid 26083755?><pub-id pub-id-type="pmid">26083755</pub-id></element-citation></ref><ref id="CR5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Schwartz</surname><given-names>S</given-names></name><name><surname>Wagner</surname><given-names>L</given-names></name><name><surname>Miller</surname><given-names>W</given-names></name></person-group><article-title>A Greedy Algorithm for Aligning DNA Sequences</article-title><source>J Comput Biol</source><year>2004</year><volume>7</volume><issue>1-2</issue><fpage>203</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1089/10665270050081478</pub-id></element-citation></ref><ref id="CR6"><label>6</label><mixed-citation publication-type="other">Huson DH, Auch AF, Qi J, Schuster SC. MEGAN analysis of metagenomic data. Genome Res. 2007;17. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.5969107">http://dx.doi.org/10.1101/gr.5969107</ext-link>.</mixed-citation></ref><ref id="CR7"><label>7</label><mixed-citation publication-type="other">Liu B, Gibbons T, Ghodsi M, Treangen T, Pop M. Accurate and fast estimation of taxonomic profiles from metagenomic shotgun sequences. BMC Genomics. 2011;12. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-12-S2-S4">http://dx.doi.org/10.1186/1471-2164-12-S2-S4</ext-link>.</mixed-citation></ref><ref id="CR8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caporaso</surname><given-names>JG</given-names></name><name><surname>Kuczynski</surname><given-names>J</given-names></name><name><surname>Stombaugh</surname><given-names>J</given-names></name><name><surname>Bittinger</surname><given-names>K</given-names></name><name><surname>Bushman</surname><given-names>FD</given-names></name><name><surname>Costello</surname><given-names>EK</given-names></name><etal/></person-group><article-title>QIIME allows analysis of high-throughput community sequencing data</article-title><source>Nat Methods</source><year>2010</year><volume>7</volume><issue>5</issue><fpage>335</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id><?supplied-pmid 20383131?><pub-id pub-id-type="pmid">20383131</pub-id></element-citation></ref><ref id="CR9"><label>9</label><mixed-citation publication-type="other">Segata N, Waldron L, Ballarini A, Narasimhan V, Jousson O, Huttenhower C. Metagenomic microbial community profiling using unique clade-specific marker genes. Nat Methods. 2012;9. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2066">http://dx.doi.org/10.1038/nmeth.2066</ext-link>.</mixed-citation></ref><ref id="CR10"><label>10</label><mixed-citation publication-type="other">Wood D, Salzberg S. Kraken: ultrafast metagenomic sequence classification using exact alignments. Genome Biol. 2014; 15. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2014-15-3-r46">http://dx.doi.org/10.1186/gb-2014-15-3-r46</ext-link>.</mixed-citation></ref><ref id="CR11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ounit</surname><given-names>R</given-names></name><name><surname>Wanamaker</surname><given-names>S</given-names></name><name><surname>Close</surname><given-names>TJ</given-names></name><name><surname>Lonardi</surname><given-names>S</given-names></name></person-group><article-title>CLARK: fast and accurate classification of metagenomic and genomic sequences using discriminative k-mers</article-title><source>BMC Genomics</source><year>2015</year><volume>16</volume><issue>1</issue><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1186/s12864-015-1419-2</pub-id><pub-id pub-id-type="pmid">25553907</pub-id></element-citation></ref><ref id="CR12"><label>12</label><mixed-citation publication-type="other">Ames SK, Hysom DA, Gardner SN, Lloyd GS, Gokhale MB, Allen JE. Scalable metagenomic taxonomy classification using a reference genome database. Bioinformatics. 2013;29. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btt389">http://dx.doi.org/10.1093/bioinformatics/btt389</ext-link>.</mixed-citation></ref><ref id="CR13"><label>13</label><mixed-citation publication-type="other">Brady A, Salzberg S. PhymmBL expanded: confidence scores, custom databases, parallelization and more. Nat Methods. 2011;8. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth0511-367">http://dx.doi.org/10.1038/nmeth0511-367</ext-link>.</mixed-citation></ref><ref id="CR14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Girotto</surname><given-names>S</given-names></name><name><surname>Pizzi</surname><given-names>C</given-names></name><name><surname>Comin</surname><given-names>M</given-names></name></person-group><article-title>MetaProb: accurate metagenomic reads binning based on probabilistic sequence signatures</article-title><source>Bioinformatics</source><year>2016</year><volume>32</volume><issue>17</issue><fpage>i567</fpage><lpage>i575</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw466</pub-id><?supplied-pmid 27587676?><pub-id pub-id-type="pmid">27587676</pub-id></element-citation></ref><ref id="CR15"><label>15</label><mixed-citation publication-type="other">Wang Y, Leung HC, Yiu SM, Chin FY. Metacluster 5.0: a two-round binning approach for metagenomic data for low-abundance species in a noisy sample. Bioinformatics. 2012;28. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts397">http://dx.doi.org/10.1093/bioinformatics/bts397</ext-link>.</mixed-citation></ref><ref id="CR16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vinh</surname><given-names>LV</given-names></name><name><surname>Lang</surname><given-names>TV</given-names></name><name><surname>Binh</surname><given-names>LT</given-names></name><name><surname>Hoai</surname><given-names>TV</given-names></name></person-group><article-title>A two-phase binning algorithm using l-mer frequency on groups of non-overlapping reads</article-title><source>Algoritm Mol Biol</source><year>2015</year><volume>10</volume><issue>1</issue><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1186/s13015-014-0028-y</pub-id></element-citation></ref><ref id="CR17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Myers</surname><given-names>EW</given-names></name></person-group><article-title>The fragment assembly string graph</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><issue>suppl 2</issue><fpage>ii79</fpage><lpage>ii85</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bti1114</pub-id><?supplied-pmid 16204131?><pub-id pub-id-type="pmid">16204131</pub-id></element-citation></ref><ref id="CR18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindgreen</surname><given-names>S</given-names></name><name><surname>Adair</surname><given-names>KL</given-names></name><name><surname>Gardner</surname><given-names>P</given-names></name></person-group><article-title>An Evaluation of the Accuracy and Speed of Metagenome Analysis Tools</article-title><source>Sci Rep</source><year>2016</year><volume>6</volume><fpage>19233</fpage><pub-id pub-id-type="doi">10.1038/srep19233</pub-id><?supplied-pmid 26778510?><pub-id pub-id-type="pmid">26778510</pub-id></element-citation></ref><ref id="CR19"><label>19</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>B</given-names></name><name><surname>Peng</surname><given-names>Y</given-names></name><name><surname>Qin</surname><given-names>J</given-names></name><name><surname>Chin</surname><given-names>FYL</given-names></name></person-group><article-title>Metacluster: unsupervised binning of environmental genomic fragments and taxonomic annotation</article-title><source>ACM BCB&#x02019;10</source><year>2010</year><publisher-loc>New York</publisher-loc><publisher-name>ACM</publisher-name></element-citation></ref><ref id="CR20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Said</surname><given-names>HS</given-names></name><name><surname>Suda</surname><given-names>W</given-names></name><name><surname>Nakagome</surname><given-names>S</given-names></name><name><surname>Chinen</surname><given-names>H</given-names></name><name><surname>Oshima</surname><given-names>K</given-names></name><name><surname>Kim</surname><given-names>S</given-names></name><etal/></person-group><article-title>Dysbiosis of Salivary Microbiota in Inflammatory Bowel Disease and Its Association With Oral Immunological Biomarkers</article-title><source>DNA Res: Int J Rapid Publ Rep Genes Genomes</source><year>2014</year><volume>21</volume><issue>1</issue><fpage>15</fpage><lpage>25</lpage><pub-id pub-id-type="doi">10.1093/dnares/dst037</pub-id></element-citation></ref><ref id="CR21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dechen</surname><given-names>TC</given-names></name><name><surname>Sumit</surname><given-names>K</given-names></name><name><surname>Ranabir</surname><given-names>P</given-names></name></person-group><article-title>Correlates of Vaginal Colonization with Group B Streptococci among Pregnant Women</article-title><source>J Global Infect Dis</source><year>2010</year><volume>2</volume><issue>3</issue><fpage>236</fpage><lpage>41</lpage><pub-id pub-id-type="doi">10.4103/0974-777X.68536</pub-id></element-citation></ref><ref id="CR22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Verstraelen</surname><given-names>H</given-names></name><name><surname>Verhelst</surname><given-names>R</given-names></name><name><surname>Vaneechoutte</surname><given-names>M</given-names></name><name><surname>Temmerman</surname><given-names>M</given-names></name></person-group><article-title>Group A streptococcal vaginitis: an unrecognized cause of vaginal symptoms in adult women</article-title><source>Arch Gynecol Obstet</source><year>2011</year><volume>284</volume><issue>1</issue><fpage>95</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1007/s00404-011-1861-6</pub-id><?supplied-pmid 21336834?><pub-id pub-id-type="pmid">21336834</pub-id></element-citation></ref></ref-list></back></article>