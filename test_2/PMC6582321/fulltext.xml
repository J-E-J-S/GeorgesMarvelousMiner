<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id><journal-id journal-id-type="publisher-id">nar</journal-id><journal-title-group><journal-title>Nucleic Acids Research</journal-title></journal-title-group><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6582321</article-id><article-id pub-id-type="pmid">30918970</article-id><article-id pub-id-type="doi">10.1093/nar/gkz176</article-id><article-id pub-id-type="publisher-id">gkz176</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methods Online</subject></subj-group></article-categories><title-group><article-title>AlleleHMM: a data-driven method to identify allele specific differences in distributed functional genomic marks</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Chou</surname><given-names>Shao-Pei</given-names></name><xref ref-type="aff" rid="AFF1">1</xref><xref ref-type="aff" rid="AFF2">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-1999-7125</contrib-id><name><surname>Danko</surname><given-names>Charles G</given-names></name><!--<email>dankoc@gmail.com</email>--><xref ref-type="aff" rid="AFF1">1</xref><xref ref-type="aff" rid="AFF3">3</xref><xref ref-type="corresp" rid="COR1"/></contrib></contrib-group><aff id="AFF1"><label>1</label>Baker Institute for Animal Health, College of Veterinary Medicine, Cornell University, Ithaca, NY 14853, USA</aff><aff id="AFF2"><label>2</label>Department of Molecular Biology and Genetics, Cornell University, Ithaca, NY 14853, USA</aff><aff id="AFF3"><label>3</label>Department of Biomedical Sciences, College of Veterinary Medicine, Cornell University, Ithaca, NY 14853, USA</aff><author-notes><corresp id="COR1">To whom correspondence should be addressed. Tel: +1&#x000a0;607 256 5620; Email: <email>dankoc@gmail.com</email></corresp></author-notes><pub-date pub-type="ppub"><day>20</day><month>6</month><year>2019</year></pub-date><pub-date pub-type="epub" iso-8601-date="2019-03-28"><day>28</day><month>3</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>28</day><month>3</month><year>2019</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>47</volume><issue>11</issue><fpage>e64</fpage><lpage>e64</lpage><history><date date-type="accepted"><day>25</day><month>3</month><year>2019</year></date><date date-type="rev-recd"><day>01</day><month>3</month><year>2019</year></date><date date-type="received"><day>24</day><month>1</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement><copyright-year>2019</copyright-year><license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:href="gkz176.pdf"/><abstract><title>Abstract</title><p>How DNA sequence variation influences gene expression remains poorly understood. Diploid organisms have two homologous copies of their DNA sequence in the same nucleus, providing a rich source of information about how genetic variation affects a wealth of biochemical processes. However, few computational methods have been developed to discover allele specific differences in functional genomic data. Existing methods either treat each SNP independently, limiting statistical power, or combine SNPs across gene annotations, preventing the discovery of allele specific differences in unexpected genomic regions. Here we introduce AlleleHMM, a new computational method to identify blocks of neighboring SNPs that share similar allele specific differences in mark abundance. AlleleHMM uses a hidden Markov model to divide the genome into three hidden states based on allele frequencies in genomic data: a symmetric state (state S) which shows no difference between alleles, and regions with a higher signal on the maternal (state M) or paternal (state P) allele. AlleleHMM substantially outperformed naive methods using both simulated and real genomic data, particularly when input data had realistic levels of overdispersion. Using global run-on sequencing (GRO-seq) data, AlleleHMM identified thousands of allele specific blocks of transcription in both coding and non-coding genomic regions. AlleleHMM is a powerful tool for discovering allele specific regions in functional genomic datasets.</p></abstract><funding-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">National Human Genome Research Institute</named-content><named-content content-type="funder-identifier">10.13039/100000051</named-content></funding-source><award-id>R01-HG009309</award-id></award-group></funding-group><counts><page-count count="10"/></counts></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>INTRODUCTION</title><p>DNA encodes the blueprints for making an organism, in part by coordinating a complex cell-type and condition-specific gene expression program. Regulatory DNA affects gene expression by controlling the rates of a variety of steps during the transcription cycle, including opening chromatin, decorating core histones and DNA with chemical modifications, initiating RNA polymerase II (Pol II) at transcription start sites (TSSs), and releasing Pol II from a paused state into productive elongation (<xref rid="B1" ref-type="bibr">1</xref>). In addition, mRNAs are subjected to a host of post-transcriptional regulatory processes, most of which are influenced by the sequence of the RNA (<xref rid="B2" ref-type="bibr">2</xref>). How DNA or RNA sequences control each step during transcription, mRNA processing, and mRNA degradation remains poorly understood.</p><p>Finding allele specific differences in the distribution of marks along the genome is a powerful strategy for understanding the link between DNA sequence and the various biochemical processes that regulate gene expression (<xref rid="B3" ref-type="bibr">3</xref>,<xref rid="B4" ref-type="bibr">4</xref>). Diploid organisms have two copies of their DNA sequence in the same nuclear environment, providing a rich source of information about how genetic variation affects biochemical processes. Additionally, alleles in a diploid genome share the same environmental signals, cell type-specific differences within a complex tissue, and other potential confounding factors. Therefore allele specific signatures are a rigorous source of information about how DNA sequence affects gene expression.</p><p>Despite the general utility of allele specific expression measurements, surprisingly few computational methods have been proposed to detect allelic differences. Current methods that examine allele specific enrichment either test single-nucleotide polymorphisms (SNPs) independently (<xref rid="B4" ref-type="bibr">4</xref>,<xref rid="B5" ref-type="bibr">5</xref>) or combine the location of SNPs using gene annotations (<xref rid="B6" ref-type="bibr">6</xref>). Each of these methods has important limitations. Treating SNPs independently requires a high sequencing depth, and exhibits a bias in which regions with higher abundance of the mark of interest are much more likely to be discovered. Summing up the reads within contiguous genomic regions, such as annotated genes, can improve sensitivity and reduce bias by pooling information across SNPs that are more likely to share the same allele specificity. However, combining reads requires a well-annotated reference genome, which is not available in some species, and also prevents the analysis of marks in unannotated or non-coding regions which are critical for proper genome function.</p><p>Here, we introduce AlleleHMM, a novel computational tool that was designed to address these limitations. AlleleHMM identifies genomic blocks of SNPs that share the same allele specificity in mark abundance using a hidden Markov model (HMM). We show that AlleleHMM has significantly higher sensitivity and specificity when compared to tests that treat each SNP independently. AlleleHMM has similar statistical power compared to the practice of merging reads inside of gene annotations, and can also identify allele specific differences in unannotated non-coding RNAs when running genome-wide. When applied to publicly available global run-on sequencing (GRO-seq) data, a direct measurement of RNA polymerase, AlleleHMM discovers the location of the vast majority of genes discovered by merging gene annotations, and also identified over one thousand allele specific blocks that lie in unannotated genomic regions. Blocks of allele specific transcription are inversely correlated with the allele specific differences in repressive chromatin marks. Thus, AlleleHMM is a powerful new strategy to identify allele specific differences in functional genomic data.</p></sec><sec sec-type="materials|methods" id="SEC2"><title>MATERIALS AND METHODS</title><sec id="SEC2-1"><title>Overview of AlleleHMM</title><p>The primary goal of AlleleHMM is to identify allele specific blocks of signal in distributed functional genomic data. AlleleHMM relies on the key assumption that contiguous genomic regions share the same allele specificity (Figure <xref ref-type="fig" rid="F1">1A</xref>). This may happen for a variety of reasons depending on the genomic mark; for example RNA polymerase across a transcription unit shares the same allele specific differences that were derived from the rates of Pol II initiation or release from pause on the promoter which controls expression of that transcription unit (<xref rid="B1" ref-type="bibr">1</xref>).</p><fig id="F1" orientation="portrait" position="float"><label>Figure 1.</label><caption><p>AlleleHMM uses a hidden Markov model (HMM) to infer the allele specificity of genomic markers at each SNPs. (<bold>A</bold>) Cartoon shows the frequency of reads mapping to the paternal&#x000a0;(light blue bars) and maternal (pink bars) allele at positions across the genome (X-axis). Nearby SNPs show similar signatures of allele specificity depicted as blue (P, paternal allele specificity), red (M, maternal allele specificity), or black (S, no evidence of allele specificity) background identified using AlleleHMM. (<bold>B</bold>) The model structure of AlleleHMM. We model allele specificity using three hidden states: a symmetric state which shows no allele specificity (S, black), and states representing maternal- (M, red) or paternal-specific (P, blue) regions. SNPs can transition between hidden states. Green arrows represent the transition probabilities set using a user-adjustable tuning parameter, &#x003c4;.</p></caption><graphic xlink:href="gkz176fig1"/></fig><p>We developed an HMM (<xref rid="B7" ref-type="bibr">7</xref>) that represents allele specificity in a distributed genomic mark using three hidden states: symmetric (S) distribution of the mark from both alleles (which shows no allele specificity), and an imbalance of the mark specific to either the maternal (M) or paternal (P) alleles (Figure <xref ref-type="fig" rid="F1">1B</xref>). AlleleHMM takes as input read counts corresponding to each allele, computed using AlleleDB (<xref rid="B4" ref-type="bibr">4</xref>,<xref rid="B5" ref-type="bibr">5</xref>). AlleleHMM uses this information to set the parameters of the HMM using Baum&#x02013;Welch expectation maximization (<xref rid="B8" ref-type="bibr">8</xref>), save for a single holdout parameter used to tune the balance between sensitivity and specificity of AlleleHMM (see below). The Viterbi algorithm (<xref rid="B9" ref-type="bibr">9</xref>) is then used to identify the most likely hidden states through the data, resulting in a series of candidate blocks of signal that show evidence of allele specificity. We last calculated the coverage of allele specific read counts in each predicted AlleleHMM block and performed a binomial test to verify that the block predicted by the HMM is significantly allele specific. The last binomial test was performed to eliminate any false positives that result from multiple counts of a single read that map to multiple nearby SNPs, which are difficult to handle in the context of the HMM.</p><p>AlleleHMM can be downloaded from: <ext-link ext-link-type="uri" xlink:href="https://github.com/Danko-Lab/AlleleHMM">https://github.com/Danko-Lab/AlleleHMM</ext-link>.</p></sec><sec id="SEC2-2"><title>HMM structure</title><p>There are three hidden states in AlleleHMM (Figure <xref ref-type="fig" rid="F1">1B</xref>): (S) a symmetric state which represents no allele specificity, and (M) or (P) which represent regions with evidence of allele specificity on the maternal or paternal allele. Each state can transition to the other two states or stay in the original state. We used allele specific read counts of SNPs with at least one mapped read as observed emissions for AlleleHMM. The distance between SNPs was not considered in the model.</p></sec><sec id="SEC2-3"><title>Transition probability</title><p>Transitions are permitted between all of the hidden states (Figure <xref ref-type="fig" rid="F1">1B</xref>). To control the balance between sensitivity and specificity of AlleleHMM, we used a tuning parameter, &#x003c4; (Figure <xref ref-type="fig" rid="F1">1B</xref>), to limit the transition out of the M or P states. We set the transition probability from the M or P states to any of the other states to &#x003c4;/2, and the transition probability to stay in the M or P state to 1-&#x003c4;. The transition probability of the S state to either M or P were set using the Baum&#x02013;Welch expectation maximization (EM) algorithm (<xref rid="B7" ref-type="bibr">7</xref>,<xref rid="B8" ref-type="bibr">8</xref>).</p></sec><sec id="SEC2-4"><title>Emission probability</title><p>Each hidden state in AlleleHMM is associated with a separate probability distribution (called the &#x02018;emission probability&#x02019;) that was used to represent the input data. The emission probabilities for all three states were calculated using the binomial distribution. The input to AlleleHMM is the total read count and maternal read count for each SNP in the genome. The input data is provided as:
<disp-formula><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*}\begin{array}{@{}*{6}{l}@{}} {{\rm{SNP}}:}&#x00026;{1,}&#x00026;{2,}&#x00026;{3,}&#x00026; \ldots &#x00026;{{{\rm{l}}_{\rm{c}}}}\\ {{\rm{Total\,read\,count}}:}&#x00026;{{{\rm{n}}_1},}&#x00026;{{{\rm{n}}_2},}&#x00026;{{{\rm{n}}_3},}&#x00026; \ldots &#x00026;{{{\rm{n}}_{\rm{l}}}}\\ {{\rm{Maternal\,read\,count}}:}&#x00026;{{{\rm{x}}_1},}&#x00026;{{{\rm{x}}_2},}&#x00026;{{{\rm{x}}_3},}&#x00026; \ldots &#x00026;{{{\rm{x}}_{\rm{l}}}} \end{array}\end{equation*}\end{document}</tex-math></disp-formula></p><p>Given these input data, the emission probability for state <italic>j</italic> is defined as:
<disp-formula><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}{\rm{\, }} &#x00026;&#x00026; \prod\nolimits_{{\rm{autosomes}}} \, \prod\nolimits_{i\ = \ 1}^{{l_c}} {\frac{{{n_i}!}}{{{x_i}!\left( {{n_i} - {x_i}} \right)!}}}\nonumber p_j^{{x_i}}{{\left( {1 - {p_j}} \right)}^{\left( {{n_i} - {x_i}} \right)}} \end{eqnarray*}\end{document}</tex-math></disp-formula></p><p>The value <inline-formula><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${p_j}$\end{document}</tex-math></inline-formula> for each state (S, M, and P) was estimated from the data using the EM algorithm, as described below.</p></sec><sec id="SEC2-5"><title>Learning procedure for transition and emission probabilities</title><p>We use the Baum&#x02013;Welch EM algorithm (<xref rid="B8" ref-type="bibr">8</xref>) to learn the transition and emission parameters in AlleleHMM (with the exception of the user adjustable tuning parameter, &#x003c4;). The EM algorithm uses the forward-backward algorithm to compute the probability of each state at every heterozygous SNP in the genome with one or more mapped read (E-step). These probabilities are used to maximize the likelihood of the model given the input data (M-step). After learning model parameters using EM, we identify the most likely path of hidden states at every mapped heterozygous SNP using the Viterbi algorithm (<xref rid="B9" ref-type="bibr">9</xref>). These algorithms are described in detail by Durbin <italic>et&#x000a0;al.</italic> (<xref rid="B7" ref-type="bibr">7</xref>).</p></sec><sec id="SEC2-6"><title>Tuning parameter optimization using GRO-seq data</title><p>AlleleHMM defines a user-adjustable tuning parameter, &#x003c4;, that controls the balance between sensitivity and specificity by limiting the frequency of transitions between model states. Intuitively, users can think about &#x003c4; as the threshold <italic>P</italic>-value that must be overcome by the input data to support a state transition.</p><p>The optimal value of &#x003c4; depends on the type of data, the sequencing depth, and the heterozygosity of the genome of interest. To determine the optimal value of &#x003c4; for GRO-seq data in this manuscript, we assumed that changes in allele specificity should usually arise near a transcription start site (TSSs) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1A</xref>), because allele specificity across a gene is controlled by the rate of initiation and release from pause at the TSS (<xref rid="B1" ref-type="bibr">1</xref>). We evaluated the proportion of AlleleHMM blocks that start within a fixed distance of a TSS defined using dREG (discriminative regulatory-element detection from GRO-seq) (<xref rid="B10" ref-type="bibr">10</xref>,<xref rid="B11" ref-type="bibr">11</xref>) over a range of &#x003c4; in the dataset of interest. As &#x003c4; increased, a larger fraction of AlleleHMM blocks occurs within a predefined distance of a dREG annotated TSS (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1B</xref>). We selected the &#x003c4; for each dataset at which this value approached a saturation point. For instance, in the 129/<italic>castaneus</italic> F1 hybrid mouse embryonic stem cells (mESC) dataset, as &#x003c4; approached 1e-05, the fraction of AlleleHMM blocks beginning within 5 kb of a dREG site saturated at &#x0223c;50% (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1B</xref>, black line, <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1C</xref>). Although the value of saturation varied with different window sizes, the value of &#x003c4; that defined the saturation point was fairly well conserved over a reasonable range of &#x003c4; (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1B</xref>). In analyses that follow we fixed &#x003c4; to 1e-05 (full GM12878 dataset, mESC dataset). For subsampled GM12878, the same criteria used above suggested an optimal value of &#x003c4; as 1e-04 (50% of total reads), 1e-03 (25% of total reads), and 1e-2 (12.5 and 6.25% of total reads).</p><p>To provide an orthogonal validation for the value of &#x003c4; selected using the TSS strategy described above, we measured the sensitivity and specificity of AlleleHMM over different values &#x003c4; in each dataset, using gene annotations as a gold-standard (see below; <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1D&#x02013;F</xref>). We found that setting &#x003c4; using the saturation point of TSSs generally produced a sensitive model with a specificity near 1.0, as desired for the problem of discovering allele specific blocks in the unbalanced setting of an entire genome.</p></sec><sec id="SEC2-7"><title>Preparing data for input to AlleleHMM</title><p>Allele specific read counts were computed using AlleleDB (<xref rid="B4" ref-type="bibr">4</xref>,<xref rid="B5" ref-type="bibr">5</xref>) with some modifications. Briefly, reads were mapped to paternal and maternal genomes separately using Bowtie (<xref rid="B14" ref-type="bibr">14</xref>). Reads with ambiguous mapping bias were removed, following the procedure in AlleleDB (<xref rid="B5" ref-type="bibr">5</xref>). The Bowtie output of each parental genome was merged and each read was assigned to either the paternal or maternal haplotype based on the amount of difference between the read and each individual genome. Reads that differed from both individual genomes by the same amount were assigned randomly to one of the individual genomes. The merged Bowtie output was separated to plus strand and minus strand using in house scripts because AlleleDB was designed for non-strand-specific datasets. The allele specific read counts of each SNP on each strand were computed using AlleleDB (<xref rid="B4" ref-type="bibr">4</xref>,<xref rid="B5" ref-type="bibr">5</xref>). The AlleleDB output was further parsed into a tab-delimited table as shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>.</p><p>An example input file can be found here: <ext-link ext-link-type="uri" xlink:href="https://github.com/Danko-Lab/AlleleHMM/blob/master/input_file_exmaples/AlleleHMM_input.txt">https://github.com/Danko-Lab/AlleleHMM/blob/master/input_file_exmaples/AlleleHMM_input.txt</ext-link></p></sec><sec id="SEC2-8"><title>Identify allele specific transcribed blocks</title><p>We used the Viterbi algorithm (<xref rid="B9" ref-type="bibr">9</xref>) to identify the most likely set of states (M, P or S) at each heterozygous position in the genome of interest. Nearby SNPs sharing the same hidden state were stitched into blocks. We then calculated the coverage of reads in each block as follows: Reads were mapped to the diploid genome using Bowtie (<xref rid="B12" ref-type="bibr">12</xref>) as implemented in AlleleDB (<xref rid="B5" ref-type="bibr">5</xref>). The Bowtie output, including reads and their mapping position, were separated into maternal- and paternal-specific text files. Then, the coordinates were transferred to the appropriate reference genome (mm10 or hg19) using liftOver (<xref rid="B13" ref-type="bibr">13</xref>). We used the older hg19 human reference genome because existing fully phased personal references for each of the two GM12878 haplotypes were available in this coordinate system (<xref rid="B4" ref-type="bibr">4</xref>,<xref rid="B5" ref-type="bibr">5</xref>), but not in the newer hg38. We calculated the number of reads from the maternal or paternal haplotype in each AlleleHMM block using bedtools (<xref rid="B14" ref-type="bibr">14</xref>). Binomial tests were performed for each block and the false discovery rate was estimated to correct for multiple hypothesis testing (<xref rid="B15" ref-type="bibr">15</xref>). These steps were performed to eliminate false positives derived from multiple counts of a single read that mapped to multiple nearby SNPs, which were more complicated to consider in the context of our HMM. AlleleHMM outputs two bed files: one with all blocks and the other only reports the blocks with an FDR &#x02264;10% as significantly allele specific.</p></sec><sec id="SEC2-9"><title>Performance test with synthetic data</title><p>To test how the performance of AlleleHMM compared with current standards in the field, which involve testing SNPs independently, we developed a simulation strategy. We used a simulation strategy because the location and magnitude of allele specific blocks could be controlled precisely, providing a confident ground truth dataset for rigorous performance evaluation. The synthetic data was composed of three blocks, each representing a region with allele specificity as shown on the top of Figure <xref ref-type="fig" rid="F2">2</xref>. The flanking blocks were symmetric, and were simulated using parameters that were kept consistent throughout the study.</p><fig id="F2" orientation="portrait" position="float"><label>Figure 2.</label><caption><p>AlleleHMM had better sensitivity and specificity compared with standard methods performing independent binomial tests for each SNP. (<bold>A</bold>) Scatterplots show the sensitivity for each SNP in the center block of AlleleHMM (red) and independent binomial tests (blue) as a function of the length of a maternal specific blocks (the number of continuous SNPs sharing same allele specificity, left), the average read count at each SNP (center), or the expected maternal reads fraction (right). Error bars represent the standard error of 1000 independent simulations. The dotted line indicates the average number of SNPs per human gene. (<bold>B</bold>) Scatterplots show the specificity of AlleleHMM (red) and independent binomial tests (blue) as a function of the length of the symmetric middle block (the number of continuous SNPs sharing same allele specificity, left) or the average read count at each SNP (right). Error bars represent the standard error of 1000 independent simulations. The dotted line indicates the average number of SNPs per human gene.</p></caption><graphic xlink:href="gkz176fig2"/></fig><p>The following parameters were changed to simulate the middle block with allele specific transcription: length, expression level, and the degree of allele specificity. Length was defined as the number of contiguous SNPs sharing the same allele specificity, and was set to 100 when testing other parameters, settings that were within the range of a typical gene in F1 hybrid mice (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2A</xref>, top). Expression level, or the average read count per SNP in the block, was set to 10 when testing other parameters. The degree of allele specificity was defined as the probability that a read comes from the maternal allele in a binomial or beta-binomial event, and was set to 0.9 when testing other parameters. The total read counts of each location were simulated with a Poisson distribution and the allele specific read count was simulated by either the binomial or beta-binomial distribution with overdispersion of 0.25. The overdispersion of 0.25 was chosen based on the estimates of two real data sets: GRO-seq in GM12878 and 129/<italic>castaneus</italic> F1 hybrid mESCs. The estimate was performed in R using the VGAM library (<xref rid="B16" ref-type="bibr">16</xref>) using all SNPs covered by at least 5 reads. The parameters used are summarized in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>.</p></sec><sec id="SEC2-10"><title>Performance test with real biological data</title><p>To test the performance of AlleleHMM with GRO-seq data, we applied AlleleHMM and independent binomial tests implemented in AlleleDB to GRO-seq from GM12878 and 129/<italic>castaneus</italic> F1 hybrid mESCs. The allele specificity of each GENCODE gene annotation was estimated and used as a surrogate for the ground truth. Allele specific reads within each GENCODE gene annotation were counted using bedtools (<xref rid="B14" ref-type="bibr">14</xref>). Binomial tests were then performed for each gene annotation and the false discovery rate was used to correct for multiple hypothesis testing. We used Release 28 (mapped to hg19/ GRCh37) for GM12878 and Release M17 (mm10/ GRCm38.p6) for 129/<italic>castaneus</italic> F1 hybrid mouse. The sensitivity, specificity, and precision were calculated at the SNP-level. All SNPs inside GENCODE gene annotations with at least one read mapped were used. The allele specificity was determined by AlleleHMM, independent binomial tests, and using GENCODE gene annotations were summarized and used to calculate performance using in-house scripts.</p></sec><sec id="SEC2-11"><title>Comparison with H3K27me3 ChIP-seq data</title><p>To test the correlation between transcription and H3K27me3 in GM12878, we mapped the H3K27me3 ChIP-seq reads to the diploid genome of GM12878 using Bowtie as implemented in AlleleDB (<xref rid="B5" ref-type="bibr">5</xref>). The Bowtie output, including reads and their mapping positions, was separated into maternal- and paternal-specific files. Coordinates were transferred to the reference genome (hg19) using liftOver. We used bedtools coverage to calculate the number of H3K27me3 ChIP-seq reads falling into each AlleleHMM block obtained from GRO-seq in GM12878. We then calculated the ratio of maternal-specific and paternal-specific H3K27me3 ChIP-seq reads in each GRO-seq AlleleHMM block and summarized using in-house R scripts.</p></sec><sec id="SEC2-12"><title>Data used in this study</title><p>
<list list-type="simple"><list-item><p>GRO-seq of 129/<italic>castaneus</italic> F1 hybrid mouse embryonic stem cells: SRA ID number SRR4041366.</p></list-item><list-item><p>GRO-seq of GM12878: SRA ID number SRR1552485</p></list-item><list-item><p>H3K27me3 ChIP-seq data of GM12878 were fastq files from ENCODE: ENCFF000ASV, ENCFF000ASW, ENCFF000ASZ, ENCFF001EXM, ENCFF001EXO</p></list-item></list>
</p></sec><sec id="SEC2-13"><title>Software availability</title><p>
<list list-type="simple"><list-item><p>The source code of AlleleHMM is available under the BSD 2-clause license <ext-link ext-link-type="uri" xlink:href="https://github.com/Danko-Lab/AlleleHMM">https://github.com/Danko-Lab/AlleleHMM</ext-link></p></list-item><list-item><p>Scripts used for each computation are available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/Danko-Lab/AlleleHMM/tree/master/analysis_for_AlleleHMM_manuscript">https://github.com/Danko-Lab/AlleleHMM/tree/master/analysis_for_AlleleHMM_manuscript</ext-link></p></list-item></list>
</p></sec></sec><sec sec-type="results" id="SEC3"><title>RESULTS</title><sec id="SEC3-1"><title>Finding allele specific differences using a hidden Markov model</title><p>Differences in mark abundance between two heterozygous alleles are often correlated across multiple adjacent SNPs (Figure <xref ref-type="fig" rid="F1">1A</xref>). We developed AlleleHMM to identify genomic regions that share allele specific differences in functional mark abundance. AlleleHMM takes as input counts of reads mapping unambiguously to each of the two alleles in heterozygous positions of a phased reference genome. AlleleHMM models the data using a hidden Markov model (HMM) that divides the genome among three hidden states: a symmetric state (state S) which shows no allelic difference in mark abundance, and regions with a higher signal on the maternal (M) or paternal (P) allele (Figure <xref ref-type="fig" rid="F1">1B</xref>; see Materials and Methods). AlleleHMM models the distribution of read counts mapping to each allele using a binomial distribution. To control the tradeoff between sensitivity and specificity, we introduced a user-adjustable tuning parameter, &#x003c4;, that constrains the transition probability out of either the maternal or paternal state. Aside from &#x003c4;, all other model parameters are set using expectation maximization over the provided data.</p></sec><sec id="SEC3-2"><title>Performance test with binomial-distributed simulated data</title><p>To determine how AlleleHMM performed in practice, we simulated blocks of contiguous SNPs with specific levels of allele specificity. We simulated a sequence of SNPs composed of three blocks using the binomial distribution (Figure <xref ref-type="fig" rid="F2">2A</xref>, top): two blocks with equal signal in both alleles and one middle block that exhibited a known difference in signal between alleles. We evaluated the performance of AlleleHMM after we systematically changed the length, signal level, and degree of allele specificity in the middle block holding other parameters constant (see methods) (Figure <xref ref-type="fig" rid="F2">2A</xref>). We evaluated the accuracy of AlleleHMM by examining the sensitivity (the fraction of true positives recovered). We also examined the specificity (the fraction of correctly classified true negatives) and precision (the fraction of true positives over all positive calls) of AlleleHMM, incorporating simulations in which the middle block was symmetric to compute precision. We chose simulation parameters characteristic of global run-on and sequencing (GRO-seq) (<xref rid="B17" ref-type="bibr">17</xref>), a direct measurement of RNA polymerase which is challenging to use in allele specific measurements because only a few reads map to each SNP in a typical dataset, resulting in poor statistical power.</p><p>AlleleHMM identified allelic differences in simulated data with higher sensitivity, specificity, and precision compared with simple methods that perform independent binomial tests at each SNP (Figure <xref ref-type="fig" rid="F2">2</xref>; <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2A</xref>). The sensitivity of AlleleHMM for each simulated allele specific SNP in the center block increased with block length. AlleleHMM had a higher sensitivity than independent binomial tests when the center block contained as few as 8 adjacent SNPs, and a higher precision with only 10 adjacent SNPs (Figure <xref ref-type="fig" rid="F2">2A</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2A</xref>, left), shorter than observed in most mammalian genes (on average, 39.7 SNPs per gene for human CEPH Utah and 237.2 SNPs for 129/<italic>castaneus</italic> F1 hybrid mouse, <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2B</xref>). AlleleHMM had a higher sensitivity across the spectrum of signal levels (Figure <xref ref-type="fig" rid="F2">2A</xref>, center). Likewise, we found that AlleleHMM was more sensitive across an important range of allele specificity magnitudes (&#x02264;0.25 or &#x02265;0.75; Figure <xref ref-type="fig" rid="F2">2A</xref>, right). Treating SNPs independently resulted in a higher sensitivity when the allele specificity was much lower in magnitude (0.25&#x02013;0.75), which we attribute to the presence of rare individual SNPs that have a higher magnitude of allele specificity than the average for that block due to random statistical fluctuations. AlleleHMM had a higher specificity throughout the range of expression and block length parameters than treating SNPs independently (Figure <xref ref-type="fig" rid="F2">2B</xref>), and generally had superior precision as well (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2A</xref>), demonstrating that AlleleHMM does not trade a higher sensitivity for a lower specificity. Thus we conclude that AlleleHMM had better sensitivity and specificity for allele specific transcription in synthetic data simulated using the binomial distribution.</p></sec><sec id="SEC3-3"><title>Performance test with overdispersed synthetic data</title><p>Many short-read datasets exhibit overdispersion due to a variety of technical factors, which increases the rate of false positive allele specific differences (<xref rid="B5" ref-type="bibr">5</xref>). To test how AlleleHMM performed with overdispersed data, we applied a similar simulation strategy using a beta-binomial distribution to simulate read counts with varying degrees of overdispersion. AlleleHMM had a reasonably high sensitivity, precision, and specificity across the spectrum of distinct overdispersion values (Figure <xref ref-type="fig" rid="F3">3A</xref>; <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3A</xref>). AlleleHMM retained a sensitivity &#x0003e;0.95, while maintaining both precision and specificity near 1.0 at realistic overdispersion levels estimated using two independent GRO-seq datasets: human GM12878 lymphoblastoid cells (overdispersion of 0.24) (<xref rid="B18" ref-type="bibr">18</xref>) and 129/<italic>castaneus</italic> F1 hybrid mouse embryonic stem cells (mESCs) (overdispersion of 0.26) (<xref rid="B19" ref-type="bibr">19</xref>).</p><fig id="F3" orientation="portrait" position="float"><label>Figure 3.</label><caption><p>AlleleHMM had better sensitivity and specificity compared with the naive standard practice of performing a binomial test for each SNP independently in overdispersed data. (<bold>A</bold>) Scatterplots show sensitivity (left) and specificity (right) of AlleleHMM (red) and independent binomial tests (blue) as a function of the overdispersion parameter in beta-binomial distributed simulated data. Error bars represent the standard error of 1000 independent simulations. Dashed lines indicate the mean of overdispersion estimated from GRO-seq of GM12878 and GRO-seq of 129/<italic>castaneus</italic> F1 hybrid mESCs. (<bold>B</bold>) Scatterplots show the sensitivity of AlleleHMM (red) and independent binomial tests (blue) as a function of the length of a maternal specific blocks (the number of continuous SNPs sharing same allele specificity, left), the average read count at each SNP (center), or the expected maternal read fraction (right) with an overdispersion of 0.25. Error bars represent the standard error of 1000 independent simulations. The dotted line indicates the average number of SNPs per human gene. (<bold>C</bold>) Scatterplots show the specificity of AlleleHMM (red) and independent binomial tests (blue) as a function of the length of the symmetric middle block (left) or the average read count at each SNP (right) with an overdispersion of 0.25. Error bars represent the standard error of 1000 independent simulations. The dotted line indicates the average number of SNPs per human gene.</p></caption><graphic xlink:href="gkz176fig3"/></fig><p>To test how AlleleHMM performance varied with the length, signal level, and the degree of allele specificity when the input data was overdispersed, we fixed overdispersion to 0.25 (dashed lines in Figure <xref ref-type="fig" rid="F3">3A</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3A</xref>) and performed simulation experiments similar to those described for the binomial distribution, above. AlleleHMM sensitivity and precision increased with block length, and were higher than independent binomial tests with as few as 8 (or 5, respectively) adjacent SNPs (Figure <xref ref-type="fig" rid="F3">3B</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3B</xref>, left). AlleleHMM was also highly sensitive over an important range of allele specificity magnitudes (&#x02264;0.25 or &#x02265;0.75; Figure <xref ref-type="fig" rid="F3">3B</xref>, right). AlleleHMM had a higher specificity than independent binomial tests across the spectrum of length (the number of SNPs per gene, Figure <xref ref-type="fig" rid="F3">3C</xref>, left) and signal levels (average read counts per SNP, Figure <xref ref-type="fig" rid="F3">3C</xref>, right). The specificity of both AlleleHMM and independent binomial tests declined as read count increased (Figure <xref ref-type="fig" rid="F3">3C</xref>, right). However, AlleleHMM maintained a reasonable precision throughout this range, while independent binomial tests never achieved a precision &#x0003e;0.75 in this test (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3</xref>, center). Moreover, AlleleHMM exhibited a high sensitivity within the range at which it maintained a high specificity (2&#x02013;20 reads supporting each SNP, Figure <xref ref-type="fig" rid="F3">3B</xref>, center), suggesting that subsampling highly expressed regions may be a viable strategy to deal with overdispersion in practice. Thus, AlleleHMM improved specificity in overdispersed data while maintaining a higher sensitivity compared with state-of-the-art tools using realistic parameters taken from GRO-seq data.</p></sec><sec id="SEC3-4"><title>Performance comparison with independent SNPs using GRO-seq data</title><p>We next asked whether AlleleHMM provides a higher sensitivity, specificity, or precision using real GRO-seq data as input. We used AlleleHMM to analyze two public GRO-seq datasets: one from 129/<italic>castaneus</italic> F1 hybrid mESCs and the other from a human GM12878 lymphoblastoid cell line (<xref rid="B18" ref-type="bibr">18</xref>,<xref rid="B19" ref-type="bibr">19</xref>).</p><p>To estimate the accuracy of AlleleHMM using real data in which there was no ground truth, we identified annotated genes with evidence for allele specific transcription by combining reads across the entire gene annotation. Because RNA polymerase in the gene body is loaded in the promoter region, SNPs residing in the same gene annotation should generally share the same level of allele specificity. Therefore we estimated the allele specificity of each gene annotation using all reads that fall inside, and assigned this magnitude of allele specificity to every SNP that resides inside that annotation (see Methods). Using gene annotations as a surrogate for a ground truth, we found that AlleleHMM had a higher sensitivity than independent binomial tests, especially within the range of allele specificity magnitudes that was most likely to contain biologically relevant allelic differences (maternal read ratio of the gene &#x02264;0.25 or &#x02265;0.75, Figure <xref ref-type="fig" rid="F4">4A</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4</xref>, left), consistent with its performance in synthetic data. AlleleHMM had a similar or higher precision compared with independent binomial tests (Figure <xref ref-type="fig" rid="F4">4A</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4</xref>, right). Thus, AlleleHMM is both more sensitive and precise when using real GRO-seq data as input.</p><fig id="F4" orientation="portrait" position="float"><label>Figure 4.</label><caption><p>Comparison between AlleleHMM and independent binomial tests. (<bold>A</bold>) Scatterplots show the sensitivity (left) and precision (right) of AlleleHMM (red) and independent binomial tests (blue) as a function of the maternal reads fraction in the gene annotation using GRO-seq data from GM12878. (<bold>B</bold>) Scatterplots show the sensitivity of AlleleHMM as a function of the fraction of maternal reads in the gene annotations. Different lines indicate the read depth of the subsampled GRO-seq reads from a deeply sequenced human GM12878 dataset. The total sequencing depth is 187 896 441. (<bold>C</bold>) Venn diagrams show the number of allele specific SNPs identified by AlleleHMM only (H, red), independent binomial tests (I, blue, implemented in AlleleDB), and intersection of both methods (B, purple) from GRO-seq data of a 129/<italic>castaneus</italic> F1 hybrid mouse (top) and a human cell line GM12878 (bottom). (<bold>D</bold>) Pie charts show the proportion of allele specific SNPs in GM12878 GRO-seq data that are within genes having no evidence of allele specificity over the gene (symmetric, S, pink), or genes that show higher expression on the same (concordant, C, white) or the opposite (discordant, D, light blue) haplotype. (<bold>E</bold>) Histograms show the fraction of genes as a function of the number of allele specificity switches the gene contains. Allele specificity was determined by AlleleHMM only (H, red, top), independent binomial tests (I, blue, bottom), and intersection of both methods (B, purple, middle) using GRO-seq data from a human cell line GM12878.</p></caption><graphic xlink:href="gkz176fig4"/></fig><p>Most genomics applications are highly imbalanced, with negative examples greatly outnumbering positive examples, resulting in poor precision despite a high specificity. To measure performance in cases where data are highly imbalanced, we generated datasets based on SNPs in genes where the magnitude of allele specificity was &#x0003c;0.2 or &#x0003e;0.8 (true positives) or between &#x0003e;0.45 and &#x0003c;0.55 (true negatives). Using these highly imbalanced datasets (ratio of positive to negative examples &#x0003c; 0.05), AlleleHMM retained a high precision (&#x0003e;0.66) at relatively high sensitivity (&#x0003e;0.76). AlleleHMM outperformed independent binomial tests by a wide margin in this task (sensitivity &#x0003c;&#x000a0;0.4 and precision &#x0003c; 0.2; see <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5</xref>). We note that a precision of 1.0 is not necessarily expected or desired in these tests, because numerous differences exist between gene annotations and the actual patterns of transcription that occur in cells (as described below). These results suggest that even in a setting where less than 5% of SNPs are true positives, AlleleHMM still obtains useful information about allele specificity, whereas the use of independent tests does not.</p><p>To examine how library sequencing depth affects the performance of AlleleHMM, we subsampled GRO-seq reads from the deeply sequenced human GM12878 dataset and evaluated recovery using annotations with true positive/ negative labels generated based on the entire dataset. We found that AlleleHMM was remarkably sensitive even at sequencing depths that were &#x0003c;10% of the total read count (Figure <xref ref-type="fig" rid="F4">4B</xref>), at a consistent precision and specificity (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S6A</xref>, center and right). In contrast, the sensitivity of independent binomial tests, which was not very high to begin with, dropped off rapidly with sequencing depth (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S6B</xref>, left). Thus, even a modest sequencing depth (&#x0223c;20 million uniquely mapped reads) is enough to identify the majority of allele specific differences in transcription using GRO-seq data.</p><p>To more rigorously understand the differences between AlleleHMM and independent binomial tests, we divided SNPs based on whether they were identified as allele specific using AlleleHMM, independent binomial tests, or both methods. Few SNPs were identified as allele specific using both AlleleHMM and independent binomial tests on each SNP (Figure <xref ref-type="fig" rid="F4">4C</xref>). In GM12878, for example, AlleleHMM identified 32,599 heterozygous SNPs with 1 or more read in 4,026 AlleleHMM blocks. Only 13,086 of the SNPs identified using AlleleHMM were also discovered using independent binomial tests (&#x0223c;40% of SNPs; Figure <xref ref-type="fig" rid="F4">4C</xref>, bottom). As expected, SNPs identified only by AlleleHMM largely reflect heterozygous positions covered by too few reads to confidently assign allele specificity when treating SNPs independently, whereas those identified using both methods had a higher read depth (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S7</xref>). Taken together, these observations are consistent with AlleleHMM making substantial improvements in sensitivity for allele specific differences in genes with lower expression levels.</p><p>We were more surprised to find large numbers of SNPs reported as allele specific using independent binomial tests without a corresponding discovery by AlleleHMM (<italic>n</italic> = 21,145 [mESC] or 79,562 [GM12878]). To investigate whether these SNPs were false negative calls by AlleleHMM or false positives by the binomial test, we again used SNPs within annotated genes under the assumption that RNA polymerase across a gene shares the same allele specificity. The majority of allele specific SNPs identified by AlleleHMM were found to have the same direction (maternal or paternal) of allele specificity as the gene annotation, henceforth called &#x02018;concordant&#x02019; (Figure <xref ref-type="fig" rid="F4">4D</xref>, concordant [C] in white). By contrast, SNPs identified as allele specific using only independent binomial tests were most often identified within genes where the entire annotation showed no evidence of allele specificity, henceforth called &#x02018;symmetric&#x02019; (Figure <xref ref-type="fig" rid="F4">4D</xref>, symmetric [S] in pink). We also directly investigated whether gene annotations tend to have a single allelic state using each method, as implied by the assumption that RNA polymerase density is largely determined by events occurring at a single promoter region. We found that AlleleHMM identified a single block covering annotations in &#x0003e;80% of cases (Figure <xref ref-type="fig" rid="F4">4E</xref>, top). In contrast, the direction of allele specificity detected by independent binomial tests often switched across the annotation (Figure <xref ref-type="fig" rid="F4">4E</xref>, bottom), resulting in no evidence of allele specificity when SNPs within annotations were merged. Taken together, these observations provide additional support to our analysis of precision in unbalanced genomic data (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5</xref>) and suggest that many of the SNPs identified only by independent binomial tests are false positives.</p></sec><sec id="SEC3-5"><title>Widespread non-coding allele specific transcription identified using AlleleHMM</title><p>Despite achieving a high concordance with gene annotations when available, AlleleHMM was also able to identify allele specific differences in unannotated transcription units. For instance, AlleleHMM identified the transcription unit upstream and antisense to <italic>Pdpn</italic> as sharing the same allele specificity as the <italic>Pdpn</italic> coding region (Figure <xref ref-type="fig" rid="F5">5A</xref>). Likewise, in cases where AlleleHMM disagreed with gene annotations, it frequently identified cell-type specific transcription units that were correctly classified upon careful examination. For instance, in the GM12878 dataset AlleleHMM found that transcription originating from enhancers within the <italic>DTNB</italic> gene annotation was maternal-specific, although most of the <italic>DTNB</italic> annotation itself was not (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S8</xref>). These observations demonstrate that AlleleHMM provides substantial advantages useful for new biological discovery compared with heuristics that summarize signals within well-known gene annotations.</p><fig id="F5" orientation="portrait" position="float"><label>Figure 5.</label><caption><p>Application of AlleleHMM to GRO-seq data. (<bold>A</bold>) Genome browser view shows the application of AlleleHMM and independent binomial tests (implemented in AlleleDB) to GRO-seq data from a 129/<italic>castaneus</italic> F1 hybrid mouse. The allele specific read counts of the blocks and SNPs are denoted as <bold>P</bold>{M:12,P:136}, meaning that the block is paternal specific (P) with 12 maternal-specific (M) reads and 136 paternal-specific (P) reads. (<bold>B</bold>) Histograms show the distribution of AlleleHMM block size of GRO-seq data from a 129/<italic>castaneus</italic> F1 hybrid mouse (red) and GRO-seq data from a human cell line GM12878 (blue) in log scale (X-axis). (<bold>C</bold>) Histograms show the fraction of AlleleHMM blocks as a function of the number of genes it contains. GRO-seq data from a 129/<italic>castaneus</italic> F1 hybrid mouse is in red and GRO-seq data from a human cell line GM12878 is in blue.</p></caption><graphic xlink:href="gkz176fig5"/></fig><p>AlleleHMM revealed thousands of regions with maternal or paternal-specific RNA polymerase abundance genome-wide. AlleleHMM identified 3,483 and 4,026 blocks with significant allele specific differences in mESCs and GM12878, respectively. The average genome size of each block in the F1 hybrid dataset was &#x0223c;166 kb (Figure <xref ref-type="fig" rid="F5">5B</xref>). Blocks were larger in the mESC dataset than in GM12878, likely owing to a combination of differences in heterozygosity and sequencing depth between datasets (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S9</xref>). Approximately 25% of AlleleHMM blocks did not contain any GENCODE gene annotation (Figure <xref ref-type="fig" rid="F5">5C</xref>), for example the antisense transcription unit upstream of <italic>Pdpn</italic> (Figure <xref ref-type="fig" rid="F5">5A</xref>). Many AlleleHMM blocks contained more than one gene annotation (28% of F1 hybrid mouse blocks and 13% of GM12878 blocks), indicating groups of nearby genes and non-coding transcription units that share similar allele specificity in their transcription. Thus, AlleleHMM identified widespread evidence for allele specificity in non-coding transcription, as well as coordination between nearby transcription units that was not evident from strategies that merged gene annotations.</p></sec><sec id="SEC3-6"><title>Allele specific transcription negatively correlates with allele specific repressive chromatin marks</title><p>To find further independent validation for blocks of allele specific transcription identified using AlleleHMM, we asked whether we could recover the negative relationship expected between transcription and histone marks associated with transcriptional repression, especially H3K27me3. We focused on GM12878, for which there is publicly available ChIP-seq data profiling the distribution of H3K27me3 (<xref rid="B20" ref-type="bibr">20</xref>,<xref rid="B21" ref-type="bibr">21</xref>). Mapping H3K27me3 ChIP-seq data onto AlleleHMM blocks identified using GRO-seq revealed 113 blocks with a significant allele specificity in H3K27me3 ChIP-seq data. As expected, the degree of allele specificity in H3K27me3 ChIP-seq was inversely correlated with that of GRO-seq (Pearson's <italic>R</italic> = &#x02013;0.57; Figure <xref ref-type="fig" rid="F6">6</xref>). The slope of the best fit line implies that a 2-fold change in H3K27me3 was associated with &#x0223c;5.7-fold change in transcription. Assuming a similar dynamic range in both assays, this result implies that relatively modest changes in H3K27me3 may have a relatively large average impact on transcription. Thus, AlleleHMM reveals blocks of allele specificity which are largely in agreement with orthogonal genomic assays.</p><fig id="F6" orientation="portrait" position="float"><label>Figure 6.</label><caption><p>Allele specific transcription correlates with allele specific H3K27me3. Scatterplots show the allele specificity of H3K27me3 ChIP-seq data (Y-axis) as a function of allele specificity in GRO-seq data (X-axis). The trendline shows the best fit based on a total least squares regression. The Pearson correlation is shown on the plot (<italic>R</italic> = &#x02013;0.57, <italic>P</italic>-value &#x0003c; 2.2e&#x02013;16). The slope of the best fit line is &#x02013;2.5.</p></caption><graphic xlink:href="gkz176fig6"/></fig></sec></sec><sec sec-type="discussion" id="SEC4"><title>DISCUSSION</title><p>Here we have introduced AlleleHMM to identify allele specific differences in functional genomic marks. AlleleHMM models the spatial correlation in allele specific differences in a phased diploid genome using hidden Markov models (HMMs). We show that AlleleHMM provides substantial improvements in both sensitivity and specificity for detecting allele specific SNPs compared with existing computational tools, using both simulation studies and analyses of real GRO-seq data. AlleleHMM is applicable to any type of functional genomic data and to any diploid species with a high-quality phased reference genome. AlleleHMM can now be deployed to understand the interplay between chromatin environment, transcription, and mRNA across a wide variety of organisms, providing new insights into how DNA sequences influence biochemical processes in the nucleus.</p><p>Although there has been extensive interest in using allele specific information to understand the interplay between functional marks, surprisingly few computational methods have been developed for this task. One of the current methods to identify allelic differences requires performing independent statistical tests at each SNP (<xref rid="B4" ref-type="bibr">4</xref>,<xref rid="B5" ref-type="bibr">5</xref>). This approach of treating SNPs independently requires a high sequencing depth with dozens of reads covering each SNP in order to be statistically powered to identify allele specific differences. Additionally, because signal for the majority of marks tends to be unevenly distributed along the genome, this strategy is prone to significant biases where loci with a higher signal intensity tend to be better represented due to statistical power. Finally, as has been reported elsewhere (<xref rid="B5" ref-type="bibr">5</xref>), and as we show here, the application of independent statistical tests is prone to a high rate of false discoveries. Although false positives can be addressed by using more conservative statistical models (<xref rid="B5" ref-type="bibr">5</xref>), this more conservative strategy exacerbates issues with statistical power. AlleleHMM addresses this deficiency in an alternative way, by modelling the correlation between adjacent signal intensities, thus pooling statistical power across adjacent positions.</p><p>An alternative approach that is commonly used to identify allele specific differences in mark abundance is to use pre-established boundaries of genes or other genomic features as a way to pool SNPs within regions of the genome (<xref rid="B6" ref-type="bibr">6</xref>). This alternative strategy improves upon the use of independent statistical tests by using information between nearby alleles. However, there are still a number of important limitations with this approach. Chiefly among the limitations of this strategy is that allele specific differences in functional marks cannot be identified if they fall outside of the boundaries of pre-established gene annotations. Likewise, cell-type specific differences in transcript isoforms are common, even in well annotated genomes like human and mouse, which provide a substantial source of error for annotation-based approaches. Finally, the use of annotations requires a well annotated reference genome, which is only available in well studied model organism such as Drosophila, humans, or mice. AlleleHMM addresses these limitations by providing a rigorous and statistically motivated method to identify the boundaries of allele specific blocks <italic>de novo</italic>.</p><p>Although AlleleHMM is a powerful tool that makes significant improvements compared with existing strategies, it does have several limitations. Chiefly among these, AlleleHMM will provide the most significant benefit for functional assays where marks are spread broadly across the genome, rather than focused within specific functional regions. This provides the broadest benefit for assays such as GRO-seq, RNA-seq, and several of the broadly distributed ChIP-seq marks. AlleleHMM may provide less benefit for assays such as 3&#x02032; mRNA-seq or chromatin accessibility assays (e.g., ATAC-seq or DNase-I-seq), where signals are distributed within a specific position of the genome. Nevertheless, AlleleHMM will still work under these settings, and may still provide a substantial benefit for detecting expression differences that span multiple genes or chromatin accessible regions.</p><p>Using AlleleHMM, we have identified thousands of regions harboring allele specific differences in human GM12878 and murine ESCs. We have found that allelic differences tend to occur over large genomic regions that harbor multiple transcription units, often sharing the same gene annotation. This finding is reminiscent of the shared architecture of quantitative trait loci (QTLs) across broad genomic regions (<xref rid="B22" ref-type="bibr">22</xref>). This finding may also reflect similar regulatory principles as the positionally dependent variation in gene expression across distinct biological replicates (<xref rid="B23" ref-type="bibr">23</xref>). Altogether, the use of AlleleHMM provides a novel tool that will be useful to rigorously examine how homologous DNA sequences in the nucleus differ in the distribution of functional genomic marks. We are confident that future studies will use this tool to unravel multiple aspects of genome function and organization.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="sup1"><label>gkz176_Supplemental_File</label><media xlink:href="gkz176_supplemental_file.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ack id="ACK1"><title>ACKNOWLEDGEMENTS</title><p>We thank members of the Danko laboratory for valuable discussions. Work in this publication was supported by an NHGRI (National Human Genome Research Institute) grant R01-HG009309 and a Cornell Research Grants program in Animal Health to C.G.D. The content is solely the responsibility of the authors and does not necessarily represent the official views of the U.S. National Institutes of Health.</p><p>
<italic>Authors&#x02019; contributions</italic>: SC wrote software and analyzed the data. SC and CGD conceived of AlleleHMM and wrote the paper.</p></ack><sec id="SEC5"><title>SUPPLEMENTARY DATA</title><p>
<ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkz176#supplementary-data">Supplementary Data</ext-link> are available at NAR Online.</p></sec><sec id="SEC6"><title>FUNDING</title><p>NHGRI (National Human Genome Research Institute) [R01-HG009309 to C.G.D.]. Funding for open access charge:&#x000a0;NIH [R01]&#x000a0;and the Cornell University open access fund.</p><p>
<italic>Conflict of interest statement</italic>. None declared.</p></sec><ref-list id="REF1"><title>REFERENCES</title><ref id="B1"><label>1.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Fuda</surname><given-names>N.J.</given-names></name>, <name name-style="western"><surname>Ardehali</surname><given-names>M.B.</given-names></name>, <name name-style="western"><surname>Lis</surname><given-names>J.T.</given-names></name></person-group>
<article-title>Defining mechanisms that regulate RNA polymerase II transcription in vivo</article-title>. <source>Nature</source>. <year>2009</year>; <volume>461</volume>:<fpage>186</fpage>&#x02013;<lpage>192</lpage>.<pub-id pub-id-type="pmid">19741698</pub-id></mixed-citation></ref><ref id="B2"><label>2.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Corbett</surname><given-names>A.H.</given-names></name></person-group>
<article-title>Post-transcriptional regulation of gene expression and human disease</article-title>. <source>Curr. Opin. Cell Biol.</source><year>2018</year>; <volume>52</volume>:<fpage>96</fpage>&#x02013;<lpage>104</lpage>.<pub-id pub-id-type="pmid">29518673</pub-id></mixed-citation></ref><ref id="B3"><label>3.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Castel</surname><given-names>S.E.</given-names></name>, <name name-style="western"><surname>Levy-Moonshine</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Mohammadi</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Banks</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Lappalainen</surname><given-names>T.</given-names></name></person-group>
<article-title>Tools and best practices for data processing in allelic expression analysis</article-title>. <source>Genome Biol.</source><year>2015</year>; <volume>16</volume>:<fpage>195</fpage>.<pub-id pub-id-type="pmid">26381377</pub-id></mixed-citation></ref><ref id="B4"><label>4.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Rozowsky</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Abyzov</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Alves</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Raha</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Harmanci</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Leng</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Bjornson</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Kong</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Kitabayashi</surname><given-names>N.</given-names></name><etal>et al</etal>.</person-group>
<article-title>AlleleSeq: analysis of allele-specific expression and binding in a network framework</article-title>. <source>Mol. Syst. Biol.</source><year>2011</year>; <volume>7</volume>:<fpage>522</fpage>.<pub-id pub-id-type="pmid">21811232</pub-id></mixed-citation></ref><ref id="B5"><label>5.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Rozowsky</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Galeev</surname><given-names>T.R.</given-names></name>, <name name-style="western"><surname>Harmanci</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Kitchen</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Bedford</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Abyzov</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Kong</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Regan</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Gerstein</surname><given-names>M.</given-names></name></person-group>
<article-title>A uniform survey of allele-specific binding and expression over 1000-Genomes-Project individuals</article-title>. <source>Nat. Commun.</source><year>2016</year>; <volume>7</volume>:<fpage>11101</fpage>.<pub-id pub-id-type="pmid">27089393</pub-id></mixed-citation></ref><ref id="B6"><label>6.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Crowley</surname><given-names>J.J.</given-names></name>, <name name-style="western"><surname>Zhabotynsky</surname><given-names>V.</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Huang</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Pakatci</surname><given-names>I.K.</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>J.R.</given-names></name>, <name name-style="western"><surname>Morgan</surname><given-names>A.P.</given-names></name>, <name name-style="western"><surname>Calaway</surname><given-names>J.D.</given-names></name>, <name name-style="western"><surname>Aylor</surname><given-names>D.L.</given-names></name><etal>et al</etal>.</person-group>
<article-title>Analyses of allele-specific gene expression in highly divergent mouse crosses identifies pervasive allelic imbalance</article-title>. <source>Nat. Genet.</source><year>2015</year>; <volume>47</volume>:<fpage>353</fpage>&#x02013;<lpage>360</lpage>.<pub-id pub-id-type="pmid">25730764</pub-id></mixed-citation></ref><ref id="B7"><label>7.</label><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Durbin</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Eddy</surname><given-names>S.R.</given-names></name>, <name name-style="western"><surname>Krogh</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Mitchison</surname><given-names>G.</given-names></name></person-group>
<source>Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids</source>. <year>1998</year>; <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation></ref><ref id="B8"><label>8.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Baum</surname><given-names>L.E.</given-names></name></person-group>
<article-title>An inequality and associated maximization technique in statistical estimation of probabilistic functions of a Markov process</article-title>. <source>Inequalities</source>. <year>1972</year>; <volume>3</volume>:<fpage>1</fpage>&#x02013;<lpage>8</lpage>.</mixed-citation></ref><ref id="B9"><label>9.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Viterbi</surname><given-names>A.</given-names></name></person-group>
<article-title>Error bounds for convolutional codes and an asymptotically optimum decoding algorithm</article-title>. <source>IEEE Trans. Inf. Theory</source>. <year>1967</year>; <volume>13</volume>:<fpage>260</fpage>&#x02013;<lpage>269</lpage>.</mixed-citation></ref><ref id="B10"><label>10.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Danko</surname><given-names>C.G.</given-names></name>, <name name-style="western"><surname>Hyland</surname><given-names>S.L.</given-names></name>, <name name-style="western"><surname>Core</surname><given-names>L.J.</given-names></name>, <name name-style="western"><surname>Martins</surname><given-names>A.L.</given-names></name>, <name name-style="western"><surname>Waters</surname><given-names>C.T.</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>H.W.</given-names></name>, <name name-style="western"><surname>Cheung</surname><given-names>V.G.</given-names></name>, <name name-style="western"><surname>Kraus</surname><given-names>W.L.</given-names></name>, <name name-style="western"><surname>Lis</surname><given-names>J.T.</given-names></name>, <name name-style="western"><surname>Siepel</surname><given-names>A.</given-names></name></person-group>
<article-title>Identification of active transcriptional regulatory elements from GRO-seq data</article-title>. <source>Nat. Methods</source>. <year>2015</year>; <volume>12</volume>:<fpage>433</fpage>&#x02013;<lpage>438</lpage>.<pub-id pub-id-type="pmid">25799441</pub-id></mixed-citation></ref><ref id="B11"><label>11.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>Chu</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Choate</surname><given-names>L.A.</given-names></name>, <name name-style="western"><surname>Danko</surname><given-names>C.G.</given-names></name></person-group>
<article-title>Identification of regulatory elements from nascent transcription using dREG</article-title>. <source>Genome Res.</source><year>2018</year>; <comment>doi:10.1101/gr.238279.118</comment>.</mixed-citation></ref><ref id="B12"><label>12.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Langmead</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Trapnell</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Pop</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group>
<article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome Biol.</source><year>2009</year>; <volume>10</volume>:<fpage>R25</fpage>.<pub-id pub-id-type="pmid">19261174</pub-id></mixed-citation></ref><ref id="B13"><label>13.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Casper</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Zweig</surname><given-names>A.S.</given-names></name>, <name name-style="western"><surname>Villarreal</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Tyner</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Speir</surname><given-names>M.L.</given-names></name>, <name name-style="western"><surname>Rosenbloom</surname><given-names>K.R.</given-names></name>, <name name-style="western"><surname>Raney</surname><given-names>B.J.</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>C.M.</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>B.T.</given-names></name>, <name name-style="western"><surname>Karolchik</surname><given-names>D.</given-names></name><etal>et al</etal>.</person-group>
<article-title>The UCSC Genome Browser database: 2018 update</article-title>. <source>Nucleic. Acids. Res.</source><year>2018</year>; <volume>46</volume>:<fpage>D762</fpage>&#x02013;<lpage>D769</lpage>.<pub-id pub-id-type="pmid">29106570</pub-id></mixed-citation></ref><ref id="B14"><label>14.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Quinlan</surname><given-names>A.R.</given-names></name>, <name name-style="western"><surname>Hall</surname><given-names>I.M.</given-names></name></person-group>
<article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>. <source>Bioinformatics</source>. <year>2010</year>; <volume>26</volume>:<fpage>841</fpage>&#x02013;<lpage>842</lpage>.<pub-id pub-id-type="pmid">20110278</pub-id></mixed-citation></ref><ref id="B15"><label>15.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Benjamini</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Hochberg</surname><given-names>Y.</given-names></name></person-group>
<article-title>Controlling the False discovery rate: A Practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc. Series B Stat. Methodol.</source><year>1995</year>; <volume>57</volume>:<fpage>289</fpage>&#x02013;<lpage>300</lpage>.</mixed-citation></ref><ref id="B16"><label>16.</label><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Yee</surname><given-names>T.W.</given-names></name></person-group>
<source>Vector Generalized Linear and Additive Models: With an Implementation in R</source>. <year>2015</year>; <publisher-loc>NY</publisher-loc><publisher-name>Springer-Verlag</publisher-name>.</mixed-citation></ref><ref id="B17"><label>17.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Kwak</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Fuda</surname><given-names>N.J.</given-names></name>, <name name-style="western"><surname>Core</surname><given-names>L.J.</given-names></name>, <name name-style="western"><surname>Lis</surname><given-names>J.T.</given-names></name></person-group>
<article-title>Precise maps of RNA polymerase reveal how promoters direct initiation and pausing</article-title>. <source>Science</source>. <year>2013</year>; <volume>339</volume>:<fpage>950</fpage>&#x02013;<lpage>953</lpage>.<pub-id pub-id-type="pmid">23430654</pub-id></mixed-citation></ref><ref id="B18"><label>18.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Core</surname><given-names>L.J.</given-names></name>, <name name-style="western"><surname>Martins</surname><given-names>A.L.</given-names></name>, <name name-style="western"><surname>Danko</surname><given-names>C.G.</given-names></name>, <name name-style="western"><surname>Waters</surname><given-names>C.T.</given-names></name>, <name name-style="western"><surname>Siepel</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Lis</surname><given-names>J.T.</given-names></name></person-group>
<article-title>Analysis of nascent RNA identifies a unified architecture of initiation regions at mammalian promoters and enhancers</article-title>. <source>Nat. Genet.</source><year>2014</year>; <volume>46</volume>:<fpage>1311</fpage>&#x02013;<lpage>1320</lpage>.<pub-id pub-id-type="pmid">25383968</pub-id></mixed-citation></ref><ref id="B19"><label>19.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Engreitz</surname><given-names>J.M.</given-names></name>, <name name-style="western"><surname>Haines</surname><given-names>J.E.</given-names></name>, <name name-style="western"><surname>Perez</surname><given-names>E.M.</given-names></name>, <name name-style="western"><surname>Munson</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Kane</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>McDonel</surname><given-names>P.E.</given-names></name>, <name name-style="western"><surname>Guttman</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Lander</surname><given-names>E.S.</given-names></name></person-group>
<article-title>Local regulation of gene expression by lncRNA promoters, transcription and splicing</article-title>. <source>Nature</source>. <year>2016</year>; <volume>539</volume>:<fpage>452</fpage>&#x02013;<lpage>455</lpage>.<pub-id pub-id-type="pmid">27783602</pub-id></mixed-citation></ref><ref id="B20"><label>20.</label><mixed-citation publication-type="journal">
<collab>ENCODE Project Consortium</collab>
<article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>. <year>2012</year>; <volume>489</volume>:<fpage>57</fpage>&#x02013;<lpage>74</lpage>.<pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation></ref><ref id="B21"><label>21.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Sloan</surname><given-names>C.A.</given-names></name>, <name name-style="western"><surname>Chan</surname><given-names>E.T.</given-names></name>, <name name-style="western"><surname>Davidson</surname><given-names>J.M.</given-names></name>, <name name-style="western"><surname>Malladi</surname><given-names>V.S.</given-names></name>, <name name-style="western"><surname>Strattan</surname><given-names>J.S.</given-names></name>, <name name-style="western"><surname>Hitz</surname><given-names>B.C.</given-names></name>, <name name-style="western"><surname>Gabdank</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Narayanan</surname><given-names>A.K.</given-names></name>, <name name-style="western"><surname>Ho</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>B.T.</given-names></name><etal>et al</etal>.</person-group>
<article-title>ENCODE data at the ENCODE portal</article-title>. <source>Nucleic Acids Res.</source><year>2016</year>; <volume>44</volume>:<fpage>D726</fpage>&#x02013;<lpage>D732</lpage>.<pub-id pub-id-type="pmid">26527727</pub-id></mixed-citation></ref><ref id="B22"><label>22.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Waszak</surname><given-names>S.M.</given-names></name>, <name name-style="western"><surname>Delaneau</surname><given-names>O.</given-names></name>, <name name-style="western"><surname>Gschwind</surname><given-names>A.R.</given-names></name>, <name name-style="western"><surname>Kilpinen</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Raghav</surname><given-names>S.K.</given-names></name>, <name name-style="western"><surname>Witwicki</surname><given-names>R.M.</given-names></name>, <name name-style="western"><surname>Orioli</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Wiederkehr</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Panousis</surname><given-names>N.I.</given-names></name>, <name name-style="western"><surname>Yurovsky</surname><given-names>A.</given-names></name><etal>et al</etal>.</person-group>
<article-title>Population variation and genetic control of modular chromatin architecture in humans</article-title>. <source>Cell</source>. <year>2015</year>; <volume>162</volume>:<fpage>1039</fpage>&#x02013;<lpage>1050</lpage>.<pub-id pub-id-type="pmid">26300124</pub-id></mixed-citation></ref><ref id="B23"><label>23.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Rennie</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Dalby</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>van&#x000a0;Duin</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Andersson</surname><given-names>R.</given-names></name></person-group>
<article-title>Transcriptional decomposition reveals active chromatin architectures and cell specific regulatory interactions</article-title>. <source>Nat. Commun.</source><year>2018</year>; <volume>9</volume>:<fpage>487</fpage>.<pub-id pub-id-type="pmid">29402885</pub-id></mixed-citation></ref></ref-list></back></article>