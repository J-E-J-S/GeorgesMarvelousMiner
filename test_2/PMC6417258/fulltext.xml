<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id><journal-title-group><journal-title>BMC Genomics</journal-title></journal-title-group><issn pub-type="epub">1471-2164</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6417258</article-id><article-id pub-id-type="publisher-id">5556</article-id><article-id pub-id-type="doi">10.1186/s12864-019-5556-x</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology Article</subject></subj-group></article-categories><title-group><article-title>Linear models enable powerful differential activity analysis in massively parallel reporter assays</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Myint</surname><given-names>Leslie</given-names></name><address><email>lmyint@macalester.edu</email></address><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name><surname>Avramopoulos</surname><given-names>Dimitrios G.</given-names></name><address><email>adimitr1@jhmi.edu</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Goff</surname><given-names>Loyal A.</given-names></name><address><email>loyalgoff@jhmi.edu</email></address><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0086-0687</contrib-id><name><surname>Hansen</surname><given-names>Kasper D.</given-names></name><address><email>khansen@jhsph.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Department of Biostatistics, Johns Hopkins Bloomberg School of Public Health, </institution></institution-wrap>615 N. Wolfe St, E3527, Baltimore, MD 21212 USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>McKusick-Nathans Institute of Genetic Medicine, Johns Hopkins School of Medicine, </institution></institution-wrap>Baltimore, USA </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Department of Neuroscience, Johns Hopkins School of Medicine, </institution></institution-wrap>Baltimore, USA </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1551 4707</institution-id><institution-id institution-id-type="GRID">grid.259382.7</institution-id><institution>Department of Mathematics, Statistics, and Computer Science, Macalester College, </institution></institution-wrap>1600 Grand Ave, Saint Paul, MN 55105 USA </aff></contrib-group><pub-date pub-type="epub"><day>12</day><month>3</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>12</day><month>3</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>20</volume><elocation-id>209</elocation-id><history><date date-type="received"><day>30</day><month>11</month><year>2018</year></date><date date-type="accepted"><day>22</day><month>2</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is distributed under the terms of theCreative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p>Massively parallel reporter assays (MPRAs) have emerged as a popular means for understanding noncoding variation in a variety of conditions. While a large number of experiments have been described in the literature, analysis typically uses ad-hoc methods. There has been little attention to comparing performance of methods across datasets.</p></sec><sec><title>Results</title><p>We present the mpralm method which we show is calibrated and powerful, by analyzing its performance on multiple MPRA datasets. We show that it outperforms existing statistical methods for analysis of this data type, in the first comprehensive evaluation of statistical methods on several datasets. We investigate theoretical and real-data properties of barcode summarization methods and show an unappreciated impact of summarization method for some datasets. Finally, we use our model to conduct a power analysis for this assay and show substantial improvements in power by performing up to 6 replicates per condition, whereas sequencing depth has smaller impact; we recommend to always use at least 4 replicates. An R package is available from the Bioconductor project.</p></sec><sec><title>Conclusions</title><p>Together, these results inform recommendations for differential analysis, general group comparisons, and power analysis and will help improve design and analysis of MPRA experiments.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Massively parallel reporter assays</kwd><kwd>Statistics</kwd><kwd>Enhancer</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>R01GM121459</award-id></award-group></funding-group><funding-group><award-group><funding-source><institution>National Cancer Institute (US)</institution></funding-source><award-id>U24CA180996</award-id></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p>Noncoding regions in the human genome represent the overwhelming majority of genomic sequence, but their function remains largely uncharacterized. Better understanding of the functional consequences of these regions has the potential to greatly enrich our understanding of biology. It is well understood that some noncoding regions are regulatory in nature. It has been straightforward to experimentally test the regulatory ability of a given DNA sequence with standard reporter assays, but these assays are low throughout and do not scale to the testing of large numbers of sequences. Massively parallel reporter assays (MPRAs) have emerged as a high-throughput means of measuring the ability of sequences to drive expression [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. These assays build on the traditional reporter assay framework by coupling each putative regulatory sequence with several short DNA tags, or barcodes, that are incorporated into the RNA output. These tags are counted in the RNA reads and the input DNA, and the resulting counts are used to quantify the activity of a given putative regulatory sequence, typically involving the ratio of RNA counts to DNA counts (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). The applications of MPRA have been diverse, and there have been correspondingly diverse and ad hoc methods used in statistical analysis.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Structure of MPRA data. Thousands of putative regulatory elements can be assayed at a time in an MPRA experiment. Each element is linked to multiple barcodes. A plasmid library containing these barcoded elements is transfected into several cell populations (samples). Cellular DNA and RNA can be isolated and sequenced. The barcodes associated with each putative regulatory element can be counted to obtain relative abundances of each element in DNA and RNA. The process of aggregation sums counts over barcodes for element in each sample. Aggregation is one method for summarizing barcode level data into element level data</p></caption><graphic xlink:href="12864_2019_5556_Fig1_HTML" id="MO1"/></fig></p><p>There are three broad categories of MPRA applications: (1) characterization studies, (2) saturation mutagenesis, and (3) differential analysis. (1) Characterization studies examine thousands of different putative regulatory elements that have a wide variety of sequence features and try to correlate these sequence features with measured activity levels [<xref ref-type="bibr" rid="CR3">3</xref>&#x02013;<xref ref-type="bibr" rid="CR10">10</xref>]. Typical statistical analyses use regression to study the impact of multiple features simultaneously. They also compare continuous activity measures or categorized (high/low) activity measures across groups using paired and unpaired t-, rank, Fisher&#x02019;s exact, and chi-squared tests. (2) Saturation mutagenesis studies look at only a few established enhancers and examine the impact on activity of every possible mutation at each base as well as interactions between these mutations [<xref ref-type="bibr" rid="CR11">11</xref>&#x02013;<xref ref-type="bibr" rid="CR17">17</xref>]. Analyses have uniformly used linear regression where each position in the enhancer sequence is a predictor. (3) Differential analysis studies look at thousands of different elements, each of which has two or more versions. Versions can correspond to allelic versions of a sequence [<xref ref-type="bibr" rid="CR18">18</xref>&#x02013;<xref ref-type="bibr" rid="CR20">20</xref>] or different environmental contexts [<xref ref-type="bibr" rid="CR21">21</xref>], such as different cell or tissue types [<xref ref-type="bibr" rid="CR22">22</xref>]. These studies have compared different sequence versions using paired t-tests, rank sum tests, and Fisher&#x02019;s exact test (FET) (by pooling counts over biological replicates).</p><p>Despite the increasing popularity of this assay, guiding principles for statistical analysis have not been put forth. Researchers use a large variety of ad hoc methods for analysis. For example, there has been considerable diversity in the earlier stages of summarization of information over barcodes. Barcodes are viewed as technical replicates of the regulatory element sequences, and groups have considered numerous methods for summarizing barcode-level information into one activity measure per enhancer. On top of this, a large variety of statistical tests are used to make comparisons.</p><p>Recently, a method called QuASAR-MPRA was developed to identify regulatory sequences that have allele-specific activity [<xref ref-type="bibr" rid="CR23">23</xref>]. This method uses a beta-binomial model to model RNA counts as a function of DNA counts, and it provides a means for identifying sequences that show a significant difference in regulatory activity between two alleles. While it provides a framework for two group differential analysis within MPRAs, QuASAR-MPRA is limited in this regard because experiments might have several conditions and involve arbitrary comparisons.</p><p>To our knowledge, no method has been developed that provides tools for general purpose differential analysis of activity measures from MPRA. General purpose methods are ones that can flexibly analyze data from a range of study designs. We present mpralm, a method for testing for differential activity in MPRA experiments. Our method uses linear models as opposed to count-based models to identify differential activity. This approach provides desired analytic flexibility for more complicated experimental designs that necessitate more complex models. It also builds on an established method that has a solid theoretical and computational framework [<xref ref-type="bibr" rid="CR24">24</xref>]. We show that mpralm can be applied to a wide variety of MPRA datasets and has good statistical properties related to type I error control and power. Furthermore, we examine proper techniques for combining information over barcodes and provide guidelines for choosing sample sizes and sequencing depth when considering power. Our method is open source and freely available in the <italic>mpra</italic> package for R on the Bioconductor repository [<xref ref-type="bibr" rid="CR25">25</xref>].</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><sec id="Sec3"><title>The structure of MPRA data and experiments</title><p>MPRA data consists of measuring the activity of some putative regulatory sequences, henceforth referred to as &#x0201c;elements&#x0201d;. First a plasmid library of oligos is constructed, where each element is coupled with a number of short DNA tags, or barcodes. This plasmid library is then transfected into one or more cellular contexts, either as free-floating plasmids or integrated into the genome [<xref ref-type="bibr" rid="CR21">21</xref>]. Next, RNA output is measured using RNA sequencing, and DNA output as a proxy for element copy number is measured using DNA sequencing (occasionally, element copy number is unmeasured), giving the data structure shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>. The log-ratio of RNA to DNA counts is commonly used as an activity outcome measure.</p><p>Since each element is measured across a number of barcodes, it is useful to summarize this data into a single activity measure <italic>a</italic> for a single element in a single sample. Multiple approaches have been proposed for this summarization step. We consider two approaches. First is averaging, where a log-ratio is computed for each barcode, then averaged across barcodes. This treats the different barcodes as technical replicates. The second approach is aggregation, where RNA and DNA counts are each summed across barcodes, followed by formation of a log-ratio. This approach effectively uses the barcodes to simply increase the sequencing counts for that element.</p><p>In our investigation of the characteristics of MPRA data we use a number of datasets listed in Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>. We have divided them into 3 categories. Two categories are focused on differential analysis: one on comparing different alleles and one on comparing the same element in different conditions (retina vs. cortex and episomal vs. chromosomal integration). The two allelic studies naturally involve paired comparisons in that the two elements being compared are always measured together in a single sample (which is replicated). We also use two saturation mutagenesis experiments.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">Description</th><th align="left">Cell culture</th><th align="left">Replicates</th><th align="left">Barcodes</th></tr></thead><tbody><tr><td align="left" colspan="2">Differential analysis: alleles</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">Tewhey</td><td align="left">Study of 39,479 oligos coming from 29,173 variants</td><td align="left">NA12878 (LCL)</td><td align="left">NA12878: 5</td><td align="left">79k pool: &#x0223c;73</td></tr><tr><td align="left"/><td align="left">to follow up on prior eQTL results.</td><td align="left">NA19239 (LCL)</td><td align="left">NA19239: 3</td><td align="left">7.5k pool: &#x0223c;350</td></tr><tr><td align="left"/><td align="left">Large initial oligo pool: 79k. Second pool: 7.5k.</td><td align="left">HepG2</td><td align="left">HepG2: 5</td><td align="left"/></tr><tr><td align="left">Ulirsch</td><td align="left">Study of 2756 variants in strong LD with 75 main</td><td align="left">K562, K562 with</td><td align="left">K562: 6</td><td align="left">14</td></tr><tr><td align="left"/><td align="left">variants to identify loci that affect RBC traits.</td><td align="left">GATA1 over-expr.</td><td align="left">K562+GATA1: 4</td><td align="left"/></tr><tr><td align="left" colspan="2">Differential analysis: conditions</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">Inoue</td><td align="left">Comparison of episomal and lentiviral MPRA.</td><td align="left">HepG2</td><td align="left">3</td><td align="left">Max: 99</td></tr><tr><td align="left">Shen</td><td align="left">Study of tissue specificity of cis-regulatory</td><td align="left">Mouse retina and</td><td align="left">3</td><td align="left">&#x0223c;8</td></tr><tr><td align="left"/><td align="left">element in-vivo in mouse.</td><td align="left">cerebral cortex</td><td align="left"/><td align="left"/></tr><tr><td align="left" colspan="2">Saturation mutagenesis</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">Melnikov</td><td align="left">Two inducible enhancers:</td><td align="left">HEK293T</td><td align="left">Single: 2</td><td align="left">Single: 13</td></tr><tr><td align="left"/><td align="left">(1) a synthetic cAMP-regulated enhancer and</td><td align="left"/><td align="left">Multi: 2</td><td align="left">Multi: 1</td></tr><tr><td align="left"/><td align="left">(2) the virus-inducible interferon-beta enhancer.</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"/><td align="left">Single-hit scanning alters one base at a time.</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"/><td align="left">Multi-hit sampling alters several bases at a time.</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">Kheradpour</td><td align="left">Study of 2104 wild-type sequences and 3314 variant</td><td align="left">K562</td><td align="left">2</td><td align="left">10</td></tr><tr><td align="left"/><td align="left">sequences containing targeted motif disruptions to</td><td align="left">HepG2</td><td align="left"/><td align="left"/></tr><tr><td align="left"/><td align="left">understand base-level effects in motifs.</td><td align="left"/><td align="left"/><td align="left"/></tr></tbody></table><table-wrap-foot><p>All datasets are publicly available, see the relevant publication</p></table-wrap-foot></table-wrap></p></sec><sec id="Sec4"><title>The variability of MPRA data depends on element copy number</title><p>It is well established that count data from RNA sequencing studies exhibit a mean-variance relationship [<xref ref-type="bibr" rid="CR26">26</xref>]. On the log scale, low counts are more variable across replicates than high counts, at least partly due to inherent Poisson variation in the sequencing process [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. This relationship has been leveraged in both count-based analysis methods [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>] and, more recently, linear model-based methods [<xref ref-type="bibr" rid="CR24">24</xref>]. For count-based methods, this mean-variance relationship helps improve dispersion estimates, and for linear model-based methods, the relationship allows for estimation of weights reflecting inherent differences in variability for count observations in different samples and genes.</p><p>Because MPRAs are fundamentally sequencing assays, it is useful to know whether similar variance relationships hold in these experiments. Due to the construction of MPRA libraries, each element is present in a different (random) copy number, and this copy number ought to impact both background and signal measurements from the element. We are therefore specifically interested in the functional relationship between element copy number and the variability of the activity outcome measure. As outcome measure we use the log-ratio of RNA counts to DNA counts (aggregate estimator), and we use aggregated DNA counts, averaged across samples, as an estimate of DNA copy number. We compute empirical standard deviations of the library size-corrected outcome measure across samples. In Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> we depict this relationship across the previously discussed publicly available datasets (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>). For all datasets, with one exception, there is higher variation associated with lower copy number. The functional form is reminiscent of the mean-variance relationship in RNA sequencing data [<xref ref-type="bibr" rid="CR24">24</xref>], despite that we here show variance of a log-ratio of sequencing counts.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Variability of MPRA activity measures depends on element copy number. For multiple publicly available datasets we compute activity measures of putative regulatory element as the log2 ratio of aggregated RNA counts over aggregated DNA counts. Each panel shows the relationship between variability (across samples) of these activity measures and the average log2 DNA levels (across samples). Smoothed relationships are lowess curves representing the local average variability. The last plot shows all lowess curves on the same figure</p></caption><graphic xlink:href="12864_2019_5556_Fig2_HTML" id="MO2"/></fig></p></sec><sec id="Sec5"><title>Statistical modeling of MPRA data</title><p>To model MPRA data we propose to use a simple variant of the voom methodology [<xref ref-type="bibr" rid="CR24">24</xref>], proposed for analysis of RNA sequencing data. This methodology is based on standard linear models, which are coupled with inverse variance weights representing the mean-variance relationship inherent in RNA sequencing data. The weights are derived from smoothing an empirical mean-variance plot. Similar to voom, we propose to use linear models to model log-ratio activity data from MPRAs, but we estimate weights by smoothing the relationship between empirical variance of the log-ratios and log-DNA copy number, as depicted in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>. We call this approach mpralm.</p><p>The current literature on analysis of MPRA experiments contains many variant methods (see Introduction). To evaluate mpralm, we compare the method to the following variants used in the literature: QuASAR-MPRA, t-tests, and Fisher&#x02019;s exact test (FET). QuASAR-MPRA is a recently developed method that is targeted for the differential analysis of MPRA data [<xref ref-type="bibr" rid="CR23">23</xref>]. It specifically addresses a two group differential analysis where the two groups are elements with two alleles and uses base-calling error rate in the model formulation. It collapses count information across samples to create three pieces of information for each element: one count for RNA reads for the reference allele, one count for RNA reads for the alternate allele, and one proportion that gives the fraction of DNA reads corresponding to the reference allele. Fisher&#x02019;s exact test similarly collapses count information across samples. To test for differential activity, a 2-by-G table is formed with RNA and DNA designation forming one dimension and condition designation (with <italic>G</italic> groups) in the second dimension. The t-test operates on the log-ratio outcomes directly; we use the aggregate estimator to summarize over barcodes. Either a paired or unpaired t-test is used based on experimental design.</p><p>Both edgeR and DESeq2 are popular methods for analysis of RNA-sequencing data represented as counts. The two methods are both built on negative binomial models, and both attempt to borrow information across genes. These methods allow for the inclusion of an offset. Because both methods use a logarithmic link function, including log-DNA as an offset allows for the modeling of log-ratios of RNA to DNA. This makes these methods readily applicable to the analysis of MPRA data, and they carry many of the same advantages as mpralm. In addition to QuASAR, t-tests, and Fisher&#x02019;s exact test, we examine the performance of edgeR and DESeq2 for differential activity analysis in our evaluations. We point out that although our application of edgeR and DESeq2 to MPRA data is straightforward, it has not been used in this way so far in the literature. Tewhey et al. [<xref ref-type="bibr" rid="CR19">19</xref>] uses DESeq2 to perform differential expression analysis of RNA counts relative to DNA counts within a single condition. This assesses whether the regulatory elements have activating or repressive activity, but it does not assess whether the activity of regulatory elements differs between conditions. We remind the community of the ability to use offsets in the edgeR and DESeq2 negative binomial models, and explore a new use of these models for MPRA data.</p></sec><sec id="Sec6"><title>mpralm is a powerful method for differential analysis</title><p>First, we focus on evaluating the performance of mpralm for differential analysis. We compare to QuASAR-MPRA, t-tests, Fisher&#x02019;s exact test, edgeR, and DESeq2. We use four of the previously discussed studies, specifically the Tewhey, Inoue, Ulirsch, and Shen studies. Two of these studies (Tewhey, Ulirsch) focus on comparing the activity of elements with two alleles, whereas the other two (Inoue, Shen) compare the activity of each element in two different conditions. For the allelic studies, we use a random effects model for mpralm and paired t-tests. In the random effects model, we estimate the correlation between the multiple alleles for a given single nucleotide polymorphism (SNP). This correlation estimate improves the estimation of element-wise variances used in testing for differences between conditions. Both Tewhey et al. [<xref ref-type="bibr" rid="CR19">19</xref>] and Ulirsch et al. [<xref ref-type="bibr" rid="CR18">18</xref>] compare alleles in different cellular contexts; we observe similar behavior of all evaluations in all contexts (data not shown) and have therefore chosen to depict results from one cellular context for both of these studies. For the Tewhey dataset we depict results both from a large pool of elements used for initial screening and a smaller, targeted pool.</p><p>Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> shows <italic>p</italic>-value distributions that result from running all methods on the 5 real datasets. Across these datasets, all methods except for QuASAR show a well-behaved <italic>p</italic>-value distribution; high <italic>p</italic>-values appear uniformly distributed, and there is a peak at low <italic>p</italic>-values. QuASAR-MPRA consistently shows conservative <italic>p</italic>-value distributions. This feature of the <italic>p</italic>-value distributions is not apparent from the QQ-plots (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>, first row) that the authors use to evaluate their method [<xref ref-type="bibr" rid="CR23">23</xref>]. Fisher&#x02019;s exact test has a very high peak around zero, likely due to the extreme sensitivity of the test with high counts. We examine mpralm using both an average estimator and an aggregation estimator for summarizing across barcodes; this cannot be done for the Tewhey dataset where we do not have access to barcode-level data. To fully interpret these <italic>p</italic>-value distributions, we need to assess error rates. For example, the large number of rejections achieved using Fisher&#x02019;s exact test may be associated with a large number of errors.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison of detection rates and <italic>p</italic>-value calibration over datasets. (<bold>a</bold>) QQ-plots (row 1), and (<bold>b</bold>) density plots (rows 2 and 3) for <italic>p</italic>-values for all datasets, including a zoom of the [0,0.1] interval for some datasets (row 3). Over all datasets, most methods show <italic>p</italic>-values that closely follow the classic mixture of uniformly distributed <italic>p</italic>-values with an enrichment of low <italic>p</italic>-values for differential elements. For the datasets which had barcode level counts (Inoue, Ulirsch, and Shen), we used two types of estimators of the activity measure (log-ratio of RNA/DNA) with mpralm, shown in light and dark blue</p></caption><graphic xlink:href="12864_2019_5556_Fig3_HTML" id="MO3"/></fig></p><p>To estimate empirical dataset-specific type I error rates, we simulated count data that gave rise to null comparisons for each regulatory element (Methods). With all comparisons being null, we estimate the dataset-dependent type I error rate for each method as the fraction of rejected null hypotheses at a given nominal level. Figure&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> shows these estimated error rates (based on simulated data). We observe that Fisher&#x02019;s exact test has wildly inflated type I error, presumably because MPRA count data are overdispersed and because exact tests for large count data can be very sensitive. The other methods are much closer to being calibrated, although there is some variability from dataset to dataset. Generally, QuASAR-MPRA seems to be slightly liberal across datasets. The t-test is close to consistently calibrated. DESeq2 and edgeR are the most variable in their calibration; in particular, they are fairly conservative for the Ulirsch dataset and liberal for the Shen dataset. mpralm falls between the t-test and edgeR/DESeq2 for calibration. For high throughput assays, there is also interest in type I error rate calibration at very low nominal levels (e.g. Bonferroni-adjusted levels). In Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>, we show estimated error rates for very low nominal error rates (roughly corresponding to <italic>&#x003b1;</italic>=0.05/3000,0.05/5000,0.05/7000,0.05/9000). We see that at these stringent levels typical of multiple testing situations in these assays, mpralm with the aggregate estimator and the t-test tend to not make any errors.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Empirical type I error rates. Type I error rates were estimated for all methods with simulated null data (Methods). For the datasets which had barcode level counts (Inoue, Ulirsch, and Shen), we used two types of estimators of the activity measure (aggregate and average estimator) with mpralm, shown in dark and light blue</p></caption><graphic xlink:href="12864_2019_5556_Fig4_HTML" id="MO4"/></fig>
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Observed type I error rates for low nominal error rates</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Nominal</th><th align="left">edgeR</th><th align="left">DESeq2</th><th align="left">QuASAR</th><th align="left">mpralm</th><th align="left">mpralm</th><th align="left">FET</th><th align="left">t-test</th></tr><tr><th align="left">error rate</th><th align="left"/><th align="left"/><th align="left"/><th align="left">(agg)</th><th align="left">(avg)</th><th align="left"/><th align="left"/></tr></thead><tbody><tr><td align="left" colspan="3">Tewhey - large</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">1.62e-05</td><td align="left">8.21e-04</td><td align="left">8.22e-04</td><td align="left">1.97e-03</td><td align="left">1.64e-04</td><td align="left">NA</td><td align="left">2.82e-01</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(5/6088)</td><td align="left">(5/6084)</td><td align="left">(12/6088)</td><td align="left">(1/6088)</td><td align="left"/><td align="left">(1718/6088)</td><td align="left">(0/6088)</td></tr><tr><td align="left">1.03e-05</td><td align="left">6.57e-04</td><td align="left">8.22e-04</td><td align="left">1.64e-03</td><td align="left">0</td><td align="left">NA</td><td align="left">2.73e-01</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(4/6088)</td><td align="left">(5/6084)</td><td align="left">(10/6088)</td><td align="left">(0/6088)</td><td align="left"/><td align="left">(1663/6088)</td><td align="left">(0/6088)</td></tr><tr><td align="left">7.25e-06</td><td align="left">4.93e-04</td><td align="left">8.22e-04</td><td align="left">1.64e-03</td><td align="left">0</td><td align="left">NA</td><td align="left">2.66e-01</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(3/6088)</td><td align="left">(5/6084)</td><td align="left">(10/6088)</td><td align="left">(0/6088)</td><td align="left"/><td align="left">(1618/6088)</td><td align="left">(0/6088)</td></tr><tr><td align="left">6.25e-06</td><td align="left">4.93e-04</td><td align="left">6.57e-04</td><td align="left">1.64e-03</td><td align="left">0</td><td align="left">NA</td><td align="left">2.62e-01</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(3/6088)</td><td align="left">(4/6084)</td><td align="left">(10/6088)</td><td align="left">(0/6088)</td><td align="left"/><td align="left">(1597/6088)</td><td align="left">(0/6088)</td></tr><tr><td align="left" colspan="3">Tewhey - targeted</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">1.62e-05</td><td align="left">5.71e-04</td><td align="left">5.71e-04</td><td align="left">1.71e-03</td><td align="left">5.71e-04</td><td align="left">NA</td><td align="left">2.57e-02</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(2/3503)</td><td align="left">(2/3503)</td><td align="left">(6/3503)</td><td align="left">(2/3501)</td><td align="left"/><td align="left">(90/3503)</td><td align="left">(0/3503)</td></tr><tr><td align="left">1.03e-05</td><td align="left">5.71e-04</td><td align="left">5.71e-04</td><td align="left">1.71e-03</td><td align="left">5.71e-04</td><td align="left">NA</td><td align="left">2.37e-02</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(2/3503)</td><td align="left">(2/3503)</td><td align="left">(6/3503)</td><td align="left">(2/3501)</td><td align="left"/><td align="left">(83/3503)</td><td align="left">(0/3503)</td></tr><tr><td align="left">7.25e-06</td><td align="left">5.71e-04</td><td align="left">5.71e-04</td><td align="left">1.43e-03</td><td align="left">5.71e-04</td><td align="left">NA</td><td align="left">2.14e-02</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(2/3503)</td><td align="left">(2/3503)</td><td align="left">(5/3503)</td><td align="left">(2/3501)</td><td align="left"/><td align="left">(75/3503)</td><td align="left">(0/3503)</td></tr><tr><td align="left">6.25e-06</td><td align="left">5.71e-04</td><td align="left">5.71e-04</td><td align="left">1.43e-03</td><td align="left">5.71e-04</td><td align="left">NA</td><td align="left">2.00e-02</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(2/3503)</td><td align="left">(2/3503)</td><td align="left">(5/3503)</td><td align="left">(2/3501)</td><td align="left"/><td align="left">(70/3503)</td><td align="left">(0/3503)</td></tr><tr><td align="left" colspan="3">Inoue</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">1.62e-05</td><td align="left">1.64e-03</td><td align="left">2.05e-03</td><td align="left">4.1e-04</td><td align="left">0</td><td align="left">4.1e-04</td><td align="left">3.69e-03</td><td align="left">4.1e-04</td></tr><tr><td align="left"/><td align="left">(4/2440)</td><td align="left">(5/2440)</td><td align="left">(1/2440)</td><td align="left">(0/2440)</td><td align="left">(1/2440)</td><td align="left">(9/2440)</td><td align="left">(1/2440)</td></tr><tr><td align="left">1.03e-05</td><td align="left">1.64e-03</td><td align="left">2.05e-03</td><td align="left">4.1e-04</td><td align="left">0</td><td align="left">4.1e-04</td><td align="left">3.28e-03</td><td align="left">4.1e-04</td></tr><tr><td align="left"/><td align="left">(4/2440)</td><td align="left">(5/2440)</td><td align="left">(1/2440)</td><td align="left">(0/2440)</td><td align="left">(1/2440)</td><td align="left">(8/2440)</td><td align="left">(1/2440)</td></tr><tr><td align="left">7.25e-06</td><td align="left">8.20e-04</td><td align="left">2.05e-03</td><td align="left">4.1e-04</td><td align="left">0</td><td align="left">4.1e-04</td><td align="left">2.87e-03</td><td align="left">4.1e-04</td></tr><tr><td align="left"/><td align="left">(2/2440)</td><td align="left">(5/2440)</td><td align="left">(1/2440)</td><td align="left">(0/2440)</td><td align="left">(1/2440)</td><td align="left">(7/2440)</td><td align="left">(1/2440)</td></tr><tr><td align="left">6.25e-06</td><td align="left">8.20e-04</td><td align="left">2.05e-03</td><td align="left">4.1e-04</td><td align="left">0</td><td align="left">4.1e-04</td><td align="left">2.46e-03</td><td align="left">4.1e-04</td></tr><tr><td align="left"/><td align="left">(2/2440)</td><td align="left">(5/2440)</td><td align="left">(1/2440)</td><td align="left">(0/2440)</td><td align="left">(1/2440)</td><td align="left">(6/2440)</td><td align="left">(1/2440)</td></tr><tr><td align="left" colspan="3">Ulirsch</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">1.62e-05</td><td align="left">0</td><td align="left">0</td><td align="left">1.09e-03</td><td align="left">0</td><td align="left">0</td><td align="left">4.14e-01</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(0/2756)</td><td align="left">(0/2756)</td><td align="left">(3/2756)</td><td align="left">(0/2756)</td><td align="left">(0/2756)</td><td align="left">(1140/2756)</td><td align="left">(0/2756)</td></tr><tr><td align="left">1.03e-05</td><td align="left">0</td><td align="left">0</td><td align="left">7.26e-04</td><td align="left">0</td><td align="left">0</td><td align="left">4.06e-01</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(0/2756)</td><td align="left">(0/2756)</td><td align="left">(2/2756)</td><td align="left">(0/2756)</td><td align="left">(0/2756)</td><td align="left">(1119/2756)</td><td align="left">(0/2756)</td></tr><tr><td align="left">7.25e-06</td><td align="left">0</td><td align="left">0</td><td align="left">7.26e-04</td><td align="left">0</td><td align="left">0</td><td align="left">3.96e-01</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(0/2756)</td><td align="left">(0/2756)</td><td align="left">(2/2756)</td><td align="left">(0/2756)</td><td align="left">(0/2756)</td><td align="left">(1092/2756)</td><td align="left">(0/2756)</td></tr><tr><td align="left">6.25e-06</td><td align="left">0</td><td align="left">0</td><td align="left">7.26e-04</td><td align="left">0</td><td align="left">0</td><td align="left">3.93e-01</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(0/2756)</td><td align="left">(0/2756)</td><td align="left">(2/2756)</td><td align="left">(0/2756)</td><td align="left">(0/2756)</td><td align="left">(1083/2756)</td><td align="left">(0/2756)</td></tr><tr><td align="left" colspan="3">Shen</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">1.62e-05</td><td align="left">2.45e-03</td><td align="left">1.67e-02</td><td align="left">2.98e-04</td><td align="left">0</td><td align="left">3e-04</td><td align="left">7.39e-01</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(8/3264)</td><td align="left">(51/3052)</td><td align="left">(1/3358)</td><td align="left">(0/3286)</td><td align="left">(1/3337)</td><td align="left">(2412/3264)</td><td align="left">(0/3264)</td></tr><tr><td align="left">1.03e-05</td><td align="left">2.45e-03</td><td align="left">1.54e-02</td><td align="left">0</td><td align="left">0</td><td align="left">3e-04</td><td align="left">7.33e-01</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(8/3264)</td><td align="left">(47/3052)</td><td align="left">(0/3358)</td><td align="left">(0/3286)</td><td align="left">(1/3337)</td><td align="left">(2393/3264)</td><td align="left">(0/3264)</td></tr><tr><td align="left">7.25e-06</td><td align="left">2.14e-03</td><td align="left">1.31e-02</td><td align="left">0</td><td align="left">0</td><td align="left">3e-04</td><td align="left">7.30e-01</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(7/3264)</td><td align="left">(40/3052)</td><td align="left">(0/3358)</td><td align="left">(0/3286)</td><td align="left">(1/3337)</td><td align="left">(2384/3264)</td><td align="left">(0/3264)</td></tr><tr><td align="left">6.25e-06</td><td align="left">1.84e-03</td><td align="left">1.21e-02</td><td align="left">0</td><td align="left">0e+00</td><td align="left">0e+00</td><td align="left">7.29e-01</td><td align="left">0</td></tr><tr><td align="left"/><td align="left">(6/3264)</td><td align="left">(37/3052)</td><td align="left">(0/3358)</td><td align="left">(0/3286)</td><td align="left">(0/3337)</td><td align="left">(2379/3264)</td><td align="left">(0/3264)</td></tr></tbody></table></table-wrap></p><p>To investigate the trade-off between observed power (number of rejected tests) and type I error rates, we combine these quantities in two ways: (1) we look at the number of rejections as a function of observed type I error rates and (2) we look at estimated FDR as a function of the number of rejections. Specifically, we use the error rates we estimate using the simulation (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>) to adjust the comparison of the observed number of rejections (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>).</p><p>In Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref> we display the number of rejections as a function of calibrated (using simulation, Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>) type I error rates. For a fixed calibrated error rate, we interpret a high number of rejections to suggest high power (since the error rates are calibrated to be the same). QuASAR-MPRA shows poor performance on this metric across datasets because it generates such conservative <italic>p</italic>-values. FET shows good performance for the Tewhey and Inoue datasets, but this is caused by its extremely liberal <italic>p</italic>-value distribution. It performs more poorly relative to the other methods in the Ulirsch and Shen datasets. Across these datasets, mpralm tends to have the best performance, particularly at low nominal error rates (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>, rows 2 and 3). However, edgeR and DESeq2 are close behind.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Number of rejections as a function of observed error rate. To compare the observed detection (rejection) rates of the methods fairly, we compare them at the same observed type I error rates, estimated in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>. The bottom two rows are zoomed-in versions of the top row. We see that mpralm, edgeR, and DESeq2 consistently have the highest detection rates</p></caption><graphic xlink:href="12864_2019_5556_Fig5_HTML" id="MO5"/></fig></p><p>If we know the proportion of true null hypotheses, <italic>&#x003c0;</italic><sub>0</sub>, and the true type I error rate, we can compute false discovery rates (FDR). The true <italic>&#x003c0;</italic><sub>0</sub> is an unknown quantity, but we estimate it using a method developed by Phipson et al. [<xref ref-type="bibr" rid="CR31">31</xref>]. The true type I error rate is also an unknown quantity, but we estimated it via a realistic simulation as described earlier (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>). Using these estimates, we compute an estimated FDR (Methods). In Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> the estimated FDR (for a given <italic>&#x003c0;</italic><sub>0</sub>) is displayed as a function of the number of rejections. QuASAR-MPRA, t-tests, and Fisher&#x02019;s exact test tend to have the highest false discovery rates. mpralm tends to have the lowest FDRs, with edgeR and DESeq2 close behind. For the Inoue dataset, all methods have very low FDR, presumably because a very high fraction of elements are expected to be differential given the extreme expected differences between the comparison groups.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Estimated FDR. For each dataset and method, the false discovery rate is estimated as a function of the number of rejections. This requires estimation of the proportion of true null hypotheses (Methods). The bottom row is a zoomed-in version of the top row</p></caption><graphic xlink:href="12864_2019_5556_Fig6_HTML" id="MO6"/></fig></p><p>In conclusion, we observe that Fisher&#x02019;s exact test has too high of an error rate and that QuASAR-MPRA is underpowered; based on these results we cannot recommend either method. T-tests perform better than these two methods but are still outperformed by mpralm, edgeR, and DESeq2. These methods have similar performance, but mpralm seems to have slightly better performance than the latter two in terms of consistency of type I error calibration and power.</p></sec><sec id="Sec7"><title>Comparison of element rankings between methods</title><p>While power and error calibration are important evaluation metrics for a differential analysis method, they do not have a direct relation with element rankings, which is often of practical importance. for the top performing methods in our evaluations (mpralm, t-test, edgeR and DESeq2) we examine rankings in more detail.</p><p>We observe fairly different rankings between mpralm and the t-test and examine drivers of these differences in Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>. For each dataset, we find the MPRA elements that appear in the top 200 elements with one method but not the other. We will call these uniquely top ranking elements, and they make up 24% to 64% of the top 200 depending on dataset. For most datasets, DNA, RNA, and log-ratio activity measures are higher in uniquely top ranking mpralm elements (top three rows of Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>). It is desirable for top ranking elements to have higher values for all three quantities because higher DNA levels increase confidence in the activity measure estimation, and higher RNA and log-ratio values give a stronger indication that a particular MPRA element has regulatory activity. In the last two rows of Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>, we compare effect sizes and variability measures (residual standard deviations). The t-test uniformly shows lower variability but also lower effect sizes for its uniquely top ranking elements. This follows experience from gene-expression studies where standard t-tests tend to underestimate the variance and thereby exhibit t-statistics which are too large, leading to false positives. In MPRA studies, as with most other high-throughput studies, it is typically more useful to have elements with high effect sizes at the top of the list. Such elements are able to picked out in mpralm due to its information sharing and weighting framework.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Distribution of quantities related to statistical inference in top ranked elements with mpralm and t-test. MPRA elements that appear in the top 200 elements with one method but not the other are examined here. For these uniquely top ranking elements, the DNA, RNA, and log-ratio percentiles are shown in the first three rows. The effect sizes (difference in mean log-ratios) and residual standard deviations are shown in the last two rows. Overall, uniquely top ranking elements for the t-test tend to have lower log-ratio activity measures, effect sizes, and residual standard deviations</p></caption><graphic xlink:href="12864_2019_5556_Fig7_HTML" id="MO7"/></fig></p><p>We similarly compare mpralm rankings with edgeR and DESeq2 rankings in Figs.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref> and <xref rid="Fig9" ref-type="fig">9</xref>. The ranking concordance between mpralm and these two methods is much higher than with the t-test. Generally, uniquely top ranking mpralm elements have higher DNA and RNA levels, but lower log-ratio activity measures. Uniquely top ranking mpralm elements also tend to have larger effect sizes. The variability of activity measures (residual SD) is similar among the methods.
<fig id="Fig8"><label>Fig. 8</label><caption><p>Distribution of quantities related to statistical inference in top ranked elements with mpralm and edgeR. Similar to Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref></p></caption><graphic xlink:href="12864_2019_5556_Fig8_HTML" id="MO8"/></fig>
<fig id="Fig9"><label>Fig. 9</label><caption><p>Distribution of quantities related to statistical inference in top ranked elements with mpralm and DESeq2. Similar to Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref></p></caption><graphic xlink:href="12864_2019_5556_Fig9_HTML" id="MO9"/></fig></p></sec><sec id="Sec8"><title>Accuracy of activity measures and power of differential analysis depends on summarization technique over barcodes</title><p>MPRA data initially contain count information at the barcode level, but we typically desire information summarized at the element level for the analysis stage. We examine the theoretical properties of two summarization methods: averaging and aggregation. Under the assumption that DNA and RNA counts follow a count distribution with a mean-variance relationship, we first show that averaging results in activity estimates with more bias. Second, we examine real data performance of these summarization techniques.</p><p>Let <italic>R</italic><sub><italic>b</italic></sub> and <italic>D</italic><sub><italic>b</italic></sub> denote the RNA and DNA count, respectively, for barcode <italic>b</italic>=1,&#x02026;,<italic>B</italic> for a putative regulatory element in a given sample. We suppress the dependency of these counts on sample and element. Typically, <italic>B</italic> is approximately 10 to 15 (for examples, see Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>). We assume that <italic>R</italic><sub><italic>b</italic></sub> has mean <italic>&#x003bc;</italic><sub><italic>r</italic></sub> and variance <italic>k</italic><sub><italic>r</italic></sub><italic>&#x003bc;</italic><sub><italic>r</italic></sub> and that <italic>D</italic><sub><italic>b</italic></sub> has mean <italic>&#x003bc;</italic><sub><italic>d</italic></sub> and variance <italic>k</italic><sub><italic>d</italic></sub><italic>&#x003bc;</italic><sub><italic>d</italic></sub>. Typically the constants <italic>k</italic><sub><italic>d</italic></sub> and <italic>k</italic><sub><italic>r</italic></sub> are greater than 1, modeling overdispersion. Negative binomial models are a particular case with <italic>k</italic>=1+<italic>&#x003d5;</italic><italic>&#x003bc;</italic>, where <italic>&#x003d5;</italic> is an overdispersion parameter. Also let <italic>N</italic><sub><italic>d</italic></sub> and <italic>N</italic><sub><italic>r</italic></sub> indicate the library size for DNA and RNA, respectively, in a given sample. Let <italic>p</italic><sub><italic>d</italic></sub> and <italic>p</italic><sub><italic>r</italic></sub> indicate the fraction of reads mapping to element <italic>e</italic> for DNA and RNA, respectively, in a given sample so that <italic>&#x003bc;</italic><sub><italic>r</italic></sub>=<italic>N</italic><sub><italic>r</italic></sub><italic>p</italic><sub><italic>r</italic></sub> and <italic>&#x003bc;</italic><sub><italic>d</italic></sub>=<italic>N</italic><sub><italic>d</italic></sub><italic>p</italic><sub><italic>d</italic></sub>. Let <italic>a</italic> be the true activity measure for element <italic>e</italic> defined as <italic>a</italic>:= log(<italic>p</italic><sub><italic>r</italic></sub>/<italic>p</italic><sub><italic>d</italic></sub>). When performing total count normalization, the RNA and DNA counts are typically scaled to a common library size <italic>L</italic>.</p><p>The average estimator of <italic>a</italic> is an average of barcode-specific log activity measures: 
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\hat a^{AV} = \frac{1}{B} \sum\limits_{b = 1}^{B} \log\left(\frac{R_{b}L/N_{r} + 1}{D_{b}L/N_{d} + 1} \right) $$ \end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AV</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12864_2019_5556_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> Using a second order Taylor expansion (Methods), it can be shown that this estimator has bias approximately equal to 
<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\text{bias}^{AV} \approx \frac{1}{2}\left(\frac{k_{d}}{\mu_{d}} - \frac{k_{r}}{\mu_{r}} \right) = \frac{1}{2}\left(\frac{k_{d}}{N_{d} p_{d}} - \frac{k_{r}}{N_{r} p_{r}} \right) $$ \end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msup><mml:mrow><mml:mtext>bias</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AV</mml:mtext></mml:mrow></mml:msup><mml:mo>&#x02248;</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12864_2019_5556_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> The aggregate estimator of <italic>a</italic> first aggregates counts over barcodes: 
<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\hat a^{AGG} = \log\left(\frac{1 + (L/N_r)\sum\nolimits_{b=1}^{B} R_{b}}{1 + (L/N_d)\sum\nolimits_{b=1}^{B} D_{b}} \right) $$ \end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:munderover><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:munderover><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12864_2019_5556_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> Using an analogous Taylor series argument (Methods), we can show that this estimator has bias approximately equal to 
<disp-formula id="Equd"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\text{bias}^{AGG} \approx \frac{1}{B}\text{bias}^{AV} $$ \end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:msup><mml:mrow><mml:mtext>bias</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup><mml:mo>&#x02248;</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mtext>bias</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AV</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math><graphic xlink:href="12864_2019_5556_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> The aggregate estimator has considerably less bias than the average estimator for most MPRA experiments because most experiments use at least 10 barcodes per element. Bias magnitude depends on count levels and the true activity measure <italic>a</italic>. Further, the direction of bias depends on the relative variability of RNA and DNA counts. Similar Taylor series arguments show that the variance of the two estimators is approximately the same.</p><p>The choice of estimator can impact the estimated log fold-changes (changes in activity) in a differential analysis. In Fig.&#x000a0;<xref rid="Fig10" ref-type="fig">10</xref> we compare the log fold-changes inferred using the two different estimators. For the Inoue dataset, these effect sizes are very similar, but there are larger differences for the Ulirsch and Shen datasets.
<fig id="Fig10"><label>Fig. 10</label><caption><p>Comparison of the average and aggregate estimators For the three datasets containing barcode-level information, we compare the effect sizes (log fold changes in activity levels) resulting from use of the aggregate and average estimators. The <italic>y</italic>=<italic>x</italic> line is shown in red</p></caption><graphic xlink:href="12864_2019_5556_Fig10_HTML" id="MO10"/></fig></p><p>Aggregation technique affects power in a differential analysis. In the last three columns of Figs.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref>, <xref rid="Fig5" ref-type="fig">5</xref>, and <xref rid="Fig6" ref-type="fig">6</xref>, we compare aggregation to averaging using mpralm. The two estimators have similar type I error rates but very different detection rates between datasets. The average estimator is more favorable for the Ulirsch and Shen datasets, and the aggregate estimator is more favorable in the Inoue dataset.</p></sec><sec id="Sec9"><title>Recommendations for sequencing depth and sample size</title><p>To aid in the design of future MPRA experiments, we used the above mathematical model to inform power calculations. Power curves are displayed in Fig.&#x000a0;<xref rid="Fig11" ref-type="fig">11</xref>. We observe that the variance of the aggregate estimator depends minimally on the true unknown activity measure but is greatly impacted by sequencing depth. We fix one of the two true activity measures to be 0.8 as this is common in many datasets. We use a nominal type I error rate of 0.05 that has been Bonferroni adjusted for 5000 tests to obtain conservative power estimates. We also use ten barcodes per element as this is typical of many studies.
<fig id="Fig11"><label>Fig. 11</label><caption><p>Power analysis. Variance and power calculated based on our theoretical model. <bold>(a)</bold> Variance of the aggregate estimator depends on library size and the true unknown activity level but not considerably on the latter. <bold>(b)</bold>-<bold>(f)</bold> Power curves as a function of library size for different effect sizes and sample sizes. Effect sizes are log2 fold-changes</p></caption><graphic xlink:href="12864_2019_5556_Fig11_HTML" id="MO11"/></fig></p><p>Our model suggests different impacts of sample size, and a marked impact of increasing the number of replicates, especially between 2 and 6 samples. From Fig.&#x000a0;<xref rid="Fig12" ref-type="fig">12</xref>, we can see that large effect sizes (effect sizes of 1 or greater) are typical for top ranking elements in many MPRA studies. In this situation it is advisable to do 4 or more replicates per group.
<fig id="Fig12"><label>Fig. 12</label><caption><p>Effect size distributions across datasets. Effect sizes in MPRA differential analysis are the (precision-weighted) differences in activity scores between groups, also called log2 fold-changes. The distribution of log2 fold changes resulting from using mpralm with the aggregate estimator are shown here</p></caption><graphic xlink:href="12864_2019_5556_Fig12_HTML" id="MO12"/></fig></p></sec></sec><sec id="Sec10" sec-type="discussion"><title>Discussion</title><p>The field of MPRA data analysis has been fragmented and consists of a large collection of study-specific ad hoc methods. Our objective in this work has been to provide a unified framework for the analysis of MPRA data. Our contributions can be divided into three areas. First, we have investigated techniques for summarizing information over barcodes. In the literature, these choices have always been made without justification and have varied considerably between studies. Second, we have developed a linear model framework, mpralm, for powerful and flexible differential analysis. To our knowledge, this is the second manuscript evaluating for statistical analysis in MPRA studies. The first proposed the QuASAR-MPRA method [<xref ref-type="bibr" rid="CR23">23</xref>], which we show to have worse performance than mpralm. In our comparisons, we provide the largest and most comprehensive comparison of analysis methods so far; earlier work used only two datasets for comparisons. Third, we have analyzed the impact of sequencing depth and number of replicates on power. To our knowledge, this is the first mathematically-based power investigation, and we expect this information to be useful in the design of MPRA studies.</p><p>The activity of a regulatory element can be quantified with the log-ratio of RNA counts to DNA counts. In the literature, groups have generally taken two approaches to summarizing barcode information to obtain one such activity measure per element per sample. One approach is to add RNA and DNA counts from all barcodes to effectively increase sequencing depth for an element. This is termed the aggregate estimator. Another approach is to compute the log-ratio measure for each barcode and use an average of these measures as the activity score for an element. This is termed the average estimator, and we have shown that it is more biased than the aggregate estimator. Because of this bias, we caution against the use of the average estimator when comparing activity scores in enhancer groups (often defined by sequence features). However, it is unclear which of the two estimators is more appropriate for differential analysis.</p><p>In addition to barcode summarization recommendations, we have proposed a linear model framework, mpralm, for the differential analysis of MPRA data. Our evaluations show that it produces calibrated <italic>p</italic>-values and is as or more powerful than existing methods being used in the literature.</p><p>While the count-based tools, edgeR and DESeq2, would seem like natural methods to use for the analysis of MPRA data, they have not yet been used for differential analysis of MPRA activity measures between groups. There has been some use of DESeq2 to identify (filter) elements with regulatory activity (differential expression of RNA relative to DNA) [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. However, these tools have not been used for comparisons of activity measures between groups. In this work we propose the use of log-DNA offsets as potential sensible uses of these software for differential analysis. In our evaluations, we see that this approach is most competitive with mpralm. For the allelic studies [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>], we observe that the degree of within-sample correlation affects the power of mpralm relative to comparison methods. In particular, there is little difference in the performance of the different methods for the Tewhey large pool experiment, and this experiment had overall low within-sample correlation. Both the Tewhey targeted pool experiment and the Ulirsch experiment had larger within-sample correlations, and we observe that mpralm has increased power over the comparison methods for these datasets. We expect that mpralm will generally be more powerful for paired designs with high within-pair correlations.</p><p>In terms of element rankings, mpralm, edgeR, and DESeq2 are similar. However, we observe a substantial difference in ranking between t-tests and mpralm and believe top ranked mpralm elements exhibit better properties compared to those from t-tests.</p><p>Linear models come with analytic flexibility that is necessary to handle diverse MPRA designs. Paired designs involving alleles, for example, are easily handled with linear mixed effects models due to computational tractability. The studies we have analyzed here only consider two alleles per locus. It is possible to have more than two alleles at a locus, and such a situation cannot be addressed with paired t-tests, but is easily analyzed using mpralm. This is important because we believe such studies will eventually become routine for understanding results from genome-wide association studies. We note that for allelic studies, it is often of interest to filter detections of significant differences to those cases where at least one allele appears to show regulatory activity. This is not inherent in the mpralm method, but it is possible to screen for regulatory activity with a conventional count-based differential analysis of RNA counts versus DNA counts using methods such as voom, edgeR, or DESeq2.</p><p>While we have focused on characterizing the mpralm linear model framework for differential analysis, it is possible to include variance weights in the multivariate models used in saturation mutagenesis and characterization studies. We expect that modeling the copy number-variance relationship will improve the performance of these models.</p><p>For power, we find a substantial impact of even small increases in sample size. This is an important observation because many MPRA studies use 2 or 3 replicates per group, and our results suggest that power can be substantially increased with even a modest increase in sample size. We caution that using less than 4 replicates can be quite underpowered.</p><p>In short, the tools and ideas set forth here will aid in making rigorous conclusions from a large variety of future MPRA studies.</p></sec><sec id="Sec11" sec-type="conclusion"><title>Conclusions</title><p>We have observed differences in the MPRA activity estimates resulting from the averaging and aggregation methods of summarizing counts across barcodes. For this reason, we recommend that practitioners perform sensitivity analyses for their results by using both of these estimation procedures. The mpralm linear model framework appears to have calibrated type I error rates and to be as or more powerful than the t-tests and Fisher&#x02019;s exact type tests that have been primarily used in the literature. mpralm has similar performance to variations of the edgeR and DESeq2 methods that we introduce here. These variations involve including DNA counts as offsets in the RNA differential analysis procedures. We recommend either of these 3 methods for unpaired differential analysis settings (such as tissue comparison studies), but we recommend mpralm for allelic studies due to its ability to better model the paired nature of the alleles with mixed models. Finally, we recommend that practitioners use at least 4 samples per condition for reasonable power to detect differences for top ranking elements.</p></sec><sec id="Sec12"><title>Methods</title><sec id="Sec13"><title>Data</title><p>See Table 1. Dataset labels used in figures are accompanied by short descriptions below.</p><p><bold>Melnikov</bold>: Study of the base-level impact of mutations in two inducible enhancers in humans [<xref ref-type="bibr" rid="CR12">12</xref>]: a synthetic cAMP-regulated enhancer (CRE) and a virus-inducible interferon-beta enhancer (IFNB). We do not look at the IFNB data because it contains only one sample. We consider 3 datasets:</p><p><bold>Melnikov: CRE, single-hit, induced state</bold>: Synthetic cAMP-regulated enhancer, single-hit scanning, induced state.</p><p><bold>Melnikov: CRE, multi-hit, uninduced state</bold>: Synthetic cAMP-regulated enhancer, multi-hit sampling, uninduced state.</p><p><bold>Melnikov: CRE, multi-hit, induced state</bold>: Synthetic cAMP-regulated enhancer, multi-hit sampling, induced state.</p><p><bold>Kheradpour</bold>: Study of the base-level impact of mutations in various motifs [<xref ref-type="bibr" rid="CR15">15</xref>]. Transfection into HepG2 and K562 cells.</p><p><bold>Tewhey</bold>: Study of allelic effects in eQTLs [<xref ref-type="bibr" rid="CR19">19</xref>]. Transfection into two lymphoblastoid cell lines (NA12878 and NA19239) as well as HepG2. In addition two pools of plasmids are considered: a large screening pool and a smaller, targeted pool, designed based on the results of the large pool. We use data from both the large and the targeted pool in NA12878.</p><p><bold>Inoue: chromosomal vs. episomal</bold>: Comparison of episomal and chromosomally-integrated constructs [<xref ref-type="bibr" rid="CR21">21</xref>]. This study uses a wild-type and mutant integrase to study the activity of a fixed set of putative regulatory elements in an episomal and a chromosomally-integrated setting, respectively.</p><p><bold>Ulirsch</bold>: Study of allelic effects in GWAS to understand red blood cell traits [<xref ref-type="bibr" rid="CR18">18</xref>]. Transfection into K562 cells as well as K562 with GATA1 overexpressed. We use the data from K562.</p><p><bold>Shen: mouse retina vs. cortex</bold>: Comparison of cis-regulatory elements in-vivo in mouse retina and cerebral cortex [<xref ref-type="bibr" rid="CR22">22</xref>]. Candidate CREs that tile targeted regions are assayed in-vivo in these two mouse tissues with adeno-associated virus delivery.</p></sec><sec id="Sec14"><title>Simulation of data for type I error rate estimation</title><p>Here we describe the realistic simulation of data to closely match properties of the real datasets. The starting point is a given dataset with two comparison groups: 
<list list-type="order"><list-item><p>Compute log-ratio activity measures from the original RNA and DNA counts.</p></list-item><list-item><p>Calculate and save the element-wise residual standard deviations of the log-ratios after mean-centering them in each group. Calculate and save the mean of the original log-ratios in group 1. These element-wise means will become the mean for both groups in the new null data.</p></list-item><list-item><p>Standardize the log-ratios in each group to have mean zero and unit variance.</p></list-item><list-item><p>The standardized log-ratios from both groups all have mean zero and unit variance. Resample these standardized residuals without replacement for each element in each sample. For paired (allelic) studies, resample each allele-allele pair without replacement.</p></list-item><list-item><p>Multiply the resampled residuals by the element-wise residual standard deviations, and add the original group 1 element-specific means. This creates identically distributed log-ratios in both comparison groups.</p></list-item><list-item><p>Retain the original DNA counts from all samples.</p></list-item><list-item><p>Compute RNA counts using the original DNA counts and the resampled log-ratio activity measures.</p></list-item><list-item><p>The original DNA counts and the new RNA counts form the new synthetic dataset.</p></list-item></list></p></sec><sec id="Sec15"><title>Count preprocessing</title><p>DNA and RNA counts are scaled to have the same library size before running any methods. We perform minimal filtering on the counts to remove elements from the analysis that have low counts across all samples. Specifically, we require that DNA counts must be at least 10 in all samples to avoid instability of the log-ratio activity measures. We also remove elements in which these log-ratios are identical across all samples; in practice this only happens when the RNA counts are zero across all samples. Both filtering steps remove clear outliers in the copy number-variance plot (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>).</p></sec><sec id="Sec16"><title>Modeling</title><p>The square root of the standard deviation of the log-ratios over samples is taken as a function of average log DNA levels over samples, and this relationship is fit with a lowess curve. Predicted variances are inverted to form observation-level precision weights. Log-ratios activity measures and weights are used in the voom analysis pipeline. For the allelic studies, a mixed model is fit for each element using the duplicateCorrelation module in the limma Bioconductor package [<xref ref-type="bibr" rid="CR33">33</xref>].</p><p>This linear model approach has a number of advantages. (1) It is flexible to different functional forms of the variance-copy number relationship. (2) It allows for a unified approach to modeling many different types of MPRA design using the power of design matrices. (3) It allows for borrowing of information across elements using empirical Bayes techniques. (4) It allows for different levels of correlation between elements using random effects.</p></sec><sec id="Sec17"><title>mpralm enables modeling for complex comparisons</title><p>While many comparisons of interest in MPRA studies can be posed as a two group comparison (e.g. major allele vs. minor allele), more complicated experimental designs are also of interest. For example, in the allelic study conducted by Ulirsch [<xref ref-type="bibr" rid="CR18">18</xref>], putative biallelic enhancer sequences are compared in two cellular contexts. The first is a standard culture of K562 cells, and the second is a K562 culture that induces over-expression of GATA1 for a more terminally-differentiated phenotype. A straightforward question is whether an allele&#x02019;s effect on enhancer activity differs between cellular contexts. Let <italic>y</italic><sub><italic>eia</italic></sub> be the enhancer activity measure (log ratio of RNA over DNA counts) for element <italic>e</italic>, in sample <italic>i</italic> for allele <italic>a</italic>. Let <italic>x</italic><sub>1<italic>eia</italic></sub> be a binary indicator of the mutant allele. Let <italic>x</italic><sub>2<italic>eia</italic></sub> be a binary indicator of the GATA1 over-expression condition. Then the following model 
<disp-formula id="Eque"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} Y_{eia} =&#x00026; \beta_{0e} + \beta_{1e}x_{1eia} + \beta_{2e}x_{2eia} + \\ &#x00026; \beta_{3e}x_{1eia}x_{2eia} + b_{i} + \epsilon_{eia} \end{array} $$ \end{document}</tex-math><mml:math id="M10"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">eia</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:msub><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mtext mathvariant="italic">eia</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mtext mathvariant="italic">eia</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:msub><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mtext mathvariant="italic">eia</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mtext mathvariant="italic">eia</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">eia</mml:mtext></mml:mrow></mml:msub><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5556_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p><p>is a linear mixed effects model for activity measures, where <italic>b</italic><sub><italic>i</italic></sub> is a random effect that induces correlation between the two alleles measured within the same sample. We can perform inference on the <italic>&#x003b2;</italic><sub>3<italic>e</italic></sub> parameters to determine differential allelic effects. Such a model is easy to fit within the mpralm framework, since our framework supports model specifications by general design matrices. In contrast, this question cannot be formulated in the QuASAR, t-test, and Fisher&#x02019;s exact test frameworks. Neither edgeR nor DESeq2 support the fitting of mixed effects models.</p></sec><sec id="Sec18"><title>Running mpralm, QuASAR, t-test, fisher&#x02019;s exact test</title><p>For all methods, DNA and RNA counts were first corrected for library size with total count normalization. For edgeR and DESeq2, DNA counts were included as offset terms on the log scale before standard analysis. For the t-test we computed the aggregate estimator of the log-ratio as the outcome measure. For Fisher&#x02019;s exact test, we summed DNA and RNA counts in the two conditions to form a 2-by-2 table as input to the procedure. For QuASAR-MPRA, we summed RNA counts in each condition to get one reference condition count and one alternative condition count per element. We also summed DNA counts in all samples and in the reference condition to get one DNA proportion for each element. These were direct inputs to the method.</p></sec><sec id="Sec19"><title>Metrics used for method comparison</title><p>We use a number of metrics to compare methods and describe them in detail here. 
<list list-type="bullet"><list-item><p><bold>Shape of</bold><bold><italic>p</italic></bold><bold>-value distributions.</bold> Calibrated differential analysis methods have a characteristic shape for the <italic>p</italic>-value distribution. Normally the majority of <italic>p</italic>-values are uniformly distributed, corresponding to null comparisons, and there is a peak at low <italic>p</italic>-values for the truly differential comparisons. We compare the methods with regards to this expected shape.</p></list-item><list-item><p><bold>Type I error rates.</bold> For all methods and datasets, we estimate via realistic simulation (described above) the proportion of truly null comparisons in which we reject the null hypothesis.</p></list-item><list-item><p><bold>Number of rejections as a function of type I error rate.</bold> To some degree, this is a comparison of power between methods. We cannot compare power of methods by comparing the height of the peaks around zero in the <italic>p</italic>-value distributions because those plots tell us nothing about type I error rates. We wished to fix type I error rate and compare the number of rejections made by the different methods. For a given <italic>nominal</italic> type I error rate, we computed (1) the number of rejections made by a method and (2) the estimated true type I error rate. For example, a conservative method would have a true type I error rate of 0.03, say, at a nominal level of 0.05. Quantity (2) is plotted on the x-axis of Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>, and quantity (1) is plotted on the y axis. Curves that are above others indicate higher detections for fixed type I error rate.</p></list-item><list-item><p><bold>False discovery rates.</bold> These are defined as the fraction of rejections that are false positives. The estimation of these FDRs is described below.</p></list-item><list-item><p><bold>Metrics that describe top ranking elements.</bold> The metrics above focus on type I error rates and power. Comparisons of the element rankings produced by the different methods were performed by taking elements that were ranked in the top 200 for one method but not the other. (Comparisons were done pairwise with mpralm always being one method compared.) Metrics measured the magnitude of the RNA counts, DNA counts, estimated log-ratio activity measures, effect sizes (difference in activity between groups), and residual standard deviations of the activity measures. It is nice if the RNA, DNA, log-ratios, and effect sizes are higher in top ranking elements. It is nice if the top ranking elements have residual standard deviations that are low, but not so low as to have been underestimated. It is common for variability to be underestimated when there are uniformly low counts across samples.</p></list-item></list></p></sec><sec id="Sec20"><title>Estimation of FDR</title><p>The proportion of truly null hypotheses <italic>&#x003c0;</italic><sub>0</sub> for each dataset was estimated using the &#x0201c;lfdr&#x0201d; method in the propTrueNull function within limma [<xref ref-type="bibr" rid="CR31">31</xref>]. As is common with <italic>&#x003c0;</italic><sub>0</sub> estimation procedures, the <italic>p</italic>-values resulting from a statistical analysis are used in the estimation process. To this end, the <italic>&#x003c0;</italic><sub>0</sub> proportion was estimated with the <italic>p</italic>-values resulting from mpralm, t-test, QuASAR, edgeR, and DESeq2, and the median of these estimates was used as the estimate for <italic>&#x003c0;</italic><sub>0</sub> for a given dataset. Fisher&#x02019;s exact test was excluded from this estimate because it gave an estimate of <italic>&#x003c0;</italic><sub>0</sub> that was considerably smaller than the other methods, and which was dubious in light of its uncontrolled type I error rate. We multiply the number of tests by these <italic>&#x003c0;</italic><sub>0</sub> estimates to obtain an estimate of the number of truly null hypotheses. We then multiply this by our estimate of the true dataset-specific type I error rate (as shown in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>) to obtain an estimate of the number of false positives. Dividing by the number of rejected hypotheses at a given nominal significance level gives the estimated FDRs in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>.</p></sec><sec id="Sec21"><title>Bias and variance of estimators</title><p>We use Taylor series arguments to approximate the bias and variance of the aggregate and average estimators. The following summarizes our parametric assumptions: 
<disp-formula id="Equf"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \mathrm{E}[R_{b}] &#x00026;= \mu_{r} = N_{r} p_{r} &#x00026; \text{Var}(R_{b}) &#x00026;= k_{r}\mu_{r} \\ \mathrm{E}[D_{b}] &#x00026;= \mu_{d} = N_{d} p_{d} &#x00026; \text{Var}(D_{b}) &#x00026;= k_{d}\mu_{d} \end{array} $$ \end{document}</tex-math><mml:math id="M12"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi mathvariant="normal">E</mml:mi><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mtext>Var</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:mi mathvariant="normal">E</mml:mi><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mtext>Var</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5556_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p><p>We suppress the dependency of these parameters on sample and element. Library sizes are given by <italic>N</italic>. The fraction of reads coming from a given element is given by <italic>p</italic>. Dispersion parameters are given by <italic>k</italic>. The common library size resulting from total count normalization is given by <italic>L</italic>. The true activity measure of a given element is given by <italic>a</italic>:= log(<italic>p</italic><sub><italic>r</italic></sub>/<italic>p</italic><sub><italic>d</italic></sub>).</p><p><bold>Average estimator:</bold> The &#x0201c;average estimator&#x0201d; of <italic>a</italic> is an average of barcode-specific log activity measures and is written as: 
<disp-formula id="Equg"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\hat a^{AV} = \frac{1}{B} \sum\limits_{b = 1}^{B} \log\left(\frac{R_{b}L/N_{r} + 1}{D_{b}L/N_{d} + 1} \right) $$ \end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AV</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12864_2019_5556_Article_Equg.gif" position="anchor"/></alternatives></disp-formula> The second-order Taylor expansion of the function 
<disp-formula id="Equh"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$f(R_{b},D_b) = \log(R_{b} L/N_{r} + 1) - \log(D_{b} L/N_{d} + 1) $$ \end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12864_2019_5556_Article_Equh.gif" position="anchor"/></alternatives></disp-formula> around the point (E[<italic>R</italic><sub><italic>b</italic></sub>],E[<italic>D</italic><sub><italic>b</italic></sub>])=(<italic>&#x003bc;</italic><sub><italic>r</italic></sub>,<italic>&#x003bc;</italic><sub><italic>d</italic></sub>) is: 
<disp-formula id="Equi"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} \log&#x00026; \left(\frac{R_{b} L/N_{r} +1}{D_{b} L/N_{d} +1} \right) \approx \\ &#x00026; \log\left(\mu_{r} L/N_{r} +1 \right) - \log\left(\mu_{d} L/N_{d} +1 \right) \\ &#x00026;+ \frac{L/N_{r}}{\mu_{r}L/N_{r}+1}(R_{b} - \mu_{r}) \\ &#x00026;- \frac{L/N_{d}}{\mu_{d}L/N_{d}+1}(D_{b} - \mu_{d}) \\ &#x00026;- \frac{(L/N_{r})^{2}}{2(\mu_{r}L/N_{r}+1)^{2}}(R_{b} - \mu_{r})^{2} \\ &#x00026;+ \frac{(L/N_{d})^{2}}{2(\mu_{d}L/N_{d}+1)^{2}}(D_{b}-\mu_{d})^{2} \end{aligned} $$ \end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>log</mml:mo></mml:mtd><mml:mtd><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>&#x02248;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12864_2019_5556_Article_Equi.gif" position="anchor"/></alternatives></disp-formula> We use the expansion above to approximate the expectation of the average estimator: 
<disp-formula id="Equj"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \mathrm{E}\left[ \hat a^{AV} \right] &#x00026; \approx \log\left(\frac{\mu_{r}L/N_{r}+1}{\mu_{d}L/N_{d}+1} \right) \\ &#x00026;\quad + \frac{(L/N_{d})^{2} k_{d}\mu_{d}}{2(\mu_{d}L/N_{d}+1)^{2}} - \frac{(L/N_{r})^{2} k_{r}\mu_{r}}{2(\mu_{r}L/N_{r}+1)^{2}} \\ &#x00026;\approx \log\left(\frac{p_{r}}{p_{d}} \right) + \frac{k_{d}}{2\mu_{d}} - \frac{k_{r}}{2\mu_{r}} \\ &#x00026;= a + \frac{k_{d}}{2\mu_{d}} - \frac{k_{r}}{2\mu_{r}} \end{array} $$ \end{document}</tex-math><mml:math id="M20"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi mathvariant="normal">E</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AV</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mtd><mml:mtd class="align-2"><mml:mo>&#x02248;</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>&#x02248;</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5556_Article_Equj.gif" position="anchor"/></alternatives></disp-formula></p><p>We can also approximate the variance under the assumption that the barcode-specific log-ratios are uncorrelated: 
<disp-formula id="Equk"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \text{Var}(\hat a^{AV}) &#x00026;= \frac{1}{B} \text{Var} \left(\log\left(\frac{R_{b}L/N_{r}+1}{D_{b}L/N_{d}+1} \right) \right) \\ &#x00026;\approx \frac{(L/N_{r})^{2} k_{r}\mu_{r}}{B(\mu_{r} L/N_{r} + 1)^{2}} + \frac{(L/N_{d})^{2} k_{d}\mu_{d}}{B(\mu_{d} L/N_{d} + 1)^{2}} \\ &#x00026;\quad - \frac{2 (L/N_{r}) (L/N_{d}) \text{Cov}(R_{b}, D_{b})}{B(\mu_{r} L/N_{r} + 1)(\mu_{d} L/N_{d} + 1)} \end{array} $$ \end{document}</tex-math><mml:math id="M22"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mtext>Var</mml:mtext><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AV</mml:mtext></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mfrac><mml:mtext>Var</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>&#x02248;</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mspace width="1em"/><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mtext>Cov</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5556_Article_Equk.gif" position="anchor"/></alternatives></disp-formula></p><p><bold>Aggregate estimator:</bold> The &#x0201c;aggregate estimator&#x0201d; of <italic>a</italic> first aggregates counts over barcodes and is written as: 
<disp-formula id="Equl"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \hat{a}^{AGG} &#x00026;= \log\left(\frac{1 + (L/N_{r})\sum\nolimits_{b=1}^{B} R_{b}}{1 + (L/N_{d})\sum\nolimits_{b=1}^{B} D_{b}} \right) \\ &#x00026;= \log \left(\frac{1 + (L/N_{r})R^{AGG}}{1 + (L/N_{d})D^{AGG}} \right) \end{array} $$ \end{document}</tex-math><mml:math id="M24"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msup><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:munderover><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:munderover><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5556_Article_Equl.gif" position="anchor"/></alternatives></disp-formula></p><p>The second-order Taylor expansion of the function 
<disp-formula id="Equm"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\begin{aligned} f(R^{AGG},D^{AGG}) = \log((L/N_{r})R^{AGG}+1) - \log((L/N_{d})D^{AGG}+1) \end{aligned}} $$ \end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mspace width="-15.0pt"/><mml:mtable><mml:mtr><mml:mtd><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12864_2019_5556_Article_Equm.gif" position="anchor"/></alternatives></disp-formula> around the point (E[<italic>R</italic><sup><italic>AGG</italic></sup>],E[<italic>D</italic><sup><italic>AGG</italic></sup>])=(<italic>B</italic><italic>&#x003bc;</italic><sub><italic>r</italic></sub>,<italic>B</italic><italic>&#x003bc;</italic><sub><italic>d</italic></sub>) is: 
<disp-formula id="Equn"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} \log &#x00026; \left(\frac{1 + (L/N_{r})R^{AGG}}{1 + (L/N_{d})D^{AGG}} \right) \approx \\ &#x00026; \log\left(B\mu_{r}L/N_{r} +1 \right) - \log\left(B\mu_{d}L/N_{d} +1 \right) \\ &#x00026; + \frac{L/N_{r}}{B\mu_{r}L/N_{r} +1}(R^{AGG} - B\mu_{r}) \\ &#x00026; - \frac{L/N_{d}}{B\mu_{d}L/N_{d} +1}(D^{AGG} - B\mu_{d}) \\ &#x00026; - \frac{(L/N_{r})^{2}}{2(B\mu_{r}L/N_{r} +1)^{2}}(R^{AGG}- B\mu_{r})^{2} \\ &#x00026; + \frac{(L/N_{d})^{2}}{2(B\mu_{d}L/N_{d} +1)^{2}}(D^{AGG}-B\mu_{d})^{2} \end{aligned} $$ \end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>log</mml:mo></mml:mtd><mml:mtd><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>&#x02248;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12864_2019_5556_Article_Equn.gif" position="anchor"/></alternatives></disp-formula> We use the expansion above to approximate the expectation: 
<disp-formula id="Equo"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \mathrm{E}\left[ \hat a^{AGG} \right] &#x00026;\approx \log\left(\frac{B\mu_{r}L/N_{r}+1}{B\mu_{d}L/N_{d}+1} \right) \\ &#x00026;\quad + \frac{B k_{d}\mu_{d} (L/N_{d})^{2}}{2(B\mu_{d}L/N_{d} +1)^{2}} \\ &#x00026;\quad - \frac{B k_{r}\mu_{r} (L/N_{r})^{2}}{2(B\mu_{r}L/N_{r} +1)^{2}} \\ &#x00026;\approx \log\left(\frac{p_{r}}{p_{d}} \right) + \frac{k_{d}}{2B\mu_{d}} - \frac{k_{r}}{2B\mu_{r}} \\ &#x00026;= a + \frac{k_{d}}{2B\mu_{d}} - \frac{k_{r}}{2B\mu_{r}} \end{array} $$ \end{document}</tex-math><mml:math id="M30"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi mathvariant="normal">E</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mtd><mml:mtd class="align-2"><mml:mo>&#x02248;</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mspace width="1em"/><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>&#x02248;</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5556_Article_Equo.gif" position="anchor"/></alternatives></disp-formula></p><p>We can also approximate the variance: 
<disp-formula id="Equp"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \text{Var} &#x00026; (\hat a^{AGG}) \approx \\ &#x00026;\frac{(L/N_{r})^{2} B k_{r}\mu_{r}}{(B\mu_{r} L/N_{r} + 1)^{2}} + \frac{(L/N_{d})^{2} B k_{d}\mu_{d}}{(B\mu_{d} L/N_{d} + 1)^{2}} \\ &#x00026;- \frac{2 (L/N_{r}) (L/N_{d}) \text{Cov}(R^{AGG}, D^{AGG})}{(B\mu_{r} L/N_{r} + 1)(B\mu_{d} L/N_{d} + 1)} \end{array} $$ \end{document}</tex-math><mml:math id="M32"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mtext>Var</mml:mtext></mml:mtd><mml:mtd class="align-2"><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>&#x000e2;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>&#x02248;</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mtext>Cov</mml:mtext><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AGG</mml:mtext></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5556_Article_Equp.gif" position="anchor"/></alternatives></disp-formula></p></sec></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>FET</term><def><p>Fisher&#x02019;s exact test</p></def></def-item><def-item><term>LCL</term><def><p>Lymphoblastoid cell line</p></def></def-item><def-item><term>MPRA</term><def><p>Massively parallel reporter assay</p></def></def-item></def-list></glossary><ack><title>Acknowledgements</title><p>The authors would like to thank Michael Ziller for sharing his insights.</p><sec id="d29e6107"><title>Funding</title><p>Research reported in this publication was supported by the National Cancer Institute and the National Institute of General Medical Sciences of the National Institutes of Health under award numbers U24CA180996 and R01GM121459. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.</p></sec><sec id="d29e6112" sec-type="data-availability"><title>Availability of data and material</title><p>The mpralm method described here is implemented in the <italic>mpra</italic> package for R on the Bioconductor repository [<xref ref-type="bibr" rid="CR25">25</xref>].</p><p>All of the data used in this study are available on GEO. The Tewhey data is available under GSE75661, Inoue data under GSE83894, Melnikov data under GSE31982, Kheradpour data under GSE33367, Shen data under GSE68247, and Ulirsch data under GSE87711.</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>LM and KDH developed the mpralm method and conceived the evaluations. LM carried out the analyses and evaluations. DA and LG provided guidance for handling allelic studies. All authors contributed to writing the manuscript. All authors read and approved the final manuscript.</p></notes><notes notes-type="COI-statement"><sec><title>Ethics approval and consent to participate</title><p>Not applicable.</p></sec><sec><title>Consent for publication</title><p>Not applicable.</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Publisher&#x02019;s Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>MA</given-names></name></person-group><article-title>Understanding how cis-regulatory function is encoded in DNA sequence using massively parallel reporter assays and designed sequences</article-title><source>Genomics</source><year>2015</year><volume>106</volume><fpage>165</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1016/j.ygeno.2015.06.003</pub-id><pub-id pub-id-type="pmid">26072432</pub-id></element-citation></ref><ref id="CR2"><label>2</label><mixed-citation publication-type="other">Melnikov A, Zhang X, Rogov P, Wang L, Mikkelsen TS. Massively parallel reporter assays in cultured mammalian cells. J Vis Exp. 2014. 10.3791/51719.</mixed-citation></ref><ref id="CR3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grossman</surname><given-names>SR</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Engreitz</surname><given-names>J</given-names></name><name><surname>Melnikov</surname><given-names>A</given-names></name><name><surname>Rogov</surname><given-names>P</given-names></name><name><surname>Tewhey</surname><given-names>R</given-names></name><name><surname>Isakova</surname><given-names>A</given-names></name><name><surname>Deplancke</surname><given-names>B</given-names></name><name><surname>Bernstein</surname><given-names>BE</given-names></name><name><surname>Mikkelsen</surname><given-names>TS</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name></person-group><article-title>Systematic dissection of genomic features determining transcription factor binding and enhancer function</article-title><source>PNAS</source><year>2017</year><volume>114</volume><fpage>1291</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1073/pnas.1621150114</pub-id></element-citation></ref><ref id="CR4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maricque</surname><given-names>BB</given-names></name><name><surname>Dougherty</surname><given-names>J</given-names></name><name><surname>Cohen</surname><given-names>BA</given-names></name></person-group><article-title>A genome-integrated massively parallel reporter assay reveals DNA sequence determinants of cis-regulatory activity in neural cells</article-title><source>Nucleic Acids Res</source><year>2017</year><volume>45</volume><fpage>16</fpage></element-citation></ref><ref id="CR5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ernst</surname><given-names>J</given-names></name><name><surname>Melnikov</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Rogov</surname><given-names>P</given-names></name><name><surname>Mikkelsen</surname><given-names>TS</given-names></name><name><surname>Kellis</surname><given-names>M</given-names></name></person-group><article-title>Genome-scale high-resolution mapping of activating and repressive nucleotides in regulatory regions</article-title><source>Nat Biotechnol</source><year>2016</year><volume>34</volume><fpage>1180</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1038/nbt.3678</pub-id><pub-id pub-id-type="pmid">27701403</pub-id></element-citation></ref><ref id="CR6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>MA</given-names></name><name><surname>Kwasnieski</surname><given-names>JC</given-names></name><name><surname>Myers</surname><given-names>CA</given-names></name><name><surname>Shen</surname><given-names>SQ</given-names></name><name><surname>Corbo</surname><given-names>JC</given-names></name><name><surname>Cohen</surname><given-names>BA</given-names></name></person-group><article-title>A simple grammar defines activating and repressing cis-regulatory elements in photoreceptors</article-title><source>Cell Rep</source><year>2016</year><volume>5</volume><fpage>1247</fpage><lpage>54</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2016.09.066</pub-id></element-citation></ref><ref id="CR7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farley</surname><given-names>EK</given-names></name><name><surname>Olson</surname><given-names>KM</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Brandt</surname><given-names>AJ</given-names></name><name><surname>Rokhsar</surname><given-names>DS</given-names></name><name><surname>Levine</surname><given-names>MS</given-names></name></person-group><article-title>Suboptimization of developmental enhancers</article-title><source>Science</source><year>2015</year><volume>350</volume><fpage>325</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1126/science.aac6948</pub-id><pub-id pub-id-type="pmid">26472909</pub-id></element-citation></ref><ref id="CR8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kamps-Hughes</surname><given-names>N</given-names></name><name><surname>Preston</surname><given-names>JL</given-names></name><name><surname>Randel</surname><given-names>MA</given-names></name><name><surname>Johnson</surname><given-names>EA</given-names></name></person-group><article-title>Genome-wide identification of hypoxia-induced enhancer regions</article-title><source>PeerJ</source><year>2015</year><volume>3</volume><fpage>1527</fpage><pub-id pub-id-type="doi">10.7717/peerj.1527</pub-id></element-citation></ref><ref id="CR9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mogno</surname><given-names>I</given-names></name><name><surname>Kwasnieski</surname><given-names>JC</given-names></name><name><surname>Cohen</surname><given-names>BA</given-names></name></person-group><article-title>Massively parallel synthetic promoter assays reveal the in vivo effects of binding site variants</article-title><source>Genome Res</source><year>2013</year><volume>23</volume><fpage>1908</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1101/gr.157891.113</pub-id><pub-id pub-id-type="pmid">23921661</pub-id></element-citation></ref><ref id="CR10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>MA</given-names></name><name><surname>Myers</surname><given-names>CA</given-names></name><name><surname>Corbo</surname><given-names>JC</given-names></name><name><surname>Cohen</surname><given-names>BA</given-names></name></person-group><article-title>Massively parallel in vivo enhancer assay reveals that highly local features determine the cis-regulatory function of ChIP-seq peaks</article-title><source>PNAS</source><year>2013</year><volume>110</volume><issue>29</issue><fpage>11952</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1073/pnas.1307449110</pub-id><pub-id pub-id-type="pmid">23818646</pub-id></element-citation></ref><ref id="CR11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patwardhan</surname><given-names>RP</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Litvin</surname><given-names>O</given-names></name><name><surname>Young</surname><given-names>DL</given-names></name><name><surname>Pe&#x02019;er</surname><given-names>D</given-names></name><name><surname>Shendure</surname><given-names>J</given-names></name></person-group><article-title>High-resolution analysis of DNA regulatory elements by synthetic saturation mutagenesis</article-title><source>Nat Biotechnol</source><year>2009</year><volume>27</volume><fpage>1173</fpage><lpage>5</lpage><pub-id pub-id-type="doi">10.1038/nbt.1589</pub-id><pub-id pub-id-type="pmid">19915551</pub-id></element-citation></ref><ref id="CR12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Melnikov</surname><given-names>A</given-names></name><name><surname>Murugan</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Tesileanu</surname><given-names>T</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Rogov</surname><given-names>P</given-names></name><name><surname>Feizi</surname><given-names>S</given-names></name><name><surname>Gnirke</surname><given-names>A</given-names></name><name><surname>Callan</surname><given-names>CG Jr</given-names></name><name><surname>Kinney</surname><given-names>JB</given-names></name><name><surname>Kellis</surname><given-names>M</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><name><surname>Mikkelsen</surname><given-names>TS</given-names></name></person-group><article-title>Systematic dissection and optimization of inducible enhancers in human cells using a massively parallel reporter assay</article-title><source>Nat Biotechnol</source><year>2012</year><volume>30</volume><fpage>271</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1038/nbt.2137</pub-id><pub-id pub-id-type="pmid">22371084</pub-id></element-citation></ref><ref id="CR13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patwardhan</surname><given-names>RP</given-names></name><name><surname>Hiatt</surname><given-names>JB</given-names></name><name><surname>Witten</surname><given-names>DM</given-names></name><name><surname>Kim</surname><given-names>MJ</given-names></name><name><surname>Smith</surname><given-names>RP</given-names></name><name><surname>May</surname><given-names>D</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Andrie</surname><given-names>JM</given-names></name><name><surname>Lee</surname><given-names>S-I</given-names></name><name><surname>Cooper</surname><given-names>GM</given-names></name><name><surname>Ahituv</surname><given-names>N</given-names></name><name><surname>Pennacchio</surname><given-names>LA</given-names></name><name><surname>Shendure</surname><given-names>J</given-names></name></person-group><article-title>Massively parallel functional dissection of mammalian enhancers in vivo</article-title><source>Nat Biotechnol</source><year>2012</year><volume>30</volume><fpage>265</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1038/nbt.2136</pub-id><pub-id pub-id-type="pmid">22371081</pub-id></element-citation></ref><ref id="CR14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kwasnieski</surname><given-names>JC</given-names></name><name><surname>Mogno</surname><given-names>I</given-names></name><name><surname>Myers</surname><given-names>CA</given-names></name><name><surname>Corbo</surname><given-names>JC</given-names></name><name><surname>Cohen</surname><given-names>BA</given-names></name></person-group><article-title>Complex effects of nucleotide variants in a mammalian cis-regulatory element</article-title><source>PNAS</source><year>2012</year><volume>109</volume><fpage>19498</fpage><lpage>503</lpage><pub-id pub-id-type="doi">10.1073/pnas.1210678109</pub-id><pub-id pub-id-type="pmid">23129659</pub-id></element-citation></ref><ref id="CR15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kheradpour</surname><given-names>P</given-names></name><name><surname>Ernst</surname><given-names>J</given-names></name><name><surname>Melnikov</surname><given-names>A</given-names></name><name><surname>Rogov</surname><given-names>P</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Alston</surname><given-names>J</given-names></name><name><surname>Mikkelsen</surname><given-names>TS</given-names></name><name><surname>Kellis</surname><given-names>M</given-names></name></person-group><article-title>Systematic dissection of regulatory motifs in 2000 predicted human enhancers using a massively parallel reporter assay</article-title><source>Genome Res</source><year>2013</year><volume>23</volume><fpage>800</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1101/gr.144899.112</pub-id><pub-id pub-id-type="pmid">23512712</pub-id></element-citation></ref><ref id="CR16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Birnbaum</surname><given-names>RY</given-names></name><name><surname>Patwardhan</surname><given-names>RP</given-names></name><name><surname>Kim</surname><given-names>MJ</given-names></name><name><surname>Findlay</surname><given-names>GM</given-names></name><name><surname>Martin</surname><given-names>B</given-names></name><name><surname>Zhao</surname><given-names>J</given-names></name><name><surname>Bell</surname><given-names>RJA</given-names></name><name><surname>Smith</surname><given-names>RP</given-names></name><name><surname>Ku</surname><given-names>AA</given-names></name><name><surname>Shendure</surname><given-names>J</given-names></name><name><surname>Ahituv</surname><given-names>N</given-names></name></person-group><article-title>Systematic dissection of coding exons at single nucleotide resolution supports an additional role in cell-specific transcriptional regulation</article-title><source>PLoS Genet</source><year>2014</year><volume>10</volume><fpage>1004592</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1004592</pub-id></element-citation></ref><ref id="CR17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>W</given-names></name><name><surname>Pollack</surname><given-names>JL</given-names></name><name><surname>Blagev</surname><given-names>DP</given-names></name><name><surname>Zaitlen</surname><given-names>N</given-names></name><name><surname>McManus</surname><given-names>MT</given-names></name><name><surname>Erle</surname><given-names>DJ</given-names></name></person-group><article-title>Massively parallel functional annotation of 3&#x02019; untranslated regions</article-title><source>Nat Biotechnol</source><year>2014</year><volume>32</volume><fpage>387</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1038/nbt.2851</pub-id><pub-id pub-id-type="pmid">24633241</pub-id></element-citation></ref><ref id="CR18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ulirsch</surname><given-names>JC</given-names></name><name><surname>Nandakumar</surname><given-names>SK</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Giani</surname><given-names>FC</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Rogov</surname><given-names>P</given-names></name><name><surname>Melnikov</surname><given-names>A</given-names></name><name><surname>McDonel</surname><given-names>P</given-names></name><name><surname>Do</surname><given-names>R</given-names></name><name><surname>Mikkelsen</surname><given-names>TS</given-names></name><name><surname>Sankaran</surname><given-names>VG</given-names></name></person-group><article-title>Systematic functional dissection of common genetic variation affecting red blood cell traits</article-title><source>Cell</source><year>2016</year><volume>165</volume><fpage>1530</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.04.048</pub-id><pub-id pub-id-type="pmid">27259154</pub-id></element-citation></ref><ref id="CR19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tewhey</surname><given-names>R</given-names></name><name><surname>Kotliar</surname><given-names>D</given-names></name><name><surname>Park</surname><given-names>DS</given-names></name><name><surname>Liu</surname><given-names>B</given-names></name><name><surname>Winnicki</surname><given-names>S</given-names></name><name><surname>Reilly</surname><given-names>SK</given-names></name><name><surname>Andersen</surname><given-names>KG</given-names></name><name><surname>Mikkelsen</surname><given-names>TS</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><name><surname>Schaffner</surname><given-names>SF</given-names></name><name><surname>Sabeti</surname><given-names>PC</given-names></name></person-group><article-title>Direct identification of hundreds of Expression-Modulating variants using a multiplexed reporter assay</article-title><source>Cell</source><year>2016</year><volume>165</volume><issue>6</issue><fpage>1519</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.04.027</pub-id><pub-id pub-id-type="pmid">27259153</pub-id></element-citation></ref><ref id="CR20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vockley</surname><given-names>CM</given-names></name><name><surname>Guo</surname><given-names>C</given-names></name><name><surname>Majoros</surname><given-names>WH</given-names></name><name><surname>Nodzenski</surname><given-names>M</given-names></name><name><surname>Scholtens</surname><given-names>DM</given-names></name><name><surname>Hayes</surname><given-names>MG</given-names></name><name><surname>Lowe</surname><given-names>WL Jr</given-names></name><name><surname>Reddy</surname><given-names>TE</given-names></name></person-group><article-title>Massively parallel quantification of the regulatory effects of noncoding genetic variation in a human cohort</article-title><source>Genome Res</source><year>2015</year><volume>25</volume><fpage>1206</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1101/gr.190090.115</pub-id><pub-id pub-id-type="pmid">26084464</pub-id></element-citation></ref><ref id="CR21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Inoue</surname><given-names>F</given-names></name><name><surname>Kircher</surname><given-names>M</given-names></name><name><surname>Martin</surname><given-names>B</given-names></name><name><surname>Cooper</surname><given-names>GM</given-names></name><name><surname>Witten</surname><given-names>DM</given-names></name><name><surname>McManus</surname><given-names>MT</given-names></name><name><surname>Ahituv</surname><given-names>N</given-names></name><name><surname>Shendure</surname><given-names>J</given-names></name></person-group><article-title>A systematic comparison reveals substantial differences in chromosomal versus episomal encoding of enhancer activity</article-title><source>Genome Res</source><year>2017</year><volume>27</volume><fpage>38</fpage><lpage>52</lpage><pub-id pub-id-type="doi">10.1101/gr.212092.116</pub-id><pub-id pub-id-type="pmid">27831498</pub-id></element-citation></ref><ref id="CR22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>SQ</given-names></name><name><surname>Myers</surname><given-names>CA</given-names></name><name><surname>Hughes</surname><given-names>AEO</given-names></name><name><surname>Byrne</surname><given-names>LC</given-names></name><name><surname>Flannery</surname><given-names>JG</given-names></name><name><surname>Corbo</surname><given-names>JC</given-names></name></person-group><article-title>Massively parallel cis-regulatory analysis in the mammalian central nervous system</article-title><source>Genome Res</source><year>2016</year><volume>26</volume><fpage>238</fpage><lpage>55</lpage><pub-id pub-id-type="doi">10.1101/gr.193789.115</pub-id><pub-id pub-id-type="pmid">26576614</pub-id></element-citation></ref><ref id="CR23"><label>23</label><mixed-citation publication-type="other">Kalita CA, Moyerbrailean GA, Brown C, Wen X, Luca F, Pique-Regi R. QuASAR-MPRA: Accurate allele-specific analysis for massively parallel reporter assays. Bioinformatics. 2017. 10.1093/bioinformatics/btx598.</mixed-citation></ref><ref id="CR24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Law</surname><given-names>CW</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>voom: Precision weights unlock linear model analysis tools for RNA-seq read counts</article-title><source>Genome Biol</source><year>2014</year><volume>15</volume><fpage>29</fpage><pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r29</pub-id></element-citation></ref><ref id="CR25"><label>25</label><mixed-citation publication-type="other">The mpra package. <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/mpra">https://bioconductor.org/packages/mpra</ext-link>.</mixed-citation></ref><ref id="CR26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>Differential expression analysis of multifactor RNA-Seq experiments with respect to biological variation</article-title><source>Nucleic Acids Res</source><year>2012</year><volume>40</volume><fpage>4288</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1093/nar/gks042</pub-id><pub-id pub-id-type="pmid">22287627</pub-id></element-citation></ref><ref id="CR27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marioni</surname><given-names>JC</given-names></name><name><surname>Mason</surname><given-names>CE</given-names></name><name><surname>Mane</surname><given-names>SM</given-names></name><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Gilad</surname><given-names>Y</given-names></name></person-group><article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title><source>Genome Res</source><year>2008</year><volume>18</volume><fpage>1509</fpage><lpage>17</lpage><pub-id pub-id-type="doi">10.1101/gr.079558.108</pub-id><pub-id pub-id-type="pmid">18550803</pub-id></element-citation></ref><ref id="CR28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bullard</surname><given-names>JH</given-names></name><name><surname>Purdom</surname><given-names>E</given-names></name><name><surname>Hansen</surname><given-names>KD</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name></person-group><article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title><source>BMC Bioinformatics</source><year>2010</year><volume>11</volume><fpage>94</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-11-94</pub-id><pub-id pub-id-type="pmid">20167110</pub-id></element-citation></ref><ref id="CR29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>edger: a bioconductor package for differential expression analysis of digital gene expression data</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>139</fpage><lpage>40</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id><pub-id pub-id-type="pmid">19910308</pub-id></element-citation></ref><ref id="CR30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name><name><surname>Anders</surname><given-names>S</given-names></name></person-group><article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title><source>Genome Biol</source><year>2014</year><volume>15</volume><fpage>550</fpage><pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id><pub-id pub-id-type="pmid">25516281</pub-id></element-citation></ref><ref id="CR31"><label>31</label><mixed-citation publication-type="other">Phipson B. Empirical bayes modelling of expression profiles and their associations. 2013. PhD thesis, University of Melbourne.</mixed-citation></ref><ref id="CR32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gisselbrecht</surname><given-names>SS</given-names></name><name><surname>Barrera</surname><given-names>LA</given-names></name><name><surname>Porsch</surname><given-names>M</given-names></name><name><surname>Aboukhalil</surname><given-names>A</given-names></name><name><surname>Estep</surname><given-names>PW 3rd</given-names></name><name><surname>Vedenko</surname><given-names>A</given-names></name><name><surname>Palagi</surname><given-names>A</given-names></name><name><surname>Kim</surname><given-names>Y</given-names></name><name><surname>Zhu</surname><given-names>X</given-names></name><name><surname>Busser</surname><given-names>BW</given-names></name><name><surname>Gamble</surname><given-names>CE</given-names></name><name><surname>Iagovitina</surname><given-names>A</given-names></name><name><surname>Singhania</surname><given-names>A</given-names></name><name><surname>Michelson</surname><given-names>AM</given-names></name><name><surname>Bulyk</surname><given-names>ML</given-names></name></person-group><article-title>Highly parallel assays of tissue-specific enhancers in whole drosophila embryos</article-title><source>Nat Methods</source><year>2013</year><volume>10</volume><fpage>774</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2558</pub-id><pub-id pub-id-type="pmid">23852450</pub-id></element-citation></ref><ref id="CR33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smyth</surname><given-names>GK</given-names></name><name><surname>Michaud</surname><given-names>J</given-names></name><name><surname>Scott</surname><given-names>HS</given-names></name></person-group><article-title>Use of within-array replicate spots for assessing differential expression in microarray experiments</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>2067</fpage><lpage>75</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bti270</pub-id><pub-id pub-id-type="pmid">15657102</pub-id></element-citation></ref></ref-list></back></article>