<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="brief-report"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6524403</article-id><article-id pub-id-type="pmid">30124794</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/bty695</article-id><article-id pub-id-type="publisher-id">bty695</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Notes</subject><subj-group subj-group-type="category-toc-heading"><subject>Sequence Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>Genome Detective: an automated system for virus identification from high-throughput sequencing data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Vilsker</surname><given-names>Michael</given-names></name><xref ref-type="aff" rid="bty695-aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Moosa</surname><given-names>Yumna</given-names></name><xref ref-type="aff" rid="bty695-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Nooij</surname><given-names>Sam</given-names></name><xref ref-type="aff" rid="bty695-aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Fonseca</surname><given-names>Vagner</given-names></name><xref ref-type="aff" rid="bty695-aff2">2</xref><xref ref-type="aff" rid="bty695-aff4">4</xref><xref ref-type="aff" rid="bty695-aff5">5</xref></contrib><contrib contrib-type="author"><name><surname>Ghysens</surname><given-names>Yoika</given-names></name><xref ref-type="aff" rid="bty695-aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Dumon</surname><given-names>Korneel</given-names></name><xref ref-type="aff" rid="bty695-aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Pauwels</surname><given-names>Raf</given-names></name><xref ref-type="aff" rid="bty695-aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Alcantara</surname><given-names>Luiz Carlos</given-names></name><xref ref-type="aff" rid="bty695-aff4">4</xref><xref ref-type="aff" rid="bty695-aff5">5</xref><xref ref-type="aff" rid="bty695-aff6">6</xref></contrib><contrib contrib-type="author"><name><surname>Vanden Eynden</surname><given-names>Ewout</given-names></name><xref ref-type="aff" rid="bty695-aff7">7</xref></contrib><contrib contrib-type="author"><name><surname>Vandamme</surname><given-names>Anne-Mieke</given-names></name><xref ref-type="aff" rid="bty695-aff7">7</xref><xref ref-type="aff" rid="bty695-aff8">8</xref></contrib><contrib contrib-type="author"><name><surname>Deforche</surname><given-names>Koen</given-names></name><xref ref-type="aff" rid="bty695-aff1">1</xref><xref ref-type="corresp" rid="bty695-cor1"/><!--<email>koen@emweb.be</email>--></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-3027-5254</contrib-id><name><surname>de Oliveira</surname><given-names>Tulio</given-names></name><xref ref-type="aff" rid="bty695-aff2">2</xref><xref ref-type="corresp" rid="bty695-cor1"/><!--<email>deoliveira@ukzn.ac.za</email>--></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name><surname>Birol</surname><given-names>Inanc</given-names></name><role>Associate Editor</role></contrib></contrib-group><aff id="bty695-aff1"><label>1</label>Emweb bvba, Herent, Belgium</aff><aff id="bty695-aff2"><label>2</label>KwaZulu-Natal Research Innovation and Sequencing Platform (KRISP), School of Laboratory Medicine and Medical Sciences, Nelson R Mandela School of Medicine, College of Health Sciences, University of KwaZulu-Natal, Durban, South Africa</aff><aff id="bty695-aff3"><label>3</label>The Dutch National Institute for Public Health and the Environment (RIVM), Bilthoven, The Netherlands</aff><aff id="bty695-aff4"><label>4</label>Instituto de Ci&#x000ea;ncias Biol&#x000f3;gicas, Universidade Federal de Minas Gerais, Belo Horizonte, MG, Brazil</aff><aff id="bty695-aff5"><label>5</label>Laboratory of Hematology Genetic and computational Biology, Goncalo Moniz Research Center, Oswaldo Cruz Foundation (LHGB/CPqGM/FIOCRUZ), Bahia, Brazil</aff><aff id="bty695-aff6"><label>6</label>Laborat&#x000f3;rio de Flaviv&#x000ed;rus, IOC, Funda&#x000e7;&#x000e3;o Oswaldo Cruz</aff><aff id="bty695-aff7"><label>7</label>KU Leuven, Department of Microbiology and Immunology, Rega Institute for Medical Research, Clinical and Epidemiological Virology, Leuven, Belgium</aff><aff id="bty695-aff8"><label>8</label>Center for Global Health and Tropical Medicine, Unidade de Microbiologia, Instituto de Higiene e Medicina Tropical, Universidade Nova de Lisboa, Lisbon, Portugal</aff><author-notes><corresp id="bty695-cor1">To whom correspondence should be addressed. <email>koen@emweb.be</email> or <email>deoliveira@ukzn.ac.za</email></corresp></author-notes><pub-date pub-type="ppub"><day>01</day><month>3</month><year>2019</year></pub-date><pub-date pub-type="epub" iso-8601-date="2018-08-16"><day>16</day><month>8</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>16</day><month>8</month><year>2018</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>35</volume><issue>5</issue><fpage>871</fpage><lpage>873</lpage><history><date date-type="received"><day>04</day><month>4</month><year>2018</year></date><date date-type="rev-recd"><day>09</day><month>7</month><year>2018</year></date><date date-type="accepted"><day>14</day><month>8</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2018. Published by Oxford University Press.</copyright-statement><copyright-year>2018</copyright-year><license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:href="bty695.pdf"/><abstract><title>Abstract</title><sec id="s1"><title>Summary</title><p>Genome Detective is an easy to use web-based software application that assembles the genomes of viruses quickly and accurately. The application uses a novel alignment method that constructs genomes by reference-based linking of <italic>de novo</italic> contigs by combining amino-acids and nucleotide scores. The software was optimized using synthetic datasets to represent the great diversity of virus genomes. The application was then validated with next generation sequencing data of hundreds of viruses. User time is minimal and it is limited to the time required to upload the data.</p></sec><sec id="s2"><title>Availability and implementation</title><p>Available online: <ext-link ext-link-type="uri" xlink:href="http://www.genomedetective.com/app/typingtool/virus/">http://www.genomedetective.com/app/typingtool/virus/</ext-link>.</p></sec><sec id="s3"><title>Supplementary information</title><p>
<xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p></sec></abstract><funding-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">South African Medical Research Council</named-content><named-content content-type="funder-identifier">10.13039/501100001322</named-content></funding-source><award-id>MRC-RFA-UFSP-01-2013/UKZN HIVEPI</award-id></award-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">Royal Society Newton Advanced Fellowship</named-content></funding-source></award-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">European Union&#x02019;s Horizon 2020 Research and Innovation Program</named-content></funding-source><award-id>634650</award-id></award-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">National Institutes of Health Common Fund</named-content></funding-source><award-id>U24HG006941</award-id></award-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">National Institutes of Health</named-content><named-content content-type="funder-identifier">10.13039/100000002</named-content></funding-source></award-group></funding-group><counts><page-count count="3"/></counts></article-meta></front><body><sec><title>1 Introduction</title><p>In the rapidly expanding field of genomics, our ability to produce data far exceeds our capacity to analyze and extract meaningful information. Analysis of viral data is particularly challenging given the high variability of viruses and their deviation from reference genomes, the increasing speed of identification, the continuous emergence of new viruses and the relative scarcity of viral fragments in metagenomic samples (<xref rid="bty695-B13" ref-type="bibr">Rose <italic>et al.</italic>, 2016</xref>).</p><p>The quality of available tools varies and most require specialized computing skills and access to powerful hardware in order to analyze next generation sequencing (NGS) data and/or high-throughput Sanger data. In response to this need, we have developed Genome Detective, a web-based bioinformatics pipeline to accurately and quickly identify, assemble and classify all known viruses present in NGS and Sanger sequencing data.</p></sec><sec><title>2 Systems and methods</title><p>Genome Detective accepts unprocessed paired-end or single reads generated by NGS platforms in FASTQ format and/or processed FASTA sequences. For FASTQ files, low-quality reads are filtered and adapters trimmed with Trimmomatic (<xref rid="bty695-B2" ref-type="bibr">Bolger <italic>et al.</italic>, 2014</xref>). The quality of the reads is visualized using FastQC (<xref rid="bty695-B3" ref-type="bibr">Brown <italic>et al.</italic>, 2017</xref>) before and after trimming. Candidate viral reads are identified using the protein-based alignment method DIAMOND (<xref rid="bty695-B4" ref-type="bibr">Buchfink <italic>et al.</italic>, 2015</xref>). We used the viral subset of the Swissprot UniRef90 protein database, which contains representative clusters of proteins linked to taxonomy IDs, to improve sensitivity and speed. The Swissprot UniRef90 is constantly updated and at the time of the submission of this paper, the viral subset of this database contained 494&#x02009;134 protein clusters. At the same time, also the NCBI RefSeq database is constantly updated, and at the time of the submission of this paper, the viral subset of this database contained 7560 unique taxonomic IDs. Genome Detective has an automated procedure to download new versions of the reference databases and the current version and the number of viral taxonomy IDs identified are shown on the interface.</p><p>The speed and accuracy of Genome Detective was also improved by first sorting short reads into groups, or buckets. Our objective was to run a separate metagenomic <italic>de novo</italic> assembly in each bucket, so all reads of one virus species needed to be assigned to the same bucket. Each bucket is then identified using the taxonomy ID of the lowest common ancestor (LCA) of the hits identified by DIAMOND. However, some reads that represented the same viral species were assigned to buckets at different taxonomic ranks. We solved this problem by either distributing the reads from the node downwards, or collapsing them upwards, by comparing the number of reads identified at each node of the taxonomy tree versus in all descendant nodes. In addition, given that metagenomic studies are accelerating (reviewed in <xref rid="bty695-B13" ref-type="bibr">Rose <italic>et al.</italic>, 2016</xref>), an increasing number of reference sequences are of novel viruses that have not yet been classified. This causes the LCA taxonomy ID to be unspecific for a number of Uniref clusters, and in the analysis of hits identified by DIAMOND. To avoid these problems, while retaining the sequence themselves, we excluded the taxonomic classification of these viruses in LCA algorithms.</p><p>Once all of the reads have been sorted in buckets, each bucket is then <italic>de novo</italic> assembled separately using SPAdes (<xref rid="bty695-B1" ref-type="bibr">Bankevich <italic>et al.</italic>, 2012</xref>) for single-ended reads or metaSPAdes (<xref rid="bty695-B1" ref-type="bibr">Bankevich <italic>et al.</italic>, 2012</xref>) for paired-end reads. Blastx and Blastn are used to search for candidate reference sequences against the NCBI RefSeq virus database. Genome Detective combines the results for every detected contig at amino acid and nucleotide (nt) level with by calculating a total score that is a sum of the total nt score plus total amino acid score. We then chose the five best scoring references for each contig to be used during the alignment.</p><p>The contigs for each individual species are joined using Advanced Genome Aligner (AGA) (<xref rid="bty695-B6" ref-type="bibr">Deforche, 2017</xref>), which is a new dynamic programing algorithm. AGA is designed to compute the optimal global alignment considering simultaneously the alignment of all annotated coding sequences of a reference genome. AGA builds further on the optimal alignment algorithms first proposed by Needleman&#x02013;Wunsch (<xref rid="bty695-B14" ref-type="bibr">Smith and Waterman, 1981</xref>), Smith&#x02013;Waterman (<xref rid="bty695-B14" ref-type="bibr">Smith and Waterman, 1981</xref>) and Gotoh (<xref rid="bty695-B7" ref-type="bibr">Gotoh, 1982</xref>), by expanding the induction state with additional state parameters. This makes alignments using AGA, and therefore Genome Detective, more sensitive and accurate as both nt and protein scores are taken into account in order to produce a consensus sequence from the <italic>de novo</italic> contigs.</p><p>A report is generated, referring to the final contigs and consensus sequences, available as FASTA files. The report also contains detailed information on filtering, assemblage and consensus sequence. Web-based (using the JWt libraries) graphics are available for viral species, genome images, alignment viewer, nt and amino acid similarity measures and read counts. In addition, the user can produce a bam file with BWA (<xref rid="bty695-B9" ref-type="bibr">Li and Durbin, 2009</xref>) using the reference or <italic>de novo</italic> consensus sequence by selecting the detailed report (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>) and access viral phylogenetic identification tools (<xref rid="bty695-B5" ref-type="bibr">de Oliveira <italic>et al.</italic>, 2005</xref>) directly from the interface.</p></sec><sec><title>3 Testing and validation</title><p>We first validated Genome Detective using a synthetic virus dataset (NCBI SRA: SRR3458562-SRR3458569), originally prepared to optimize laboratory-based virus extraction procedures, in which viruses were carefully selected to cover the range of naturally occurring diversity (<xref rid="bty695-B100" ref-type="bibr">Concei&#x000e7;&#x000e3;o-Neto <italic>et al.</italic>, 2015</xref>). This published dataset also includes carefully validated quantitative results, confirmed with quantitative PCR. Genome Detective identified all of the viruses in the synthetic dataset. We then validated Genome Detective with real clinical datasets. In total, we analyzed 208 datasets, which are available via Sequence Read Archive (SRA) or the European Nucleotide Archive. We then compared our results to the published results and found a&#x02009;&#x0003e;95% concordance, successfully identifying 257 viral species (<xref rid="bty695-T1" ref-type="table">Table&#x000a0;1</xref> and <xref ref-type="supplementary-material" rid="sup2">Supplementary Table</xref>). These included single viruses with unsegmented (HIV) and segmented genomes (Influenza A, Rotavirus, MERS) from amplicon-based NGS sequenced as well as unbiased metagenomic datasets (<xref rid="bty695-T1" ref-type="table">Table&#x000a0;1</xref>). Overall, precision, sensitivity and specificity were high, with the exception of 20 metagenomic datasets from human fecal (ERR233412-ERR233431), which had scarce viral reads (<xref ref-type="supplementary-material" rid="sup2">Supplementary Table</xref>).
<table-wrap id="bty695-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Validation datasets</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Publication</th><th align="left" rowspan="1" colspan="1">PMID</th><th align="left" rowspan="1" colspan="1">Description</th><th align="left" rowspan="1" colspan="1">Number of datasets</th><th align="left" rowspan="1" colspan="1">Expected number of viruses</th><th align="left" rowspan="1" colspan="1">Assigned number of viruses</th><th align="left" rowspan="1" colspan="1">Average reconstructed genome size (%)</th><th align="left" rowspan="1" colspan="1">Number of additional viruses</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">26&#x000a0;559&#x000a0;140</td><td rowspan="1" colspan="1">Synthetic virome</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">64</td><td rowspan="1" colspan="1">57</td><td rowspan="1" colspan="1">92</td><td rowspan="1" colspan="1">9</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">Pending (bioRxiv)</td><td rowspan="1" colspan="1">Single virus&#x02014;HIV</td><td rowspan="1" colspan="1">14</td><td rowspan="1" colspan="1">13</td><td rowspan="1" colspan="1">13</td><td rowspan="1" colspan="1">93</td><td rowspan="1" colspan="1">1</td></tr><tr><td rowspan="1" colspan="1">Unpublished</td><td rowspan="1" colspan="1">PRJNA434&#x000a0;385 (SRA)</td><td rowspan="1" colspan="1">Single virus&#x02014;HIV</td><td rowspan="1" colspan="1">94</td><td rowspan="1" colspan="1">94</td><td rowspan="1" colspan="1">94</td><td rowspan="1" colspan="1">95</td><td rowspan="1" colspan="1">15</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">25&#x000a0;609&#x000a0;811</td><td rowspan="1" colspan="1">Single virus&#x02014;RSV</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">98</td><td rowspan="1" colspan="1">1</td></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">25&#x000a0;056&#x000a0;894</td><td rowspan="1" colspan="1">Single virus&#x02014;norovirus</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">99</td><td rowspan="1" colspan="1">7</td></tr><tr><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">26&#x000a0;071&#x000a0;329</td><td rowspan="1" colspan="1">Single virus&#x02014;influenza</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">10 (80 segments)</td><td rowspan="1" colspan="1">94</td><td rowspan="1" colspan="1">26</td></tr><tr><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">24&#x000a0;055&#x000a0;451</td><td rowspan="1" colspan="1">Single virus&#x02014;MERS</td><td rowspan="1" colspan="1">14</td><td rowspan="1" colspan="1">14</td><td rowspan="1" colspan="1">14</td><td rowspan="1" colspan="1">94</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">28&#x000a0;748&#x000a0;110</td><td rowspan="1" colspan="1">Metagenomic&#x02014;pig fecal</td><td rowspan="1" colspan="1">20</td><td rowspan="1" colspan="1">20</td><td rowspan="1" colspan="1">20 (220 segments)</td><td rowspan="1" colspan="1">90</td><td rowspan="1" colspan="1">143</td></tr><tr><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">24&#x000a0;695&#x000a0;106</td><td rowspan="1" colspan="1">Metagenomic&#x02014;human fecal</td><td rowspan="1" colspan="1">20</td><td rowspan="1" colspan="1">66</td><td rowspan="1" colspan="1">25</td><td rowspan="1" colspan="1">83</td><td rowspan="1" colspan="1">35</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"><bold>&#x02014;</bold></td><td rowspan="1" colspan="1"><bold>&#x02014;</bold></td><td rowspan="1" colspan="1"><bold>204</bold></td><td rowspan="1" colspan="1"><bold>305</bold></td><td rowspan="1" colspan="1"><bold>257</bold></td><td rowspan="1" colspan="1"><bold>&#x02014;</bold></td><td rowspan="1" colspan="1"><bold>237</bold></td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p><italic>Note</italic>: For the validation of Genome Detective (GD) we used 204 datasets from seven studies. This table lists the PMID of the publications, a description of the data, number of datasets, number of viruses originally identified, number of viruses for which GD reconstructed whole genomes (i.e. &#x0003e;80% of the whole genome <bold><underline>and high NT/AA score</underline></bold>) and number of viruses that GD additionally detected (<bold>i.e. &#x0003c;80% of the whole genome <underline>or low NT/AA score</underline></bold>). Detailed information such as (SRA files list and full results are seem in <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p></fn></table-wrap-foot></table-wrap></p><p>We compared our assignment results with IVA (<xref rid="bty695-B8" ref-type="bibr">Hunt <italic>et al.</italic>, 2015</xref>) and with drVM (<xref rid="bty695-B11" ref-type="bibr">Lin and Liao, 2017</xref>), which is a new and accurate method for efficient genome assembly of viruses. When the HIV-1 runs were compared with IVA, our web-based application reduced the processing time needed for assembling whole viral genomes by a factor of 10 (10&#x02013;500-fold) and provided longer and more accurate contigs. In order to compare our results with drVM, we used five datasets (SRR1170797, SRR1106548, DRR049387, SRR062073 and ERR690519). These were the same datasets that the authors of drVM used to compare with three other similar tools, SURPI (<xref rid="bty695-B12" ref-type="bibr">Naccache <italic>et al.</italic>, 2014</xref>), VIP (<xref rid="bty695-B10" ref-type="bibr">Li <italic>et al.</italic>, 2016</xref>) and VirusTap (<xref rid="bty695-B15" ref-type="bibr">Yamashita <italic>et al.</italic>, 2016</xref>). We found that, in general, Genome Detective creates longer, more accurate contigs than drVM, SURPI, VIP and VirusTap. In addition, Genome Detective speed is similar or faster than the four other mentioned tools (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). For example, we assembled a near complete genome (length 8.334&#x000a0;bp) of HIV-1 (SRR1106548) in 430&#x000a0;s, whereas VirusTap identified a 2.896&#x000a0;bp contig in 1.388&#x000a0;s and drVM identified a 3.005&#x000a0;bp segment in 608&#x000a0;s. For the Rotavirus reads (DRR049387), Genome Detective identified all of the 11 segments of Rotavirus A (segment 1&#x02013;11) in one contig, each covering 97&#x02013;100% of each segment, whereas rdVM identified only 7 segments from 13 contigs. The time for this run in Genome Detective was 440 versus 464&#x000a0;s of drVM (<xref rid="bty695-B11" ref-type="bibr">Lin and Liao, 2017</xref>). For Influenza A virus (ERR690519), we identified the same eight segments as drVM in less than half of the time (<xref ref-type="supplementary-material" rid="sup2">Supplementary Table S3</xref>).</p></sec><sec><title>4 Discussion</title><p>Genome Detective was developed to generate and analyze whole or partial viral genomes directly from NGS reads within minutes. Speed and accuracy were gained by using DIAMOND with a UniProt90 reference dataset to sort viral taxonomy units. The use of DIAMOND and UniRef90 allowed Genome Detective to identify viral short reads at least 1000 times faster than if we used Blastn and the viral nt database of NCBI (<xref rid="bty695-B4" ref-type="bibr">Buchfink <italic>et al.</italic>, 2015</xref>). Accuracy was also gained by joining contigs with a novel alignment method that uses amino acids and nt scores to create <italic>de novo</italic> contigs. Despite the use of only RefSeq for the identification of virus species, sensitivity and specificity were maintained due to the use of both nt and amino acid similarity scores. We found that for large NGS and metagenomic datasets, Virus Detective substantially reduces computational cost without compromising the quality of the result. However, the construction of <italic>de novo</italic> whole genomes from metagenomic samples depends on the number of reads, the virus genome size and read length. Our pipeline also allows detailed displays of data and results. Furthermore, Genome Detective is linked to our popular virus-specific typing tools (&#x0003e;3 million submissions, <xref rid="bty695-B5" ref-type="bibr">de Oliveira <italic>et al.</italic>, 2005</xref>), which allow phylogenetic classification below species level. User time is minimal; it is limited to the time required to upload the data. In conclusion, Genome Detective is a web-based pipeline that allows raw NGS data to be assembled into <italic>de novo</italic> complete viral genomes in a fast and accurate manner.</p></sec><sec><title>Funding</title><p>Supported by a research Flagship grant from the South African Medical Research Council (MRC-RFA-UFSP-01-2013/UKZN HIVEPI), a Royal Society Newton Advanced Fellowship (TdO), the VIROGENESIS project receives funding from the European Union&#x02019;s Horizon 2020 Research and Innovation Program (under Grant Agreement no. 634650) and the National Institutes of Health Common Fund, grant number U24HG006941. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health. We would like to acknowledge the contribution of Annelies Kroneman, Harry Vennema, Roel Standaert, Pieter Libin and Kristof Theys.</p><p>
<italic>Conflict of Interest</italic>: none declared.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="sup1"><label>Supplementary Information</label><media xlink:href="bty695_supplementary_information.docx"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="sup2"><label>Supplementary Table</label><media xlink:href="bty695_supplementary_table.xlsx"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ref-list id="ref1"><title>References</title><ref id="bty695-B1"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Bankevich</surname><given-names>A.</given-names></name></person-group>
<etal>et al</etal> (<year>2012</year>) 
<article-title>SPAdes: a new genome assembly algorithm and its applications to single-cell sequencing</article-title>. <source>J. Comput. Biol</source>., <volume>19</volume>, <fpage>455</fpage>&#x02013;<lpage>477</lpage>.<pub-id pub-id-type="pmid">22506599</pub-id></mixed-citation></ref><ref id="bty695-B2"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Bolger</surname><given-names>A.M.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>2114</fpage>&#x02013;<lpage>2120</lpage>.<pub-id pub-id-type="pmid">24695404</pub-id></mixed-citation></ref><ref id="bty695-B3"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>J.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>FQC Dashboard: integrates FastQC results into a web-based, interactive, and extensible FASTQ quality control tool</article-title>. <source>Bioinformatics</source>., <volume>33</volume>, <fpage>3137</fpage>&#x02013;<lpage>3139</lpage>.</mixed-citation></ref><ref id="bty695-B4"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Buchfink</surname><given-names>B.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>59</fpage>&#x02013;<lpage>60</lpage>.<pub-id pub-id-type="pmid">25402007</pub-id></mixed-citation></ref><ref id="bty695-B100"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Concei&#x000e7;&#x000e3;o-Neto</surname><given-names>N.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Modular approach to customise sample preparation procedures for viral metagenomics: a reproducible protocol for virome analysis</article-title>. <source>Scientific Reports</source>, <volume>5</volume>, <fpage>16532</fpage> Retrieved from <pub-id pub-id-type="doi">10.1038/srep16532</pub-id>.<pub-id pub-id-type="pmid">26559140</pub-id></mixed-citation></ref><ref id="bty695-B5"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>de Oliveira</surname><given-names>T.</given-names></name></person-group>
<etal>et al</etal> (<year>2005</year>) 
<article-title>An automated genotyping system for analysis of HIV-1 and other microbial sequences</article-title>. <source>Bioinformatics</source>, <volume>21</volume>, <fpage>3797</fpage>&#x02013;<lpage>3800</lpage>.<pub-id pub-id-type="pmid">16076886</pub-id></mixed-citation></ref><ref id="bty695-B6"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Deforche</surname><given-names>K.</given-names></name></person-group> (<year>2017</year>) 
<article-title>An alignment method for nucleic acid sequences against annotated genomes</article-title>. doi.org/10.1101/200394.</mixed-citation></ref><ref id="bty695-B7"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Gotoh</surname><given-names>O.</given-names></name></person-group> (<year>1982</year>) 
<article-title>An improved algorithm for matching biological sequences</article-title>. <source>J. Mol. Biol</source>., <volume>162</volume>, <fpage>705</fpage>&#x02013;<lpage>708</lpage>.<pub-id pub-id-type="pmid">7166760</pub-id></mixed-citation></ref><ref id="bty695-B8"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Hunt</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>IVA: accurate de novo assembly of RNA virus genomes</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>2374</fpage>&#x02013;<lpage>2376</lpage>.<pub-id pub-id-type="pmid">25725497</pub-id></mixed-citation></ref><ref id="bty695-B9"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R.</given-names></name></person-group> (<year>2009</year>) 
<article-title>Fast and accurate short read alignment with Burrows&#x02013;Wheeler transform</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1754</fpage>&#x02013;<lpage>1760</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation></ref><ref id="bty695-B10"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>Y.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>VIP: an integrated pipeline for metagenomics of virus identification and discovery</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>23774.</fpage><pub-id pub-id-type="pmid">27026381</pub-id></mixed-citation></ref><ref id="bty695-B11"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Lin</surname><given-names>H.H.</given-names></name>, <name name-style="western"><surname>Liao</surname><given-names>Y.C.</given-names></name></person-group> (<year>2017</year>) 
<article-title>drVM: a new tool for efficient genome assembly of known eukaryotic viruses from metagenomes</article-title>. <source>Gigascience</source>, <volume>6</volume>, <fpage>1</fpage>&#x02013;<lpage>10</lpage>.</mixed-citation></ref><ref id="bty695-B12"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Naccache</surname><given-names>S.N.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>A cloud-compatible bioinformatics pipeline for ultrarapid pathogen identification from next-generation sequencing of clinical samples</article-title>. <source>Genome Res</source>., <volume>24</volume>, <fpage>1180</fpage>&#x02013;<lpage>1192</lpage>.<pub-id pub-id-type="pmid">24899342</pub-id></mixed-citation></ref><ref id="bty695-B13"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Rose</surname><given-names>R.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Challenges in the analysis of viral metagenomes</article-title>. <source>Virus Evol</source>., <volume>2</volume>, <fpage>vew022.</fpage><pub-id pub-id-type="pmid">29492275</pub-id></mixed-citation></ref><ref id="bty695-B14"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>T.F.</given-names></name>, <name name-style="western"><surname>Waterman</surname><given-names>M.S.</given-names></name></person-group> (<year>1981</year>) 
<article-title>Identification of common molecular subsequences</article-title>. <source>J. Mol. Biol</source>., <volume>147</volume>, <fpage>195</fpage>&#x02013;<lpage>197</lpage>.<pub-id pub-id-type="pmid">7265238</pub-id></mixed-citation></ref><ref id="bty695-B15"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Yamashita</surname><given-names>A.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>VirusTAP: viral genome-targeted assembly pipeline</article-title>. <source>Front. Microbiol</source>., <volume>7</volume>, <fpage>32.</fpage> [PMC free article] [PubMed]<pub-id pub-id-type="pmid">26870004</pub-id></mixed-citation></ref></ref-list></back></article>