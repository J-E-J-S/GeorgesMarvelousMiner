<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nat Commun</journal-id><journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id><journal-title-group><journal-title>Nature Communications</journal-title></journal-title-group><issn pub-type="epub">2041-1723</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6461651</article-id><article-id pub-id-type="publisher-id">9575</article-id><article-id pub-id-type="doi">10.1038/s41467-019-09575-2</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Platanus-allee is a de novo haplotype assembler enabling a comprehensive access to divergent heterozygous regions</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Kajitani</surname><given-names>Rei</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Yoshimura</surname><given-names>Dai</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Okuno</surname><given-names>Miki</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Minakuchi</surname><given-names>Yohei</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0653-2393</contrib-id><name><surname>Kagoshima</surname><given-names>Hiroshi</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Fujiyama</surname><given-names>Asao</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Kubokawa</surname><given-names>Kaoru</given-names></name><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name><surname>Kohara</surname><given-names>Yuji</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0728-7548</contrib-id><name><surname>Toyoda</surname><given-names>Atsushi</given-names></name><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6113-557X</contrib-id><name><surname>Itoh</surname><given-names>Takehiko</given-names></name><address><email>takehiko@bio.titech.ac.jp</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2179 2105</institution-id><institution-id institution-id-type="GRID">grid.32197.3e</institution-id><institution>School of Life Science and Technology, </institution><institution>Tokyo Institute of Technology, </institution></institution-wrap>Meguro-ku, Tokyo 152-8550 Japan </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0466 9350</institution-id><institution-id institution-id-type="GRID">grid.288127.6</institution-id><institution>Comparative Genomics Laboratory, National Institute of Genetics, </institution></institution-wrap>Mishima, Shizuoka 411-8540 Japan </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0466 9350</institution-id><institution-id institution-id-type="GRID">grid.288127.6</institution-id><institution>Advanced Genomics Center, National Institute of Genetics, </institution></institution-wrap>Mishima, Shizuoka 411-8540 Japan </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2151 536X</institution-id><institution-id institution-id-type="GRID">grid.26999.3d</institution-id><institution>Ocean Alliance, </institution><institution>The University of Tokyo, </institution></institution-wrap>Bunkyo-ku, Tokyo 113-0033 Japan </aff></contrib-group><pub-date pub-type="epub"><day>12</day><month>4</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>12</day><month>4</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>10</volume><elocation-id>1702</elocation-id><history><date date-type="received"><day>23</day><month>7</month><year>2018</year></date><date date-type="accepted"><day>19</day><month>3</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">The ultimate goal for diploid genome determination is to completely decode homologous chromosomes independently, and several phasing programs from consensus sequences have been developed. These methods work well for lowly heterozygous genomes, but the manifold species have high heterozygosity. Additionally, there are highly divergent regions (HDRs), where the haplotype sequences differ considerably. Because HDRs are likely to direct various interesting biological phenomena, many genomic analysis targets fall within these regions. However, they cannot be accessed by existing phasing methods, and we have to adopt costly traditional methods. Here, we develop a de novo haplotype assembler, Platanus-allee (<ext-link ext-link-type="uri" xlink:href="http://platanus.bio.titech.ac.jp/platanus2">http://platanus.bio.titech.ac.jp/platanus2</ext-link>), which initially constructs each haplotype sequence and then untangles the assembly graphs utilizing sequence links and synteny information. A comprehensive benchmark analysis reveals that Platanus-allee exhibits high recall and precision, particularly for HDRs. Using this approach, previously unknown HDRs are detected in the human genome, which may uncover novel aspects of genome variability.</p></abstract><abstract id="Abs2" abstract-type="web-summary"><p id="Par2">Most phasing programmes for sequencing data work well for genomes with low heterozygosity but drop in performance in regions of high heterozygosity. Here, Kajitani et al. develop the assembler Platanus-allee and demonstrate its utility in de novo assemblies of various genomes and the human MHC region.</p></abstract><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par3">In diploid genomes, the distribution of heterozygosity generally deviates from the Poisson distribution<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, and highly divergent regions (HDRs), in which haplotype sequences differ considerably, occasionally&#x02009;&#x0003e;&#x02009;5%, have been observed<sup><xref ref-type="bibr" rid="CR2">2</xref>&#x02013;<xref ref-type="bibr" rid="CR12">12</xref></sup>. HDRs were reported to be associated with certain biological phenomena, such as marked variations of morphs<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>, social behavior<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, speciation<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup>, sex-determining systems<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, and gametic incompatibilities in plants<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. These HDRs have been investigated employing laborious and costly procedures such as fosmid/BAC cloning and sequencing<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup> of targeted regions, Sanger/454 sequencing methods (with relatively long reads but low throughput)<sup><xref ref-type="bibr" rid="CR3">3</xref>&#x02013;<xref ref-type="bibr" rid="CR5">5</xref></sup>, analysis of many individual genomes<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR9">9</xref>&#x02013;<xref ref-type="bibr" rid="CR11">11</xref></sup> and sequencing of a trio (father, mother, and offspring)<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>.</p><p id="Par4">Whole-genome and high-throughput sequencing data were utilized as a cost-effective method in an attempt to detect variants. However, a majority of the tests of variant-detections and phasing (detection of linkages between variants) was performed primarily for the human genome with relatively rare HDRs (heterozygosity ~0.1%)<sup><xref ref-type="bibr" rid="CR14">14</xref>&#x02013;<xref ref-type="bibr" rid="CR17">17</xref></sup>.</p><p id="Par5">FALCON-Unzip<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, the phasing tool for the single-molecule DNA sequencing, succeeded in constructing haplotigs (heterozygous phased blocks) with large contig-N50 (6.92 Mbp) for <italic>Arabidopsis thaliana</italic> F1-hybrid (estimated heterozygosity, ~1%). However, the value for the more heterozygous plant, grape, was reported to decline to 0.779 Mbp. According to the supplementary analysis and surveys in ref. <sup><xref ref-type="bibr" rid="CR18">18</xref></sup>., there are certain effects to phasing performances from heterozygosity, and half of the other species surveyed (6/12) were estimated to have heterozygosities&#x02009;&#x0003e;&#x02009;1%, implying that there is room to develop versatile haplotype phasing methods.</p><p id="Par6">These observations mainly arise from the two major technical issues. First, de novo assembly itself is difficult for highly heterozygous organisms<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR3">3</xref>&#x02013;<xref ref-type="bibr" rid="CR5">5</xref></sup> when using conventional procedures. Second, read mapping-based variant detections were often hampered owing to the size of the haplotype differences, which hinders their mapping onto the assembled genome<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Due to these difficulties, it is possible that many elements in HDRs and highly heterozygous genomes were not observed in previous studies.</p><p id="Par7">Consequently, the development of a phasing tool able to handle these HDRs is an important requirement for the comprehensive survey of diploid genome diversity, and it can help reform current single nucleotide polymorphism (SNP)-centered genetic frameworks. To this end, we develop a de novo haplotype assembler, Platanus-allee, which constructs each haplotype in a diploid genome independently without conventional procedures of consensus-sequence assembly and variant-calling. Benchmarks targeting the organisms with the wide-range of heterozygosities (0.1&#x02013;3.5%) illustrates the versatility of this tool and its advantage to assemble haplotypes of HDRs.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><sec id="Sec3"><title>Development of Platanus-allee</title><p id="Par8">The basic algorithm of Platanus-allee is based on the arrangement of two independently assembled sequences derived from each haplotype of the corresponding two homologous chromosomes (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1a</xref>), in contrast to the most haplotype assemblers, which try to split the consensus sequences into two homologous regions (for details, Supplementary Note&#x000a0;<xref rid="MOESM1" ref-type="media">7</xref>). These concepts were mainly realized by adding the information of de Bruijn graphs<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> to the following two modules: scaffolding and gap-closing modules of the Platanus genome assembler<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. The feature of Platanus-allee is that it never constructs consensus sequences by multiple alignment or removal of one side of bubble structures in graphs before finishing phasing.<fig id="Fig1"><label>Fig. 1</label><caption><p>Platanus-allee algorithm. (<bold>a</bold>) Schematic model of the concept of phasing and haplotype synteny-based assembly. (<bold>b</bold>) Workflow</p></caption><graphic xlink:href="41467_2019_9575_Fig1_HTML" id="d29e458"/></fig></p><p id="Par9">Platanus-allee exactly distinguishes the <italic>k</italic>-mers in reads (typically, <italic>k</italic>&#x02009;&#x0003e;&#x02009;100 at the final step of contig-assembly), possibly reducing the number of errors that occurred in the omitted steps. To apply this function, accurate reads with low error rate (&#x0003c;1%) are essential. Currently, the suitable data type is the Illumina short-reads and Platanus-allee is designed to primarily use these data. Long-reads with high error rate (&#x0003e;10%) can be optionally utilized in the downstream steps. The assembly step of Platanus-allee is supported by the following two strategies: (1) untangling complex graph structures and (2) skipping difficult regions by scaffolding. The former can generate gap-less sequences but may be hindered from extending by complex and repetitive regions, in contrary to the latter. The two complementary functions are iteratively applied to long and gap-less phased blocks (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1b</xref>).</p><p id="Par10">Platanus-allee requires at least one library from the Illumina sequencer and can exploit mate-pair (jumping) libraries, linked-reads<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> (barcoded reads from long DNA fragments, 10X Genomics), and single-molecule long reads (Pacific Biosciences (PacBio) or Oxford Nanopore, utilizing Minimap2<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>). Note that, although Illumina reads are short compared to single-molecule reads, their accuracy (&#x0003e;99% for each base) may help to effectively distinguish homologous haplotypes in some cases. Essentially, Platanus-allee is a hybrid assembler that primarily uses the accurate short-reads and can combine other types of libraries to enhance performances.</p><p id="Par11">Initially, Platanus-allee attempts to untangle cross structures, such as X-like forms, using link information from single reads, paired-ends (PEs), mate-pairs (MPs), and linked-reads mapped to both de Bruijn and scaffold graphs. The cross structure consists of one central node and four remaining nodes possibly representing a homozygous sequence and heterozygous sequences, respectively. When there is adequate link information between the heterozygous nodes, the duplication of the central node and the assembly of two sequences (untangling) correspond to the phasing of heterozygous variants (see &#x0201c;Methods&#x0201d;&#x000a0;section). The untangling processes are iteratively executed for both de Bruijn and scaffold graphs (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1b</xref>). Similar ideas for untangling have been previously proposed<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref></sup>, and our improvements consist of an application to the two types of graphs and handling of various types of libraries.</p><p id="Par12">Furthermore, to obtain the continuous phased homologous sequences correctly and to improve structural accuracy, Platanus-allee employs an algorithm called haplotype synteny-based assembly (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1a</xref>; see &#x0201c;Methods&#x0201d; section). This was designed using the following assumptions for a diploid genome: (1) both HDRs and low-heterozygous regions exist and are distributed in patchwork structures, and (2) chromosome-scale synteny is conserved between a homologous chromosome pair even if heterozygosity is high and the local structural variants are contained. After the anchor bubble detection and alignment of homologous haplotype sequences (see &#x0201c;Methods&#x0201d; section), edge regions that are not aligned to the counterparts (<italic>i.e</italic>., non-syntenic) are determined. The boundary between the aligned and unaligned regions is assumed as the mis-assembly point, and the haplotype sequences are divided according to the boundary. Divided sequences are re-extended through the following iterations to determine the correct structures.</p><p id="Par13">The procedure consisting of untangling, scaffolding, correction, and gap-closing is iterated twice in the default setting, and finally, the output phased blocks are obtained (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1b</xref>). The format of the block is similar to &#x0201c;megabubble style&#x0201d; of Supernova<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>, the de novo assembly-based phasing tool for linked-reads, in which a heterozygous haplotype sequence is associated with a homologous counterpart from end to end as a bubble. For each bubble, the sequence with more non-N bases is defined as a primary-bubble, whereas the other is defined as a secondary-bubble. Optionally, primary-bubbles and non-bubble sequences can be connected, obtaining the conventional consensus format of scaffolds, which may be more contiguous for highly heterozygous organisms compared to the results of other assemblers<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>.</p></sec><sec id="Sec4"><title>Benchmarks for data of highly heterozygous organisms</title><p id="Par14">We benchmarked the contiguity, coverage, and accuracy of the phased block generated by de novo assembly-based phasing tools, namely Platanus-allee (version 2.0.2), FALCON-Unzip (version binary from 11/02/2017, applied in ref. <sup><xref ref-type="bibr" rid="CR13">13</xref></sup>), and Supernova (version 2.0.0). In the original articles<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR23">23</xref></sup>, the latter two recorded the large N50s. Therefore, we used them as cutting-edge tools. Below NG50, length such that 50% of the genome size contained in sequences of this value or greater is used as the indicator of contiguity of assemblies. LG50 is the number of sequences whose lengths&#x02009;&#x02265;&#x02009;NG50. NG50 can be measured for both scaffolds (sequences containing gaps (Ns)) and contigs (gap-free sequences). In this study, scaffold-NG50 equals contig-NG50 if an assembled sequence has no gaps, such as the FALCON-Unzip&#x02019;s result. The targets of benchmarks were the phased blocks, so that the primary contigs of FALCON-Unzip, the mosaics of haplotypes, were divided at boundaries of blocks (see &#x0201c;Methods&#x0201d;&#x000a0;section). The results of Platanus-allee and Supernova were used as bubble and non-bubble sequences, or, in the &#x0201c;megabubble style&#x0201d;.</p><p id="Par15">To optimize the existing tools, multiple parameter sets were tested, and we selected a result with the largest scaffold-NG50 of phased blocks for each tool. For FALCON-Uuzip, the four parameter sets consisting of the ones used in the previous studies<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR26">26</xref></sup> or the distributed one (Supplementary Note&#x000a0;<xref rid="MOESM1" ref-type="media">12</xref>; Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">6</xref>) were tried. Illumina-reads-based polishing tool, Pilon<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, and redundancy-reduction tools, Purge-Haplotigs (PH)<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> were both applied and the results were also benchmarked. For Supernova, either all reads or reads downsampled to reach 56&#x02009;&#x000d7;&#x02009;of expected coverage depth (optimum value in the manual) were tested.</p><p id="Par16">Finally, in addition to the phased blocks, consensus sequence statistics were evaluated. Note that Platanus (version 1, the base of Platanus-allee) can only construct consensus scaffolds, not phased blocks, and its results were exclusively included in the table for consensus sequences.</p><p id="Par17">We initially generated the sequencing dataset of the swallowtail butterfly, <italic>Papilio polytes</italic>, using various platforms: Illumina PEs, MPs, PacBio long reads, 10X Genomics linked-reads (10X) (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>). According to the <italic>k</italic>-mer frequency distribution of PEs, high heterozygosity was represented (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>) and the estimated genome size was 240 Mbp. To quantify heterozygosity, we also applied the <italic>k</italic>-mer analysis tool, GenomeScope<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, which can estimate that value, to all species used for benchmarks in this study (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">5</xref>), resulting in 1.52% heterozygosity for this sample. This species has two distinct wing patterns and these phenotypes are determined by a single locus<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, which is an HDR, including not only a large inversion (~130&#x02009;kbp) but also a low sequence identity (&#x0003c;95%) between two haplotypes<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>.</p><p id="Par18">The contiguity statistics of phased blocks for <italic>P. polytes</italic> were measured (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>; Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">7</xref>). The consensus sequence statistics and the run times of Platanus-allee under the condition of 20 threads and are shown in Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">8</xref>&#x02013;<xref rid="MOESM1" ref-type="media">10</xref>. We expected that Platanus-allee would be efficient in low-coverage long-reads datasets, and therefore the input PacBio data were reduced to 20&#x000d7;. Contiguities of sequences were measured using NG50 and LG50. For the various combinations of the input data, Platanus-allee exhibited the largest scaffold-NG50 of phased blocks compared to other tools. Remarkably, FALCON-Unzip and Supernova no longer achieved mega-scale NG50, indicating their weaknesses in the analysis of a highly heterozygous organism. To measure the quality of the phased blocks, we mapped Illumina MPs (insert-size, 15 kbp) to the blocks, and counted the number of pairs with reads exactly matching the same block. For the accurate and contiguous phased blocks, we expected to obtain a large number. The evaluation tool that uses universal single-copy orthologs, BUSCO<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, was also utilized, and the results (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>; Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">7</xref>) confirmed that the quality of Platanus-allee phased blocks was higher than those of the other tools.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Phased block statistics</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Species</th><th>Assembler</th><th>Input data</th><th>Total (Mbp)</th><th>Bubble total (Mbp)</th><th>Bubble-total / genome-size</th><th>Scaffold NG50 (kbp)</th><th>Scaffold LG50 (#)</th><th>Contig NG50 (kbp)</th><th>Contig LG50 (#)</th><th>% gaps</th><th>BUSCO duplicate complete (%)</th><th>% exact-match MP15k pairs</th></tr></thead><tbody><tr><td rowspan="7">
<italic>P. polytes</italic>
</td><td rowspan="4">Platanus-allee</td><td>PE&#x02009;+&#x02009;4 MP</td><td>442</td><td>393</td><td>0.818</td><td>404</td><td>344</td><td>102</td><td>1,282</td><td>2.80</td><td>79.03</td><td>
<bold>35.83</bold>
</td></tr><tr><td>PE&#x02009;+&#x02009;4 MP&#x02009;+&#x02009;PacBio(20&#x02009;&#x000d7;&#x02009;)</td><td>473</td><td>456</td><td>0.950</td><td>
<bold>3,225</bold>
</td><td>
<bold>51</bold>
</td><td>161</td><td>868</td><td>2.79</td><td>
<bold>89.15</bold>
</td><td>33.82</td></tr><tr><td>PE&#x02009;+&#x02009;4 MP&#x02009;+&#x02009;10X</td><td>449</td><td>407</td><td>0.848</td><td>698</td><td>207</td><td>113</td><td>1,214</td><td>2.60</td><td>83.25</td><td>35.61</td></tr><tr><td>PE&#x02009;+&#x02009;4 MP&#x02009;+&#x02009;PacBio(20&#x02009;&#x000d7;&#x02009;)&#x02009;+&#x02009;10X</td><td>476</td><td>460</td><td>
<bold>0.959</bold>
</td><td>2,392</td><td>65</td><td>143</td><td>987</td><td>2.71</td><td>88.94</td><td>33.57</td></tr><tr><td>FALCON-Unzip</td><td>PacBio(99&#x02009;&#x000d7;&#x02009;)</td><td>481</td><td>404</td><td>0.843</td><td>413</td><td>352</td><td>413</td><td>
<bold>352</bold>
</td><td>
<bold>0.00</bold>
</td><td>70.68</td><td>31.10</td></tr><tr><td>FALCON-Unzip, Pilon, PH</td><td>PacBio(99&#x000d7;)&#x02009;+&#x02009;PE</td><td>471</td><td>422</td><td>0.880</td><td>421</td><td>353</td><td>
<bold>421</bold>
</td><td>353</td><td>
<bold>0.00</bold>
</td><td>77.48</td><td>34.60</td></tr><tr><td>Supernova</td><td>10X</td><td>313</td><td>122</td><td>0.253</td><td>79</td><td>789</td><td>31</td><td>2,362</td><td>1.92</td><td>24.32</td><td>29.98</td></tr><tr><td rowspan="7">
<italic>B. japonicum</italic>
</td><td rowspan="4">Platanus-allee</td><td>PE&#x02009;+&#x02009;3 MP</td><td>720</td><td>686</td><td>0.880</td><td>1,090</td><td>194</td><td>47</td><td>4,406</td><td>3.79</td><td>86.30</td><td/></tr><tr><td>PE&#x02009;+&#x02009;3 MP&#x02009;+&#x02009;PacBio(20&#x02009;&#x000d7;&#x02009;)</td><td>739</td><td>715</td><td>0.916</td><td>1,514</td><td>142</td><td>48</td><td>4,300</td><td>4.40</td><td>
<bold>87.53</bold>
</td><td/></tr><tr><td>PE&#x02009;+&#x02009;3 MP&#x02009;+&#x02009;10X</td><td>732</td><td>694</td><td>0.889</td><td>1,155</td><td>172</td><td>33</td><td>6,271</td><td>3.94</td><td>84.15</td><td/></tr><tr><td>PE&#x02009;+&#x02009;3 MP&#x02009;+&#x02009;PacBio(20&#x02009;&#x000d7;&#x02009;)&#x02009;+&#x02009;10X&#x02009;</td><td>750</td><td>720</td><td>
<bold>0.923</bold>
</td><td>
<bold>1,516</bold>
</td><td>
<bold>140</bold>
</td><td>34</td><td>6,124</td><td>4.53</td><td>85.28</td><td/></tr><tr><td>FALCON-Unzip</td><td>PacBio(156&#x000d7;)</td><td>918</td><td>378</td><td>0.484</td><td>172</td><td>1,179</td><td>172</td><td>1,179</td><td>
<bold>0.00</bold>
</td><td>74.34</td><td/></tr><tr><td>FALCON-Unzip, Pilon, PH</td><td>PE&#x02009;+&#x02009;PacBio(156&#x02009;&#x000d7;&#x02009;)</td><td>978</td><td>852</td><td>1.092</td><td>1,075</td><td>162</td><td>
<bold>1,075</bold>
</td><td>
<bold>162</bold>
</td><td>
<bold>0.00</bold>
</td><td>80.98</td><td/></tr><tr><td>Supernova</td><td>10X</td><td>697</td><td>177</td><td>0.227</td><td>18</td><td>8,779</td><td>11</td><td>17,306</td><td>2.98</td><td>41.41</td><td/></tr><tr><td rowspan="4">
<italic>C. elegans</italic>
</td><td rowspan="2">Platanus-allee</td><td>PE&#x02009;+&#x02009;3 MP</td><td>195</td><td>179</td><td>0.897</td><td>470</td><td>112</td><td>43</td><td>1,242</td><td>4.89</td><td>77.09</td><td/></tr><tr><td>PE&#x02009;+&#x02009;3 MP&#x02009;+&#x02009;PacBio(20&#x02009;&#x000d7;&#x02009;)</td><td>205</td><td>198</td><td>
<bold>0.988</bold>
</td><td>
<bold>902</bold>
</td><td>
<bold>64</bold>
</td><td>60</td><td>992</td><td>4.95</td><td>
<bold>86.05</bold>
</td><td/></tr><tr><td>FALCON-Unzip</td><td>PacBio(192&#x02009;&#x000d7;&#x02009;)</td><td>243</td><td>224</td><td>1.121</td><td>511</td><td>105</td><td>511</td><td>
<bold>105</bold>
</td><td>
<bold>0.00</bold>
</td><td>82.28</td><td/></tr><tr><td>FALCON-Unzip, Pilon, PH</td><td>PacBio(192&#x02009;&#x000d7;&#x02009;)&#x02009;+&#x02009;PE</td><td>232</td><td>222</td><td>1.109</td><td>512</td><td>105</td><td>
<bold>512</bold>
</td><td>
<bold>105</bold>
</td><td>
<bold>0.00</bold>
</td><td>82.49</td><td/></tr><tr><td rowspan="8">
<italic>H. sapiens</italic>
</td><td rowspan="4">Platanus-allee</td><td>PE&#x02009;+&#x02009;4 MP</td><td>3,898</td><td>2,018</td><td>0.325</td><td>4</td><td>194,055</td><td>2</td><td>454,273</td><td>6.25</td><td>6.35</td><td/></tr><tr><td>PE&#x02009;+&#x02009;4 MP&#x02009;+&#x02009;PacBio(x20)</td><td>5,684</td><td>5,406</td><td>0.872</td><td>306</td><td>5,294</td><td>19</td><td>78,213</td><td>6.72</td><td>59.71</td><td/></tr><tr><td>PE&#x02009;+&#x02009;4 MP&#x02009;+&#x02009;10X</td><td>4,918</td><td>4,025</td><td>0.649</td><td>59</td><td>23,612</td><td>13</td><td>118,218</td><td>2.64</td><td>39.15</td><td/></tr><tr><td>PE&#x02009;+&#x02009;4 MP&#x02009;+&#x02009;PacBio(20&#x02009;&#x000d7;&#x02009;)&#x02009;+&#x02009;10X</td><td>5,673</td><td>5,460</td><td>
<bold>0.881</bold>
</td><td>658</td><td>2,584</td><td>23</td><td>71,898</td><td>3.53</td><td>68.33</td><td/></tr><tr><td>FALCON-Unzip</td><td>PacBio(77&#x02009;&#x000d7;&#x02009;)</td><td>4,721</td><td>3,691</td><td>0.595</td><td>109</td><td>13,508</td><td>109</td><td>13,508</td><td>
<bold>0.00</bold>
</td><td>30.36</td><td/></tr><tr><td>FALCON-Unzip, Pilon, PH</td><td>PacBio(77&#x000d7;)&#x02009;+&#x02009;PE</td><td>4,851</td><td>3,783</td><td>0.610</td><td>124</td><td>11,817</td><td>
<bold>124</bold>
</td><td>
<bold>11,817</bold>
</td><td>
<bold>0.00</bold>
</td><td>30.98</td><td/></tr><tr><td>Supernova</td><td>10X</td><td>5,405</td><td>5,028</td><td>0.811</td><td>2,489</td><td>675</td><td>124</td><td>13,651</td><td>1.38</td><td>72.38</td><td/></tr><tr><td>Mostovoy et al. 2016</td><td>PE&#x02009;+&#x02009;1 MP&#x02009;+&#x02009;10X&#x02009;+&#x02009;Bionano</td><td>5,535</td><td>5,353</td><td>0.863</td><td>
<bold>3,998</bold>
</td><td>
<bold>423</bold>
</td><td>9</td><td>184,955</td><td>8.25</td><td>
<bold>75.10</bold>
</td><td/></tr></tbody></table><table-wrap-foot><p>Statistics were calculated for phased blocks whose length&#x02009;&#x02265;&#x02009;500&#x02009;bp. A bold value indicates the best one for each species. Bubbles are phased heterozygous regions. Genome sizes and heterozygosities were estimated based on the <italic>k</italic>-mer frequency information of PEs and GenomeScope<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. Bubble-total/genome-size, NG50s and LG50s were calculated based on the estimated diploid genome sizes (<italic>P. polytes</italic>, 480 Mbp; <italic>B. japonicum</italic>, 780 Mbp; <italic>C. elegans</italic>, 200 Mbp; <italic>H. sapiens</italic> 6.2 Gbp). Estimated heterozygosities are shown in Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">5</xref>. BUSCO<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> (version 3.0.2) was used to estimate the rate of the phased single-copy genes for <italic>P. polytes, B. japonicum, C. elegans</italic> and <italic>H. sapiens</italic> with the endopterygota set (2442 orthologs), the metazoa set (978 orthologs), the nematoda set (982 orthologs) and the euarchotoglires set (6192 orthologs), respectively</p></table-wrap-foot></table-wrap></p><p id="Par19">We examined the HDR responsible for the wing pattern, <italic>H</italic> locus, on the phased blocks. Platanus-allee was used for the construction of the bubble that covers the <italic>H</italic> locus entirely (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2a</xref>). The structure of the inverted HDR was consistent with that reported in a previous study<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, which was confirmed using different approaches. Using FALCON-Unzip, we also obtained the phased haplotype sequences of <italic>H</italic> locus as a bubble, but the flanking regions were fragmented compared to the Platanus-allee (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2b</xref>). The Supernova output was also represented as non-bubble sequences for <italic>H</italic> locus. These were non-redundant and one of the haplotypes may be lost or finely fragmented, and therefore our analysis demonstrated an example of a biologically important HDR plus the mega-scale flanking regions that can be examined using Platanus-allee.<fig id="Fig2"><label>Fig. 2</label><caption><p>Benchmarking for <italic>P. polytes</italic> and <italic>B. japonicum</italic>. <bold>a</bold> Alignment between the <italic>P. polytes</italic> bubbles mapped to the <italic>dsx</italic>-gene locus. Dot plot was obtained using Nucmer and a modified version of Mummerplot in Mummer package<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>. <bold>b</bold> Alignment between Platanus-allee bubble and the results obtained using other methods for the <italic>dsx</italic>-gene locus. <bold>c</bold> Precision-recall evaluation of <italic>B. japonicum</italic> based on Moleculo synthetic long reads. Underlined numbers indicate F-measures (harmonic mean of recall and precision). <bold>d</bold> Relation between phasing performances and heterozygosity of amphioxus. <bold>e</bold> Examples of highly divergent Platanus-allee bubbles obtained in the amphioxus analysis. Heterozygosities between bubble sequences were calculated based on the sequence difference (1 &#x02212; (number of matches/alignment-length)) for the mapped 1k-mer pairs obtained from the Moleculo data using 100 kbp-windows. Alignments (&#x0201c;Arrangements of other results&#x0201d;) in <bold>b</bold>, <bold>e</bold> were performed using Minimap2<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> (see &#x0201c;Methods&#x0201d; section)</p></caption><graphic xlink:href="41467_2019_9575_Fig2_HTML" id="d29e1842"/></fig></p><p id="Par20">For the second benchmark, we generated the data from the amphioxus <italic>Branchiostoma japonicum</italic> using a similar library configuration as for the first benchmark (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">2</xref>). Similar to the other reports on amphioxus<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, this sample had considerably higher heterozygosity than <italic>P. polytes</italic>, inferred from the <italic>k</italic>-mer frequency distribution (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">5</xref>; Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1b</xref>), with an estimated genome size of 390 Mbp. As a result, the contiguities (scaffold-NG50 and scaffold-LG50) of Platanus-allee phased blocks outperformed those of other tools (Table&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>; Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">7</xref>). Compared to the results obtained for the analysis of <italic>P. polytes</italic>, the scaffold-NG50s of phased blocks of Platanus-allee with MPs were much larger than those without MPs, which may indicate that the effectiveness of MP increases with heterozygosity.</p><p id="Par21">To evaluate the recall and precision of phased blocks in detail, we additionally generated the Moleculo synthetic long-read library<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>, consisting of the contigs locally assembled for each DNA fragment (~10 kbp). Although expensive to construct, this library was expected to have accurate sequences, and therefore, it was considered suitable for the evaluation. Here, the Moleculo contigs or the phased blocks were divided into non-overlapping and fixed-length (1 kbp or 5 kbp) fragments and counted the exact matches to the other set. The indicators were defined as follows: recall, number of Moleculo-fragments matched to phased blocks/number of all Moleculo fragments; precision, number of phased block-fragments matched to Moleculo contigs/number of all phased block fragments. As the integrated one, F-measure (harmonic mean of recall and precision) was introduced.</p><p id="Par22">These metrics depend on the exact matches and a fine-scale accuracy is required to achieve excellent results. Consistently with the contiguity, Platanus-allee with MP outperformed FALCON-Unzip and Supernova for both recall and precision (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2c</xref>; Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">11</xref>). Against the combination of FALCON-Unzip, Pilon, and PH, Platanus-allee was inferior for recall but superior for F-measure. FALCON-Unzip produced a large total size (917 Mbp; with Pilon and PH, 978 Mbp), but it exceeded the 2&#x000d7; estimated genome size (780 Mbp) and the precisions were low, indicating many false positives. Considering that the amount of input PacBio reads was large (156&#x000d7;) for FALCON-Unzip, the test of full input (coverage depth&#x02009;&#x0003e;&#x02009;100&#x02009;&#x000d7;&#x02009;for both PE and MPs; Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">2</xref>) to Platanus-allee was performed, and it could exceed the other tools for both recall and precision (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">11</xref>). Overall, it covered true haplotype sequences comprehensively with less false positives.</p><p id="Par23">For users of phasing tools, the ideal outputs of all heterozygous genomic regions are recognizable data structures such as &#x0201c;bubbles&#x0201d;. We prepared heterozygous sequence pairs from the Moleculo datasets and examined the relationships between heterozygosity and the fraction of pairs that were correctly phased as bubbles for each tool. Specifically, each Moleculo contig was aligned to the others and an alignment corresponding to an alternative allele was detected based on the best hit among non-exact hits, which most likely contained heterozygous variants. The resultant alignments were divided into approximately 1 kbp-blocks and the heterozygous &#x0201c;1k-mer pairs&#x0201d; for evaluation were constructed (see &#x0201c;Methods&#x0201d;&#x000a0;section). For each phased block set, we counted 1k-mer pairs that had exact matches for both sequences (phased). Furthermore, for each 1k-mer, we determined whether it matched the bubbles and calculated the heterozygosity (number of match-sites/alignment-length). Finally, we observed the relationship between heterozygosity and phasing performances (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2d</xref>). Remarkably, only Platanus-allee maintained the high rate of phased 1k-mer pairs in bubbles for high heterozygosity, though Pilon and PH recovered that of FALCON-Unzip, suggesting that only the Platanus-allee tool can be efficiently used for HDR analysis. Examples of long and highly divergent bubbles obtained using Platanus-allee are presented in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2e</xref>, whereas the results obtained using other tools were fragmented and rich in redundant non-bubble sequences, not suitable for downstream analysis.</p><p id="Par24">Even as a consensus scaffold, Platanus-allee exhibited larger contiguities (scaffold-NG50) for the aforementioned heterozygous samples than the other tools (Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>). Especially for the amphioxus, only Platanus-allee yielded the sequences that had total sizes similar to the estimated genome size (390 Mbp), the large scaffold-NG50s of consensus sequences (maximum, 7.3 Mbp) and the high BUSCO single-completeness (&#x0003e;95%), while the other tools may have generated redundant and/or fragmented sequences. These results were consistent with the high performances of Platanus-allee, in terms of phasing, and performing the phasing procedure first will be effective for obtaining useful consensus genomes from highly heterozygous organisms.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Consensus sequence statistics</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Species</th><th>Assembler</th><th>Input data</th><th>Total (Mbp)</th><th>Total / geome-size</th><th>Scaffold NG50 (kbp)</th><th>Scaffold LG50 (#)</th><th>Contig NG50 (kbp)</th><th>Contig LG50 (#)</th><th>% gaps</th><th>BUSCO single complete (%)</th></tr></thead><tbody><tr><td rowspan="8">
<italic>P. polytes</italic>
</td><td rowspan="4">Platanus-allee</td><td>PE&#x02009;+&#x02009;4 MP</td><td>248</td><td>1.032</td><td>
<bold>8,204</bold>
</td><td>
<bold>10</bold>
</td><td>157</td><td>460</td><td>3.22</td><td>95.95</td></tr><tr><td>PE&#x02009;+&#x02009;4 MP&#x02009;+&#x02009;PacBio(20&#x02009;&#x000d7;&#x02009;)</td><td>247</td><td>1.028</td><td>7,784</td><td>
<bold>10</bold>
</td><td>164</td><td>438</td><td>3.18</td><td>96.19</td></tr><tr><td>PE&#x02009;+&#x02009;4 MP&#x02009;+&#x02009;10X</td><td>248</td><td>1.031</td><td>6,621</td><td>13</td><td>138</td><td>516</td><td>3.08</td><td>96.40</td></tr><tr><td>PE&#x02009;+&#x02009;4 MP&#x02009;+&#x02009;PacBio(20&#x02009;&#x000d7;&#x02009;)&#x02009;+&#x02009;10X</td><td>247</td><td>1.029</td><td>7,845</td><td>11</td><td>145</td><td>482</td><td>3.02</td><td>96.44</td></tr><tr><td>Platanus (v1.2.4)</td><td>PE&#x02009;+&#x02009;4 MP</td><td>232</td><td>0.968</td><td>5,995</td><td>15</td><td>159</td><td>438</td><td>1.37</td><td>
<bold>96.52</bold>
</td></tr><tr><td>FALCON-Unzip</td><td>PacBio(99&#x02009;&#x000d7;&#x02009;)</td><td>261</td><td>1.088</td><td>5,196</td><td>18</td><td>5,196</td><td>
<bold>18</bold>
</td><td>
<bold>0.00</bold>
</td><td>89.35</td></tr><tr><td>FALCON-Unzip, Pilon, PH</td><td>PacBio(99&#x02009;&#x000d7;&#x02009;)&#x02009;+&#x02009;PE</td><td>242</td><td>
<bold>1.008</bold>
</td><td>5,199</td><td>18</td><td>
<bold>5,199</bold>
</td><td>
<bold>18</bold>
</td><td>
<bold>0.00</bold>
</td><td>92.47</td></tr><tr><td>Supernova</td><td>10X</td><td>257</td><td>1.070</td><td>329</td><td>201</td><td>98</td><td>638</td><td>1.75</td><td>88.00</td></tr><tr><td rowspan="8">
<italic>B. japonicum</italic>
</td><td rowspan="4">Platanus-allee</td><td>PE&#x02009;+&#x02009;3 MP</td><td>384</td><td>0.984</td><td>5,336</td><td>22</td><td>48</td><td>2,149</td><td>4.40</td><td>94.07</td></tr><tr><td>PE&#x02009;+&#x02009;3 MP&#x02009;+&#x02009;PacBio(20&#x02009;&#x000d7;&#x02009;)</td><td>389</td><td>
<bold>0.997</bold>
</td><td>
<bold>7,304</bold>
</td><td>
<bold>16</bold>
</td><td>49</td><td>2,120</td><td>5.12</td><td>
<bold>94.58</bold>
</td></tr><tr><td>PE&#x02009;+&#x02009;3 MP&#x02009;+&#x02009;10X</td><td>392</td><td>1.004</td><td>4,914</td><td>21</td><td>34</td><td>3,104</td><td>4.52</td><td>93.87</td></tr><tr><td>PE&#x02009;+&#x02009;3 MP&#x02009;+&#x02009;PacBio(20&#x02009;&#x000d7;&#x02009;)&#x02009;+&#x02009;10X</td><td>397</td><td>1.017</td><td>5,413</td><td>17</td><td>35</td><td>3,030</td><td>5.15</td><td>94.07</td></tr><tr><td>Platanus (v1.2.4)</td><td>PE&#x02009;+&#x02009;MP</td><td>488</td><td>1.250</td><td>239</td><td>414</td><td>10</td><td>10,393</td><td>13.89</td><td>65.75</td></tr><tr><td>FALCON-Unzip</td><td>PacBio(156&#x02009;&#x000d7;&#x02009;)</td><td>707</td><td>1.812</td><td>4,301</td><td>32</td><td>
<bold>4301</bold>
</td><td>
<bold>32</bold>
</td><td>
<bold>0.00</bold>
</td><td>27.91</td></tr><tr><td>FALCON-Unzip, Pilon, PH</td><td>PE&#x02009;+&#x02009;PacBio(156&#x02009;&#x000d7;&#x02009;)</td><td>406</td><td>1.042</td><td>3,259</td><td>39</td><td>3,259</td><td>39</td><td>
<bold>0.00</bold>
</td><td>84.97</td></tr><tr><td>Supernova</td><td>10X</td><td>662</td><td>1.697</td><td>45</td><td>2271</td><td>23</td><td>5,554</td><td>2.86</td><td>54.09</td></tr><tr><td rowspan="5">
<italic>C. elegans</italic>
</td><td rowspan="2">Platanus-allee</td><td>PE&#x02009;+&#x02009;3 MP</td><td>106</td><td>1.058</td><td>2,388</td><td>14</td><td>63</td><td>458</td><td>4.76</td><td>95.52</td></tr><tr><td>PE&#x02009;+&#x02009;3 MP&#x02009;+&#x02009;PacBio(20&#x02009;&#x000d7;&#x02009;)</td><td>107</td><td>1.065</td><td>
<bold>3,316</bold>
</td><td>
<bold>12</bold>
</td><td>64</td><td>456</td><td>5.13</td><td>95.11</td></tr><tr><td>Platanus (v1.2.4)</td><td>PE&#x02009;+&#x02009;3 MP</td><td>102</td><td>
<bold>1.016</bold>
</td><td>1,848</td><td>19</td><td>71</td><td>364</td><td>2.30</td><td>
<bold>96.64</bold>
</td></tr><tr><td>FALCON-Unzip</td><td>PacBio(192&#x02009;&#x000d7;&#x02009;)</td><td>109</td><td>1.093</td><td>2,064</td><td>17</td><td>
<bold>2,064</bold>
</td><td>
<bold>17</bold>
</td><td>
<bold>0.00</bold>
</td><td>93.18</td></tr><tr><td>FALCON-Unzip, Pilon, PH</td><td>PacBio(192&#x02009;&#x000d7;&#x02009;)&#x02009;+&#x02009;PE</td><td>103</td><td>1.029</td><td>2,064</td><td>17</td><td>2,064</td><td>
<bold>17</bold>
</td><td>
<bold>0.00</bold>
</td><td>94.60</td></tr><tr><td rowspan="9">
<italic>H. sapiens</italic>
</td><td rowspan="4">Platanus-allee</td><td>PE&#x02009;+&#x02009;4 MP</td><td>2,894</td><td>0.934</td><td>3,917</td><td>230</td><td>23</td><td>34,650</td><td>4.08</td><td>88.82</td></tr><tr><td>PE&#x02009;+&#x02009;4 MP&#x02009;+&#x02009;PacBio(x20)</td><td>2,995</td><td>0.966</td><td>3,717</td><td>250</td><td>22</td><td>36,365</td><td>6.76</td><td>86.45</td></tr><tr><td>PE&#x02009;+&#x02009;4 MP&#x02009;+&#x02009;10X</td><td>2,914</td><td>0.940</td><td>3,050</td><td>305</td><td>25</td><td>33,967</td><td>2.46</td><td>89.34</td></tr><tr><td>PE&#x02009;+&#x02009;4 MP&#x02009;+&#x02009;PacBio(20&#x02009;&#x000d7;&#x02009;)&#x02009;+&#x02009;10X</td><td>2,954</td><td>
<bold>0.953</bold>
</td><td>3,730</td><td>252</td><td>24</td><td>34,583</td><td>3.66</td><td>88.66</td></tr><tr><td>Platanus (v1.2.4)</td><td>PE&#x02009;+&#x02009;4 MP</td><td>2,706</td><td>0.873</td><td>13,149</td><td>65</td><td>24</td><td>33,902</td><td>1.62</td><td>
<bold>90.39</bold>
</td></tr><tr><td>FALCON-Unzip</td><td>PacBio(77&#x02009;&#x000d7;&#x02009;)</td><td>2,788</td><td>0.899</td><td>8,670</td><td>98</td><td>
<bold>8,670</bold>
</td><td>
<bold>98</bold>
</td><td>
<bold>0.00</bold>
</td><td>87.97</td></tr><tr><td>FALCON-Unzip, Pilon, PH</td><td>PacBio(77&#x02009;&#x000d7;&#x02009;)&#x02009;+&#x02009;PE</td><td>2,791</td><td>0.900</td><td>8,669</td><td>98</td><td>
<bold>8,669</bold>
</td><td>
<bold>98</bold>
</td><td>
<bold>0.00</bold>
</td><td>88.97</td></tr><tr><td>Supernova</td><td>10X</td><td>2,942</td><td>0.949</td><td>30,823</td><td>
<bold>28</bold>
</td><td>147</td><td>5,954</td><td>1.42</td><td>90.33</td></tr><tr><td>Mostovoy et al. 2016</td><td>PE&#x02009;+&#x02009;1 MP&#x02009;+&#x02009;10X&#x02009;+&#x02009;Bionano</td><td>2,857</td><td>0.922</td><td>
<bold>30,830</bold>
</td><td>34</td><td>9</td><td>91,880</td><td>10.22</td><td>88.76</td></tr></tbody></table><table-wrap-foot><p>Statistics were calculated for consensus (pseudo-haploid) sequences whose length&#x02009;&#x02265;&#x02009;500&#x02009;bp. <italic>P. polytes, B. japonicum, C. elegans</italic> and <italic>H. sapiens</italic> correspond to a butterfly, am amphioxus, a worm and the human (NA12878), respectively. A bold value indicates the best one for each species. Genome sizes were estimated based on the <italic>k</italic>-mer frequency information of PEs and GenomeScope<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. Total/genome-size, NG50s, and LG50s were calculated based on the estimated haploid genome sizes (<italic>P. polytes</italic>, 240 Mbp; <italic>B. japonicum</italic>, 390 Mbp; <italic>C. elegans</italic>, 100 Mbp; <italic>H. sapiens</italic> 3.1 Gbp). BUSCO was used to estimate the rate of the non-redundantly constructed single-copy genes in a similar manner for the phased blocks (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>). The formats of the results from FALCON-Unzip and Supernova were &#x0201c;primary-contigs&#x0201d; and &#x0201c;pseudohap,&#x0201d; respectively</p></table-wrap-foot></table-wrap></p></sec><sec id="Sec5"><title>Benchmarking for model organism data</title><p id="Par25">To assess the phasing performances comprehensively, using the reference genomes, we generated synthetic diploid data from the <italic>Caenorhabditis elegans</italic> strains N2<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> and CB4856<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, whose genomic sequences have been completely determined with almost no gaps (genome size, 100 Mbp). These two strains are nearly completely homozygous, and we individually sequenced them and used the same amount of data in silico (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">3</xref>). The single nucleotide variant (SNV) density between the two genomes was reported as 0.33%, and the HDRs were shown to represent 2&#x02013;16% of the genome<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. Therefore, we considered these datasets suitable for analysis.</p><p id="Par26">As a Platanus-allee competitor, we executed FALCON-Unzip because it exhibited better performance than Supernova for most indicators during previous analyses. We tested the coverage depths of PacBio from 80&#x02009;&#x000d7;&#x02009;to 192&#x02009;&#x000d7;&#x02009;for FALCON-Unzip and used 20&#x02009;&#x000d7;&#x02009;for Platanus-allee. The recall and precision were determined using an approach similar to that used when analyzing amphioxus, but reference genomes were used instead of the Moleculo contigs. For the contiguities of the phased blocks, Platanus-allee results exceeded the quality of the best result obtained with FALCON-Unzip (192&#x02009;&#x000d7;&#x02009;) when three MPs were used (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>; Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3a</xref>; Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">7</xref>, <xref rid="MOESM1" ref-type="media">12</xref>). Similarly, for recall and precision, Platanus-allee produced larger values than FALCON-Unzip when inputting at least one MP. Remarkably, Platanus-allee with MPs invariably showed higher precision (differences&#x02009;&#x0003e;&#x02009;10%) than FALCON-Unzip even with Pilon and PH.<fig id="Fig3"><label>Fig. 3</label><caption><p>Benchmarking for the synthetic diploid sample of <italic>C. elegans</italic>. <bold>a</bold> Precision-recall evaluation for the synthetic diploid <italic>C. elegans</italic> based on the reference genomes. Underlined numbers indicate F-measures. <bold>b</bold> Phasing performances and heterozygosity for the entire genome and a highly divergent region of the synthetic diploid <italic>C. elegans</italic>. Phased 1k-mer pair rate and heterozygosity in the entire genome (above two graphs) and the highly divergent chromosome II end (bottom two graphs) were calculated using 1 Mbp- and 100 kbp-windows, respectively. Alignments (&#x0201c;Arrangements of the other results&#x0201d;) were performed using Minimap2<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> (see &#x0201c;Methods&#x0201d;&#x000a0;section)</p></caption><graphic xlink:href="41467_2019_9575_Fig3_HTML" id="d29e3101"/></fig></p><p id="Par27">To investigate the correlation between heterozygosity and phasing performance, we initially aligned the reference sequences of the two strains for each chromosome using a previously described method<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, and heterozygosity (SNV density) was calculated for each 1 Mbp-window (see &#x0201c;Methods&#x0201d;&#x000a0;section). The 1k-mer pairs from the alignment between reference genomes were then identified, and the rate of exactly phased 1k-mer pairs was calculated for each 1 Mbp-window as an indicator of phasing performance. The results (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3b</xref>) showed that the heterozygosities tend to be higher near the ends of the chromosomes, as previously reported<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, and the coverage obtained using Platanus-allee frequently exceeded that obtained using FALCON-Unzip in these regions. The highly divergent region near the end of chromosome II is magnified in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3b</xref>, demonstrating that FALCON-Unzip could not phase the HDR as bubbles. The mean heterozygosity of 1 Mbp-windows where Platanus-allee had much larger phased 1k-mer rate (differences&#x02009;&#x0003e;&#x02009;10%) than the other tools did was 1.27% (<italic>n</italic>&#x02009;<italic>=</italic>&#x02009;23), which was significantly higher than that of the other windows, 0.68% (<italic>n</italic>&#x02009;=&#x02009;74) (<italic>p</italic>&#x02009;<italic>=</italic>&#x02009;0.0192, two-sided Wilcoxon rank-sum test).</p><p id="Par28">Structural accuracy was determined by counting switch-errors (i.e., errors of phasing) and mis-assemblies. We determined the inconsistency between the assembly and the reference based on the alignments of fixed-length fragments (for details, Supplementary Note&#x000a0;<xref rid="MOESM1" ref-type="media">18</xref>). Platanus-allee with PE and MPs was shown to lead to a lower rate of switch-errors&#x02009;+&#x02009;mis-assemblies compared to those obtained using FALCON-Unzip with 192&#x02009;&#x000d7;&#x02009;data (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">13</xref>).</p><p id="Par29">Additionally, we confirmed that the consensus scaffolds of Platanus-allee indicated a relatively high contiguity, completeness, and accuracy (Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>; Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">14</xref>) even for the <italic>C. elegans</italic> data.</p><p id="Par30">Finally, we benchmarked the tools using the human sample NA12878 (female, cell line GM12878). The input PE, MP (2 kbp), PacBio, and 10X data were previously generated and reported<sup><xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR23">23</xref></sup>. We additionally sequenced three MPs (5&#x02013;15 kbp) (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">4</xref>). To the best of our knowledge, the de novo assembly-based phasing results with the largest N50 was previously reported in Mostovoy et al. 2016<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> utilizing PEs, 10X, and Bionano genome-map data, and we used this phased block set for comparison. For the calculation of precision and recall, Moleculo data of the 1000 Genomes Project<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> were used.</p><p id="Par31">In striking contrast to highly heterozygous organisms, the contiguities of Platanus-allee and FALCON-Unzip in this analysis were shown to be inferior to the other tools probably due to the shortage of heterozygous sites used for phasing, and the scaffold-NG50 of phased blocks substantially increased with PacBio or 10X data (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>; Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">7</xref>). Note that this tendency was common to the consensus sequences (Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>; Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">8</xref>). Scaffold-NG50s of phased blocks of Platanus-allee with PacBio were shown to be larger than the reported value (145 kbp) of pipeline<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> that combined the PacBio-assembly of FALCON and the mapping of Illumina reads, and in some cases, the value obtained with Platanus-allee surpassed that of the phasing method based on fosmid-pooling (484 kbp)<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> (target individual was not NA12878). The recall performance of Platanus-allee with PacBio or 10X exceeded that of the Mostovoy et al. 2016 pipeline<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, but was smaller than that of Supernova in all cases (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4a</xref>, Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">15</xref>). In contrast, the precision of Platanus-allee was better than that of any other tool. Although the situation may be impractical, when all libraries including PacBio (20&#x02009;&#x000d7;&#x02009;) and 10X were input into Platanus-allee, its F-measure was the top value.<fig id="Fig4"><label>Fig. 4</label><caption><p>Benchmarking for <italic>H. sapiens</italic>. <bold>a</bold> Precision-recall evaluation of the human sample based on the Moleculo synthetic long reads. Underlined numbers indicate F-measures. <bold>b</bold> Relation between phasing performances and heterozygosity using a human sample. <bold>c</bold> Phasing results for the human MHC class II region. Positions on chromosome 6 and gene annotation were based on human reference genome GRCh38.p10. Heterozygosity was calculated based on the sequence difference (1&#x02009;&#x02212;&#x02009;(number of matches/alignment-length)) for the mapped 1k-mer pairs from the Moleculo data using 1 Mbp-windows. <bold>d</bold> Dot plot between the bubble of Platanus-allee covering the MHC class II region. <bold>e</bold> Highly divergent and non-localized bubble obtained using human NA12878 data. Alignments (&#x0201c;Arrangements of the other results&#x0201d;) in <bold>c</bold>, <bold>e</bold> were performed using Minimap2<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> (see &#x0201c;Methods&#x0201d;&#x000a0;section). Dot plots in <bold>d</bold>, <bold>e</bold> were depicted using Nucmer and modified version of Mummerplot in Mummer package<sup><xref ref-type="bibr" rid="CR57">57</xref></sup></p></caption><graphic xlink:href="41467_2019_9575_Fig4_HTML" id="d29e3256"/></fig></p><p id="Par32">We also performed the evaluation using the phased variant set of NA12878, called &#x0201c;Platinum set&#x0201d;, previously derived from the trio data<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. Note that the variants were basically detected on the basis of mapping of short-reads and possibly HDRs were not reflected, but this evaluation was valuable as the one not depending on the Moleculo data. For Recalls and precisions measured based on fixed-length fragments from the haplotypes of the Platinum set (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">16</xref>), the trend was consistent with those for the Moleculo contigs. The details are described in Supplementary Note including the evaluation of switch-errors and mis-assemblies (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">17</xref>).</p><p id="Par33">As previously shown with the amphioxus, the relation between heterozygosity and phasing performance (phased 1k-mer rate) was investigated based on the Moleculo contigs (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4b</xref>), and Platanus-allee showed a better performance in the HDR (heterozygosity&#x02009;&#x02265;&#x02009;3%) analyses even when a human sample was used, although the fraction of HDRs was low compared to that observed in other organisms. One remarkable example of HDR was the major histocompatibility complex (MHC) region<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>, which generally shows high haplotype divergence and functional importance. Platanus-allee successfully constructed this highly divergent bubble (~1.05 Mbp) covering the entire MHC class II region (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4c</xref>). Although Supernova also succeeded in the construction of a long bubble (~6.95 Mbp) covering the MHC region, the HDR between the <italic>HLA-DRA</italic> and <italic>HLA-DRB1</italic> loci was represented as a large gap (~90 kbp) and short sequences. In this region, FALCON-Unzip indicated the divisions of phased blocks and Mostovoy et al. 2016 could not construct the large range of the region (&#x0003e;300 kbp), illustrating the advantage of using Platanus-allee for HDR analysis. Notably, <italic>HLA-DRB3</italic> gene was found (identity&#x02009;&#x02265;&#x02009;95% and alignment-coverage&#x02009;&#x02265;&#x02009;50%) in one of the haplotype Platanus-allee constructed (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4d</xref>), which was concordant with the report based on the trio data and PacBio reads<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>.</p><p id="Par34">To evaluate the accuracies of the phased blocks of the MHC region, using the previous typing results of six loci in the MHC region<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, we counted loci correctly represented in the phased blocks (for details, Supplementary Note&#x000a0;<xref rid="MOESM1" ref-type="media">24</xref>). As a result, (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">18</xref>), Platanus-allee with MP and/or PacBio and FALCON-Unzip correctly typed all loci, and the number of exact-matches to database-sequences was the most for Platanus-allee, supporting that this tool has an advantage to phase the MHC region.</p><p id="Par35">Intriguingly, 8 long bubbles were observed (primary&#x02009;+&#x02009;secondary length&#x02009;&#x02265;&#x02009;100 kbp) that were not found in the reference genome (GRCh38.p10) or the Supernova results when Platanus-allee was used (for details, Methods and Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">19</xref>). The longest one (lengths, 435 kbp and 382 kbp) was highly diverged and repeat-rich (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4e</xref>). Mapping of the Moleculo contigs and PacBio reads confirmed that this bubble was not an artifact or a contaminant sequence. (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">6</xref>). Most of the other observed bubbles absent from the reference genome were shown to be of similar nature (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">7</xref>), and some exhibited an extremely high repeat rate.</p></sec><sec id="Sec6"><title>Benchmarking for the other organisms using the public data</title><p id="Par36">To further investigate the versatility of Platanus-allee, we added the two plants (<italic>A. thaliana</italic> F1-hybrid<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> and <italic>Prunus yedonensis</italic> (cherry blossom)<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>) and the one mammal (<italic>Pteropus alecto</italic> (bat)<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>) samples, whose sequencing data are publicly available (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">20</xref>&#x02013;<xref rid="MOESM1" ref-type="media">22</xref>). Although the performances of Platanus-allee were inferior to those of FALCON-Unzip when MP was not available (<italic>A. thaliana</italic>, Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">23</xref>&#x02013;<xref rid="MOESM1" ref-type="media">25</xref>), the other benchmarks confirm the effectiveness of Platanus-allee for high heterozygosity and MPs, demonstrating the high performances compared to the public assemblies <bold>(</bold>Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">23</xref>; for details, Supplementary Note&#x000a0;<xref rid="MOESM1" ref-type="media">26</xref>).</p></sec><sec id="Sec7"><title>Benchmarking for fully simulated heterozygous data</title><p id="Par37">Finally, to systematically investigate the effect of heterozygosity, we prepared data sets including all types of libraries fully simulated in silico using the multiple tools<sup><xref ref-type="bibr" rid="CR39">39</xref>&#x02013;<xref ref-type="bibr" rid="CR41">41</xref></sup>. The target species was <italic>C. elegans</italic> (N2) and the configuration of the libraries was similar to that in the benchmark of synthetic diploid <italic>C. elegans</italic>, and the heterozygosities were simulated as 0.1&#x02013;2% using pIRS<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> (for details, Supplementary Note&#x000a0;<xref rid="MOESM1" ref-type="media">27</xref>).</p><p id="Par38">The results are shown in Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">26</xref>, <xref rid="MOESM1" ref-type="media">27</xref>. Although most NG50s of both phased blocks and consensus sequences outperform those of the actual data possibly unknown natures of actual ones, there are two important tendencies:</p><p id="Par39">(1) The performance of Supernova considerably worsened for 2%-heterozygous data. This is consistent with the bad performances of this tool for <italic>P. polytes</italic> and <italic>B. japonicum</italic>, implying that it cannot handle high heterozygosity (&#x0003e;1%).</p><p id="Par40">(2) Platanus-allee exceeded FALCON-Unzip even with Pilon and PH when heterozygosity&#x02009;&#x02265;&#x02009;1% for most indicators. This supports the advantage of Platanus-allee for HDRs.</p></sec></sec><sec id="Sec8" sec-type="discussion"><title>Discussion</title><p id="Par41">The ultimate goal for diploid eukaryotic species is to completely decode each homologous chromosome sequence, and a comprehensive survey of HDRs can be performed by comparing homologous pairs of chromosome sequences.</p><p id="Par42">Platanus-allee was evaluated for determination of homologous chromosome sequences and it showed high performance especially for HDRs. In each case, the total size of its phased blocks was close to twice the size of each genome, and the consensus sequences were close to each genome size, while FALCON-Unzip and Supernova built too large or too small sizes. Considering these benchmarks, we conclude that the Platanus-allee approach has versatility and advantages in the analysis of non-model organisms that often have high levels of heterozygosity.</p><p id="Par43">The algorithm of Supernova, which utilizes short-reads and bubbles in de Bruijn graphs, is partially similar to that of Platanus-allee. However, the performances of Supernova obviously declined for the highly heterozygous samples and HDRs (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>, Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2d</xref> and so on), displaying the difference between these tools.</p><p id="Par44">The range of real times to run Platanus-allee with 20 threads were 4.54&#x02013;13.5 days for the human, while that was 6.44&#x02013;8.45&#x02009;h for <italic>C. elengans</italic> (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">9</xref>). Although this tool is not designed to make use of machine clusters, we could complete the assembly of human genomic reads composed of PE, MPs, 10X and PacBio within 2 weeks in a single machine, suggesting that Platanus-allee is applicable to multiple genome projects.</p><p id="Par45">Through four benchmark analyses, while using Platanus-allee, Illumina MP libraries were shown to be effective for the analysis of highly heterozygous genomes, and at least one MP can substantially improve the performance of the approach even when combined with PacBio data. In contrast, PacBio and 10X data were more effective when analyzing a lowly heterozygous sample. This is associated with the concept of Platanus-allee that exactly separates the haplotype sequences using accurate reads, and MP is the practical choice to obtain long-range link information with low sequencing error rate (&#x0003c;1%). Although MP is not a state-of-the-art method in comparison to PacBio or 10X, it was recently employed for the phasing of polyploid plants<sup><xref ref-type="bibr" rid="CR43">43</xref>,<xref ref-type="bibr" rid="CR44">44</xref></sup> and de novo assembly of the human genomes<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> as well. The NG50s of phased blocks or consensus sequences in the latter case were comparable to those obtained with PacBio, suggesting that the usefulness of MP is not specific only to Platanus-allee. In contrast, combination of PE and PacBio without MP does not lead to a better result of Platanus-allee compared to that of FALCON-Unzip for many cases.</p><p id="Par46">Platanus-allee generated many gaps compared to the other tools. Especially FALCON-Unzip constructs completely gap-free sequences as its algorithm design making use of long reads. Long-reads-based strategy will also cover extremely repeat-rich regions<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>. However, Platanus-allee indicated better performances for recalls and BUSCO-completeness in most cases. Importantly, precisions of Platanus-allee outperformed those of FALCON-Unzip even when Pilon was applied. We believe that the results of Platanus-allee have a certain value for practical uses.</p><p id="Par47">Although describing the exact costs are difficult because of the rapid improvement of technology and dependencies of retail prices on distribution channels, the rough summaries are described below referring the previous comparison and reviews<sup><xref ref-type="bibr" rid="CR47">47</xref>&#x02013;<xref ref-type="bibr" rid="CR49">49</xref></sup>. PE is the most cost-effective one and it is useful for preliminary survey, assembly and polishing. The sequencing cost of a typical configuration of MPs (3&#x02013;4 libraries, ~40&#x02009;&#x000d7;&#x02009;for each) used in this study may be lower than that of a high-coverage (&#x02265;100&#x02009;&#x000d7;&#x02009;) PacBio library preferred from FALCON-Unzip, although the relation is possibly reversed for the samples with smaller genome sizes. For lowly heterozygous samples such as humans, 10X combined with Supernova might be the most cost-effective strategy if HDRs are out of interest (for details, Supplementary Note&#x000a0;<xref rid="MOESM1" ref-type="media">30</xref>).</p><p id="Par48">Lastly, we propose three possible applications of the de novo-assembled phased block. First, it can be used for the cataloging of variants, including structural ones. The effectiveness of de novo assembly for complex variants has been validated using human samples<sup><xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR45">45</xref></sup> and it is expected to be more important for highly heterozygous organisms such as sea squirt<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> and lancelet<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. Furthermore, the phased blocks are helpful for the investigation of the allele-specific nature of diploid genomes, such as gene expression (RNA-Seq), DNA methylation (bisulfite-seq), protein binding (ChIP-seq) and chromosome conformation (Hi-C). For the methods based on sequencers, the possible targets are not limited to those listed above. Allele-specific gene expression and DNA methylation have been detected in the phased blocks of human sequences based on fosmid-pooling<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, and recent single-cell RNA-seq studies reported that 12&#x02013;76% of genes may be expressed monoallelically<sup><xref ref-type="bibr" rid="CR50">50</xref>,<xref ref-type="bibr" rid="CR51">51</xref></sup>, emphasizing the importance of this analysis. In the <italic>H</italic> locus of <italic>P. polytes</italic>, not only differences in gene expression but also a haplotype-specific non-coding gene, <italic>U3X</italic>, were observed<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. Finally, we believe that certain fields, such as phylogenetics and population genetics, that regularly use genome comparison in their analyses will greatly benefit from the use of phasing. Phased blocks can be used to determine the origin of specific haplotypes, exemplified in the phylogenetic study of beer yeasts<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>. Other examples include the application of phasing results for high-resolution inference of population history<sup><xref ref-type="bibr" rid="CR53">53</xref></sup> and the detection of selective pressure for each haplotype<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>. Overall, the accuracy and the comprehensiveness of the phased blocks generated using Platanus-allee are expected to facilitate a large variety of downstream analyses.</p></sec><sec id="Sec9"><title>Methods</title><sec id="Sec10"><title>Sample collection</title><p id="Par49">One wild individual of <italic>P. polytes</italic> was collected in Ishigaki Island, Okinawa, Japan in 2016. No field work permit was required for sampling this species in this region. One wild individual of <italic>B. japonicum</italic> was collected Atsumi Peninshula, Aichi, Japan in 2012. The samples of <italic>C. elegans</italic> N2 and CB4856 strains were the laboratory stocks. The samples of <italic>H. sapiens</italic> was the cell line of GM12878, CEPH/UTAH Pedigree 1463, provided by Coriell Institute.</p></sec><sec id="Sec11"><title>Sequencing</title><p id="Par50">The Illumina paired-end and mate-pair libraries were prepared using TruSeq DNA PCR-Free LT Sample Prep Kit and Nextera Mate Pair Sample Prep Kit, respectively. The 10X linked-read libraries were prepared by the Chromium system (10X Genomics). The Moleculo library of <italic>B. japonicum</italic> was prepared using TruSeq Synthetic Long Read Kit. All Illumina sequencing runs, including 10X linked-reads and Moleculo, were performed using HiSeq 2500. PacBio sequencing runs were performed using RS II sequencer for <italic>P. polytes</italic> and <italic>B. japonicum</italic>, and Sequel for <italic>C. elegan</italic>s N2 and CB4756 strains.</p></sec><sec id="Sec12"><title>Contig-assembly</title><p id="Par51">The contig-assembly module of Platanus-allee is derived from that of Platanus with some differences as follows:</p><p id="Par52">(1) The initial <italic>k</italic>-mer coverage cutoff is set to (leftmost-local-minimum-coverage/2) rather than (leftmost-local-minimum-coverage). The leftmost-local-minimum-coverage is determined for an occurrence distribution of <italic>k</italic>-mers (default, <italic>k</italic>&#x02009;=&#x02009;32) using a smoothing window-size of 1 rather than 7.</p><p id="Par53">(2) In steps of increasing <italic>k</italic> and reconstruction of the de Bruijn graph, a step size of <italic>k</italic> (<italic>k</italic><sub>step</sub>) is set to 20 rather than 10.</p><p id="Par54">(3) The function to correct contigs based on mapping of the reads (&#x0201c;Check of contigs using exact-match reads<italic>&#x0201d;</italic> in ref. <sup><xref ref-type="bibr" rid="CR1">1</xref></sup>) is omitted.</p><p id="Par55">(4) The bubble-removal function is omitted.</p><p id="Par56">Steps (1) and (3) above are adopted to handle low-coverage heterozygous regions, which are expected to cover half of the homozygous regions.</p></sec><sec id="Sec13"><title>Construction of a (gapped) de Bruijn graph</title><p id="Par57">Similar to Platanus, Platanus-allee extracted sub-graphs in a de Bruijn graph (<italic>k</italic>-mers) without junctions, which have multiple edges for the same direction, and treated them as &#x0201c;straight nodes&#x0201d; (contigs). The nodes corresponding to junctions are &#x0201c;junction nodes&#x0201d;. Input to the phasing step described in sections below is a de Bruijn graph (<italic>k</italic>&#x02009;=&#x02009;<italic>k</italic><sub>max</sub>, see ref. <sup><xref ref-type="bibr" rid="CR1">1</xref></sup>) resulting from the contig-assembly module, which consists of both straight and junction nodes.</p><p id="Par58">Straight nodes in the graph may contain gaps (Ns) after the first iteration round, which was referred to as a gapped de Bruijn graph in this study. Note that a pair of nodes are connected if they have (<italic>k</italic> &#x02212; 1)-length overlap with each other.</p></sec><sec id="Sec14"><title>Mapping reads to a (gapped) de Bruijn graph</title><p id="Par59">For short reads (Illumina), the reads are mapped to the nodes of the graph in a similar manner as in Platanus based on exact and unique matches of fixed-length sequences. The differences from Platanus are as follows:</p><p id="Par60">(1) Three fixed-lengths for mapping are applied, 32, 64, and 96, to increase sensitivity.</p><p id="Par61">(2) If single read is mapped to multiple nodes, link information among those nodes are stored and possibly used in downstream steps. Note that Platanus only uses links between paired-reads and/or mate-pairs.</p><p id="Par62">Long reads (PacBio or Nanopore) are mapped to the nodes using Minimap2<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> (version 2.0-r191 in this study) with default parameters except for the options for detailed alignments (-c) and multi-threading (-t user-specified-value). In this setting, the <italic>k</italic>-mer size for mapping is 15 (-k 15) and error-prone long reads can be handled. After execution of Minimap2, the resulting alignments are filtered based on the following conditions (1):<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{{sequence-identity}}} \ge 0.8\;{\mathrm{and}}\;\left( {{\mathrm{{alignment-length}}} \ge 1000\;{\mathrm{or}}\;{\mathrm{{alignment-coverage}}} \ge 0.8} \right)$$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="normal">sequence - identity</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>0.8</mml:mn><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="0.16em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">alignment - length</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>1000</mml:mn><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">or</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">alignment - coverage</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2019_9575_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par63">Here, the sequence-identity and alignment-coverage are defined as follows (2, 3):<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{{sequence-identity}}} = \left( {\# \;{\mathrm{{matched-sites}}}/{\mathrm{{alignment-length}}}} \right)$$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="normal">sequence - identity</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>#</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">matched - sites</mml:mi><mml:mo>&#x02215;</mml:mo><mml:mi mathvariant="normal">alignment - length</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2019_9575_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{{alignment-coverage}}} = {\mathrm{{alignment-length}}}/{\mathrm{min}}\left( {{\mathrm{{query-length}}},{\mathrm{{target-length}}}} \right)$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="normal">alignment - coverage</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">alignment - length</mml:mi><mml:mo>&#x02215;</mml:mo><mml:mi mathvariant="normal">min</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">query - length</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">target - length</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2019_9575_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par64">Next, the alignments are greedily selected according to the order of # match-sites, ensuring that each pair of selected alignments does not have overlaps&#x02009;&#x02265;&#x02009;<italic>k</italic> (<italic>k</italic>-mer size) in a query-sequence. For each pair of query and target sequences, the positions of local alignments are weighted by their lengths and the weighted average position is used as the final mapped position. If one query sequence (read) spans multiple target sequences (nodes), the gap size between nodes is determined from the read sequence, and the resulting link information is stored and used in downstream steps.</p><p id="Par65">The mapping result of each library is used individually in ascending order of insert-sizes and finally all libraries are used simultaneously for each iteration (for details, Methods, Iteration of phasing).</p></sec><sec id="Sec15"><title>Mapping linked-reads to a (gapped) de Bruijn graph</title><p id="Par66">Linked-reads are paired-end reads containing short (~16 base pair, bp) &#x0201c;barcode&#x0201d; sequences generated from the 10X Genomics platform. Platanus-allee assumes that input linked-reads are formatted as FASTQ files in which barcode sequences are represented as &#x0201c;BX: Z:&#x0201d; tag information. These files can be generated by the &#x0201c;longranger basic&#x0201d; command of Long Ranger, which is found on the web page of 10X Genomics (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/genome-exome/software/downloads/latest">https://support.10xgenomics.com/genome-exome/software/downloads/latest</ext-link>).</p><p id="Par67">Linked-reads are mapped to the (gapped) de Bruijn graph in a similar manner for paired-ends (see &#x0201c;Methods&#x0201d; section, Mapping reads to a (gapped) de Bruijn graph), and the number of reads is counted for each node and barcode. To reduce the effect of mis-mapping, the counting results are discarded if the number of reads&#x02009;&#x02264;&#x02009;3.</p></sec><sec id="Sec16"><title>Detection of anchor bubbles for haplotype synteny-based correction</title><p id="Par68">For the initial de Bruijn graph, simple bubbles, which consist of two straight nodes, two junction nodes, and four edges ((<italic>k</italic> &#x02212; 1)-length overlaps), are extracted to estimate the sequence coverage depth corresponding to non-repetitive regions in a genome. Here, similarly to Platanus, the sequence coverage depth of each node in a de Bruijn graph is estimated from the <italic>k</italic>-mer coverage depth. Most extracted simple bubbles are assumed to be heterozygous regions, and the length-weighted average value is calculated from the coverage depths of straight nodes inside the bubbles as the coverage depth of non-repetitive heterozygous regions, <italic>c</italic><sub>hetero</sub>. For each simple bubble in the initial de Bruijn graph, if the coverage depths of both straight nodes&#x02009;&#x02264;&#x02009;<italic>r</italic><sub>upper-threshold</sub>&#x02009;&#x000d7;&#x02009;<italic>c</italic><sub>hetero</sub> (<italic>r</italic><sub>upper-threthold</sub> is the constant value; default, 1.75), this value is used as an &#x0201c;anchor bubble&#x0201d; for haplotype synteny-based correction as described below.</p></sec><sec id="Sec17"><title>Untangling cross structures in the (gapped) de Bruijn graph</title><p id="Par69">By definition, a cross structure consists of five straight nodes and two junction nodes (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">2a</xref>). Note that the edges between nodes above are based on the de Bruijn graph, which reflects (<italic>k</italic> &#x02212; 1)-length overlaps of sequences. Next, for simplification, one straight node and the flanking two junction nodes are merged into one node, named as the &#x0201c;center node&#x0201d;, while the remaining four nodes are named as the &#x0201c;external nodes&#x0201d; (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">2b</xref>). Let <italic>c</italic><sub>hetero</sub> be the estimated average coverage depth of heterozygous nodes (for details, see &#x0201c;Methods&#x0201d;&#x000a0;section, Detection of anchor bubbles for haplotype synteny-based correction) and <italic>r</italic><sub>upper-threthold</sub> be the constant value to determine a threshold (default, 1.75). To phase non-repeat heterozygous regions, the untangling function targets cross structures that satisfy the following conditions (4, 5):<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{{coverage-depth-of-the-center-node}}} \le 2 \times r_{{\mathrm{{upper-threshold}}}} \times c_{\mathrm{hetero}}$$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="normal">coverage - depth - of - the - center - node</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">upper-threshold</mml:mi></mml:mrow></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hetero</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2019_9575_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par70">and<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{min}}\left( {{\mathrm{{coverage-depths-of-the-four-external-nodes}}}} \right) \le r_{\mathrm{{upper-threshold}}} \times c_{\mathrm{hetero}}$$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="normal">min</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">coverage - depths - of - the - four - external - nodes</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">upper-threshold</mml:mi></mml:mrow></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hetero</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2019_9575_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par71">Platanus-allee determines whether a cross structure is untangled as one of two possible solutions (depicted as parallel and cross in Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">2c</xref>), for which determination methods are available as follows:</p><p id="Par72">(1) According to the number of links</p><p id="Par73">For each solution (parallel or cross), the number of supporting links between external nodes is counted for paired-ends, mate-pairs, short-reads, and/or long-reads (see &#x0201c;Methods&#x0201d; section, Mapping all reads to a (gapped) de Bruijn graph). Let <italic>n</italic><sub>alt-link</sub> be the number of the links supporting the alternative solution. One solution is adopted as the result of untangling if the number of the links of the solution&#x02009;&#x02265;&#x02009;4&#x02009;&#x000d7;&#x02009;<italic>n</italic><sub>alt-link</sub>.</p><p id="Par74">(2) According to the number of match-sites in alignments of long-reads</p><p id="Par75">This function is designed for long-reads to select one solution with a higher alignment-score against alternative one for each cross structure. Similar to (1), for each solution, the number of match-sites (calculated by the Minimap2 aligner) in supporting links between external nodes is summed. Let <italic>m</italic><sub>alt</sub> be the number of match-sites supporting the alternative solution. Let <italic>n</italic><sub>alt-match</sub> be the sum of the match-sites in supporting links for alternative solution. One solution is adopted as the result of untangling if the number of match-sites for the solution is&#x02009;&#x02265;&#x02009;4&#x02009;&#x000d7;&#x02009;<italic>n</italic><sub>alt-match</sub>.</p><p id="Par76">(3) According to barcode-information of linked-reads (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">3</xref>)</p><p id="Par77">If the length of a center node is&#x02009;&#x02265;&#x02009;200 kbp, this function is not executed because of the limitation of lengths of DNA fragments for linked-reads. For common barcode sets between external nodes, the number of reads is summed and assigned for each resolution (for details regarding counting reads for barcodes, see &#x0201c;Methods&#x0201d;&#x000a0;section, Mapping linked-reads to a (gapped) de Bruijn graph). Let <italic>n</italic><sub>alt-barcode</sub> be the number of reads comprising the common barcode set in alternative solution. One solution is adopted as the result of untangling if the number of reads comprising the common barcode set the solution&#x02009;&#x02265;&#x02009;4&#x02009;&#x000d7;&#x02009;<italic>n</italic><sub>alt-barcode</sub>.</p><p id="Par78">Each untangling procedure above is iteratively executed. The iteration is ended if the number of iteration reaches five or number of untangled subgraphs is zero.</p></sec><sec id="Sec18"><title>Construction of the scaffold graph</title><p id="Par79">The resulting sequences of untangling of the de Bruijn graph (see &#x0201c;Methods&#x0201d; section, Untangling cross structures in the (gapped) de Bruijn graph) is input into the scaffolding module, which is derived from that of Platanus. The extension is that Platanus-allee can accept data from long-reads and handle multiple libraries simultaneously to construct a scaffold graph.</p></sec><sec id="Sec19"><title>Untangling cross structures in the scaffold graph</title><p id="Par80">For a scaffold graph, cross structures are detected and solved in a similar manner as in the untangling function for de Bruijn graphs (see &#x0201c;Methods&#x0201d;&#x000a0;section, Untangling cross structures in the (gapped) de Bruijn graph). The difference is that edges between the center and external nodes are not necessarily derived from (<italic>k</italic> &#x02212; 1)-length overlaps of sequences, but can be derived from link-information of read mapping. Short nodes are excluded from the scaffold graph according to the procedures of scaffold-graph construction; however, nodes containing anchor bubbles (<italic>i.e</italic>., candidates of heterozygous nodes) are not excluded.</p></sec><sec id="Sec20"><title>Haplotype synteny-based correction</title><p id="Par81">The summary of characteristic procedures associated with this step are as follows:</p><p id="Par82">(i) Anchor bubble detection</p><p id="Par83">Bubble structures in the initial de Bruijn graph are used as the anchors to associate homologous regions, assuming each HDR is flanked by the regions with the heterozygosity low enough to form bubbles. The bubbles derived from the repetitive sequences are excluded, using coverage depth information.</p><p id="Par84">(ii) Alignment of homologous haplotype sequences</p><p id="Par85">Haplotype sequences extended through untangling and scaffolding are aligned according to anchor bubbles, and homologous regions are determined. Omitting global sequence alignments, local structural differences between homologous pairs are permitted.</p><p id="Par86">This function is applied to a (gapped) de Bruijn graph or a scaffold graph, and the schematic model is shown in Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">3a</xref>. Each node of these graphs is a sequence consisting of nodes of the initial de Bruijn graph (contigs) and gaps (Ns) and has a numerical identifier (scaffold-ID). The procedures to correct one node, which consists of <italic>n</italic> contigs, are as follows:</p><p id="Par87">(1) Anchor bubble information (see &#x0201c;Methods&#x0201d; section, Detection of anchor bubbles for haplotype synteny-based correction) to find the homologous node are assigned to the contigs. Let <italic>b</italic><sub>1</sub>, <italic>b</italic><sub>2</sub>,&#x02026;, <italic>b</italic><sub><italic>n</italic></sub> be the numerical sequences. If the <italic>i-</italic>th contig (<italic>i</italic>&#x02009;&#x02208;&#x02009;{1, 2,&#x02026;, <italic>n</italic>}) is an anchor bubble, <italic>b</italic><sub><italic>i</italic></sub> is the scaffold-ID of the node to which the counterpart of <italic>i</italic>th contig belongs; otherwise <italic>b</italic><sub><italic>i</italic></sub>&#x02009;=&#x02009;0.</p><p id="Par88">(2) <italic>B</italic><sub>max</sub>, the scaffold-ID of the homologous counterpart of most anchor bubbles, is determined. Let <italic>l</italic><sub>1</sub>, <italic>l</italic><sub>2</sub>,&#x02026;, <italic>l</italic><sub><italic>n</italic></sub> be the lengths of the <italic>n</italic> contigs. <italic>L</italic><sub>sum</sub>(<italic>x</italic>) is the sum of all <italic>l</italic><sub><italic>i</italic></sub> such that <italic>b</italic><sub><italic>i</italic></sub>&#x02009;=&#x02009;<italic>x</italic>, and<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{{\mathrm{max}}} = \mathop {{{\mathrm{arg}}\;{\mathrm{max}}}}\limits_{x\; \in \;N} L_{{\mathrm{sum}}}(x)$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">arg</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mspace width="0.16em"/><mml:mo>&#x02208;</mml:mo><mml:mspace width="0.16em"/><mml:mi>N</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sum</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2019_9575_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par89">Note that <italic>x</italic> is a scaffold-ID and non-zero integer.</p><p id="Par90">(3) <italic>d</italic><sub>min</sub> and <italic>d</italic><sub>max</sub> are the minimum and maximum <italic>i</italic> such that <italic>b</italic><sub><italic>i</italic></sub>&#x02009;=&#x02009;<italic>B</italic><sub>max</sub>, respectively, and the candidate position to be divided for correction. Note that it is assumed that the region from the <italic>d</italic><sub>min</sub>-th to <italic>d</italic><sub>max</sub>-th contig retains synteny to the homologous counterpart.</p><p id="Par91">(4) Whether the region from the <italic>d</italic><sub>min</sub>-th to <italic>d</italic><sub>max</sub>-th contig contains many anchor bubbles whose counter-part-scaffold-IDs are not <italic>B</italic><sub>max</sub>. If so, <italic>d</italic><sub>min</sub> and/or <italic>d</italic><sub>max</sub> are corrected. For <italic>d</italic><sub>min</sub>, the division score is calculated as follows:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S(x) = \left\{ {\begin{array}{*{20}{l}} {S(x - 1)\;\mathrm{if}\;b_x = 0} \\ {S(x - 1) - l_x\;\mathrm{if}\;b_x = B_{{\mathrm{ma}}x}} \\ {S(x - 1) + l_x\;\mathrm{otherwise}} \end{array}} \right.x \in \{ d_{{\mathrm{min}}},d_{{\mathrm{min}}} + 1,...,d_{{\mathrm{max}}}\}$$\end{document}</tex-math><mml:math id="M14"><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.16em"/><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.16em"/><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ma</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">otherwise</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2019_9575_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par92">If positions at which <italic>S</italic>(<italic>x</italic>)&#x02009;&#x0003e;&#x02009;0 exist, the position at which <italic>S</italic>(<italic>x</italic>) is the maximum for <italic>x</italic> is the new <italic>d</italic><sub>min</sub>. This correction procedure is applied for <italic>d</italic><sub>max</sub> in a similar manner.</p><p id="Par93">(5) The node is divided and the region from the <italic>d</italic><sub>min</sub>-th to <italic>d</italic><sub>max</sub>-th contig becomes the new node.</p><p id="Par94">(6) Platanus-allee assumes that both ends of a homologous sequence-pair in a bubble correspond to each other as anchor bubbles. The schematic model of this step is shown in Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">3b</xref>. Here, the <italic>i</italic>-th contig in a node is referred to as the &#x0201c;edge contig&#x0201d; if <italic>i</italic>&#x02009;<italic>=</italic>&#x02009;0 or <italic>i</italic>&#x02009;=&#x02009;<italic>n</italic>; otherwise, it is called the &#x0201c;internal contig&#x0201d;. A node is divided at the position of internal contigs if its counterparts are the edge contigs of other nodes.</p><p id="Par95">The procedures described above are iteratively executed until the number of corrections (divisions) is zero. After iteration, nodes containing anchor bubbles are assumed as heterozygous bubble regions and are paired according to the anchor bubbles. The pairing information is used in the downstream steps.</p></sec><sec id="Sec21"><title>Gap-closing</title><p id="Par96">The gap-closing module, which maps paired-ends (mate-pairs) and assembles reads assigned to each gap, is derived from that of Platanus. This module is executed for results from the phasing module, and the steps through phasing and gap-closing are iterated twice (default) to output the final phased blocks (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1a</xref>). Note that mapping of reads is based on unique-hits (i.e., reads that are mapped to multiple regions are not used) and it is expected that haplotype phase information is retained without chimeric sequences.</p></sec><sec id="Sec22"><title>Construction of consensus scaffolds</title><p id="Par97">On the basis of the results of the phasing module, primary-bubbles and non-bubble sequences are input into the consensus-scaffolding module. First, (<italic>k</italic> &#x02212; 1)-length overlaps of input sequences are detected (<italic>k</italic> is the mer-length of the input de Bruijn graph for the phasing module). Each pair of input sequences is connected if the pair overlaps with each other without overlapping other sequences. Next, the connected sequences are input into the scaffolding procedure applied in the phasing module (Supplementary Note&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>), and the resulting sequences are referred to as consensus scaffolds.</p></sec><sec id="Sec23"><title>Constructing heterozygous 1k-mer pairs from Moleculo data</title><p id="Par98">The heterozygous 1k-mer pairs were used to benchmark the phasing performance of the tools for amphioxus and human (NA12878) samples. The procedures to construct 1k-mer pairs are as follows:</p><p id="Par99">(1) Bases in the Moleculo contigs with quality values&#x02009;&#x02264;&#x02009;40 were masked as &#x0201c;N&#x0201d;. Quality values were obtained from the FASTQ files.</p><p id="Par100">(2) Masked contigs were aligned to themselves using Minimap2 (version 2.9-r720) with the options of &#x0201c;-c -k 19 -p 0 -Xc --cs=long&#x0201d;. Note that the version of Minimap2 differs from those in the other sections, considering the usability of file-format conversions for downstream steps.</p><p id="Par101">(3) An alignment is referred to as a near-exact-match alignment if</p><p id="Par102">edit-distance&#x02009;&#x02264;&#x02009;# N-bases-in-both-aligned-regions.</p><p id="Par103">The information for edit distances and N bases in aligned regions were obtained from the values of &#x0201c;NM:i&#x0201d; and &#x0201c;cs:Z&#x0201d; in the PAF files, respectively. To exclude self-alignments and alignments between the same haplotypes, near-exact-match alignments were discarded.</p><p id="Par104">(4) For each Moleculo contig, the best hit, which showed the largest number of match-sites, was extracted from the result of step (3).</p><p id="Par105">(5) From the results of (4), alignments with a sequence-identity&#x02009;&#x02265;&#x02009;0.8 and alignment-length&#x02009;&#x02265;&#x02009;500 were extracted. The resulting alignments were assumed to be between homologous regions from different haplotypes.</p><p id="Par106">(6) The result of step (5), represented in PAF file format, was converted to MAF file format. The conversion was conducted using &#x0201c;paftools.js&#x0201d;, which is an attachment script of Minimap2 (version 2.9-r720).</p><p id="Par107">(7) Each alignment in the MAF file was divided into non-overlapping blocks in which the shorter sequence contained 1k bases (&#x02018;-&#x02018;s were not counted). The blocks containing &#x02018;N&#x02019; or no differences (i.e., homozygous) were discarded. The pairs of sequences in the resulting blocks were used as 1k-mer pairs as described below.</p><p id="Par108">(8) To further reduce the effect of sequencing errors, the 1k-mer pairs were aligned to all Moleculo contigs and the number of exact-matches was calculated. The 1k-mer pairs in which both sequences contained at least two exact-matches, were extracted and used as benchmarks for phasing performances of the tools.</p></sec><sec id="Sec24"><title>Whole-genome alignment between the C. elegans strains</title><p id="Par109">The reference genomes of the <italic>C. elegans</italic> N2 and CB4856 strains were aligned using a similar procedure to that described previously for the CB4856 strain genome<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. The specific procedures were as follows:</p><p id="Par110">(1) For each nuclear chromosome (I&#x02013;V and X), the reference sequences of the two strains were aligned using the LASTZ aligner<sup><xref ref-type="bibr" rid="CR55">55</xref></sup> (version 1.03.66) with the options of &#x0201c;-gap=400,30 -hspthresh=3000 -gappedthresh=3000 -masking=0 -format=LAV&#x0201d;.</p><p id="Par111">(2) For chaining of the alignments, the algorithm of ChainNet<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> is applied. Specifically, commands in the kentUtils toolkit (version v302.1; URL, <ext-link ext-link-type="uri" xlink:href="https://github.com/ENCODE-DCC/kentUtils">https://github.com/ENCODE-DCC/kentUtils</ext-link>) were sequentially executed for the LASTZ-alignments (LAV file) as follows: lavToPsl, axtChain (-linearGap=loose -psl), chainMergeSort, chainPreNet, chainNet and netToAxt. The file-formant of the result was AXT.</p><p id="Par112">(3) Alignments between regions from different strands were excluded and the sequence difference, (1 &#x02212; (# match-sites / # aligned-bases)), was calculated for each 1 Mbp-windows on the N2-strain reference chromosome. The sequence differences were assumed to reflect the heterozygosity of synthetic diploid data (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3b</xref>).</p><p id="Par113">(4) Each alignment in the AXT file was divided into non-overlapping blocks in which shorter sequence contains 1k bases (&#x02018;-&#x02018;s were not counted). The blocks containing &#x02018;N&#x02019; or no differences were discarded. Pairs of sequences in the resulting blocks were used as 1k-mer pairs for the benchmarks of phasing performances of the tools in a similar manner to Moleculo contigs (see &#x0201c;Methods&#x0201d; section, Construction of heterozygous 1k-mer pairs from Moleculo contigs).</p></sec><sec id="Sec25"><title>Detecting sequences absent from the human reference genome</title><p id="Par114">For the phased heterozygous blocks (bubbles) constructed from Illumina and PacBio data using Platanus-allee, we searched those not present in the reference genome (GRCh38.p10) based on the alinements of 1k-mers in the phased blocks. The procedures were as follows:</p><p id="Par115">(1) The phased blocks of Platanus-allee were divided into non-overlapping and fixed-length (1 kbp) fragments. Those containing gaps (&#x02018;N&#x02019;s) were discarded.</p><p id="Par116">(2) The fragments were aligned to the reference genome using Minimap2 (version 2.0-r191) with the options of &#x0201c;-c -k 19 -p 1&#x0201d;.</p><p id="Par117">(3) Alignments with an alignment-length&#x02009;&#x0003c;&#x02009;500 or sequence-identity&#x02009;&#x0003c;&#x02009;0.9 were extracted and treated as reference-unaligned.</p><p id="Par118">(4) Reference-unaligned fragments were aligned to the Moleculo contigs sets using Minimap2 with the same options as in step (2). The fragments without an exact-match to the Moleculo contigs were discarded. This step confirms that reference-unaligned fragments were not caused by mis-assemblies.</p><p id="Par119">(5) The rate of reference-unaligned fragments confirmed by the Moleculo contigs was calculated for each pair of bubbles.</p><p id="Par120">(6) The aligned-fragments-rates against the phased blocks of the other tools (FALCON-Unzip (raw and with Pilon, PH), Supernova, Mostovoy et al. 2016 pipeline<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>) were calculated in the same manner. Bubbles whose lengths (primary&#x02009;+&#x02009;secondary bubbles)&#x02009;&#x02265;&#x02009;100 kbp and unaligned-fragments-rate&#x02009;&#x02265;&#x02009;0.25 for the reference genome and phased blocks of the other tools were extracted (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">19</xref>).</p></sec></sec><sec sec-type="supplementary-material"><title>Supplementary information</title><sec id="Sec27"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="41467_2019_9575_MOESM1_ESM.pdf"><caption><p>Supplementary Information</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="41467_2019_9575_MOESM2_ESM.pdf"><caption><p>peer review file</p></caption></media></supplementary-material>
</p></sec></sec></body><back><fn-group><fn><p><bold>Journal peer review information:</bold>
<italic>Nature Communications</italic> thanks Justin Zook, Fritz Sedlazeck and the other anonymous reviewer for their contribution to the peer review of this work. Peer reviewer reports are available.</p></fn><fn><p><bold>Publisher&#x02019;s note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><sec><title>Supplementary information</title><p><bold>Supplementary Information</bold> accompanies this paper at 10.1038/s41467-019-09575-2.</p></sec><ack><title>Acknowledgements</title><p>We would like to thank the staff of Comparative Genomics Laboratory at NIG and Itoh Laboratory at Tokyo Tech for supporting genome sequencing. The experiment using TruSeq Synthetic Long Read Kit (Moleculo) is supported by Illumina inc. (San Diego, CA). This work was supported by MEXT KAKENHI Grant Number JP16H06279, JP16H04719, JP15H05979 and AMED Grant Number JP16gm6010003.</p></ack><notes notes-type="author-contribution"><title>Author contributions</title><p>T.I. designed and supervised this study. Y.M., H.K., A.F., K.K., Y.K., and A.T. collected and prepared the DNA samples. A.T. performed genomic DNA sequencing. R.K. developed the software. R.K., D.Y. and M.O. performed the benchmarks. R.K. and T.I wrote the manuscript.</p></notes><notes notes-type="data-availability"><title>Data availability</title><p>The whole-genome sequencing data generated in this study have been deposited under BioProject PRJDB7193. All other data are contained within the article and its supplementary information or upon reasonable request from the corresponding author.</p></notes><notes notes-type="data-availability"><title>Code availability</title><p>The source code of Platanus-allee (version 2.0.2) are freely available under GNU General Public License (GNU GPL) version 3 and can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://platanus.bio.titech.ac.jp/platanus2">http://platanus.bio.titech.ac.jp/platanus2</ext-link>.</p></notes><notes notes-type="COI-statement"><sec id="FPar1"><title>Competing interests</title><p>The authors declare no competing interests.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kajitani</surname><given-names>R</given-names></name><etal/></person-group><article-title>Efficient <italic>de novo</italic> assembly of highly heterozygous genomes from whole-genome shotgun short reads</article-title><source>Genome Res.</source><year>2014</year><volume>24</volume><fpage>1384</fpage><lpage>1395</lpage><pub-id pub-id-type="doi">10.1101/gr.170720.113</pub-id><pub-id pub-id-type="pmid">24755901</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nishikawa</surname><given-names>H</given-names></name><etal/></person-group><article-title>A genetic mechanism for female-limited Batesian mimicry in <italic>Papilio</italic> butterfly</article-title><source>Nat. Genet.</source><year>2015</year><volume>47</volume><fpage>405</fpage><lpage>409</lpage><pub-id pub-id-type="doi">10.1038/ng.3241</pub-id><pub-id pub-id-type="pmid">25751626</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>S</given-names></name><etal/></person-group><article-title>Decelerated genome evolution in modern vertebrates revealed by analysis of multiple lancelet genomes</article-title><source>Nat. Commun.</source><year>2014</year><volume>5</volume><fpage>5896</fpage><pub-id pub-id-type="doi">10.1038/ncomms6896</pub-id><pub-id pub-id-type="pmid">25523484</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Putnam</surname><given-names>NH</given-names></name><etal/></person-group><article-title>The amphioxus genome and the evolution of the chordate karyotype</article-title><source>Nature</source><year>2008</year><volume>453</volume><fpage>1064</fpage><lpage>1071</lpage><pub-id pub-id-type="doi">10.1038/nature06967</pub-id><pub-id pub-id-type="pmid">18563158</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Small</surname><given-names>KS</given-names></name><name><surname>Brudno</surname><given-names>M</given-names></name><name><surname>Hill</surname><given-names>MM</given-names></name><name><surname>Sidow</surname><given-names>A</given-names></name></person-group><article-title>Extreme genomic variation in a natural population</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2007</year><volume>104</volume><fpage>5698</fpage><lpage>5703</lpage><pub-id pub-id-type="doi">10.1073/pnas.0700890104</pub-id><pub-id pub-id-type="pmid">17372217</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>K&#x000fc;pper</surname><given-names>C</given-names></name><etal/></person-group><article-title>A supergene determines highly divergent male reproductive morphs in the ruff</article-title><source>Nat. Genet.</source><year>2015</year><volume>48</volume><fpage>79</fpage><lpage>83</lpage><pub-id pub-id-type="doi">10.1038/ng.3443</pub-id><pub-id pub-id-type="pmid">26569125</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lamichhaney</surname><given-names>S</given-names></name><etal/></person-group><article-title>Structural genomic changes underlie alternative reproductive strategies in the ruff (<italic>Philomachus pugnax</italic>)</article-title><source>Nat. Genet.</source><year>2015</year><volume>48</volume><fpage>84</fpage><lpage>88</lpage><pub-id pub-id-type="doi">10.1038/ng.3430</pub-id><pub-id pub-id-type="pmid">26569123</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>J</given-names></name><etal/></person-group><article-title>A Y-like social chromosome causes alternative colony organization in fire ants</article-title><source>Nature</source><year>2013</year><volume>493</volume><fpage>664</fpage><lpage>668</lpage><pub-id pub-id-type="doi">10.1038/nature11832</pub-id><pub-id pub-id-type="pmid">23334415</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malinsky</surname><given-names>M</given-names></name><etal/></person-group><article-title>Genomic islands of speciation separate cichlid ecomorphs in an East African crater lake</article-title><source>Science</source><year>2015</year><volume>350</volume><fpage>1493</fpage><lpage>1498</lpage><pub-id pub-id-type="doi">10.1126/science.aac9927</pub-id><pub-id pub-id-type="pmid">26680190</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burri</surname><given-names>R</given-names></name><etal/></person-group><article-title>Linked selection and recombination rate variation drive the evolution of the genomic landscape of differentiation across the speciation continuum of <italic>Ficedula</italic> flycatchers</article-title><source>Genome Res.</source><year>2015</year><volume>25</volume><fpage>1656</fpage><lpage>1665</lpage><pub-id pub-id-type="doi">10.1101/gr.196485.115</pub-id><pub-id pub-id-type="pmid">26355005</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Natri</surname><given-names>HM</given-names></name><name><surname>Shikano</surname><given-names>T</given-names></name><name><surname>Meril&#x000e4;</surname><given-names>J</given-names></name></person-group><article-title>Progressive recombination suppression and differentiation in recently evolved neo-sex chromosomes</article-title><source>Mol. Biol. Evol.</source><year>2013</year><volume>30</volume><fpage>1131</fpage><lpage>1144</lpage><pub-id pub-id-type="doi">10.1093/molbev/mst035</pub-id><pub-id pub-id-type="pmid">23436913</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sassa</surname><given-names>H</given-names></name><etal/></person-group><article-title>S locus F-box brothers: multiple and pollen-specific F-box genes with S haplotype-specific polymorphisms in apple and Japanese pear</article-title><source>Genetics</source><year>2007</year><volume>175</volume><fpage>1869</fpage><lpage>1881</lpage><pub-id pub-id-type="doi">10.1534/genetics.106.068858</pub-id><pub-id pub-id-type="pmid">17237509</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koren</surname><given-names>S</given-names></name><etal/></person-group><article-title>De novo assembly of haplotype-resolved genomes with trio binning.</article-title><source>Nat. Biotechnol.</source><year>2018</year><volume>36</volume><fpage>1174</fpage><lpage>1182</lpage><pub-id pub-id-type="doi">10.1038/nbt.4277</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DePristo</surname><given-names>MA</given-names></name><etal/></person-group><article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title><source>Nat. Genet.</source><year>2011</year><volume>43</volume><fpage>491</fpage><lpage>498</lpage><pub-id pub-id-type="doi">10.1038/ng.806</pub-id><pub-id pub-id-type="pmid">21478889</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weisenfeld</surname><given-names>NI</given-names></name><etal/></person-group><article-title>Comprehensive variation discovery in single human genomes</article-title><source>Nat. Genet.</source><year>2014</year><volume>46</volume><fpage>1350</fpage><lpage>1355</lpage><pub-id pub-id-type="doi">10.1038/ng.3121</pub-id><pub-id pub-id-type="pmid">25326702</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pendleton</surname><given-names>Matthew</given-names></name><name><surname>Sebra</surname><given-names>Robert</given-names></name><name><surname>Pang</surname><given-names>Andy Wing Chun</given-names></name><name><surname>Ummat</surname><given-names>Ajay</given-names></name><name><surname>Franzen</surname><given-names>Oscar</given-names></name><name><surname>Rausch</surname><given-names>Tobias</given-names></name><name><surname>St&#x000fc;tz</surname><given-names>Adrian M</given-names></name><name><surname>Stedman</surname><given-names>William</given-names></name><name><surname>Anantharaman</surname><given-names>Thomas</given-names></name><name><surname>Hastie</surname><given-names>Alex</given-names></name><name><surname>Dai</surname><given-names>Heng</given-names></name><name><surname>Fritz</surname><given-names>Markus Hsi-Yang</given-names></name><name><surname>Cao</surname><given-names>Han</given-names></name><name><surname>Cohain</surname><given-names>Ariella</given-names></name><name><surname>Deikus</surname><given-names>Gintaras</given-names></name><name><surname>Durrett</surname><given-names>Russell E</given-names></name><name><surname>Blanchard</surname><given-names>Scott C</given-names></name><name><surname>Altman</surname><given-names>Roger</given-names></name><name><surname>Chin</surname><given-names>Chen-Shan</given-names></name><name><surname>Guo</surname><given-names>Yan</given-names></name><name><surname>Paxinos</surname><given-names>Ellen E</given-names></name><name><surname>Korbel</surname><given-names>Jan O</given-names></name><name><surname>Darnell</surname><given-names>Robert B</given-names></name><name><surname>McCombie</surname><given-names>W Richard</given-names></name><name><surname>Kwok</surname><given-names>Pui-Yan</given-names></name><name><surname>Mason</surname><given-names>Christopher E</given-names></name><name><surname>Schadt</surname><given-names>Eric E</given-names></name><name><surname>Bashir</surname><given-names>Ali</given-names></name></person-group><article-title>Assembly and diploid architecture of an individual human genome via single-molecule technologies</article-title><source>Nature Methods</source><year>2015</year><volume>12</volume><issue>8</issue><fpage>780</fpage><lpage>786</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3454</pub-id><pub-id pub-id-type="pmid">26121404</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="other">Zheng, G. X. Y. et al. Haplotyping germline and cancer genomes with high-throughput linked-read sequencing.&#x000a0;<italic>Nat. Biotech.</italic>&#x000a0;<bold>34</bold>, 303&#x02013;311 (2016).EndFragment</mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="other">Chin, C.-S. et al. Phased diploid genome assembly with single-molecule real-time sequencing.&#x000a0;<italic>Nat. Methods</italic>&#x000a0;<bold>13</bold>, 1050&#x02013;1054 (2016).</mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="other">Pevzner, P., Tang, H. &#x00026; Waterman, M. An Eulerian path approach to DNA fragment assembly.&#x000a0;<italic>Proc. Natl Acad. Sci. USA.</italic><bold>98</bold>, 9748&#x02013;9753 (2001).</mixed-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Heng</given-names></name></person-group><article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title><source>Bioinformatics</source><year>2018</year><volume>34</volume><issue>18</issue><fpage>3094</fpage><lpage>3100</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id><pub-id pub-id-type="pmid">29750242</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>R.</given-names></name><name><surname>Zhu</surname><given-names>H.</given-names></name><name><surname>Ruan</surname><given-names>J.</given-names></name><name><surname>Qian</surname><given-names>W.</given-names></name><name><surname>Fang</surname><given-names>X.</given-names></name><name><surname>Shi</surname><given-names>Z.</given-names></name><name><surname>Li</surname><given-names>Y.</given-names></name><name><surname>Li</surname><given-names>S.</given-names></name><name><surname>Shan</surname><given-names>G.</given-names></name><name><surname>Kristiansen</surname><given-names>K.</given-names></name><name><surname>Li</surname><given-names>S.</given-names></name><name><surname>Yang</surname><given-names>H.</given-names></name><name><surname>Wang</surname><given-names>J.</given-names></name><name><surname>Wang</surname><given-names>J.</given-names></name></person-group><article-title>De novo assembly of human genomes with massively parallel short read sequencing</article-title><source>Genome Research</source><year>2009</year><volume>20</volume><issue>2</issue><fpage>265</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1101/gr.097261.109</pub-id><pub-id pub-id-type="pmid">20019144</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bankevich</surname><given-names>Anton</given-names></name><name><surname>Nurk</surname><given-names>Sergey</given-names></name><name><surname>Antipov</surname><given-names>Dmitry</given-names></name><name><surname>Gurevich</surname><given-names>Alexey A.</given-names></name><name><surname>Dvorkin</surname><given-names>Mikhail</given-names></name><name><surname>Kulikov</surname><given-names>Alexander S.</given-names></name><name><surname>Lesin</surname><given-names>Valery M.</given-names></name><name><surname>Nikolenko</surname><given-names>Sergey I.</given-names></name><name><surname>Pham</surname><given-names>Son</given-names></name><name><surname>Prjibelski</surname><given-names>Andrey D.</given-names></name><name><surname>Pyshkin</surname><given-names>Alexey V.</given-names></name><name><surname>Sirotkin</surname><given-names>Alexander V.</given-names></name><name><surname>Vyahhi</surname><given-names>Nikolay</given-names></name><name><surname>Tesler</surname><given-names>Glenn</given-names></name><name><surname>Alekseyev</surname><given-names>Max A.</given-names></name><name><surname>Pevzner</surname><given-names>Pavel A.</given-names></name></person-group><article-title>SPAdes: A New Genome Assembly Algorithm and Its Applications to Single-Cell Sequencing</article-title><source>Journal of Computational Biology</source><year>2012</year><volume>19</volume><issue>5</issue><fpage>455</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1089/cmb.2012.0021</pub-id><pub-id pub-id-type="pmid">22506599</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="other">Weisenfeld, N. I., Kumar, V., Shah, P., Church, D. M. &#x00026; Jaffe, D. B. Direct determination of diploid genome sequences.&#x000a0;<italic>Genome Res.</italic>&#x000a0;<bold>27</bold>,&#x000a0;757&#x02013;767 (2017).</mixed-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walker</surname><given-names>Bruce J.</given-names></name><name><surname>Abeel</surname><given-names>Thomas</given-names></name><name><surname>Shea</surname><given-names>Terrance</given-names></name><name><surname>Priest</surname><given-names>Margaret</given-names></name><name><surname>Abouelliel</surname><given-names>Amr</given-names></name><name><surname>Sakthikumar</surname><given-names>Sharadha</given-names></name><name><surname>Cuomo</surname><given-names>Christina A.</given-names></name><name><surname>Zeng</surname><given-names>Qiandong</given-names></name><name><surname>Wortman</surname><given-names>Jennifer</given-names></name><name><surname>Young</surname><given-names>Sarah K.</given-names></name><name><surname>Earl</surname><given-names>Ashlee M.</given-names></name></person-group><article-title>Pilon: An Integrated Tool for Comprehensive Microbial Variant Detection and Genome Assembly Improvement</article-title><source>PLoS ONE</source><year>2014</year><volume>9</volume><issue>11</issue><fpage>e112963</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0112963</pub-id><pub-id pub-id-type="pmid">25409509</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="other">Roach, M. J., Schmidt, S. A. &#x00026; Borneman, A. R. Purge Haplotigs: allelic contig reassignment for third-gen diploid genome assemblies.&#x000a0;<italic>BMC Bioinformatics</italic>&#x000a0;<bold>19</bold>,&#x000a0;460 (2018).</mixed-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vurture</surname><given-names>Gregory W</given-names></name><name><surname>Sedlazeck</surname><given-names>Fritz J</given-names></name><name><surname>Nattestad</surname><given-names>Maria</given-names></name><name><surname>Underwood</surname><given-names>Charles J</given-names></name><name><surname>Fang</surname><given-names>Han</given-names></name><name><surname>Gurtowski</surname><given-names>James</given-names></name><name><surname>Schatz</surname><given-names>Michael C</given-names></name></person-group><article-title>GenomeScope: fast reference-free genome profiling from short reads</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><issue>14</issue><fpage>2202</fpage><lpage>2204</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btx153</pub-id><pub-id pub-id-type="pmid">28369201</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sim&#x000e3;o</surname><given-names>FA</given-names></name><name><surname>Waterhouse</surname><given-names>RM</given-names></name><name><surname>Ioannidis</surname><given-names>P</given-names></name><name><surname>Kriventseva</surname><given-names>EV</given-names></name><name><surname>Zdobnov</surname><given-names>EM</given-names></name></person-group><article-title>BUSCO: assessing genome assembly and annotation completeness with single-copy orthologs</article-title><source>Bioinformatics</source><year>2015</year><volume>31</volume><fpage>3210</fpage><lpage>3212</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv351</pub-id><pub-id pub-id-type="pmid">26059717</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Voskoboynik</surname><given-names>A</given-names></name><etal/></person-group><article-title>The genome sequence of the colonial chordate, Botryllus schlosseri</article-title><source>eLife</source><year>2013</year><volume>2</volume><fpage>e00569</fpage><pub-id pub-id-type="doi">10.7554/eLife.00569</pub-id><pub-id pub-id-type="pmid">23840927</pub-id></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><collab>The C. elegans Sequencing Consortium.</collab></person-group><article-title>Genome sequence of the nematode <italic>C. elegans</italic>: a platform for investigating biology</article-title><source>Science</source><year>1998</year><volume>282</volume><fpage>2012</fpage><lpage>2018</lpage><pub-id pub-id-type="doi">10.1126/science.282.5396.2012</pub-id><pub-id pub-id-type="pmid">9851916</pub-id></element-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>OA</given-names></name><etal/></person-group><article-title>Remarkably divergent regions punctuate the genome assembly of the <italic>Caenorhabditis elegans</italic> Hawaiian strain CB4856</article-title><source>Genetics</source><year>2015</year><volume>200</volume><fpage>975</fpage><lpage>989</lpage><pub-id pub-id-type="doi">10.1534/genetics.115.175950</pub-id><pub-id pub-id-type="pmid">25995208</pub-id></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mostovoy</surname><given-names>Y</given-names></name><etal/></person-group><article-title>A hybrid approach for <italic>de novo</italic> human genome sequence assembly and phasing</article-title><source>Nat. Methods</source><year>2016</year><volume>13</volume><fpage>587</fpage><lpage>590</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3865</pub-id><pub-id pub-id-type="pmid">27159086</pub-id></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sudmant</surname><given-names>PH</given-names></name><etal/></person-group><article-title>An integrated map of structural variation in 2,504 human genomes</article-title><source>Nature</source><year>2015</year><volume>526</volume><fpage>75</fpage><lpage>81</lpage><pub-id pub-id-type="doi">10.1038/nature15394</pub-id><pub-id pub-id-type="pmid">26432246</pub-id></element-citation></ref><ref id="CR33"><label>33.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>H</given-names></name><etal/></person-group><article-title><italic>De novo</italic> assembly of a haplotype-resolved human genome</article-title><source>Nat. Biotech.</source><year>2015</year><volume>33</volume><fpage>617</fpage><lpage>622</lpage><pub-id pub-id-type="doi">10.1038/nbt.3200</pub-id></element-citation></ref><ref id="CR34"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eberle</surname><given-names>MA</given-names></name><etal/></person-group><article-title>A reference dataset of 5.4 million phased human variants validated by genetic inheritance from sequencing a three-generation 17-member pedigree</article-title><source>Genome Res.</source><year>2017</year><volume>27</volume><fpage>157</fpage><lpage>164</lpage><pub-id pub-id-type="doi">10.1101/gr.210500.116</pub-id><pub-id pub-id-type="pmid">27903644</pub-id></element-citation></ref><ref id="CR35"><label>35.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trowsdale</surname><given-names>J</given-names></name><name><surname>Knight</surname><given-names>JC</given-names></name></person-group><article-title>Major Histocompatibility Complex Genomics and Human Disease</article-title><source>Annu. Rev. Genomics Hum. Genet.</source><year>2013</year><volume>14</volume><fpage>301</fpage><lpage>323</lpage><pub-id pub-id-type="doi">10.1146/annurev-genom-091212-153455</pub-id><pub-id pub-id-type="pmid">23875801</pub-id></element-citation></ref><ref id="CR36"><label>36.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dilthey</surname><given-names>AT</given-names></name><etal/></person-group><article-title>High-accuracy HLA type inference from whole-genome sequencing data using population reference graphs</article-title><source>PLoS. Comput. Biol.</source><year>2016</year><volume>12</volume><fpage>e1005151</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005151</pub-id><pub-id pub-id-type="pmid">27792722</pub-id></element-citation></ref><ref id="CR37"><label>37.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baek</surname><given-names>S</given-names></name><etal/></person-group><article-title>Draft genome sequence of wild <italic>Prunus yedoensis</italic> reveals massive inter-specific hybridization between sympatric flowering cherries</article-title><source>Genome. Biol.</source><year>2018</year><volume>19</volume><fpage>1</fpage><lpage>17</lpage><pub-id pub-id-type="doi">10.1186/s13059-018-1497-y</pub-id><pub-id pub-id-type="pmid">29301551</pub-id></element-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>G</given-names></name><etal/></person-group><article-title>Comparative analysis of bat genomes provides insight into the evolution of flight and immunity</article-title><source>Science</source><year>2013</year><volume>339</volume><fpage>456</fpage><lpage>460</lpage><pub-id pub-id-type="doi">10.1126/science.1230835</pub-id><pub-id pub-id-type="pmid">23258410</pub-id></element-citation></ref><ref id="CR39"><label>39.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>W</given-names></name><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Myers</surname><given-names>JR</given-names></name><name><surname>Marth</surname><given-names>GT</given-names></name></person-group><article-title>ART: a next-generation sequencing read simulator</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>593</fpage><lpage>594</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id><pub-id pub-id-type="pmid">22199392</pub-id></element-citation></ref><ref id="CR40"><label>40.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lau</surname><given-names>B</given-names></name><etal/></person-group><article-title>LongISLND: in silico sequencing of lengthy and noisy datatypes</article-title><source>Bioinformatics</source><year>2016</year><volume>32</volume><fpage>3829</fpage><lpage>3832</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw602</pub-id><pub-id pub-id-type="pmid">27667791</pub-id></element-citation></ref><ref id="CR41"><label>41.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>R</given-names></name><name><surname>Sedlazeck</surname><given-names>FJ</given-names></name><name><surname>Darby</surname><given-names>CA</given-names></name><name><surname>Kelly</surname><given-names>SM</given-names></name><name><surname>Schatz</surname><given-names>MC</given-names></name></person-group><article-title>LRSim: a linked-reads simulator generating insights for better genome partitioning</article-title><source>Comput. Struct. Biotechnol. J.</source><year>2017</year><volume>15</volume><fpage>478</fpage><lpage>484</lpage><pub-id pub-id-type="doi">10.1016/j.csbj.2017.10.002</pub-id><pub-id pub-id-type="pmid">29213995</pub-id></element-citation></ref><ref id="CR42"><label>42.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>X</given-names></name><etal/></person-group><article-title>pIRS: profile-based Illumina pair-end reads simulator</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>1533</fpage><lpage>1535</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts187</pub-id><pub-id pub-id-type="pmid">22508794</pub-id></element-citation></ref><ref id="CR43"><label>43.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Avni</surname><given-names>R</given-names></name><etal/></person-group><article-title>Wild emmer genome architecture and diversity elucidate wheat evolution and domestication</article-title><source>Science</source><year>2017</year><volume>357</volume><fpage>93</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1126/science.aan0032</pub-id><pub-id pub-id-type="pmid">28684525</pub-id></element-citation></ref><ref id="CR44"><label>44.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>J</given-names></name><etal/></person-group><article-title>Haplotype-resolved sweet potato genome traces back its hexaploidization history</article-title><source>Nat. Plants</source><year>2017</year><volume>3</volume><fpage>696</fpage><lpage>703</lpage><pub-id pub-id-type="doi">10.1038/s41477-017-0002-z</pub-id><pub-id pub-id-type="pmid">28827752</pub-id></element-citation></ref><ref id="CR45"><label>45.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maretty</surname><given-names>L</given-names></name><etal/></person-group><article-title>Sequencing and <italic>de novo</italic> assembly of 150 genomes from Denmark as a population reference</article-title><source>Nature</source><year>2017</year><volume>548</volume><fpage>87</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1038/nature23264</pub-id><pub-id pub-id-type="pmid">28746312</pub-id></element-citation></ref><ref id="CR46"><label>46.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koren</surname><given-names>S</given-names></name><etal/></person-group><article-title>Canu: Scalable and accurate long-read assembly via adaptive <italic>k</italic>-mer weighting and repeat separation</article-title><source>Genome Res.</source><year>2017</year><volume>27</volume><fpage>722</fpage><lpage>736</lpage><pub-id pub-id-type="doi">10.1101/gr.215087.116</pub-id><pub-id pub-id-type="pmid">28298431</pub-id></element-citation></ref><ref id="CR47"><label>47.</label><mixed-citation publication-type="other">Paajanen, P. et al. A critical comparison of technologies for a plant genome sequencing project. <italic>Gigascience</italic>10.1093/gigascience/giy163 (2019).</mixed-citation></ref><ref id="CR48"><label>48.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sedlazeck</surname><given-names>FJ</given-names></name><name><surname>Lee</surname><given-names>H</given-names></name><name><surname>Darby</surname><given-names>CA</given-names></name><name><surname>Schatz</surname><given-names>MC</given-names></name></person-group><article-title>Piercing the dark matter: bioinformatics of long-range sequencing and mapping</article-title><source>Nat. Rev. Genet.</source><year>2018</year><volume>19</volume><fpage>329</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1038/s41576-018-0003-4</pub-id><pub-id pub-id-type="pmid">29599501</pub-id></element-citation></ref><ref id="CR49"><label>49.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rhoads</surname><given-names>A</given-names></name><name><surname>Au</surname><given-names>KFPacBio</given-names></name></person-group><article-title>Sequencing and Its applications</article-title><source>Genomics Proteomics Bioinformatics</source><year>2015</year><volume>15</volume><fpage>279</fpage><lpage>289</lpage></element-citation></ref><ref id="CR50"><label>50.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deng</surname><given-names>Q</given-names></name><etal/></person-group><article-title>Single-Cell RNA-Seq reveals dynamic, random monoallelic gene expression in mammalian cells</article-title><source>Science</source><year>2014</year><volume>343</volume><fpage>193</fpage><lpage>196</lpage><pub-id pub-id-type="doi">10.1126/science.1245316</pub-id><pub-id pub-id-type="pmid">24408435</pub-id></element-citation></ref><ref id="CR51"><label>51.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borel</surname><given-names>C</given-names></name><etal/></person-group><article-title>Biased allelic expression in human primary fibroblast single cells</article-title><source>Am. J. Hum. Genet.</source><year>2015</year><volume>96</volume><fpage>70</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2014.12.001</pub-id><pub-id pub-id-type="pmid">25557783</pub-id></element-citation></ref><ref id="CR52"><label>52.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Okuno</surname><given-names>M</given-names></name><etal/></person-group><article-title>Next-generation sequencing analysis of lager brewing yeast strains reveals the evolutionary history of interspecies hybridization</article-title><source>DNA Res.</source><year>2016</year><volume>23</volume><fpage>67</fpage><lpage>80</lpage><?supplied-pmid 26732986?><pub-id pub-id-type="pmid">26732986</pub-id></element-citation></ref><ref id="CR53"><label>53.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schiffels</surname><given-names>S</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>Inferring human population size and separation history from multiple genome sequences</article-title><source>Nat. Genet.</source><year>2014</year><volume>46</volume><fpage>919</fpage><lpage>925</lpage><pub-id pub-id-type="doi">10.1038/ng.3015</pub-id><pub-id pub-id-type="pmid">24952747</pub-id></element-citation></ref><ref id="CR54"><label>54.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hart</surname><given-names>MW</given-names></name></person-group><article-title>Structure and evolution of the sea star egg receptor for sperm bindin</article-title><source>Mol. Ecol.</source><year>2013</year><volume>22</volume><fpage>2143</fpage><lpage>2156</lpage><pub-id pub-id-type="doi">10.1111/mec.12251</pub-id><pub-id pub-id-type="pmid">23432510</pub-id></element-citation></ref><ref id="CR55"><label>55.</label><mixed-citation publication-type="other">Harris, R. S. <italic>Improved Pairwise Alignment of Genomic DNA</italic>. Ph.D. Thesis, The Pennsylvania State University (2007).</mixed-citation></ref><ref id="CR56"><label>56.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kent</surname><given-names>JW</given-names></name><name><surname>Baertsch</surname><given-names>R</given-names></name><name><surname>Hinrichs</surname><given-names>A</given-names></name><name><surname>Miller</surname><given-names>W</given-names></name><name><surname>Haussler</surname><given-names>D</given-names></name></person-group><article-title>Evolution&#x02019;s cauldron: duplication, deletion, and rearrangement in the mouse and human genomes</article-title><source>Proc. Natl Acad. Sci.</source><year>2003</year><volume>100</volume><fpage>11484</fpage><lpage>11489</lpage><pub-id pub-id-type="doi">10.1073/pnas.1932072100</pub-id><pub-id pub-id-type="pmid">14500911</pub-id></element-citation></ref><ref id="CR57"><label>57.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kurtz</surname><given-names>S</given-names></name><etal/></person-group><article-title>Versatile and open software for comparing large genomes</article-title><source>Genome. Biol.</source><year>2004</year><volume>5</volume><fpage>R12</fpage><pub-id pub-id-type="doi">10.1186/gb-2004-5-2-r12</pub-id><pub-id pub-id-type="pmid">14759262</pub-id></element-citation></ref></ref-list></back></article>