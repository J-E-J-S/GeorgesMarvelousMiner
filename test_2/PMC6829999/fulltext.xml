<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id><journal-title-group><journal-title>BMC Bioinformatics</journal-title></journal-title-group><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6829999</article-id><article-id pub-id-type="publisher-id">3146</article-id><article-id pub-id-type="doi">10.1186/s12859-019-3146-1</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>A comparative study of topology-based pathway enrichment analysis methods</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6294-227X</contrib-id><name><surname>Ma</surname><given-names>Jing</given-names></name><address><email>jingma@tamu.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Shojaie</surname><given-names>Ali</given-names></name><address><email>ashojaie@uw.edu</email></address><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Michailidis</surname><given-names>George</given-names></name><address><email>gmichail@ufl.edu</email></address><xref ref-type="aff" rid="Aff4">4</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 4687 2082</institution-id><institution-id institution-id-type="GRID">grid.264756.4</institution-id><institution>Texas A&#x00026;M University, </institution></institution-wrap>Department of Statistics, College Station, 77840 USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2180 1622</institution-id><institution-id institution-id-type="GRID">grid.270240.3</institution-id><institution>Fred Hutchinson Cancer Research Center, </institution></institution-wrap>Public Health Sciences Division, Seattle, 98107 USA </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000000122986657</institution-id><institution-id institution-id-type="GRID">grid.34477.33</institution-id><institution>University of Washington, </institution></institution-wrap>Department of Biostatistics, Seattle, 98105 USA </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8091</institution-id><institution-id institution-id-type="GRID">grid.15276.37</institution-id><institution>University of Florida, </institution></institution-wrap>Department of Statistics, Gainesville, 32611 USA </aff></contrib-group><pub-date pub-type="epub"><day>4</day><month>11</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>4</day><month>11</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>20</volume><elocation-id>546</elocation-id><history><date date-type="received"><day>17</day><month>9</month><year>2018</year></date><date date-type="accepted"><day>2</day><month>10</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p id="Par1">Pathway enrichment extensively used in the analysis of Omics data for gaining biological insights into the functional roles of pre-defined subsets of genes, proteins and metabolites. A large number of methods have been proposed in the literature for this task. The vast majority of these methods use as input expression levels of the biomolecules under study together with their membership in pathways of interest. The latest generation of pathway enrichment methods also leverages information on the topology of the underlying pathways, which as evidence from their evaluation reveals, lead to improved sensitivity and specificity. Nevertheless, a systematic empirical comparison of such methods is still lacking, making selection of the most suitable method for a specific experimental setting challenging. This comparative study of nine network-based methods for pathway enrichment analysis aims to provide a systematic evaluation of their performance based on three real data sets with different number of features (genes/metabolites) and number of samples.</p></sec><sec><title>Results</title><p id="Par2">The findings highlight both methodological and empirical differences across the nine methods. In particular, certain methods assess pathway enrichment due to differences both across expression levels and in the strength of the interconnectedness of the members of the pathway, while others only leverage differential expression levels. In the more challenging setting involving a metabolomics data set, the results show that methods that utilize both pieces of information (with NetGSA being a prototypical one) exhibit superior statistical power in detecting pathway enrichment.</p></sec><sec><title>Conclusion</title><p id="Par3">The analysis reveals that a number of methods perform equally well when testing large size pathways, which is the case with genomic data. On the other hand, NetGSA that takes into consideration both differential expression of the biomolecules in the pathway, as well as changes in the topology exhibits a superior performance when testing small size pathways, which is usually the case for metabolomics data.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Pathway enrichment analysis</kwd><kwd>Pathway topology</kwd><kwd>Type I error</kwd><kwd>Power</kwd><kwd>Differential network biology</kwd></kwd-group><funding-group><award-group><funding-source><institution>NIH</institution></funding-source><award-id>R01 GM114029</award-id></award-group></funding-group><funding-group><award-group><funding-source><institution>NIH</institution></funding-source><award-id>R01 GM114029</award-id></award-group></funding-group><funding-group><award-group><funding-source><institution>NSF</institution></funding-source><award-id>DMS-1561814</award-id></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p>Pathway enrichment has become a standard tool in the analytic pipeline for Omics data, since it reduces the complexity and provides a systems view of the biological question under investigation [<xref ref-type="bibr" rid="CR1">1</xref>&#x02013;<xref ref-type="bibr" rid="CR5">5</xref>]. Dozens of methods have been proposed in the literature, ranging in modeling sophistication and effectiveness [<xref ref-type="bibr" rid="CR6">6</xref>&#x02013;<xref ref-type="bibr" rid="CR19">19</xref>]. A number of papers have provided comprehensive reviews of available methods [<xref ref-type="bibr" rid="CR20">20</xref>&#x02013;<xref ref-type="bibr" rid="CR22">22</xref>] capturing the evolving technical landscape, as well as the range of data types and applications (genes, proteins, etc.). In [<xref ref-type="bibr" rid="CR20">20</xref>], existing methods have been classified into three generations, the first two corresponding respectively to over-representation analysis (ORA) and functional class scoring (FCS) methods. FCS methods were motivated by the fact that there may be a coordinated activity in functionally related sets of genes, even though each one of them may not be deemed significantly differential by over-representation analysis. The current review focuses on the third generation of pathway analysis methods, namely, topology-based pathway enrichment analysis methods, which utilize information about the interconnections of genes (or other biomolecules) within the pathways, and offer improved performance over conventional second generation methods [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>].</p><p>Despite the plethora of available methods, there has been a scarcity of systematic comparisons of their performance in controlled settings based on synthetic or real data sets. In [<xref ref-type="bibr" rid="CR23">23</xref>] and [<xref ref-type="bibr" rid="CR24">24</xref>], several pathway analysis methods were compared in case studies by assessing the consistency of selected significant pathways. The results confirm that nominated enriched pathways can differ widely across methods, which coupled with absence of a ground truth, makes it difficult to offer guidance to practitioners. In [<xref ref-type="bibr" rid="CR25">25</xref>], pathway enrichment methods that do not use topology information were compared to topology-based ones. The conclusion was that topology-based methods exhibit superior performance when the pathways under study do not overlap, but not otherwise. However, the data sets examined correspond to small scale studies with no more than 50 samples in total. Moreover, existing comparative studies have primarily focused on methods developed for gene expression data, which may not be suitable for studies involving metabolomics or lipidomics data, where quantitation of all biomolecules in the pathways under study may be incomplete.</p><p>Pathway enrichment methods aim to compare the &#x02018;activity&#x02019; of pathways of interest across two or more biological conditions or groups of specimens (patients, cell lines, etc.). At the technical level, an important feature is the nature of the statistical null hypothesis being tested. Most methods can be categorized to those testing (I) <italic>self-contained</italic> and (II) <italic>competitive</italic> null hypotheses [<xref ref-type="bibr" rid="CR26">26</xref>]. A competitive null hypothesis compares the activity of each pathway with other biomolecules/pathways. In contrast, a self-contained null hypothesis compares the activity of each pathway across the biological conditions (e.g. normal vs. disease samples), without comparing it to the other biomolecules/pathways. This difference in the objective results in differences in procedures used for evaluating self-contained and competitive hypotheses (including, e.g., permutation strategies), as well as interpretations of results. In the discussion of methodological issues concerning analysis of sets of biomolecules in [<xref ref-type="bibr" rid="CR26">26</xref>], the authors argued against the competitive null hypothesis, since tests based on it consider biomolecules as the sampling units which are clearly not independent.</p><p>In the current comparative study, we examine nine popular topology-based pathway analysis methods that investigate different null hypotheses. Methods considered in this review have good user interface in R, and include Pathway-Express [<xref ref-type="bibr" rid="CR8">8</xref>], SPIA [<xref ref-type="bibr" rid="CR9">9</xref>], NetGSA [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>], topologyGSA [<xref ref-type="bibr" rid="CR12">12</xref>], DEGraph [<xref ref-type="bibr" rid="CR13">13</xref>], CAMERA [<xref ref-type="bibr" rid="CR14">14</xref>], CePa [<xref ref-type="bibr" rid="CR15">15</xref>], PRS [<xref ref-type="bibr" rid="CR16">16</xref>] and PathNet [<xref ref-type="bibr" rid="CR17">17</xref>]. Given the importance of availability of open-source software for conducting simulation experiments, popular approaches with only web-based interfaces, such as Ingenuity Pathway Analysis [<xref ref-type="bibr" rid="CR27">27</xref>], are not included in our comparison. We assess the performance of the above nine methods by performing an extensive numerical analysis using <italic>in silico</italic> experiments that offer advantages over simulation experiments conducted on purely synthetic data [<xref ref-type="bibr" rid="CR25">25</xref>] or evaluation based on publicly available data [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. On the one hand, unlike commonly used simulation experiments, our experiments maintain the complexity of real gene/metabolite expression data sets by generating simulated signals from three data sets containing gene and metabolite expressions. On the other hand, unlike comparisons based on publicly available data, active genes/metabolites and pathways are well-controlled in our experiments, allowing us to assess false positive rates and statistical power of the nine pathway analysis methods. Moreover, our review differs from previous ones in that we base our comparisons both on gene expression data and on metabolomic data. The two gene expression data sets studied contain at least 100 samples per condition/group, which enable us to include more genes and pathways of potential relevance in the enrichment analysis. The metabolomic data set provides a different perspective as enrichment analysis of metabolomics data presents additional challenges due to the smaller size of biochemical pathways, their high degrees of overlap, as well as their incomplete coverage by many mass spectrometry acquired data sets.</p></sec><sec id="Sec2"><title>Experimental design</title><p>To systematically evaluate the type I error and power of the nine pathway enrichment methods, we consider a variety of settings using three different data sets, two from cancer genomics and one based on metabolomics.</p><sec id="Sec3"><title>Pathway dysregulation</title><p>We analyzed primary metabolic pathways mapped from KEGG in the metabolomic study, and KEGG pathways that describe signaling and biochemical functions and their interactions in the cancer genomic studies (see Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref> for the complete lists of pathways analyzed). To obtain synthetic, but realistic omics data, a subset <italic>q</italic>&#x0003c;<italic>K</italic> out of a total <italic>K</italic> pathways were first randomly selected as &#x02018;dysregulated&#x02019;. Next, a pre-specified proportion of genes/metabolites within each dysregulated pathway was chosen to be altered. This proportion, referred to as <italic>detection call</italic> (DC), was set to be 20% for the metabolomic study and 10% for the cancer genomic studies. Due to the smaller pathway sizes and limited number of known interactions within each pathway, affected metabolites were selected randomly from each dysregulated pathway. Since genetic pathways are typically larger in size and have well documented interactions in the graphite package, we considered three mechanisms to select affected genes within each dysregulated pathway following the practice in [<xref ref-type="bibr" rid="CR25">25</xref>].</p><p>Note that due to the overlap amongst pathways, a 10% DC threshold may lead to some pathways with more than 10% affected genes/metabolites and more than <italic>q</italic> pathways with at least one affected gene/metabolite.</p><p><bold>Betweenness</bold>
The betweenness of a gene quantifies how often the gene appears on the shortest path between two other genes and effectively measures how important a gene is in the pathway. To select affected genes under this dysregulation design, pathway members are first ranked by their degrees of betweenness. Affected genes are set to be those whose betweenness is above a certain threshold, which is chosen so that a 10% DC is reached.</p><p><bold>Community</bold>
Biological networks tend to contain modules (communities) that are densely connected internally and loosely connected in between. For a pre-specified pathway with a given topology, we find the communities within the pathway using a community detection algorithm, e.g., using the function cluster_edge_betweenness from the igraphR package [<xref ref-type="bibr" rid="CR28">28</xref>]. We then search for a community that approximately represents the 10% DC level.</p><p><bold>Neighborhood</bold>
Under the neighborhood dysregulation design, members within a certain shortest path distance of a randomly chosen gene are used to define the affected genes. The distance parameter is optimized such that a 10% DC is reached after looping over all members within the pathway.</p></sec><sec id="Sec7"><title>Data generating model</title><p>The steps for generating simulated data are illustrated in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> and described below. We start with the original log-transformed expression data from <italic>p</italic> genes/metabolites and <italic>n</italic> samples (left heat map in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). Each sample is assumed to follow a distribution <italic>f</italic> with mean <italic>&#x003bc;</italic> and covariance <italic>&#x003a3;</italic>. More specifically, let 
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ Y^{(i)} \sim \left\{\begin{array}{ll} f(\mu_{1}, \Sigma_{1}) \quad (i=1, \ldots, n_{1}), \\ f(\mu_{2}, \Sigma_{2}) \quad (i=n_{1}+1, \ldots, n). \end{array}\right. $$ \end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>&#x0223c;</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2019_3146_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> Here we do not assume <italic>f</italic> to be the multivariate normal distribution not only because the distribution of real data is far more complex but because we aim for an agnostic mechanism for data generation that does not favor any method. By assuming a general distribution <italic>f</italic>, we can also assess whether the compared methods are sensitive to normality assumptions.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematics of the simulation design. In each study, real expression data is used to carry out the simulations. From left to right, the original expression data is first standardized such that each gene/metabolite has mean zero and unit variance. Varying mean signals are then added to genes/metabolites in the selected pathways in each of the simulation replicates. The top bar indicates the sample labels, which are either the original case/control status or a random permutation of the original case/control status</p></caption><graphic xlink:href="12859_2019_3146_Fig1_HTML" id="MO1"/></fig>
</p><p>The data were standardized so that each gene/metabolite has mean zero and unit variance. This corresponds to the middle heat map in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> and the model 
<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \widetilde Y^{(i)} \sim \left\{\begin{array}{ll} f\left(0, \widetilde \Sigma_{1}\right) \quad (i=1, \ldots, n_{1}), \\ f\left(0, \widetilde \Sigma_{2}\right) \quad (i=n_{1}+1, \ldots, n), \end{array}\right. $$ \end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>&#x0223c;</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2019_3146_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\widetilde \Sigma _{k} \ (k=1,2)$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq1.gif"/></alternatives></inline-formula> is the correlation matrix.</p><p>We considered both settings with and without sample permutation. 
<list list-type="bullet"><list-item><p>Sample labels are fixed to be the original case/control status. We added mean signals varying from 0.1 to 0.5 to affected genes/metabolites selected according to different pathway dysregulation designs. This corresponds to the right heat map in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> and the model 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \tilde Y^{(i)} \sim \left\{\begin{array}{ll} f\left(0, \widetilde \Sigma_{1}\right) \quad (i=1, \ldots, n_{1}), \\ f\left(\tilde \mu_{2}, \widetilde \Sigma_{2}\right) \quad (i=n_{1}+1, \ldots, n). \end{array}\right.  $$ \end{document}</tex-math><mml:math id="M8"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>&#x0223c;</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2019_3146_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p>We permuted the sample labels first and added varying mean signals to the same set of affected genes/metabolites as in (I). This corresponds to the model 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \tilde {\tilde Y}^{(i)} \sim \left\{\begin{array}{ll} f\left(0, {\widetilde \Sigma}\right) \quad (i=\pi_{1}, \ldots, \pi_{n_{1}}), \\ f\left({\tilde \mu}_{2}, {\widetilde \Sigma}\right) \quad (i=\pi_{n_{1}+1}, \ldots, \pi_{n}), \end{array}\right.  $$ \end{document}</tex-math><mml:math id="M10"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>&#x0223c;</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mover accent="false"><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="false"><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2019_3146_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p><p>where <inline-formula id="IEq2"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\widetilde \Sigma }$\end{document}</tex-math><mml:math id="M12"><mml:mover accent="false"><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq2.gif"/></alternatives></inline-formula> is the common covariance matrix for both populations, and <italic>&#x003c0;</italic> is a random permutation of the sample index 1,&#x02026;,<italic>n</italic>.</p></list-item></list></p><p>The main difference between models (<xref rid="Equ1" ref-type="">1</xref>) and (<xref rid="Equ2" ref-type="">2</xref>) is whether sample labels are permuted. The intuition is that the permutation version nullifies the difference in covariances, thereby creating a situation where the assumption of equal covariances is satisfied. The permutation version can benefit certain methods, such as DEGraph, but is not ideal for methods such as CAMERA that exploit difference in correlations. Theoretical justifications for how permutation works are available in [<xref ref-type="bibr" rid="CR29">29</xref>] and [<xref ref-type="bibr" rid="CR30">30</xref>].</p><p>The above data generating mechanism relaxes the distributional assumptions and allows us to evaluate different methods with respect to a ground truth. This is in contrast to most existing reviews in the literature based on either publicly available data where the ground truth is unknown [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>], or purely synthetic data from parametric distributions [<xref ref-type="bibr" rid="CR25">25</xref>]. In practice, because there is only one deterministic data matrix, for both (I) and (II) we added independently and identically distributed Gaussian noise to each entry in the data matrix to introduce randomness.</p><p>The complete set of test designs is summarized in Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>.</p></sec></sec><sec id="Sec8" sec-type="results"><title>Results</title><p>We present the results of our comparative study by assessing the performance of the nine methods in terms of their type I errors, followed by their statistical powers. A type I error, also called a false positive, occurs when a true null hypothesis is rejected, whereas the power quantifies the probability of a test correctly rejecting the null when the alternative hypothesis is true. Of course, power comparison is only meaningful if the tests all have valid type I error control. Due to the large size of the two gene expression data sets, the type I errors and powers were calculated as the proportion of null hypotheses rejected among 200 simulation replications, but they were evaluated over 1000 replications in the metabolomic data example.</p><p>Several methods require <italic>p</italic>-value thresholding. To this end, we used univariate two-sample <italic>t</italic>-test assuming unequal variances to calculate the <italic>p</italic>-value for each gene/metabolite. These <italic>p</italic>-values were corrected for multiple comparisons using the Benjamini &#x00026; Hochberg procedure for controlling false discovery rate (FDR) [<xref ref-type="bibr" rid="CR31">31</xref>]. The FDR cutoff of 0.05 was used to identify DE genes/metabolites.</p><p>In our analysis, multiple method-specific difficulties made it impossible to compare all available pathways. First, in the two gene expression data examples, SPIA and Pathway-Express returned <italic>p</italic>-values primarily for signaling pathways, which is expected given their testing procedures. Second, topologyGSA only works for pathway whose topology is a DAG and whose size is smaller than the minimum number of samples in the two conditions/groups. As a result, our comparisons in the two cancer genomic applications only include selected pathways that were analyzed by all methods. Lastly, the network in the metabolomics data example is not directed acyclic and the pathways are smaller biochemical pathways that often have incomplete coverage and high degrees of overlap. Thus we excluded topologyGSA, Pathway-Express, SPIA and PRS in the metabolomics data example.</p><sec id="Sec9"><title>Ranking empirical powers</title><p>In power comparisons, we summarize the relative performance of all nine methods based on the ranking of each pathway&#x02019;s empirical power. Specifically, for each pathway, we rank the empirical powers of all methods at each level of mean change from low (indicating higher power) to high (indicating lower power). Methods that produce &#x02018;NA&#x02019; (e.g. ORA methods when there are too few DE genes) are ranked the highest. For each pathway, the geometric mean of all rankings across different mean changes is taken as the final measure of relative performance. Spreadsheets with disaggregated empirical powers for each pathway, across all the experimental settings, are provided in [<xref ref-type="bibr" rid="CR32">32</xref>].</p></sec><sec id="Sec10"><title>Analysis of gene expression data</title><p>There are 11 KEGG pathways (primarily on signaling) whose topologies satisfy the input requirement needed for topologyGSA and Pathway-Express. We thus focused on type I error and power comparisons on this subset of pathways under the betweenness dysregulation design. Details on the pathways and more comparisons are available in Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>.</p><p>The scatter plot in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> shows the type I error for each of the 11 KEGG pathways using the TCGA breast cancer data [<xref ref-type="bibr" rid="CR33">33</xref>]. Each point indicates the type I error rate for one pathway. Overlapping points were re-positioned by adding &#x000b1;&#x02009;1 to the x-axis and &#x000b1;&#x02009;0.01 to the y-axis, which explains why some values are less than zero&#x02014;these should be understood as being close to zero. Because the number of DE genes under the self-contained null is zero even with liberal FDR cutoffs, ORA-type methods such as SPIA, CePa, PRS and PE.Cut (Pathway-Express with <italic>p</italic>-value cutoff) can not assess the pathway significance. These methods have thus been excluded from type I error comparison. On the other hand, PE.noCut does not require <italic>p</italic>-value thresholding and is therefore included in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>. Across the 11 pathways, all methods control the type I error rate at 0.05 significance level. It is worth noting that most of the type I error rates from PE.noCut and PathNet are close to the nominal level 0.05, whereas all other methods seem to have conservative type I error rates.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Type I errors for the 11 KEGG (primarily signaling) pathways in the TCGA breast cancer study [<xref ref-type="bibr" rid="CR33">33</xref>]. The x-axis shows the pathway size and the y-axis indicates the type I error. Overlapping points were re-positioned by adding &#x000b1;&#x02009;1 to the x-axis and &#x000b1;&#x02009;0.01 to the y-axis. Thus the negative values should be understood as being very close to zero. All methods control type I errors</p></caption><graphic xlink:href="12859_2019_3146_Fig2_HTML" id="MO2"/></fig>
</p><p>Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> presents the relative performance of different methods in terms of average ranking of empirical powers for the 11 pathways, both with and without sample label permutation. Lower rankings indicate better performance. Again we re-positioned overlapping points by adding &#x000b1;&#x02009;1 to the x-axis and &#x000b1;&#x02009;0.1 to the y-axis for visualization purpose, which explains why some rankings in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>a are below 1. Among all methods, PathNet, CAMERA and PE.noCut seem to perform the best when using the original sample labels (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>a). NetGSA and DEGraph have similar performance. On the other hand, when sample labels are permuted, DEGraph, PE.noCut and topologyGSA have the best performance (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>b). This is not surprising because the permutation version nullifies the difference in covariances asymptotically, thereby creating a situation where the assumption of equal covariances and shared graph structure is approximately satisfied. DEGraph and topologyGSA thus performed better relative to the others, whereas the performance of CAMERA deteriorated, especially for large pathways, because it cannot leverage the difference in correlations. Sample permutation does not affect PE.noCut because its significance is evaluated based on gene permutation. All ORA-type methods (SPIA, PE.Cut, CePa and PRS) have relatively higher ranking and hence poorer performance because they only work when the magnitude of mean changes between conditions is large.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Average ranking of empirical powers on the 11 KEGG (primarily signaling) pathways using sample labels from the original study (<bold>a</bold>) and shuffled sample labels (<bold>b</bold>) based on the betweenness dysregulation design for the TCGA breast cancer study [<xref ref-type="bibr" rid="CR33">33</xref>]. The x-axis shows the pathway size, and the y-axis indicates the average ranking of empirical power over different mean changes. Lower ranking indicates better performance. Overlapping points were re-positioned by adding &#x000b1;&#x02009;1 to the x-axis and &#x000b1;&#x02009;0.1 to the y-axis. PathNet, CAMERA and PE.noCut perform the best when using the original sample labels (<bold>a</bold>), whereas DEGraph, PE.noCut and topologyGSA yield the best performance with permuted sample labels (<bold>b</bold>)</p></caption><graphic xlink:href="12859_2019_3146_Fig3_HTML" id="MO3"/></fig>
</p><p>Similar figures for other dysregulation designs and other pathways, including those for the prostate cancer study, are available in Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>. It is worth noting that PathNet shows inflated type I error rates on several KEGG metabolic pathways (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figures S1 and S4), which could be due to the inaccurate coverage in pathway topology in graphite. Methods such as topologyGSA, SPIA, Pathway-Express and PRS are not applicable to those metabolic pathways due to constraints in their topology. Among the methods compared, DEGraph has the best overall performance.</p></sec><sec id="Sec11"><title>Analysis of metabolomics data</title><p>The findings in the metabolomics data example differ qualitatively from those in genomic examples. This difference can be attributed to the relatively small number of edges in the metabolic network and small pathway sizes, which are due to the incomplete coverage of metabolomic assays. Note because SPIA, Pathway-Express and PRS were proposed specifically for genetic pathways, and the metabolic network is not directed acyclic, we only compared NetGSA, DEGraph, CAMERA, CePa and PathNet in this example. In addition, CePa requires the presence of DE metabolites, which only appear when the mean change is greater than 0.5. The mean signal in this example was thus allowed to vary from 0.1 to 1.0. To run all 5 methods, we filtered out 33 of the 65 KEGG pathways whose topologies are too sparse&#x02014;fewer than two edges&#x02014;and focused on type I error and power comparisons on the remaining 32 pathways.</p><p>Figure&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> shows that all four methods control type I errors, although NetGSA and CAMERA exhibit slightly inflated type I errors for some pathways, which is likely due to the small sample sizes available. This will be less of an issue for NetGSA if more samples are available for network estimation; such samples can be obtained from other related studies. The conservative type I errors of DEGraph is again due to its assumption that the networks for the two conditions are the same. Since there are very few pathway interactions available in the metabolic network, PathNet also exhibits conservative type I errors.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Type I errors for KEGG metabolic pathways in the metabolomics data [<xref ref-type="bibr" rid="CR39">39</xref>]. The x-axis shows the pathway size and the y-axis indicates the type I error. Overlapping points were re-positioned by adding &#x000b1;&#x02009;1 to the x-axis and &#x000b1;&#x02009;0.01 to the y-axis. CAMERA, DEGraph and PathNet have controlled type I errors, but NetGSA&#x02019;s type I errors are slightly inflated for several pathways</p></caption><graphic xlink:href="12859_2019_3146_Fig4_HTML" id="MO4"/></fig>
</p><p>Figure&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref> compares the relative performance of different methods in ranking of empirical powers out of 1000 replications. It is evident that DEGraph and NetGSA perform the best (lowest rankings), regardless of whether the sample labels are shuffled. DEGraph performs slightly better than NetGSA, especially under permuted sample labels (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>b), because the Hotelling&#x02019;s T-squared test works well for small pathways. In comparison, the linear mixed effects model underlying NetGSA considers an additional random effects, resulting in slightly lower power when samples are permuted. The other methods CAMERA, CePa and PathNet have comparable performances both with and without permuting sample labels. The poor performance of PathNet and CePa is due to the sparse metabolic network, whereas CAMERA does not work well because there is high overlap among metabolic pathways (Figure S7 in Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>).
<fig id="Fig5"><label>Fig. 5</label><caption><p>Average ranking of empirical powers using sample labels from the original study (<bold>a</bold>) and shuffled sample labels (<bold>b</bold>) for the metabolomics data [<xref ref-type="bibr" rid="CR39">39</xref>]. The x-axis shows the pathway size, and the y-axis indicates the average ranking of empirical power over different mean changes. Lower ranking indicates better performance. Overlapping points were re-positioned by adding &#x000b1;&#x02009;1 to the x-axis and &#x000b1;&#x02009;0.1 to the y-axis. DEGraph and NetGSA perform the best regardless of sample permutation</p></caption><graphic xlink:href="12859_2019_3146_Fig5_HTML" id="MO5"/></fig>
</p></sec></sec><sec id="Sec12" sec-type="discussion"><title>Discussion</title><p>The methods considered in this study exhibit differences in terms of the network information that they incorporate. For example, CePa, PathNet, Pathway-Express, PRS and SPIA only account for the pathway topology. CAMERA does not directly take into account the pathway topology, but estimates the correlations among the biomolecules from data. In contrast, NetGSA, DEGraph and topologyGSA assume the underlying networks come from a known class of graphs, whose parameters are inferred from data. NetGSA can also incorporate existing network information from user-provided sources for improved power. The downside with the more flexible version of NetGSA that accounts for differences in networks is that the type I errors may be slightly inflated, if too few samples are available for the estimation of the network parameters, corresponding to network edges. This was observed in the metabolomics data example. This issue can be addressed by aggregating data from multiple related studies for more accurate network estimation.</p><p>Taking a broader view point, NetGSA is capable of assessing pathway enrichment due to changes both in the mean levels of the biomolecules, as well as their connectivity; it can thus be more suitable for studies involving comparisons across different disease states, where a possible strong dysregulation of the interactome can occur. It can also seamlessly accommodate more than two conditions [<xref ref-type="bibr" rid="CR34">34</xref>], as well as multiple types of Omics data for integrated analysis of pathway enrichment [<xref ref-type="bibr" rid="CR35">35</xref>]. Although fairly robust in the examples shown above, a disadvantage of DEGraph is that it is not particularly suitable in settings where one expects a strong dysregulation of the underlying interactome, since it assumes the underlying networks in different conditions have the same structure. Consider, e.g., the two networks in Figure S8 of Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>. The proportion of nodes in pathways 8, 4 and 7 that have nonzero mean changes is 0.2, 0.4 and 0.6, respectively. In contrast, pathways 3, 5, and 2 have not only the corresponding level of mean changes, but also complete rewiring of the pathway topology. In this simulated setting, NetGSA is able to identify pathways 5, 3 and 7 as the most significantly enriched pathways (with empirical power at least 0.9), followed by pathway 2 (0.89). DEGraph identifies pathways 2, 3 and 5 as being enriched, but misses pathway 7 (0.62).</p><p>Importantly, existing methods such as CAMERA, CePa, DEGraph, PathNet, Pathway-Express, PRS, SPIA and topologyGSA often analyze one pathway at a time while ignoring the fact that pathways overlap with each other. This practice is common because it is conceptually and computationally convenient, yet it may lead to undesirable consequences as the interactions between genes/metabolites that show up in multiple pathways may be different when analyzing these pathways separately. Separate analysis is particularly problematic for metabolomic studies where the pathways are considerably smaller in size and exhibit a high degree of overlap (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S7). In contrast to these methods, NetGSA can combine all metabolites by inferring a joint network, and is thus more powerful for detecting enriched pathways. However, simultaneous analysis of all pathways using NetGSA could become computationally expensive, if the study contains a very large number of biomolecules.</p></sec><sec id="Sec13" sec-type="conclusion"><title>Conclusions</title><p>Significant progress has been made in developing topology-based methods for pathway enrichment analysis. In this study, we undertook a systematic comparison of nine popular such methods using three data sets from gene expression and metabolomics profiling. Compared to existing reviews [<xref ref-type="bibr" rid="CR23">23</xref>&#x02013;<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR36">36</xref>], our comparison leverages the large sample sizes in the two cancer genomic studies, and, in particular, offers important insights for how the nine competitors perform in metabolomics studies, where the focus is on smaller biochemical pathways. Results in Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figures S2, S3, S5 and S6 suggest similar findings as those observed in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>, and confirm the overall robust performance of DEGraph. In general, when the methods examined are used for pathway enrichment purposes in studies based on genomic data and focusing on large signaling pathways, most exhibit a satisfactory overall performance, with DEGraph being the most robust, followed by PathNet, Pathway-Express without <italic>p</italic>-value cutoff (PE.noCut) and topologyGSA. In comparison, ORA-type methods (SPIA, PE.Cut, CePa and PRS) require the presence of DE genes and perform well only in specific settings. Our experience with Pathway-Express is that PE.noCut (without <italic>p</italic>-value cutoff) seems to dominate PE.Cut (with <italic>p</italic>-value cutoff). Additionally, due to inaccurate coverage and special features of topology information on smaller metabolic pathways, only DEGraph shows robust performance (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figures S3 and S6). On the other hand, in studies involving metabolomics data and pathway enrichment of relatively small biochemical pathways, NetGSA and DEGraph clearly outperform all competitors.</p></sec><sec id="Sec14"><title>Methods</title><p>In this section, we describe the three data sets used in our comparative study and then provide an overview of the nine topology-based pathway enrichment methods analyzed.</p><sec id="Sec15"><title>Data sets</title><p>Our first comparison considers a breast cancer gene expression study from The Cancer Genome Atlas ([<xref ref-type="bibr" rid="CR33">33</xref>], TCGA). We focused on 114 signaling and metabolic pathways from the Kyoto Encyclopedia of Genes and Genomes ([<xref ref-type="bibr" rid="CR37">37</xref>], KEGG), and expression data from 2784 genes that have matched Entrez IDs. The data set consists of 520 samples in total, 117 estrogen-receptor-negative (ER-) and 403 estrogen-receptor-positive (ER+).</p><p>Our second comparison is based on a TCGA gene expression data on prostate cancer from [<xref ref-type="bibr" rid="CR38">38</xref>]. The data contained Affymetrix probe IDs, which were first mapped to gene Entrez IDs. When multiple probes mapped to a single gene (i.e., to the same gene Entrez ID), their mean profile was used to avoid duplicated gene IDs. To reduce the dimensionality, genes in 112 KEGG signaling and metabolic pathways were considered for the final analysis. The final data set contains expression levels of 2952 genes across 264 case and 160 control subjects.</p><p>The third and final data set comes from a metabolomics study on non-obese diabetic mice, where the metabolic profiles of 41 non-diabetic and 30 diabetic animals of 100 named metabolites were collected, with the goal of identifying metabolic signatures of Type I diabetes progression [<xref ref-type="bibr" rid="CR39">39</xref>].</p></sec><sec id="Sec16"><title>Pathway enrichment methods</title><sec id="Sec17"><title>Pathway-express</title><p>The Pathway-Express method [<xref ref-type="bibr" rid="CR8">8</xref>] for analyzing signaling pathways is implemented in the ROntoTools Bioconductor package [<xref ref-type="bibr" rid="CR40">40</xref>]. Its null hypothesis is that the list of DE genes on a given pathway is completely random; this hypothesis is tested by calculating an impact factor for each pathway <italic>G</italic> defined as 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ IF(G) = \log\left(\frac{1}{P_{\text{NDE}}}\right) + \frac{\sum_{j \in G} |PF(g_j)|}{N_{de}(G)\cdot \overline{|\Delta E|}}.  $$ \end{document}</tex-math><mml:math id="M14"><mml:mtext mathvariant="italic">IF</mml:mtext><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NDE</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mtext mathvariant="italic">PF</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">de</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mover accent="false"><mml:mrow><mml:mo>|</mml:mo><mml:mi>&#x00394;E</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2019_3146_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p><p>Here, <italic>P</italic><sub>NDE</sub> in the first term on the right hand side of (<xref rid="Equ3" ref-type="">3</xref>) evaluates the significance of the pathway <italic>G</italic> as measured by an over-representation analysis, whereas the second term incorporates the DE genes in the data and the interactions among genes inside the pathway. The perturbation factor (PF) for each gene is defined as 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ PF(g_i) = \Delta E(g_i) + \sum_{j: j\rightarrow i} \beta_{ij} \frac{PF(g_j)}{N_{\text{ds}}(g_j)}.  $$ \end{document}</tex-math><mml:math id="M16"><mml:mtext mathvariant="italic">PF</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>&#x00394;E</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">PF</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>ds</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2019_3146_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p><p>In Eq. <xref rid="Equ4" ref-type="">4</xref>, <italic>&#x00394;</italic><italic>E</italic>(<italic>g</italic><sub><italic>i</italic></sub>) is the signed normalized expression change of biomolecule <italic>g</italic><sub><italic>i</italic></sub>. The denominator <italic>N</italic><sub>ds</sub>(<italic>g</italic><sub><italic>j</italic></sub>) represents the number of downstream biomolecules of <italic>g</italic><sub><italic>j</italic></sub> and the sum is only over biomolecules <italic>g</italic><sub><italic>j</italic></sub> directly upstream of <italic>g</italic><sub><italic>i</italic></sub>. The interactions between <italic>g</italic><sub><italic>i</italic></sub> and <italic>g</italic><sub><italic>j</italic></sub> are encoded in the coefficients <italic>&#x003b2;</italic><sub><italic>ij</italic></sub>, e.g. +&#x02009;1 for activation, &#x02212;&#x02009;1 for inhibition. Therefore, the second term on the right hand side of (<xref rid="Equ3" ref-type="">3</xref>) can be thought of as the total perturbation factor normalized by (i) the number of DE genes in pathway <italic>G</italic>, which is <italic>N</italic><sub><italic>d</italic><italic>e</italic>(<italic>G</italic>)</sub>, and (ii) the mean absolute fold changes among all DE genes in the data, which is <inline-formula id="IEq3"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {|\Delta E|}$\end{document}</tex-math><mml:math id="M18"><mml:mover accent="false"><mml:mrow><mml:mo>|</mml:mo><mml:mi>&#x00394;E</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq3.gif"/></alternatives></inline-formula>. Normalization with respect to <inline-formula id="IEq4"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {|\Delta E|}$\end{document}</tex-math><mml:math id="M20"><mml:mover accent="false"><mml:mrow><mml:mo>|</mml:mo><mml:mi>&#x00394;E</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq4.gif"/></alternatives></inline-formula> is to account for the potential differences in estimating the fold changes among various technologies. The random quantity <italic>I</italic><italic>F</italic>(<italic>G</italic>) is shown to have a <italic>&#x00393;</italic>(2,1) distribution, such that for any realization of <italic>I</italic><italic>F</italic>(<italic>G</italic>)=<italic>f</italic> the significance of a pathway can be calculated as 
<disp-formula id="Equc"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$P_{G} = \{f+ 1\} e^{-f}. $$ \end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_3146_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p><p>Pathway-Express is implemented in the R package ROntoTools. The latest version of this package (2.10.0) also permits a cutoff-free version which eliminates the need to select DE genes [<xref ref-type="bibr" rid="CR41">41</xref>]. In this version, Pathway-Express does not calculate the ORA significance, but only reports the significance from pathway perturbation.</p></sec><sec id="Sec18"><title>SPIA</title><p>Signaling pathway impact analysis ([<xref ref-type="bibr" rid="CR9">9</xref>], SPIA) tests the same null hypothesis as Pathway-Express; it combines one evidence based on <italic>P</italic><sub>NDE</sub> with a second evidence, <italic>P</italic><sub>PB</sub>, that quantifies the amount of perturbation in each pathway. To calculate the second type of evidence, the total net perturbation accumulation for a given pathway <italic>G</italic> is defined as 
<disp-formula id="Equd"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$t_{A}(G)= \sum_{i\in G}\{PF(g_{i}) - \Delta E(g_{i})\}, $$ \end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:mo>{</mml:mo><mml:mtext mathvariant="italic">PF</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>&#x00394;E</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_3146_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> where the perturbation factor <italic>P</italic><italic>F</italic>(<italic>g</italic><sub><italic>i</italic></sub>) is defined in (<xref rid="Equ4" ref-type="">4</xref>). A bootstrap approach is used to obtain the perturbation <italic>p</italic>-value <italic>P</italic><sub>PB</sub>, which is the probability of observing a total accumulated perturbation of a pathway more extreme than <italic>t</italic><sub><italic>A</italic></sub>(<italic>G</italic>) just by chance.</p><p>The overall significance of pathway <italic>G</italic> is calculated as 
<disp-formula id="Eque"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$P_{G} = P_{\text{NDE}} P_{\text{PB}} - P_{\text{NDE}} P_{\text{PB}} \log \{P_{\text{NDE}} P_{\text{PB}} \}. $$ \end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NDE</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>PB</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NDE</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>PB</mml:mtext></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NDE</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>PB</mml:mtext></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_3146_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p><p>It is worth noting that Eq. <xref rid="Equ4" ref-type="">4</xref> imposes an implicit constraint on the pathway topology, in that a pathway with a singular matrix <italic>I</italic>&#x02212;<italic>B</italic> for <italic>B</italic><sub><italic>ij</italic></sub>=<italic>&#x003b2;</italic><sub><italic>ij</italic></sub>/<italic>N</italic><sub>ds</sub>(<italic>g</italic><sub><italic>j</italic></sub>) cannot be analyzed using Pathway-Express and SPIA. In addition, both Pathway-Express and SPIA require the presence of DE genes to define the impact of pathways. Hence pathways that do not have any DE genes will not be analyzed. This phenomenon was observed in [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR36">36</xref>] and in our comparisons, where Pathway-Express and SPIA often only return the significance of half of all pathways considered.</p></sec><sec id="Sec19"><title>NetGSA</title><p>The NetGSA method [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>] employs as input directed and/or undirected networks that define pathway interconnectedness. If the network information is incomplete, it uses a probabilistic graphical model to complete the pathway topology based on the available data, while using the existing topology information as constraints. As a result, not only can NetGSA estimate novel interactions, but also validate existing network information. Next, we present the statistical model used in NetGSA assuming the underlying networks are undirected.</p><p>Given the adjacency matrix <italic>A</italic> of the network, NetGSA defines the propagated effect of genes on each other through the <italic>influence matrix</italic>
<italic>&#x0039b;</italic>, defined as <italic>&#x0039b;</italic><italic>&#x0039b;</italic><sup>&#x02032;</sup>=(<italic>I</italic>&#x02212;<italic>A</italic>)<sup>&#x02212;1</sup> with <italic>I</italic> denoting the identity matrix. It then decomposes the measurements in the <italic>i</italic>th sample, <italic>Y</italic><sup>(<italic>i</italic>)</sup>, into signal <italic>X</italic><sup>(<italic>i</italic>)</sup> and noise <bold><italic>&#x003b5;</italic></bold><sup>(<italic>i</italic>)</sup>. The multivariate signal&#x02019;s interactions are captured through a Gaussian Markov random field encoded by <italic>A</italic>. Formally, let <bold><italic>&#x003b3;</italic></bold><sup>(<italic>i</italic>)</sup> be the baseline expression levels of all biomolecules and <bold><italic>&#x003bc;</italic></bold> be their mean expression levels. NetGSA decomposes <italic>X</italic><sup>(<italic>i</italic>)</sup>=<italic>&#x0039b;</italic><bold><italic>&#x003b3;</italic></bold><sup>(<italic>i</italic>)</sup> so that the signal for the <italic>j</italic>th gene, <inline-formula id="IEq5"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{j}^{(i)}$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq5.gif"/></alternatives></inline-formula>, combines both its baseline activity <inline-formula id="IEq6"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\gamma _{j}^{(i)}$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq6.gif"/></alternatives></inline-formula> and those propagated from its neighbors. Given data from <italic>K</italic> conditions, NetGSA allows for the <italic>K</italic> networks to be different and for each condition <italic>k</italic> considers a linear mixed effects model 
<disp-formula id="Equf"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} Y^{(i)} &#x00026; = \Lambda_{k} \boldsymbol{\mu}_{k} + \Lambda_{k} \boldsymbol{\gamma}^{(i)} + \boldsymbol{\varepsilon}^{(i)} \quad (k=1,\ldots,K), \end{array} $$ \end{document}</tex-math><mml:math id="M32"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x0039b;</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>&#x0039b;</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b5;</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_3146_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p><p>where the random effects <inline-formula id="IEq7"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\gamma }^{(i)} \sim N\left (0, \sigma _{\gamma }^{2} I\right)$\end{document}</tex-math><mml:math id="M34"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>&#x0223c;</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>I</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq7.gif"/></alternatives></inline-formula> are independent from noise <bold><italic>&#x003b5;</italic></bold><sup>(<italic>i</italic>)</sup>.</p><p>Let <bold><italic>&#x003b2;</italic></bold> be the concatenated vector of the baseline means <bold><italic>&#x003bc;</italic></bold><sub>1</sub>,&#x02026;,<bold><italic>&#x003bc;</italic></bold><sub><italic>K</italic></sub>. To test for enrichment of any pathway <italic>G</italic>, NetGSA uses a Wald test statistic, 
<disp-formula id="Equg"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$TS(G) = \frac{\ell \hat{\boldsymbol{\beta}}}{\text{s.e.}(\ell \hat{\boldsymbol{\beta}})}, $$ \end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mtext mathvariant="italic">TS</mml:mtext><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>&#x02113;</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>s.e.</mml:mtext><mml:mo>(</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_3146_Article_Equg.gif" position="anchor"/></alternatives></disp-formula> for <italic>K</italic>=2 or an F statistic for <italic>K</italic>&#x02265;3 to test the null <italic>&#x02113;</italic><bold><italic>&#x003b2;</italic></bold>=0; here, <inline-formula id="IEq8"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\beta }}$\end{document}</tex-math><mml:math id="M38"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq8.gif"/></alternatives></inline-formula> denotes the estimate of <bold><italic>&#x003b2;</italic></bold> based on the data, <inline-formula id="IEq9"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {s.e.}(\ell \hat {\boldsymbol {\beta }})$\end{document}</tex-math><mml:math id="M40"><mml:mi mathvariant="normal">s.e.</mml:mi><mml:mo>(</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq9.gif"/></alternatives></inline-formula> represents the standard error of <inline-formula id="IEq10"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\ell \hat {\boldsymbol {\beta }}$\end{document}</tex-math><mml:math id="M42"><mml:mi>&#x02113;</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq10.gif"/></alternatives></inline-formula>, and <italic>&#x02113;</italic> is a contrast vector optimally defined to allow for simultaneous testing of differences in the mean structure across the <italic>K</italic> conditions, as well as differences in interaction networks.</p><p>NetGSA can be computationally slow in the presence of a large number of biomolecules, which is the case for the two studies involving gene expression data. In those instances, enrichment analysis is carried out separately for each pathway. On the other hand, since the metabolomic data set contains only 100 metabolites, enrichment analysis of all pathways is performed simultaneously.</p></sec><sec id="Sec20"><title>topologyGSA</title><p>The pathway topology information in the topologyGSA method [<xref ref-type="bibr" rid="CR12">12</xref>] is first converted into a directed acyclic graph (DAG) and then to its moral graph, which represents its corresponding Markov equivalence class [<xref ref-type="bibr" rid="CR42">42</xref>]. Let the data be organized such that the first <italic>n</italic><sub>1</sub> columns correspond to samples from condition 1, and the last <italic>n</italic>&#x02212;<italic>n</italic><sub>1</sub> columns from condition 2. Given the graph structure, topologyGSA models each sample <italic>Y</italic><sup>(<italic>i</italic>)</sup> using a probabilistic graphical model approach: 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ Y^{(i)} \sim \left\{\begin{array}{ll} N(\boldsymbol{\mu}_{1}, \Sigma_{1})\quad (i = 1, \ldots, n_{1}),\\ N(\boldsymbol{\mu}_{2}, \Sigma_{2})\quad (i = n_{1} + 1, \ldots, n), \end{array}\right.  $$ \end{document}</tex-math><mml:math id="M44"><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>&#x0223c;</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2019_3146_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p><p>where <bold><italic>&#x003bc;</italic></bold><sub><italic>k</italic></sub> is the mean expression level for condition <italic>k</italic>, and <italic>&#x003a3;</italic><sub><italic>k</italic></sub> is the corresponding covariance. Note <italic>&#x003a3;</italic><sub>1</sub> and <italic>&#x003a3;</italic><sub>2</sub> are constrained to have the same structure as specified a priori. topologyGSA first tests the hypothesis of equal variances <italic>&#x003a3;</italic><sub>1</sub>=<italic>&#x003a3;</italic><sub>2</sub> using a likelihood ratio test. Depending on the conclusion from testing the equality of variances, the test of differential expression <bold><italic>&#x003bc;</italic></bold><sub>1</sub>=<bold><italic>&#x003bc;</italic></bold><sub>2</sub> is performed through a multivariate analysis of variance (MANOVA) [<xref ref-type="bibr" rid="CR43">43</xref>] if <italic>&#x003a3;</italic><sub>1</sub>=<italic>&#x003a3;</italic><sub>2</sub>, or based on the Behrens-Fisher problem [<xref ref-type="bibr" rid="CR44">44</xref>] if <italic>&#x003a3;</italic><sub>1</sub>&#x02260;<italic>&#x003a3;</italic><sub>2</sub>. The method is designed specifically for gene expression data.</p><p>topologyGSA has several limitations. First, it requires the pathway topology to be organized as a DAG, which may not be possible for, e.g., metabolomics studies. In addition, topologyGSA relies on the likelihood ratio statistic for testing equal covariances, which restricts its use to relatively small pathways. For large pathways with more members than the sample size&#x02014;which are frequently observed in studies involving gene expression data&#x02014;topologyGSA can become computationally very inefficient. Lastly, differential network and differential expression are tested separately in topologyGSA, which may also limit the power of the test when the two populations differ in both means and variances.</p><p>In our data examples, we implemented both test on differential network using pathway.var.test and test on differential expression using pathway.mean.test from the R package topologyGSA. Since naive combination of the two tests (e.g. by taking the minimum <italic>p</italic>-value) resulted in inflated type I errors in our numerical analyses, we used the <italic>p</italic>-value for testing equality of means as representing significance for pathway enrichment.</p></sec><sec id="Sec21"><title>DEGraph</title><p>DEGraph was introduced in [<xref ref-type="bibr" rid="CR13">13</xref>] to conduct a two-sample test of means, while incorporating topology information of the biomolecules. It considers a special case of the model in (<xref rid="Equ5" ref-type="">5</xref>) with <italic>&#x003a3;</italic><sub>1</sub>=<italic>&#x003a3;</italic><sub>2</sub> and tests the null <bold><italic>&#x003bc;</italic></bold><sub>1</sub>=<bold><italic>&#x003bc;</italic></bold><sub>2</sub>. The motivation underlying DEGraph is that the classical Hotelling&#x02019;s <italic>T</italic><sup>2</sup>-test [<xref ref-type="bibr" rid="CR45">45</xref>], which is known to be uniformly most powerful against global mean-shift alternatives for multivariate normal distributions and may behave poorly in high dimensions. When the graph <italic>G</italic> capturing interactions of the biomolecules in the two conditions is known, [<xref ref-type="bibr" rid="CR13">13</xref>] derived an equivalent expression for Hotelling&#x02019;s <italic>T</italic><sup>2</sup> statistic in the graph-Fourier space [<xref ref-type="bibr" rid="CR46">46</xref>]. It further proposed to approximate Hotelling&#x02019;s <italic>T</italic><sup>2</sup> by filtering out high frequencies of the Fourier coefficients when the dimension is high. The statistic after filtering is shown to yield a test that is more powerful than testing in the original unfiltered space.</p><p>Because DEGraph is a test in the graph-Fourier space, it requires knowledge of a connected graph, which is assumed to be the same between the two conditions under consideration. If a pathway consists of more than one connected component, DEGraph will test whether the means are different for each connected subgraph, and correct for multiple comparisons using a permutation procedure. In addition, if the input pathway topology can not be immediately used in constructing a test in the graph-Fourier space, DEGraph offers the functionality of subgraph discovery. In our implementation, we supplied DEGraph with the pathway information from KEGG and let the method decide whether to undertake subgraph discovery.</p></sec><sec id="Sec22"><title>CAMERA</title><p>Correlation Adjusted MEan RAnk gene set test ([<xref ref-type="bibr" rid="CR14">14</xref>], CAMERA) is a competitive biomolecule set testing procedure and is available as a function in the limma package [<xref ref-type="bibr" rid="CR47">47</xref>]. CAMERA assumes that the log-expression value <italic>Y</italic><sub><italic>g</italic></sub> for biomolecule <italic>g</italic> is linear in the design variables specifying the conditions with coefficients <bold><italic>&#x003b1;</italic></bold><sub><italic>g</italic></sub>. Enrichment analysis of a given pathway <italic>G</italic> is done by testing the null <italic>&#x02113;</italic><bold><italic>&#x003b1;</italic></bold><sub><italic>g</italic></sub>=0, where <italic>&#x02113;</italic> is a contrast vector specified by the user. Denote by <italic>z</italic><sub><italic>g</italic></sub> the biomolecule-level statistic for <italic>g</italic>. Given <italic>m</italic> such statistics <italic>z</italic><sub><italic>G</italic></sub>=(<italic>z</italic><sub>1</sub>,&#x02026;,<italic>z</italic><sub><italic>m</italic></sub>) in pathway <italic>G</italic>, CAMERA tests whether their mean expression <inline-formula id="IEq11"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar z_{G}$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq11.gif"/></alternatives></inline-formula> inside a pathway is significantly different from the mean expression of biomolecules outside the pathway. Let <italic>p</italic> be the total number of biomolecules, both inside and outside the pathway, and <inline-formula id="IEq12"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar z$\end{document}</tex-math><mml:math id="M48"><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq12.gif"/></alternatives></inline-formula> be the mean of all biomolecule-level statistics. CAMERA uses the statistic 
<disp-formula id="Equh"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$TS(G) = \frac{\delta}{s_{\text{pool}}\sqrt{\frac{\text{VIF}}{m} + \frac{1}{p-m}}} $$ \end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mtext mathvariant="italic">TS</mml:mtext><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>pool</mml:mtext></mml:mrow></mml:msub><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>VIF</mml:mtext></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2019_3146_Article_Equh.gif" position="anchor"/></alternatives></disp-formula> to test the competitive null hypothesis; here, <inline-formula id="IEq13"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta = (\bar z_{G} - \bar z) p/(p-m)$\end{document}</tex-math><mml:math id="M52"><mml:mi>&#x003b4;</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mi>p</mml:mi><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq13.gif"/></alternatives></inline-formula> is the adjusted mean difference, <italic>s</italic><sub>pool</sub> is the pooled residual standard deviation and <inline-formula id="IEq14"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {VIF}=1+(m-1)\bar \rho $\end{document}</tex-math><mml:math id="M54"><mml:mtext>VIF</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c1;</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq14.gif"/></alternatives></inline-formula> denotes the variance inflation factor. The parameter <inline-formula id="IEq15"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar \rho $\end{document}</tex-math><mml:math id="M56"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c1;</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq15.gif"/></alternatives></inline-formula> is defined as the average correlation amongst the biomolecule-level statistics inside the pathway and is estimated from the data. Note that CAMERA incorporates the pathway membership information and does not take interconnectedness inside the pathway into account. However, it does account for correlation among biomolecules in the pathway.</p></sec><sec id="Sec23"><title>CePa</title><p>CePa is a centrality-based pathway enrichment analysis method [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR48">48</xref>]. CePa allows multiple centrality measures to capture the topology of a given pathway from different aspects. It also maps genes to pathway nodes and considers the node as the basic pathway unit, which is particularly useful for enrichment analysis of complexes or protein families.</p><p>For a given pathway with <italic>m</italic> nodes, the CePa score is defined as 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ s = \sum_{i=1}^{m} w_{i} d_{i},  $$ \end{document}</tex-math><mml:math id="M58"><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2019_3146_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p><p>where <italic>d</italic><sub><italic>i</italic></sub>=1 if the <italic>i</italic>th node is differentially expressed and <italic>d</italic><sub><italic>i</italic></sub>=0 otherwise, and <italic>w</italic><sub><italic>i</italic></sub> corresponds to the <italic>i</italic>th node&#x02019;s weight defined based on various centrality measures. A small offset of 0.01 is added to each <italic>w</italic><sub><italic>i</italic></sub> to ensure positive weights. CePa allows equal weights and weights defined from centrality measures such as node degree, betweenness [<xref ref-type="bibr" rid="CR49">49</xref>] and the largest reach. The degree centrality measures the number of neighbors a node has, betweenness quantifies how often a node appears on the shortest path between two other nodes, and the largest reach centrality defines how far a node can send or receive information within the pathway.</p><p>CePa uses gene permutation to test whether genes inside the pathway are at most as differentially expressed as those outside the pathway given its score. In our numerical results, we took the minimum of the <italic>p</italic>-values obtained using different weights as representing significance for pathway enrichment. The score definition in (<xref rid="Equ6" ref-type="">6</xref>) is a variant of ORA, but can also be extended to incorporate gene-level statistics as in FCS methods [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR50">50</xref>].</p></sec><sec id="Sec24"><title>PRS</title><p>The Pathway Regulation Score ([<xref ref-type="bibr" rid="CR16">16</xref>], PRS) enrichment method was developed in parallel to CePa and the two share some similarities. Specifically, PRS assigns a value <italic>v</italic><sub><italic>i</italic></sub> and weight <italic>w</italic><sub><italic>i</italic></sub> to each node <italic>i</italic>, which may contain one or more genes. The node value <italic>v</italic><sub><italic>i</italic></sub> is 0 if the corresponding gene(s) are not expressed, 1 if they are expressed but not differential, or the maximum fold-change value if one or more genes in node <italic>i</italic> are differential. If <italic>v</italic><sub><italic>i</italic></sub>&#x0003e;1, node <italic>i</italic> is then assigned a weight <italic>w</italic><sub><italic>i</italic></sub>, which is the number of downstream DE nodes (either directly or via other significant nodes, including the starting node itself). The score for a pathway with <italic>m</italic> nodes is defined as 
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ PRS = \sum_{i=1}^{m} s_{i},  $$ \end{document}</tex-math><mml:math id="M60"><mml:mtext mathvariant="italic">PRS</mml:mtext><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2019_3146_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p><p>where node score <italic>s</italic><sub><italic>i</italic></sub>=<italic>w</italic><sub><italic>i</italic></sub><italic>v</italic><sub><italic>i</italic></sub> if node value <italic>v</italic><sub><italic>i</italic></sub>&#x0003e;1 and 0 otherwise. The pathway score <italic>PRS</italic> is then normalized with respect to pathway size by multiplying the proportion of DE genes over the total number of expressed genes.</p><p>PRS assesses the significance of each pathway using gene permutation. The raw and permuted scores, calculated respectively from the original data and permuted data, are first standardized with respect to the permuted scores in order to derive the empirical null distribution. The <italic>p</italic>-value of each pathway is determined as the proportion of normalized permuted scores greater than or equal to the normalized raw scores.</p></sec><sec id="Sec25"><title>PathNet</title><p>PathNet [<xref ref-type="bibr" rid="CR17">17</xref>] combines all pathways under consideration into a <italic>pooled</italic> pathway, defined as the union of all pathways. The interactions among genes in the pooled pathway are represented by an adjacency matrix <italic>A</italic>, which is a binary matrix with 1 and 0 indicating the presence and absence of an interaction. Given the network <italic>A</italic>, PathNet calculates the biomolecule-level significance <inline-formula id="IEq16"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$p_{i}^{C}$\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq16.gif"/></alternatives></inline-formula> by combining the direct evidence <inline-formula id="IEq17"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$p_{i}^{D}$\end{document}</tex-math><mml:math id="M64"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq17.gif"/></alternatives></inline-formula> with the indirect one <inline-formula id="IEq18"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$p_{i}^{I}$\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq18.gif"/></alternatives></inline-formula> based on Fisher&#x02019;s method. It then uses a hypergeometric test to evaluate the significance of a given pathway. While the direct evidence <inline-formula id="IEq19"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$p_{i}^{D}$\end{document}</tex-math><mml:math id="M68"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq19.gif"/></alternatives></inline-formula> accounts for the differential expression of each biomolecule <italic>g</italic><sub><italic>i</italic></sub>, the indirect evidence <inline-formula id="IEq20"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$p_{i}^{I}$\end{document}</tex-math><mml:math id="M70"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq20.gif"/></alternatives></inline-formula> incorporates the effects on <italic>g</italic><sub><italic>i</italic></sub> from its neighbors. Specifically, PathNet defines the indirect evidence score for <italic>g</italic><sub><italic>i</italic></sub> as 
<disp-formula id="Equi"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\text{SI}_{i} = \sum_{j: j\ne i} A_{ij} * \left\{- \log_{10}\left(p_{j}^{D}\right)\right\}, $$ \end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msub><mml:mrow><mml:mtext>SI</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02217;</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_3146_Article_Equi.gif" position="anchor"/></alternatives></disp-formula> where the sum is over all biomolecules in the pooled pathway. The significance of the indirect evidence <inline-formula id="IEq21"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$p_{i}^{I}$\end{document}</tex-math><mml:math id="M74"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3146_Article_IEq21.gif"/></alternatives></inline-formula> is then determined by testing if the observed SI<sub><italic>i</italic></sub> is greater than expected by chance. Similar to SPIA, PathNet accounts for biomolecule interactions only through the topology information available in the database, e.g., KEGG.</p></sec></sec><sec id="Sec26"><title>Methodological considerations</title><p>Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref> provides an overview of all methods in terms of their null hypotheses and input requirements. These methods differ in two main aspects.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Overview of tested pathway enrichment methods</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">Null hypothesis</th><th align="left">Gene <italic>p</italic>-value thresholding</th><th align="left">Expression data</th><th align="left">Pathway</th><th align="left">R/Bioconductor</th><th align="left">Reference</th></tr></thead><tbody><tr><td align="left">Pathway-Express</td><td align="left">Competitive</td><td align="left">Optional</td><td align="left">No</td><td align="left">Topology</td><td align="left">ROntoTools 2.10.0</td><td align="left">[<xref ref-type="bibr" rid="CR8">8</xref>]</td></tr><tr><td align="left">SPIA</td><td align="left">Competitive</td><td align="left">Yes</td><td align="left">No</td><td align="left">Topology</td><td align="left">graphite 1.28.2</td><td align="left">[<xref ref-type="bibr" rid="CR9">9</xref>]</td></tr><tr><td align="left">NetGSA</td><td align="left">Self-contained</td><td align="left">No</td><td align="left">Yes</td><td align="left">Topology</td><td align="left">netgsa 3.1.0</td><td align="left">[<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]</td></tr><tr><td align="left">topologyGSA</td><td align="left">Self-contained</td><td align="left">No</td><td align="left">Yes</td><td align="left">Topology</td><td align="left">topologyGSA 1.4.6</td><td align="left">[<xref ref-type="bibr" rid="CR12">12</xref>]</td></tr><tr><td align="left">DEGraph</td><td align="left">Self-contained</td><td align="left">No</td><td align="left">Yes</td><td align="left">Topology</td><td align="left">DEGraph 1.34.0</td><td align="left">[<xref ref-type="bibr" rid="CR13">13</xref>]</td></tr><tr><td align="left">CAMERA</td><td align="left">Competitive</td><td align="left">No</td><td align="left">Yes</td><td align="left">Membership</td><td align="left">limma 3.38.3</td><td align="left">[<xref ref-type="bibr" rid="CR14">14</xref>]</td></tr><tr><td align="left">CePa</td><td align="left">Competitive</td><td align="left">Yes</td><td align="left">No</td><td align="left">Topology</td><td align="left">CePa 0.6</td><td align="left">[<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR48">48</xref>]</td></tr><tr><td align="left">PRS</td><td align="left">Competitive</td><td align="left">Yes</td><td align="left">No</td><td align="left">Topology</td><td align="left">ToPASeq 1.16.1</td><td align="left">[<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR51">51</xref>]</td></tr><tr><td align="left">PathNet</td><td align="left">Competitive</td><td align="left">Yes</td><td align="left">No</td><td align="left">Topology</td><td align="left">PathNet 1.22.0</td><td align="left">[<xref ref-type="bibr" rid="CR17">17</xref>]</td></tr></tbody></table><table-wrap-foot><p>All methods return the <italic>p</italic>-values before and/or after correcting for multiple comparisons</p></table-wrap-foot></table-wrap>
</p><p>The first distinction is in the type of null hypothesis. CAMERA and PathNet test a competitive null hypothesis of whether the genes in a given pathway are at most as differentially expressed as those outside the pathway. Pathway-Express, SPIA, CePa and PRS test the competitive null by comparing the pathway of interest to a random pathway (while holding the sample labels fixed). In contrast, NetGSA, topologyGSA and DEGraph consider the self-contained null hypothesis by testing a pathway against itself. Although the competitive null hypothesis can have an appealing interpretation, assessing the significance of the competitive null is challenging, as it corresponds to a gene sampling framework which treats genes as independent (see discussion in [<xref ref-type="bibr" rid="CR26">26</xref>]).</p><p>Another major difference among these methods is whether the method takes as input expression data or thresholded gene <italic>p</italic>-values. With the exception of CAMERA, all methods based on testing the competitive null need to determine DE genes based on a pre-specified threshold of corrected <italic>p</italic>-values. While the thresholding may seem intuitive, the resulting enrichment results may be sensitive to the <italic>p</italic>-value cutoff. The emphasis on <italic>p</italic>-value thresholding also implies that these methods will not work in settings where there are too few DE genes, i.e. when gene-wise expression change is too small, as illustrated in the &#x0201c;<xref rid="Sec8" ref-type="sec">Results</xref>&#x0201d; section. All self-contained tests directly use expression data and thus avoid making subjective choices about DE genes.</p></sec><sec id="Sec27"><title>Network information</title><p>In evaluating these methods, we also make the distinction between pathway topology and pathway membership, where the former refers to both pathway membership and the interactions amongst pathway members.</p><p>Importantly, the pathway topology information required by different methods can be quite different, which may affect the user experience. CAMERA only uses pathway membership and requires the least effort. The R package graphite provides functionality to retrieve the list of KEGG pathways, and the resulting topology information can be readily passed to Pathway-Express, SPIA, topologyGSA, DEGraph and PRS (as implemented in ToPASeq).</p><p>In comparison, NetGSA, CePa and PathNet require additional steps of processing before graphite pathways can be analyzed. However, this additional step also implies flexibility in the sense that the user can specify desired network information. For example, NetGSA requires a weighted network, where the weights reflect the interactions between genes/metabolites. This can be either available network connectivity information from a database, or estimated from data based on partial correlations complemented with connectivity information from a database. In the gene expression data examples, we used gene-gene interactions available in BioGrid 3.5.170 [<xref ref-type="bibr" rid="CR52">52</xref>] compiled on February 25, 2019 as known structural constraints and estimated the weights from data. In the metabolomic data example, we took the metabolic network from KEGG metabolic reactions using the KEGGgraph R package (version 1.38.0).</p><p>Finally, although NetGSA allows condition-specific networks, we implemented NetGSA assuming equal networks to ensure fair comparisons with topologyGSA and DEGraph.</p></sec><sec id="Sec28"><title>Implementation and availability</title><p>All methods tested have well-maintained R packages available on CRAN or Bioconductor. Input genes are named by Entrez IDs in all methods with the exception of topologyGSA and CePa, which use instead gene symbols. Pathway topology information was obtained from the KEGG database [<xref ref-type="bibr" rid="CR37">37</xref>], extracted using the R package graphite on November 28, 2018 for cancer genomic studies, and from KEGG metabolic interactions using the KEGGgraph R package in the metabolomic study.</p></sec></sec><sec sec-type="supplementary-material"><title>Supplementary information</title><sec id="Sec29"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="12859_2019_3146_MOESM1_ESM.pdf"><caption><p><bold>Additional file 1</bold> Supplementary materials. Supplementary Materials include details on test design, additional simulation results on the two gene expression data and analysis of a synthetic data set as well as information on data and code availability. (pdf)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>CAMERA</term><def><p>Correlation adjusted MEan RAnk gene set test</p></def></def-item><def-item><term>DE</term><def><p>Differentially expressed</p></def></def-item><def-item><term>DC</term><def><p>Detection call</p></def></def-item><def-item><term>FCS</term><def><p>Functional class scoring</p></def></def-item><def-item><term>FDR</term><def><p>False discovery rate</p></def></def-item><def-item><term>KEGG</term><def><p>Kyoto encyclopedia of genes and genomes</p></def></def-item><def-item><term>NetGSA</term><def><p>Network-based gene set analysis</p></def></def-item><def-item><term>ORA</term><def><p>Over-representation analysis</p></def></def-item><def-item><term>PE</term><def><p>Pathway express</p></def></def-item><def-item><term>PRS</term><def><p>Pathway regulation score</p></def></def-item><def-item><term>SPIA</term><def><p>Signaling pathway impact analysis</p></def></def-item><def-item><term>TCGA</term><def><p>The cancer genome atlas</p></def></def-item></def-list></glossary><fn-group><fn><p><bold>Publisher&#x02019;s Note</bold></p><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><sec><title>Supplementary information</title><p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-019-3146-1.</p></sec><ack><title>Acknowledgements</title><p>The authors would like to thank three anonymous referees for their constructive comments.</p></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>JM carried out the simulation studies, performed the statistical analyses and wrote the manuscript. AS and GM participated in the design of the simulation studies. AS and GM revised the manuscript and supervised the project. All authors read and approved the final manuscript.</p></notes><notes notes-type="funding-information"><title>Funding</title><p>This work was partially supported by grant R01 GM114029 from the NIH. AS also acknowledges the support from the NSF through grant DMS-1561814. The funders had no role in study design, data collection and analysis, interpretation of data, or preparation of the manuscript.</p></notes><notes notes-type="data-availability"><title>Availability of data and materials</title><p>Detailed results for all parameter settings in Excel spreadsheets, together with datasets and R code for reproducing the results of this study can be found in [<xref ref-type="bibr" rid="CR32">32</xref>].</p></notes><notes><title>Ethics approval and consent to participate</title><p>Not applicable.</p></notes><notes><title>Consent for publication</title><p>Not applicable.</p></notes><notes notes-type="COI-statement"><title>Competing interests</title><p>The authors declare no competing interests.</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>BG</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Shen</surname><given-names>X</given-names></name><name><surname>McKenna</surname><given-names>ES</given-names></name><name><surname>Lemieux</surname><given-names>ME</given-names></name><name><surname>Cho</surname><given-names>Y. -J.</given-names></name><name><surname>Koellhoffer</surname><given-names>EC</given-names></name><name><surname>Pomeroy</surname><given-names>SL</given-names></name><name><surname>Orkin</surname><given-names>SH</given-names></name><name><surname>Roberts</surname><given-names>CW</given-names></name></person-group><article-title>Epigenetic antagonism between polycomb and swi/snf complexes during oncogenic transformation</article-title><source>Cancer Cell</source><year>2010</year><volume>18</volume><issue>4</issue><fpage>316</fpage><lpage>28</lpage><pub-id pub-id-type="doi">10.1016/j.ccr.2010.09.006</pub-id><?supplied-pmid 20951942?><pub-id pub-id-type="pmid">20951942</pub-id></element-citation></ref><ref id="CR2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Green</surname><given-names>MR</given-names></name><name><surname>Monti</surname><given-names>S</given-names></name><name><surname>Dalla-Favera</surname><given-names>R</given-names></name><name><surname>Pasqualucci</surname><given-names>L</given-names></name><name><surname>Walsh</surname><given-names>NC</given-names></name><name><surname>Schmidt-Supprian</surname><given-names>M</given-names></name><name><surname>Kutok</surname><given-names>JL</given-names></name><name><surname>Rodig</surname><given-names>SJ</given-names></name><name><surname>Neuberg</surname><given-names>DS</given-names></name><name><surname>Rajewsky</surname><given-names>K</given-names></name><etal/></person-group><article-title>Signatures of murine b-cell development implicate yy1 as a regulator of the germinal center-specific program</article-title><source>Proc Natl Acad Sci</source><year>2011</year><volume>108</volume><issue>7</issue><fpage>2873</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1073/pnas.1019537108</pub-id><?supplied-pmid 21282644?><pub-id pub-id-type="pmid">21282644</pub-id></element-citation></ref><ref id="CR3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lehmann</surname><given-names>BD</given-names></name><name><surname>Bauer</surname><given-names>JA</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Sanders</surname><given-names>ME</given-names></name><name><surname>Chakravarthy</surname><given-names>AB</given-names></name><name><surname>Shyr</surname><given-names>Y</given-names></name><name><surname>Pietenpol</surname><given-names>JA</given-names></name></person-group><article-title>Identification of human triple-negative breast cancer subtypes and preclinical models for selection of targeted therapies</article-title><source>J Clin Investig</source><year>2011</year><volume>121</volume><issue>7</issue><fpage>2750</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1172/JCI45014</pub-id><?supplied-pmid 21633166?><pub-id pub-id-type="pmid">21633166</pub-id></element-citation></ref><ref id="CR4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Putluri</surname><given-names>N</given-names></name><name><surname>Shojaie</surname><given-names>A</given-names></name><name><surname>Vasu</surname><given-names>VT</given-names></name><name><surname>Vareed</surname><given-names>SK</given-names></name><name><surname>Nalluri</surname><given-names>S</given-names></name><name><surname>Putluri</surname><given-names>V</given-names></name><name><surname>Thangjam</surname><given-names>GS</given-names></name><name><surname>Panzitt</surname><given-names>K</given-names></name><name><surname>Tallman</surname><given-names>CT</given-names></name><name><surname>Butler</surname><given-names>C</given-names></name><etal/></person-group><article-title>Metabolomic profiling reveals potential markers and bioprocesses altered in bladder cancer progression</article-title><source>Cancer Res</source><year>2011</year><volume>71</volume><issue>24</issue><fpage>7376</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1158/0008-5472.CAN-11-1154</pub-id><?supplied-pmid 21990318?><pub-id pub-id-type="pmid">21990318</pub-id></element-citation></ref><ref id="CR5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danussi</surname><given-names>C</given-names></name><name><surname>Akavia</surname><given-names>UD</given-names></name><name><surname>Niola</surname><given-names>F</given-names></name><name><surname>Jovic</surname><given-names>A</given-names></name><name><surname>Lasorella</surname><given-names>A</given-names></name><name><surname>Pe&#x02019;er</surname><given-names>D</given-names></name><name><surname>Iavarone</surname><given-names>A</given-names></name></person-group><article-title>Rhpn2 drives mesenchymal transformation in malignant glioma by triggering rhoa activation</article-title><source>Cancer Res</source><year>2013</year><volume>73</volume><issue>16</issue><fpage>5140</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1158/0008-5472.CAN-13-1168-T</pub-id><?supplied-pmid 23774217?><pub-id pub-id-type="pmid">23774217</pub-id></element-citation></ref><ref id="CR6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Subramanian</surname><given-names>A</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Mootha</surname><given-names>VK</given-names></name><name><surname>Mukherjee</surname><given-names>S</given-names></name><name><surname>Ebert</surname><given-names>BL</given-names></name><name><surname>Gillette</surname><given-names>MA</given-names></name><name><surname>Paulovich</surname><given-names>A</given-names></name><name><surname>Pomeroy</surname><given-names>SL</given-names></name><name><surname>Golub</surname><given-names>TR</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><etal/></person-group><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title><source>Proc Natl Acad Sci</source><year>2005</year><volume>102</volume><issue>43</issue><fpage>15545</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id><pub-id pub-id-type="pmid">16199517</pub-id></element-citation></ref><ref id="CR7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Efron</surname><given-names>B</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><article-title>On testing the significance of sets of genes</article-title><source>Ann Appl Stat</source><year>2007</year><volume>1</volume><issue>1</issue><fpage>107</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1214/07-AOAS101</pub-id></element-citation></ref><ref id="CR8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Draghici</surname><given-names>S</given-names></name><name><surname>Khatri</surname><given-names>P</given-names></name><name><surname>Tarca</surname><given-names>AL</given-names></name><name><surname>Amin</surname><given-names>K</given-names></name><name><surname>Done</surname><given-names>A</given-names></name><name><surname>Voichita</surname><given-names>C</given-names></name><name><surname>Georgescu</surname><given-names>C</given-names></name><name><surname>Romero</surname><given-names>R</given-names></name></person-group><article-title>A systems biology approach for pathway level analysis</article-title><source>Genome Res</source><year>2007</year><volume>17</volume><issue>10</issue><fpage>1537</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1101/gr.6202607</pub-id><?supplied-pmid 17785539?><pub-id pub-id-type="pmid">17785539</pub-id></element-citation></ref><ref id="CR9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tarca</surname><given-names>AL</given-names></name><name><surname>Draghici</surname><given-names>S</given-names></name><name><surname>Khatri</surname><given-names>P</given-names></name><name><surname>Hassan</surname><given-names>SS</given-names></name><name><surname>Mittal</surname><given-names>P</given-names></name><name><surname>Kim</surname><given-names>J. -s.</given-names></name><name><surname>Kim</surname><given-names>CJ</given-names></name><name><surname>Kusanovic</surname><given-names>JP</given-names></name><name><surname>Romero</surname><given-names>R</given-names></name></person-group><article-title>A novel signaling pathway impact analysis</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><issue>1</issue><fpage>75</fpage><lpage>82</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btn577</pub-id><?supplied-pmid 18990722?><pub-id pub-id-type="pmid">18990722</pub-id></element-citation></ref><ref id="CR10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shojaie</surname><given-names>A</given-names></name><name><surname>Michailidis</surname><given-names>G</given-names></name></person-group><article-title>Analysis of gene sets based on the underlying regulatory network</article-title><source>J Comput Biol</source><year>2009</year><volume>16</volume><issue>3</issue><fpage>407</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1089/cmb.2008.0081</pub-id><?supplied-pmid 19254181?><pub-id pub-id-type="pmid">19254181</pub-id></element-citation></ref><ref id="CR11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>J</given-names></name><name><surname>Shojaie</surname><given-names>A</given-names></name><name><surname>Michailidis</surname><given-names>G</given-names></name></person-group><article-title>Network-based pathway enrichment analysis with incomplete network information</article-title><source>Bioinformatics</source><year>2016</year><volume>32</volume><issue>20</issue><fpage>3165</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw410</pub-id><?supplied-pmid 27357170?><pub-id pub-id-type="pmid">27357170</pub-id></element-citation></ref><ref id="CR12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Massa</surname><given-names>MS</given-names></name><name><surname>Chiogna</surname><given-names>M</given-names></name><name><surname>Romualdi</surname><given-names>C</given-names></name></person-group><article-title>Gene set analysis exploiting the topology of a pathway</article-title><source>BMC Syst Biol</source><year>2010</year><volume>4</volume><issue>1</issue><fpage>121</fpage><?supplied-pmid 20809931?><pub-id pub-id-type="pmid">20809931</pub-id></element-citation></ref><ref id="CR13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacob</surname><given-names>L</given-names></name><name><surname>Neuvial</surname><given-names>P</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name></person-group><article-title>More power via graph-structured tests for differential expression of gene networks</article-title><source>Ann Appl Stat</source><year>2012</year><volume>6</volume><issue>2</issue><fpage>561</fpage><lpage>600</lpage><pub-id pub-id-type="doi">10.1214/11-AOAS528</pub-id></element-citation></ref><ref id="CR14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>D</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>Camera: a competitive gene set test accounting for inter-gene correlation</article-title><source>Nucleic Acids Res</source><year>2012</year><volume>40</volume><issue>17</issue><fpage>133</fpage><pub-id pub-id-type="doi">10.1093/nar/gks461</pub-id></element-citation></ref><ref id="CR15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gu</surname><given-names>Z</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Cao</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name></person-group><article-title>Centrality-based pathway enrichment: a systematic approach for finding significant pathways dominated by key genes</article-title><source>BMC Syst Biol</source><year>2012</year><volume>6</volume><issue>1</issue><fpage>56</fpage><pub-id pub-id-type="doi">10.1186/1752-0509-6-56</pub-id><?supplied-pmid 22672776?><pub-id pub-id-type="pmid">22672776</pub-id></element-citation></ref><ref id="CR16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ibrahim</surname><given-names>M. A. -H.</given-names></name><name><surname>Jassim</surname><given-names>S</given-names></name><name><surname>Cawthorne</surname><given-names>MA</given-names></name><name><surname>Langlands</surname><given-names>K</given-names></name></person-group><article-title>A topology-based score for pathway enrichment</article-title><source>J Comput Biol</source><year>2012</year><volume>19</volume><issue>5</issue><fpage>563</fpage><lpage>73</lpage><pub-id pub-id-type="doi">10.1089/cmb.2011.0182</pub-id><?supplied-pmid 22468678?><pub-id pub-id-type="pmid">22468678</pub-id></element-citation></ref><ref id="CR17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dutta</surname><given-names>B</given-names></name><name><surname>Wallqvist</surname><given-names>A</given-names></name><name><surname>Reifman</surname><given-names>J</given-names></name></person-group><article-title>Pathnet: a tool for pathway analysis using topological information</article-title><source>Source Code Biol Med</source><year>2012</year><volume>7</volume><issue>1</issue><fpage>10</fpage><pub-id pub-id-type="doi">10.1186/1751-0473-7-10</pub-id><?supplied-pmid 23006764?><pub-id pub-id-type="pmid">23006764</pub-id></element-citation></ref><ref id="CR18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>St&#x000e4;dler</surname><given-names>N</given-names></name><name><surname>Mukherjee</surname><given-names>S</given-names></name></person-group><article-title>Multivariate gene-set testing based on graphical models</article-title><source>Biostatistics</source><year>2014</year><volume>16</volume><issue>1</issue><fpage>47</fpage><lpage>59</lpage><pub-id pub-id-type="doi">10.1093/biostatistics/kxu027</pub-id><?supplied-pmid 24974316?><pub-id pub-id-type="pmid">24974316</pub-id></element-citation></ref><ref id="CR19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Wieringen</surname><given-names>Wessel N.</given-names></name><name><surname>Peeters</surname><given-names>Carel F. W.</given-names></name><name><surname>de Menezes</surname><given-names>Renee X.</given-names></name><name><surname>van de Wiel</surname><given-names>Mark A.</given-names></name></person-group><article-title>Testing for pathway (in)activation by using Gaussian graphical models</article-title><source>Journal of the Royal Statistical Society: Series C (Applied Statistics)</source><year>2018</year><volume>67</volume><issue>5</issue><fpage>1419</fpage><lpage>1436</lpage><pub-id pub-id-type="doi">10.1111/rssc.12282</pub-id></element-citation></ref><ref id="CR20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khatri</surname><given-names>P</given-names></name><name><surname>Sirota</surname><given-names>M</given-names></name><name><surname>Butte</surname><given-names>AJ</given-names></name></person-group><article-title>Ten years of pathway analysis: current approaches and outstanding challenges</article-title><source>PLoS Comput Biol</source><year>2012</year><volume>8</volume><issue>2</issue><fpage>1002375</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002375</pub-id></element-citation></ref><ref id="CR21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitrea</surname><given-names>C</given-names></name><name><surname>Taghavi</surname><given-names>Z</given-names></name><name><surname>Bokanizad</surname><given-names>B</given-names></name><name><surname>Hanoudi</surname><given-names>S</given-names></name><name><surname>Tagett</surname><given-names>R</given-names></name><name><surname>Donato</surname><given-names>M</given-names></name><name><surname>Voichita</surname><given-names>C</given-names></name><name><surname>Draghici</surname><given-names>S</given-names></name></person-group><article-title>Methods and approaches in the topology-based analysis of biological pathways</article-title><source>Front Physiol</source><year>2013</year><volume>4</volume><fpage>278</fpage><pub-id pub-id-type="doi">10.3389/fphys.2013.00278</pub-id><?supplied-pmid 24133454?><pub-id pub-id-type="pmid">24133454</pub-id></element-citation></ref><ref id="CR22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>L</given-names></name><name><surname>Zuo</surname><given-names>X-Y</given-names></name><name><surname>Su</surname><given-names>W-Y</given-names></name><name><surname>Zhao</surname><given-names>X-L</given-names></name><name><surname>Yuan</surname><given-names>M-Q</given-names></name><name><surname>Han</surname><given-names>L-Z</given-names></name><name><surname>Zhao</surname><given-names>X</given-names></name><name><surname>Chen</surname><given-names>Y-D</given-names></name><name><surname>Rao</surname><given-names>S-Q</given-names></name></person-group><article-title>Pathway-based analysis tools for complex diseases: a review</article-title><source>Genom Proteomics Bioinforma</source><year>2014</year><volume>12</volume><issue>5</issue><fpage>210</fpage><lpage>20</lpage><pub-id pub-id-type="doi">10.1016/j.gpb.2014.10.002</pub-id></element-citation></ref><ref id="CR23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Varadan</surname><given-names>V</given-names></name><name><surname>Mittal</surname><given-names>P</given-names></name><name><surname>Vaske</surname><given-names>CJ</given-names></name><name><surname>Benz</surname><given-names>SC</given-names></name></person-group><article-title>The integration of biological pathway knowledge in cancer genomics: a review of existing computational approaches</article-title><source>IEEE Sig Process Mag</source><year>2012</year><volume>29</volume><issue>1</issue><fpage>35</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1109/MSP.2011.943037</pub-id></element-citation></ref><ref id="CR24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaakkola</surname><given-names>MK</given-names></name><name><surname>Elo</surname><given-names>LL</given-names></name></person-group><article-title>Empirical comparison of structure-based pathway methods</article-title><source>Brief Bioinforma</source><year>2016</year><volume>17</volume><issue>2</issue><fpage>336</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1093/bib/bbv049</pub-id></element-citation></ref><ref id="CR25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bayerlov&#x000e1;</surname><given-names>M</given-names></name><name><surname>Jung</surname><given-names>K</given-names></name><name><surname>Kramer</surname><given-names>F</given-names></name><name><surname>Klemm</surname><given-names>F</given-names></name><name><surname>Bleckmann</surname><given-names>A</given-names></name><name><surname>Bei&#x000df;barth</surname><given-names>T</given-names></name></person-group><article-title>Comparative study on gene set and pathway topology-based enrichment methods</article-title><source>BMC Bioinformatics</source><year>2015</year><volume>16</volume><issue>1</issue><fpage>334</fpage><pub-id pub-id-type="doi">10.1186/s12859-015-0751-5</pub-id><?supplied-pmid 26489510?><pub-id pub-id-type="pmid">26489510</pub-id></element-citation></ref><ref id="CR26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goeman</surname><given-names>JJ</given-names></name><name><surname>B&#x000fc;hlmann</surname><given-names>P</given-names></name></person-group><article-title>Analyzing gene expression data in terms of gene sets: methodological issues</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><issue>8</issue><fpage>980</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btm051</pub-id><?supplied-pmid 17303618?><pub-id pub-id-type="pmid">17303618</pub-id></element-citation></ref><ref id="CR27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kr&#x000e4;mer</surname><given-names>A</given-names></name><name><surname>Green</surname><given-names>J</given-names></name><name><surname>Pollard Jr</surname><given-names>J</given-names></name><name><surname>Tugendreich</surname><given-names>S</given-names></name></person-group><article-title>Causal analysis approaches in ingenuity pathway analysis</article-title><source>Bioinformatics</source><year>2013</year><volume>30</volume><issue>4</issue><fpage>523</fpage><lpage>30</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btt703</pub-id><?supplied-pmid 24336805?><pub-id pub-id-type="pmid">24336805</pub-id></element-citation></ref><ref id="CR28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Girvan</surname><given-names>M</given-names></name><name><surname>Newman</surname><given-names>ME</given-names></name></person-group><article-title>Community structure in social and biological networks</article-title><source>Proc Natl Acad Sci</source><year>2002</year><volume>99</volume><issue>12</issue><fpage>7821</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.1073/pnas.122653799</pub-id><?supplied-pmid 12060727?><pub-id pub-id-type="pmid">12060727</pub-id></element-citation></ref><ref id="CR29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Janssen</surname><given-names>A</given-names></name></person-group><article-title>Studentized permutation tests for non-i.i.d, hypotheses and the generalized behrens-fisher problem</article-title><source>Stat Probab Lett</source><year>1997</year><volume>36</volume><fpage>9</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1016/S0167-7152(97)00043-6</pub-id></element-citation></ref><ref id="CR30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Janssen</surname><given-names>A</given-names></name><name><surname>Pauls</surname><given-names>T</given-names></name></person-group><article-title>How do bootstrap and permutation tests work?</article-title><source>Ann Stat</source><year>2003</year><volume>31</volume><issue>3</issue><fpage>768</fpage><lpage>806</lpage><pub-id pub-id-type="doi">10.1214/aos/1056562462</pub-id></element-citation></ref><ref id="CR31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y</given-names></name><name><surname>Hochberg</surname><given-names>Y</given-names></name></person-group><article-title>Controlling the false discovery rate: A practical and powerful approach to multiple testing</article-title><source>J R Stat Soc Ser B (Methodol)</source><year>1995</year><volume>57</volume><issue>1</issue><fpage>289</fpage><lpage>300</lpage></element-citation></ref><ref id="CR32"><label>32</label><mixed-citation publication-type="other">Ma J, Shojaie A, Michailidis G. Supplementary materials to &#x02018;A comparative study of network-based pathway enrichment analysis methods&#x02019;. 2019. <ext-link ext-link-type="uri" xlink:href="https://github.com/drjingma/NetGSAreview">https://github.com/drjingma/NetGSAreview</ext-link>. [Online; accessed 3-May-2019].</mixed-citation></ref><ref id="CR33"><label>33</label><mixed-citation publication-type="other">Koboldt DC, Fulton RS, McLellan MD, Schmidt H, Kalicki-Veizer J, McMichael JF, Fulton LL, Dooling DJ, Ding L, Mardis ER, et al. Comprehensive molecular portraits of human breast tumours. Nature. 2012; 490(7418):61&#x02013;70.</mixed-citation></ref><ref id="CR34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shojaie</surname><given-names>A</given-names></name><name><surname>Michailidis</surname><given-names>G</given-names></name></person-group><article-title>Network enrichment analysis in complex experiments</article-title><source>Stat Appl Genet Mol Biol</source><year>2010</year><volume>9</volume><issue>1</issue><fpage>22</fpage><pub-id pub-id-type="doi">10.2202/1544-6115.1483</pub-id><?supplied-pmid 2898649?><pub-id pub-id-type="pmid">2898649</pub-id></element-citation></ref><ref id="CR35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Yuping</given-names></name><name><surname>Linder</surname><given-names>M. Henry</given-names></name><name><surname>Shojaie</surname><given-names>Ali</given-names></name><name><surname>Ouyang</surname><given-names>Zhengqing</given-names></name><name><surname>Shen</surname><given-names>Ronglai</given-names></name><name><surname>Baggerly</surname><given-names>Keith A.</given-names></name><name><surname>Baladandayuthapani</surname><given-names>Veerabhadran</given-names></name><name><surname>Zhao</surname><given-names>Hongyu</given-names></name></person-group><article-title>Dissecting Pathway Disturbances Using Network Topology and Multi-platform Genomics Data</article-title><source>Statistics in Biosciences</source><year>2017</year><volume>10</volume><issue>1</issue><fpage>86</fpage><lpage>106</lpage><pub-id pub-id-type="doi">10.1007/s12561-017-9193-0</pub-id></element-citation></ref><ref id="CR36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ihnatova</surname><given-names>I</given-names></name><name><surname>Popovici</surname><given-names>V</given-names></name><name><surname>Budinska</surname><given-names>E</given-names></name></person-group><article-title>A critical comparison of topology-based pathway analysis methods</article-title><source>PloS ONE</source><year>2018</year><volume>13</volume><issue>1</issue><fpage>0191154</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0191154</pub-id></element-citation></ref><ref id="CR37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanehisa</surname><given-names>M</given-names></name><name><surname>Goto</surname><given-names>S</given-names></name></person-group><article-title>Kegg: Kyoto encyclopedia of genes and genomes</article-title><source>Nucleic Acids Res</source><year>2000</year><volume>28</volume><issue>1</issue><fpage>27</fpage><lpage>30</lpage><pub-id pub-id-type="doi">10.1093/nar/28.1.27</pub-id><?supplied-pmid 10592173?><pub-id pub-id-type="pmid">10592173</pub-id></element-citation></ref><ref id="CR38"><label>38</label><mixed-citation publication-type="other">Abeshouse A, Ahn J, Akbani R, Ally A, Amin S, Andry CD, Annala M, Aprikian A, Armenia J, Arora A, et al. The molecular taxonomy of primary prostate cancer. Cell. 2015; 163(4):1011&#x02013;25.</mixed-citation></ref><ref id="CR39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fahrmann</surname><given-names>J</given-names></name><name><surname>Grapov</surname><given-names>D</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Hammock</surname><given-names>B</given-names></name><name><surname>Fiehn</surname><given-names>O</given-names></name><name><surname>Bell</surname><given-names>GI</given-names></name><name><surname>Hara</surname><given-names>M</given-names></name></person-group><article-title>Systemic alterations in the metabolome of diabetic nod mice delineate increased oxidative stress accompanied by reduced inflammation and hypertriglyceridemia</article-title><source>Am J Physiol Endocrinol Metab</source><year>2015</year><volume>308</volume><issue>11</issue><fpage>978</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1152/ajpendo.00019.2015</pub-id></element-citation></ref><ref id="CR40"><label>40</label><mixed-citation publication-type="other">Voichita C, Ansari S, Draghici S. ROntoTools: R Onto-Tools suite. 2018. R package version 2.10.0.</mixed-citation></ref><ref id="CR41"><label>41</label><mixed-citation publication-type="other">Voichita C, Donato M, Draghici S. Incorporating gene significance in the impact analysis of signaling pathways. In: 2012 11th International Conference on Machine Learning and Applications, vol. 1. IEEE: 2012. p. 126&#x02013;31. 10.1109/icmla.2012.230.</mixed-citation></ref><ref id="CR42"><label>42</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lauritzen</surname><given-names>SL</given-names></name></person-group><source>Graphical models</source><year>1996</year><publisher-loc>Oxford</publisher-loc><publisher-name>Clarendon Press</publisher-name></element-citation></ref><ref id="CR43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>H</given-names></name><name><surname>Gnanadesikan</surname><given-names>R</given-names></name><name><surname>Hughes</surname><given-names>J</given-names></name></person-group><article-title>Multivariate analysis of variance (manova)</article-title><source>Biometrics</source><year>1962</year><volume>18</volume><issue>1</issue><fpage>22</fpage><lpage>41</lpage><pub-id pub-id-type="doi">10.2307/2527708</pub-id></element-citation></ref><ref id="CR44"><label>44</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>TW</given-names></name></person-group><source>An introduction to multivariate statistical analysis (3rd edition)</source><year>2003</year><publisher-loc>New Jersey</publisher-loc><publisher-name>John Wiley &#x00026; Sons</publisher-name></element-citation></ref><ref id="CR45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hotelling</surname><given-names>H</given-names></name></person-group><article-title>The generalization of student&#x02019;s ratio</article-title><source>Ann Math Stat</source><year>1931</year><volume>2</volume><issue>3</issue><fpage>360</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1214/aoms/1177732979</pub-id></element-citation></ref><ref id="CR46"><label>46</label><mixed-citation publication-type="other">Chung FRK. Spectral graph theory: CBMS Regional Conference Series in Mathematics (Am. Math. Soc. Providence, RI) no. 92.</mixed-citation></ref><ref id="CR47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ritchie</surname><given-names>ME</given-names></name><name><surname>Phipson</surname><given-names>B</given-names></name><name><surname>Wu</surname><given-names>D</given-names></name><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Law</surname><given-names>CW</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>limma powers differential expression analyses for rna-sequencing and microarray studies</article-title><source>Nucleic Acids Res</source><year>2015</year><volume>43</volume><issue>7</issue><fpage>47</fpage><pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id></element-citation></ref><ref id="CR48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gu</surname><given-names>Z</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name></person-group><article-title>Cepa: an r package for finding significant pathways weighted by multiple network centralities</article-title><source>Bioinformatics</source><year>2013</year><volume>29</volume><issue>5</issue><fpage>658</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btt008</pub-id><?supplied-pmid 23314125?><pub-id pub-id-type="pmid">23314125</pub-id></element-citation></ref><ref id="CR49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freeman</surname><given-names>LC</given-names></name></person-group><article-title>A set of measures of centrality based on betweenness</article-title><source>Sociometry</source><year>1977</year><volume>40</volume><issue>1</issue><fpage>35</fpage><lpage>41</lpage><pub-id pub-id-type="doi">10.2307/3033543</pub-id></element-citation></ref><ref id="CR50"><label>50</label><mixed-citation publication-type="other">Braun R, Shah S. Network methods for pathway analysis of genomic data. 2014. arXiv preprint arXiv:1411.1993.</mixed-citation></ref><ref id="CR51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ihnatova</surname><given-names>I</given-names></name><name><surname>Budinska</surname><given-names>E</given-names></name></person-group><article-title>Topaseq: an r package for topology-based pathway analysis of microarray and rna-seq data</article-title><source>BMC Bioinformatics</source><year>2015</year><volume>16</volume><issue>1</issue><fpage>350</fpage><pub-id pub-id-type="doi">10.1186/s12859-015-0763-1</pub-id><?supplied-pmid 26514335?><pub-id pub-id-type="pmid">26514335</pub-id></element-citation></ref><ref id="CR52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stark</surname><given-names>C.</given-names></name><name><surname>Breitkreutz</surname><given-names>B.-J.</given-names></name><name><surname>Chatr-aryamontri</surname><given-names>A.</given-names></name><name><surname>Boucher</surname><given-names>L.</given-names></name><name><surname>Oughtred</surname><given-names>R.</given-names></name><name><surname>Livstone</surname><given-names>M. S.</given-names></name><name><surname>Nixon</surname><given-names>J.</given-names></name><name><surname>Van Auken</surname><given-names>K.</given-names></name><name><surname>Wang</surname><given-names>X.</given-names></name><name><surname>Shi</surname><given-names>X.</given-names></name><name><surname>Reguly</surname><given-names>T.</given-names></name><name><surname>Rust</surname><given-names>J. M.</given-names></name><name><surname>Winter</surname><given-names>A.</given-names></name><name><surname>Dolinski</surname><given-names>K.</given-names></name><name><surname>Tyers</surname><given-names>M.</given-names></name></person-group><article-title>The BioGRID Interaction Database: 2011 update</article-title><source>Nucleic Acids Research</source><year>2010</year><volume>39</volume><issue>Database</issue><fpage>D698</fpage><lpage>D704</lpage><pub-id pub-id-type="doi">10.1093/nar/gkq1116</pub-id><?supplied-pmid 21071413?><pub-id pub-id-type="pmid">21071413</pub-id></element-citation></ref></ref-list></back></article>