<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id><journal-title-group><journal-title>BMC Genomics</journal-title></journal-title-group><issn pub-type="epub">1471-2164</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6456936</article-id><article-id pub-id-type="publisher-id">5476</article-id><article-id pub-id-type="doi">10.1186/s12864-019-5476-9</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>ENIGMA: an enterotype-like unigram mixture model for microbial association analysis</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Abe</surname><given-names>Ko</given-names></name><address><email>ko.abe@med.nagoya-u.ac.jp</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Hirayama</surname><given-names>Masaaki</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Ohno</surname><given-names>Kinji</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Shimamura</surname><given-names>Teppei</given-names></name><address><email>shimamura@med.nagoya-u.ac.jp</email></address><xref ref-type="aff" rid="Aff4">4</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0943 978X</institution-id><institution-id institution-id-type="GRID">grid.27476.30</institution-id><institution>Division of Systems Biology, Nagoya University Graduate School of Medicine, </institution></institution-wrap>65 Tsurumai-Cho, Showa-Ku, Nagoya, 466-8550 Japan </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0943 978X</institution-id><institution-id institution-id-type="GRID">grid.27476.30</institution-id><institution>School of Health Sciences, Nagoya University Graduate School of Medicine, </institution></institution-wrap>1-1-20 Daiko-Minami, Higashi-Ku, Nagoya, 461-8873 Japan </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0943 978X</institution-id><institution-id institution-id-type="GRID">grid.27476.30</institution-id><institution>Division of Neurogenetics, Center for Neurological Diseases and Cancer, Nagoya University Graduate School of Medicine, </institution></institution-wrap>65 Tsurumai-Cho, Showa-Ku, Nagoya, 466-8550 Japan </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0943 978X</institution-id><institution-id institution-id-type="GRID">grid.27476.30</institution-id><institution>Division of Systems Biology, Nagoya University Graduate School of Medicine, </institution></institution-wrap>65 Tsurumai-Cho, Showa-Ku, Nagoya, 466-8550 Japan </aff></contrib-group><pub-date pub-type="epub"><day>4</day><month>4</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>4</day><month>4</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>20</volume><issue>Suppl 2</issue><issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. The Supplement Editors declare that they have no competing interests.</issue-sponsor><elocation-id>191</elocation-id><permissions><copyright-statement>&#x000a9; The Author(s) 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p>One of the major challenges in microbial studies is detecting associations between microbial communities and a specific disease. A specialized feature of microbiome count data is that intestinal bacterial communities form clusters called as &#x0201c;enterotype&#x0201d;, which are characterized by differences in specific bacterial taxa, making it difficult to analyze these data under health and disease conditions. Traditional probabilistic modeling cannot distinguish between the bacterial differences derived from enterotype and those related to a specific disease.</p></sec><sec><title>Results</title><p>We propose a new probabilistic model, named as ENIGMA (Enterotype-like uNIGram mixture model for Microbial Association analysis), which can be used to address these problems. ENIGMA enabled simultaneous estimation of enterotype-like clusters characterized by the abundances of signature bacterial genera and the parameters of environmental effects associated with the disease.</p></sec><sec><title>Conclusion</title><p>In the simulation study, we evaluated the accuracy of parameter estimation. Furthermore, by analyzing the real-world data, we detected the bacteria related to Parkinson&#x02019;s disease. ENIGMA is implemented in R and is available from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/abikoushi/enigma">https://github.com/abikoushi/enigma</ext-link>).</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Enterotype</kwd><kwd>Topic model</kwd><kwd>Unigram mixture</kwd><kwd>Bayesian inference</kwd><kwd>Metagenomics</kwd></kwd-group><conference xlink:href="http://glab.hzau.edu.cn/APBC2019/"><conf-name>The 17th Asia Pacific Bioinformatics Conference (APBC 2019)</conf-name><conf-acronym>APBC 2019</conf-acronym><conf-loc>Wuhan, China</conf-loc><conf-date>14-16 January 2019</conf-date></conference><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p>More than 100 trillion microbes live on and within human beings and form of complex microbial communities (microbiota). Most microbes cannot be cultured in laboratories, making it difficult to understand how individual microorganisms mediate vital microbiome-host interactions under health and disease conditions. However, recent important advances in high-throughput sequencing technology have enabled observation of the composition of these intestinal microbes. For each sample drawn from an ecosystem, the number of occurrences of each operational taxonomic units (OTUs) is measured and the resulting OTU abundance can be summarized at any level of the bacterial phylogeny. Discovering recurrent microbial compositional patterns that are related to a specific disease is a significant challenge, as individuals with the same disease typically harbor different microbial community structures.</p><p>Recent large-scale sequencing surveys of the human intestinal microbiome, such as the US NIH Human Microbiome Project (HMP) and the European Metagenomics of the Human Intestinal Tract project (MetaHIT), have revealed considerable variations in microbiota composition among individuals [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Particularly, community clusters characterized by differences in the abundance of signature taxa, referred to as enterotypes, were first reported in humans [<xref ref-type="bibr" rid="CR3">3</xref>]. Later, other studies identified enterotype-like clusters that may reflect features of the host-microbial physiology and homeostasis in different species [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>] or at different human body sites [<xref ref-type="bibr" rid="CR6">6</xref>&#x02013;<xref ref-type="bibr" rid="CR9">9</xref>]. This microbial stratification has motivated the development of methods for examining unknown clusters of microbial communities.</p><p>Probabilistic modeling of microbial metagenomics data often provides a powerful framework for characterizing the microbial community structures [<xref ref-type="bibr" rid="CR10">10</xref>&#x02013;<xref ref-type="bibr" rid="CR12">12</xref>]. For example, Knights et al. [<xref ref-type="bibr" rid="CR10">10</xref>] applied a Dirichlet prior to a single-level hierarchy and proposed a Bayesian approach for estimating the proportion of microbial communities. Holmes et al. [<xref ref-type="bibr" rid="CR11">11</xref>] extended the Dirichlet prior to Dirichlet multinomial mixtures to facilitate clustering of microbiome samples. Shafiei et al. [<xref ref-type="bibr" rid="CR12">12</xref>] proposed a hierarchical model for Bayesian inference of microbial communities (BioMiCo) to identify clusters of OTUs related to environmental factors of interest.</p><p>However, such models are not suitable for discovering enterotype-like clusters of microbial communities and associations between microbes and a specific disease for the following two reasons. First, the frameworks of Knights et al. [<xref ref-type="bibr" rid="CR10">10</xref>] and Holmes et al. [<xref ref-type="bibr" rid="CR11">11</xref>] do not explicitly address the association between the microbial compositional patterns and environmental depend on the interest. Second, the framework of Shafiei et al. [<xref ref-type="bibr" rid="CR12">12</xref>] models the structure of each sample using a hierarchical mixture of multinomial distributions that are depends on the factors of interest. Individual host properties such as body mass index, age, or gender cannot explain the observed enterotypes [<xref ref-type="bibr" rid="CR3">3</xref>]. Thus, such enterotype-like clusters that describes interindividual variability among humans do not always to directly affect host probabilities such as diseases ranging from localized gastroenterologic disorders to neurologic, respiratory, metabolic hepatic, and cardiovascular illnesses.</p><p>Here, we introduce a novel probabilistic model of a microbial community structures, named as ENIGMA (Enterotype-like uNIGram mixture model for Microbial Association analysis), to address these problems. ENIGMA includes the following contributions: 
<list list-type="order"><list-item><p>ENIGMA uses OTU abundances as input and models each sample by the underlying unigram mixture whose parameters are represented by unknown group effects and known effects of interest. The group effects are represented by baseline parameters that change with a latent group of microbial communities. One of the most important features of our model is that the group effects are independent of the effects of interest. This enables the separation of interindividual variability and fixed effects of the host properties related to disease risk.</p></list-item><list-item><p>ENIGMA is regarded as Bayesian learning for detecting associations between a community structure and factors of interest. Our model can be used to simultaneously learn how enterotype-like clusters of OTUs contribute to the microbial structure and how microbial compositional patterns may be related to known features of the sample.</p></list-item><list-item><p>We provide an efficient learning procedure for ENIGMA by using a Laplace approximation to integrate latent variables and estimate the evidence of the complete model and credible intervals of the parameters. The software package that implements ENIGMA in the R environment is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/abikoushi/enigma">https://github.com/abikoushi/enigma</ext-link>.</p></list-item></list></p><p>We describe our proposed framework and algorithm in the &#x0201c;<xref rid="Sec2" ref-type="sec">Methods</xref>&#x0201d; section. We evaluate the performance of ENIGMA using simulated data in terms of its accuracy to estimate parameters and identify clusters in the &#x0201c;<xref rid="Sec6" ref-type="sec">Simulation study</xref>&#x0201d; section. We apply ENIGMA to clinical metagenomics data and demonstrate how ENIGMA simultaneously identifies enterotype-like clusters and gut microbiota related to Parkinson&#x02019;s disease (PD) in the &#x0201c;<xref rid="Sec7" ref-type="sec">Results on real data</xref>&#x0201d; section.</p></sec><sec id="Sec2"><title>Methods</title><p>The key idea of ENIGMA is to adjust for the effects of the enterotype and evaluate the increases and decreases of bacterial abundance associated with environmental factors. Figure&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> shows a conceptual view of ENIGMA. The formal definition of the model is described in the following Mode section. Here we introduce several notations.
<fig id="Fig1"><label>Fig. 1</label><caption><p>A conceptual view of ENIGMA</p></caption><graphic xlink:href="12864_2019_5476_Fig1_HTML" id="MO1"/></fig></p><p>Suppose that we observe microbiome count data of <italic>K</italic> taxa for <italic>N</italic> samples with <italic>M</italic> individual host properties, (<italic>y</italic><sub><italic>nk</italic></sub>,<italic>x</italic><sub><italic>nm</italic></sub>) (<italic>n</italic>=1,&#x02026;,<italic>n</italic>;<italic>k</italic>=1,&#x02026;,<italic>K</italic>;<italic>m</italic>=1,&#x02026;,<italic>M</italic>) where <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$y_{nk}\in \mathbb {N}$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">nk</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>&#x02115;</mml:mi></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq1.gif"/></alternatives></inline-formula> represents the abundance of the <italic>k</italic>-th taxa in the <italic>n</italic>-th sample and <italic>x</italic><sub><italic>nm</italic></sub> represents a binary variable such that <italic>x</italic><sub><italic>nm</italic></sub>=1 if the <italic>n</italic>-th sample has the <italic>m</italic>-th host property and is otherwise <italic>x</italic><sub><italic>nm</italic></sub>=0. Here the word taxa can represent any level of the bacterial phylogeny, e.g., species, genes, family, order, etc.</p><sec id="Sec3"><title>Model</title><p>Figure&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> shows a plate diagram of the proposed model for metagenome sequencing, where <bold><italic>y</italic></bold><sub><italic>n</italic></sub> is the read count vector of the <italic>n</italic>-th sample, <bold><italic>x</italic></bold><sub><italic>n</italic></sub> is the vector of the host properties of the <italic>n</italic>-th sample and <italic>z</italic><sub><italic>n</italic></sub>&#x02208;{1,&#x02026;,<italic>L</italic>} is a latent class of the <italic>n</italic>-th sample. Our model is a simple extension of the unigram mixture model. We assume that each sample is generated from a multinomial distribution with the parameter vector <bold><italic>p</italic></bold><sub><italic>n</italic></sub>=(<italic>p</italic><sub><italic>n</italic>1</sub>,&#x02026;,<italic>p</italic><sub><italic>nK</italic></sub>)<sup>&#x022a4;</sup>. The elements of <bold><italic>p</italic></bold><sub><italic>n</italic></sub> and <italic>p</italic><sub><italic>nk</italic></sub> (<italic>k</italic>=1,&#x02026;,<italic>K</italic>) are probabilities of the occurrence of the <italic>K</italic> taxa for the <italic>n</italic>-th sample. We also assume that <italic>p</italic><sub><italic>nk</italic></sub> can be influenced independently by the environmental factor on the taxa that is common to all latent classes and the interindividual factor on the latent enterotype-like classes. More specifically, the generative process of ENIGMA is defined as follows: 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \boldsymbol{y}_{n}|z_{n},x_{n},\boldsymbol{\beta} &#x00026;\sim \text{Multinomial}\left(\boldsymbol{p}_{n}\right)  \\ \boldsymbol{p}_{n} &#x00026;= \text{softmax}\left(\boldsymbol{\gamma}_{z_{n}} + \boldsymbol{x}_{n}\boldsymbol{B}\right) \\ z_{n}|\boldsymbol{\pi} &#x00026;\sim \text{Categorical}(\boldsymbol{\pi}) \\ \boldsymbol{\pi}|\boldsymbol{\alpha} &#x00026;\sim \text{Dirichlet}(\boldsymbol{\alpha})  \\ \boldsymbol{\beta}_{m} &#x00026;\sim \text{Normal}_{K}\left(O_{K},\sigma^{2} I_{K}\right)  \\ \boldsymbol{\gamma}_{l} &#x00026;\sim \text{Normal}_{K}\left(O_{K},\tau^{2} I_{K}\right)  \end{array} $$ \end{document}</tex-math><mml:math id="M4"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mtd><mml:mtd class="align-2"><mml:mo>&#x0223c;</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mtext>softmax</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:mtd><mml:mtd class="align-2"><mml:mo>&#x0223c;</mml:mo><mml:mtext>Categorical</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo>)</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi></mml:mtd><mml:mtd class="align-2"><mml:mo>&#x0223c;</mml:mo><mml:mtext>Dirichlet</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo>)</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>&#x0223c;</mml:mo><mml:msub><mml:mrow><mml:mtext>Normal</mml:mtext></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>&#x0223c;</mml:mo><mml:msub><mml:mrow><mml:mtext>Normal</mml:mtext></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5476_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
<fig id="Fig2"><label>Fig. 2</label><caption><p>Plate diagram of the model for ENIGMA <bold><italic>y</italic></bold><sub><italic>n</italic></sub> is affected from environmental factors <bold><italic>x</italic></bold><sub><italic>n</italic></sub> and latent variables <bold><italic>z</italic></bold><sub><italic>n</italic></sub></p></caption><graphic xlink:href="12864_2019_5476_Fig2_HTML" id="MO2"/></fig></p><p>where <bold><italic>&#x003b3;</italic></bold><sub><italic>l</italic></sub> is baseline parameter (<italic>K</italic>-dimensional vector) that changes with the latent class, <italic>M</italic>&#x000d7;<italic>K</italic> matrix <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {B}=\left (\beta _{mk}\right)$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">mk</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq2.gif"/></alternatives></inline-formula> is effect of a environmental factor common to all enterotype-like clusters, <bold><italic>&#x003b2;</italic></bold><sub><italic>m</italic></sub> is a <italic>m</italic>-th row-vector of <bold><italic>B</italic></bold>, <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\pi }=\left (\pi _{1},\ldots,\pi _{L}\right)$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq3.gif"/></alternatives></inline-formula> is a mixing ratio of components, <italic>O</italic><sub><italic>K</italic></sub> is a <italic>K</italic>-dimensional zero matrix and <italic>I</italic><sub><italic>K</italic></sub> is <italic>K</italic>-dimensional identity matrix. Here, the softmax function is defined by <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {softmax}(\boldsymbol {x})=\frac {\exp (\boldsymbol {x})}{\sum _{k=1}^{K}{\exp (x_{k})}}$\end{document}</tex-math><mml:math id="M10"><mml:mtext>softmax</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq4.gif"/></alternatives></inline-formula> for a vector <bold><italic>x</italic></bold>=(<italic>x</italic><sub>1</sub>,&#x02026;,<italic>x</italic><sub><italic>K</italic></sub>)<sup>&#x022a4;</sup> using an element-wise exponential function and the probability function of categorical distribution is parameterized as <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Pr (z=l |\boldsymbol {\pi }) = \pi _{l}$\end{document}</tex-math><mml:math id="M12"><mml:mo>Pr</mml:mo><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq5.gif"/></alternatives></inline-formula>, <italic>l</italic>&#x02208;{1,&#x02026;,<italic>L</italic>}. In a Bayesian approach, the prior distributions for <bold><italic>&#x003c0;</italic></bold>, <bold><italic>&#x003b2;</italic></bold>, and <bold><italic>&#x003b3;</italic></bold><sub><italic>l</italic></sub> must be defiend. We set a prior based on the Dirichlet distribution for <bold><italic>&#x003c0;</italic></bold>, and flat priors to the hyperparameters <italic>&#x003c3;</italic> and <italic>&#x003c4;</italic> for <bold><italic>&#x003b2;</italic></bold> and <bold><italic>&#x003b3;</italic></bold>, respectively. For the convenience of later section, let <bold><italic>p</italic></bold><italic>l</italic>&#x02032;=softmax(<bold><italic>&#x003b3;</italic></bold><sub><italic>l</italic></sub>) be the probabilities of the occurrence of bacteria in the latent classes <italic>l</italic>.</p></sec><sec id="Sec4"><title>Parameter estimation</title><p>Let us denote observed matrix by <bold><italic>Y</italic></bold>=(<italic>y</italic><sub><italic>nk</italic></sub>), <bold><italic>X</italic></bold>=(<italic>x</italic><sub><italic>nm</italic></sub>), the unknown parameters by <bold><italic>&#x003b8;</italic></bold>=(<bold><italic>&#x003b1;</italic></bold>,<bold><italic>B</italic></bold>,<bold><italic>&#x003b3;</italic></bold><sub>1</sub>,&#x02026;,<bold><italic>&#x003b3;</italic></bold><sub><italic>L</italic></sub>,<italic>&#x003c3;</italic>,<italic>&#x003c4;</italic>), and their prior by <italic>&#x003d5;</italic>(<bold><italic>&#x003b8;</italic></bold>). The posterior distribution is represented as follows: 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} p(\boldsymbol{\theta}, \boldsymbol{z} |\boldsymbol{Y}) \propto \prod_{n=1}^{N} p(\boldsymbol{y}_{n}|z_{n},\boldsymbol{x}_{n},\boldsymbol{\theta})p(z_{n}|\boldsymbol{\theta})\phi(\boldsymbol{\theta}) \end{array} $$ \end{document}</tex-math><mml:math id="M14"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x0221d;</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>)</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>)</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5476_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p><p>First, latent variable <italic>z</italic><sub><italic>n</italic></sub> must be marginalized. The likelihood is described by 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \prod_{n=1}^{N} p(\boldsymbol{y}_{n}|\boldsymbol{x}_{n},\boldsymbol{\theta}) = \prod_{n=1}^{N}\sum_{l=1}^{L}\pi_{l} p(\boldsymbol{y}_{n}|z_{n}=l,\boldsymbol{x}_{n},\boldsymbol{\theta}).  $$ \end{document}</tex-math><mml:math id="M16"><mml:munderover><mml:mrow><mml:mo>&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12864_2019_5476_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p><p>The posterior distribution is proportional to the product of the likelihood and prior density: 
<disp-formula id="Equa"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} p(\boldsymbol{\theta}|\boldsymbol{Y}) &#x00026;\propto \exp\left\{\sum_{n=1}^{N} \log p\left(\boldsymbol{y}_{n}|\boldsymbol{x}_{n},\boldsymbol{\theta}\right) + \log \phi (\boldsymbol{\theta}) \right\} \end{array} $$ \end{document}</tex-math><mml:math id="M18"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mo>&#x0221d;</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mo>log</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5476_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p><p>Let <inline-formula id="IEq6"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\hat \theta }$\end{document}</tex-math><mml:math id="M20"><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq6.gif"/></alternatives></inline-formula> be the MAP estimator of <bold><italic>&#x003b8;</italic></bold>, found by maximizing <inline-formula id="IEq7"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\log p(\boldsymbol {\theta },\boldsymbol {Y},\boldsymbol {X})$\end{document}</tex-math><mml:math id="M22"><mml:mo>log</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq7.gif"/></alternatives></inline-formula>.</p><p>We use a Laplace approximation [<xref ref-type="bibr" rid="CR13">13</xref>] for parameter estimation. A Taylor expansion around <inline-formula id="IEq8"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\hat \theta }$\end{document}</tex-math><mml:math id="M24"><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq8.gif"/></alternatives></inline-formula> gives 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \log p(\boldsymbol{\theta} | \boldsymbol{Y}, \boldsymbol{X}) \approx \log p(\boldsymbol{\hat \theta}| \boldsymbol{Y}, \boldsymbol{X}) + \frac{1}{2}(\boldsymbol{\theta} - \boldsymbol{\hat \theta})^{\top} H(\boldsymbol{\hat \theta})(\boldsymbol{\theta} - \boldsymbol{\hat \theta})  \end{array} $$ \end{document}</tex-math><mml:math id="M26"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mspace width="-15.0pt"/><mml:mo>log</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x02248;</mml:mo><mml:mo>log</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x022a4;</mml:mo></mml:mrow></mml:msup><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5476_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p><p>where <inline-formula id="IEq9"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H(\boldsymbol {\hat \theta })$\end{document}</tex-math><mml:math id="M28"><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq9.gif"/></alternatives></inline-formula> is the Hessian of <inline-formula id="IEq10"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\log p(\boldsymbol {\theta } | \boldsymbol {Y}, \boldsymbol {X})$\end{document}</tex-math><mml:math id="M30"><mml:mo>log</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq10.gif"/></alternatives></inline-formula> evaluated at <inline-formula id="IEq11"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\hat \theta }$\end{document}</tex-math><mml:math id="M32"><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq11.gif"/></alternatives></inline-formula>. Eq. <xref rid="Equ4" ref-type="">4</xref> gives 
<disp-formula id="Equb"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} p(\boldsymbol{\theta} | \boldsymbol{Y}, \boldsymbol{X}) \approx \frac{1}{C} \exp\left\{\frac{1}{2}(\boldsymbol{\theta} - \boldsymbol{\hat \theta})^{\top} H\left(\boldsymbol{\hat \theta}\right)\left(\boldsymbol{\theta} - \boldsymbol{\hat \theta}\right) \right\} \end{array} $$ \end{document}</tex-math><mml:math id="M34"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x02248;</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x022a4;</mml:mo></mml:mrow></mml:msup><mml:mi>H</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5476_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p><p>where <italic>C</italic> is a normalizing constant. This relationship shows that <italic>p</italic>(<italic>&#x003b8;</italic>|<bold><italic>Y</italic></bold>,<bold><italic>X</italic></bold>) can be approximated by the normal distribution <inline-formula id="IEq12"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N\left (\boldsymbol {\hat \theta }, H^{-1}\left (\boldsymbol {\hat \theta }\right)\right)$\end{document}</tex-math><mml:math id="M36"><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq12.gif"/></alternatives></inline-formula>. Credible intervals can be calculated from this multivariate normal distribution.</p><p>We used the stochastic programming language Stan (<ext-link ext-link-type="uri" xlink:href="http://mc-stan.org/">http://mc-stan.org/</ext-link>) for its implementation. The MAP estimators were obtained by the L-BFGS method. Credible intervals were computed from the using a Stan function to compute the Hessian at the MAP estimates.</p><p>After fitting the model, the enterotype-like cluster of each sample must be classified. The conditional probability of <italic>z</italic><sub><italic>n</italic></sub>=<italic>l</italic> is 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \Pr(z_{n}=l)=\frac{\pi_{l} p(\boldsymbol{y}_{n}|\boldsymbol{\gamma}_{l}, \boldsymbol{\beta}, \boldsymbol{x}_{n})}{\sum_{l=1}^{L}\pi_{l} p(\boldsymbol{y}_{n}|\boldsymbol{\gamma}_{l},\boldsymbol{\beta}, \boldsymbol{x}_{n})}.   $$ \end{document}</tex-math><mml:math id="M38"><mml:mo>Pr</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12864_2019_5476_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p><p>This is the probability that the <italic>n</italic>-th sample belongs to cluster <italic>l</italic>. Next, the <italic>n</italic>-th sample is then classified into the <italic>l</italic>-th cluster that maximizes the conditional probability given by Eq. <xref rid="Equ5" ref-type="">5</xref>.</p></sec><sec id="Sec5"><title>Model Selection</title><p>We also examined whether or not the whole set rather than individual bacteria is related to the environmental factors of interest. We compared between the two models when <bold><italic>B</italic></bold>&#x02260;<bold><italic>0</italic></bold> and <bold><italic>B</italic></bold>=<bold><italic>0</italic></bold>. We used the log marginal likelihood as the goodness of fit for model comparison. The marginal likelihood is given by 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} P(\boldsymbol{Y}|\boldsymbol{X}) = \int p(\boldsymbol{Y},\boldsymbol{\theta}|\boldsymbol{X}) \, d\boldsymbol{\theta}. \end{array} $$ \end{document}</tex-math><mml:math id="M40"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>&#x0222b;</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5476_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p><p>From Eq. <xref rid="Equ4" ref-type="">4</xref>, we have 
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {}{\begin{aligned} \int\! p(\boldsymbol{\theta}, \boldsymbol{Y}|\boldsymbol{X}) \, d \boldsymbol{\theta} \approx p\left(\boldsymbol{\hat \theta}| \boldsymbol{Y}, \boldsymbol{X}\right) \int\! \exp\left(\frac{1}{2}\left(\boldsymbol{\theta} - \boldsymbol{\hat \theta}\right)^{\top} H\left(\boldsymbol{\hat \theta}\right)\left(\boldsymbol{\theta} - \boldsymbol{\hat \theta}\right)\right) \, d \, \boldsymbol{\theta}. \end{aligned}}  $$ \end{document}</tex-math><mml:math id="M42"><mml:mtable><mml:mtr><mml:mtd><mml:mo>&#x0222b;</mml:mo><mml:mspace width="0.3em"/><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>&#x02248;</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x0222b;</mml:mo><mml:mspace width="0.3em"/><mml:mo>exp</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>&#x022a4;</mml:mo></mml:mrow></mml:msup><mml:mi>H</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mspace width="0.3em"/><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5476_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p><p>Thus, the log marginal likelihood is approximated by the following formula: 
<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {}{\begin{aligned} \log P(\boldsymbol{Y}|\boldsymbol{X}) \approx \log p\left(\boldsymbol{Y} | \boldsymbol{\hat \theta}, \boldsymbol{X}\right) + \phi\left(\boldsymbol{\hat \theta}\right) + \frac{D}{2}\log{2 \pi} - \frac{1}{2} \log |H\left(\boldsymbol{\hat \theta}\right)|  \end{aligned}}  $$ \end{document}</tex-math><mml:math id="M44"><mml:mtable><mml:mtr><mml:mtd><mml:mo>log</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x02248;</mml:mo><mml:mo>log</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>|</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>log</mml:mo><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>log</mml:mo><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:mfenced><mml:mo>|</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5476_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p><p>where <italic>D</italic> is the number of free parameters. In model comparison, we choose the model showing larger log marginal likelihood.</p></sec></sec><sec id="Sec6"><title>Simulation study</title><p>To demonstrate the performance of ENIGMA, we conducted several simulation experiments. The synthetic data were naturally produced via our generative process given by Eq. <xref rid="Equ1" ref-type="">1</xref>. We set <italic>M</italic>=2000, <italic>L</italic>=3, <italic>&#x003c0;</italic><sub><italic>l</italic></sub>=1/3, and <bold><italic>&#x003b1;</italic></bold>=(1,1,1)<sup><italic>T</italic></sup>. We first generated <bold><italic>B</italic></bold> and <bold><italic>&#x003b3;</italic></bold><sub><italic>l</italic></sub> from the standard normal distribution. The variables <bold><italic>x</italic></bold><sub><italic>n</italic></sub>, <italic>z</italic><sub><italic>n</italic></sub>, and <bold><italic>y</italic></bold><sub><italic>n</italic></sub> are then sampled from the Bernoulli distribution with probability of 0.5, the categorical distribution, and the multinomial distribution, respectively. For the above parameter settings, we randomly generated a count dataset of 100 taxa for 100 samples for evaluation. 
<list list-type="bullet"><list-item><p><bold>Coverage probability (CP)</bold>: The coverage probability is the proportion of the time over which the interval contains the true value. A discrepancy between the coverage probability and the nominal coverage probability frequently occurs. When the actual coverage is greater than the nominal coverage, the interval is referred to as conservative. If the interval is conservative, there is no inconsistency in interpretation.</p></list-item><list-item><p><bold>Bias</bold>: The bias of <bold><italic>B</italic></bold> is defined by the difference between true value and estimated value <inline-formula id="IEq13"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$E[\hat {\boldsymbol {B}}]-\boldsymbol {B}$\end{document}</tex-math><mml:math id="M46"><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>]</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq13.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p><bold>Standard error (SE)</bold>: The standard error is the standard deviation from the estimate. A smaller standard error indicates the higher accuracy of estimation.</p></list-item><list-item><p><bold>Root mean squared error (RMSE)</bold>: The RMSE is defined by</p><p><inline-formula id="IEq14"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sqrt {E[\left (\boldsymbol {\hat {B}} - \mathbf {B}\right)^{2}]}$\end{document}</tex-math><mml:math id="M48"><mml:msqrt><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle><mml:mo>&#x02212;</mml:mo><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mrow></mml:msqrt></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq14.gif"/></alternatives></inline-formula>. A smaller RMSE indicates the higher accuracy of the estimation.</p></list-item><list-item><p><bold>Accuracy</bold>: The accuracy is the percentage of samples correctly classified into original group.</p></list-item></list></p><p>To calcurate these metrics, we detrmined that we calculated the sample means and standard deviations of <inline-formula id="IEq15"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {B}}$\end{document}</tex-math><mml:math id="M50"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\hat {\boldsymbol {B}}-\boldsymbol {B}\right)^{2}$\end{document}</tex-math><mml:math id="M52"><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>&#x02212;</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq16.gif"/></alternatives></inline-formula> from the 10,000 synthetic datasets.</p><p>Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> shows a comparison of the true <bold><italic>B</italic></bold> and the mean and standard deviation of estimates <inline-formula id="IEq17"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {B}}$\end{document}</tex-math><mml:math id="M54"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq17.gif"/></alternatives></inline-formula> obtained from the 10,000 simulations. We observed that the points were arranged diagonally, indicating that the estimator of ENIGMA was unbiased. We also calculated the proportion of the time for which the 95% credible interval contains the true value of <bold><italic>B</italic></bold>. We found that this proportion was greater than nominal value of 0.95 for all <bold><italic>B</italic></bold> in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>. Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref> shows the coverage probability (CP), bias, standard error (SE), and RMSE of <inline-formula id="IEq18"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {B}}$\end{document}</tex-math><mml:math id="M56"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq18.gif"/></alternatives></inline-formula>, respectively. We observed that the bias and standard error decreased when <italic>&#x003b2;</italic><sub><italic>mk</italic></sub> was large (i.e. the corresponding abundance was large). We also found that the accuracy of classification given by Eq. <xref rid="Equ5" ref-type="">5</xref> was exactly 100%. Thus, these results indicate that ENIGMA can produce reasonable estimates.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Simulation result of <bold><italic>B</italic></bold> The comparison true <bold><italic>B</italic></bold> and the mean of <inline-formula id="IEq19"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\hat {B}}$\end{document}</tex-math><mml:math id="M58"><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq19.gif"/></alternatives></inline-formula>. The error bars indicates SE</p></caption><graphic xlink:href="12864_2019_5476_Fig3_HTML" id="MO3"/></fig>
<fig id="Fig4"><label>Fig. 4</label><caption><p>Coverage probability of <bold><italic>B</italic></bold>. The histogram of coverage probability of <bold><italic>B</italic></bold></p></caption><graphic xlink:href="12864_2019_5476_Fig4_HTML" id="MO4"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Coverage probability (CP), bias, standard error (SE), and RMSE of <inline-formula id="IEq20"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\hat {B}}$\end{document}</tex-math><mml:math id="M60"><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq20.gif"/></alternatives></inline-formula></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">
<bold><italic>&#x003b2;</italic></bold>
</th><th align="left">CP</th><th align="left">Bias</th><th align="left">SE</th><th align="left">RMSE</th><th align="left">
<bold><italic>&#x003b2;</italic></bold>
</th><th align="left">CP</th><th align="left">Bias</th><th align="left">SE</th><th align="left">RMSE</th></tr></thead><tbody><tr><td align="left">-3.40</td><td align="left">0.97</td><td align="left">0.08</td><td align="left">0.15</td><td align="left">0.17</td><td align="left">-0.04</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.05</td><td align="left">0.05</td></tr><tr><td align="left">-2.65</td><td align="left">0.97</td><td align="left">0.06</td><td align="left">0.15</td><td align="left">0.16</td><td align="left">-0.04</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.05</td><td align="left">0.05</td></tr><tr><td align="left">-2.34</td><td align="left">0.99</td><td align="left">0.04</td><td align="left">0.12</td><td align="left">0.13</td><td align="left">-0.01</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.05</td><td align="left">0.05</td></tr><tr><td align="left">-2.32</td><td align="left">0.99</td><td align="left">0.03</td><td align="left">0.12</td><td align="left">0.12</td><td align="left">0.01</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.04</td></tr><tr><td align="left">-1.83</td><td align="left">0.98</td><td align="left">0.03</td><td align="left">0.14</td><td align="left">0.15</td><td align="left">0.02</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.06</td><td align="left">0.06</td></tr><tr><td align="left">-1.59</td><td align="left">0.99</td><td align="left">0.02</td><td align="left">0.13</td><td align="left">0.13</td><td align="left">0.02</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.05</td></tr><tr><td align="left">-1.58</td><td align="left">0.99</td><td align="left">0.03</td><td align="left">0.13</td><td align="left">0.13</td><td align="left">0.03</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.04</td></tr><tr><td align="left">-1.51</td><td align="left">0.99</td><td align="left">0.02</td><td align="left">0.14</td><td align="left">0.14</td><td align="left">0.10</td><td align="left">1.00</td><td align="left">-0.00</td><td align="left">0.08</td><td align="left">0.08</td></tr><tr><td align="left">-1.51</td><td align="left">0.99</td><td align="left">0.02</td><td align="left">0.13</td><td align="left">0.13</td><td align="left">0.13</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.03</td><td align="left">0.03</td></tr><tr><td align="left">-1.29</td><td align="left">0.99</td><td align="left">0.02</td><td align="left">0.11</td><td align="left">0.11</td><td align="left">0.14</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.03</td><td align="left">0.03</td></tr><tr><td align="left">-1.14</td><td align="left">0.99</td><td align="left">0.01</td><td align="left">0.11</td><td align="left">0.11</td><td align="left">0.21</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.06</td><td align="left">0.06</td></tr><tr><td align="left">-0.95</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.09</td><td align="left">0.09</td><td align="left">0.23</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.08</td><td align="left">0.08</td></tr><tr><td align="left">-0.95</td><td align="left">0.99</td><td align="left">0.01</td><td align="left">0.12</td><td align="left">0.12</td><td align="left">0.29</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.04</td></tr><tr><td align="left">-0.92</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.09</td><td align="left">0.09</td><td align="left">0.31</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.05</td><td align="left">0.05</td></tr><tr><td align="left">-0.88</td><td align="left">0.99</td><td align="left">0.01</td><td align="left">0.12</td><td align="left">0.12</td><td align="left">0.32</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.08</td><td align="left">0.08</td></tr><tr><td align="left">-0.84</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.05</td><td align="left">0.05</td><td align="left">0.33</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.04</td></tr><tr><td align="left">-0.82</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.08</td><td align="left">0.08</td><td align="left">0.44</td><td align="left">0.99</td><td align="left">-0.02</td><td align="left">0.10</td><td align="left">0.10</td></tr><tr><td align="left">-0.78</td><td align="left">0.99</td><td align="left">0.01</td><td align="left">0.13</td><td align="left">0.13</td><td align="left">0.46</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.05</td><td align="left">0.05</td></tr><tr><td align="left">-0.78</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.07</td><td align="left">0.07</td><td align="left">0.50</td><td align="left">1.00</td><td align="left">-0.01</td><td align="left">0.08</td><td align="left">0.08</td></tr><tr><td align="left">-0.76</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.08</td><td align="left">0.08</td><td align="left">0.53</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.06</td><td align="left">0.06</td></tr><tr><td align="left">-0.72</td><td align="left">0.99</td><td align="left">0.00</td><td align="left">0.12</td><td align="left">0.12</td><td align="left">0.54</td><td align="left">1.00</td><td align="left">-0.00</td><td align="left">0.08</td><td align="left">0.08</td></tr><tr><td align="left">-0.68</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.10</td><td align="left">0.10</td><td align="left">0.55</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.04</td></tr><tr><td align="left">-0.65</td><td align="left">0.99</td><td align="left">0.01</td><td align="left">0.11</td><td align="left">0.11</td><td align="left">0.55</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.03</td><td align="left">0.03</td></tr><tr><td align="left">-0.65</td><td align="left">0.99</td><td align="left">0.01</td><td align="left">0.11</td><td align="left">0.11</td><td align="left">0.56</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.05</td><td align="left">0.05</td></tr><tr><td align="left">-0.65</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.06</td><td align="left">0.06</td><td align="left">0.76</td><td align="left">1.00</td><td align="left">-0.00</td><td align="left">0.07</td><td align="left">0.07</td></tr><tr><td align="left">-0.61</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.06</td><td align="left">0.06</td><td align="left">0.79</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.06</td><td align="left">0.06</td></tr><tr><td align="left">-0.58</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.06</td><td align="left">0.06</td><td align="left">0.84</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.05</td><td align="left">0.05</td></tr><tr><td align="left">-0.58</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.07</td><td align="left">0.07</td><td align="left">0.90</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.04</td></tr><tr><td align="left">-0.56</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.05</td><td align="left">0.05</td><td align="left">0.93</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.05</td><td align="left">0.05</td></tr><tr><td align="left">-0.52</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.06</td><td align="left">0.06</td><td align="left">0.96</td><td align="left">1.00</td><td align="left">-0.01</td><td align="left">0.08</td><td align="left">0.08</td></tr><tr><td align="left">-0.52</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.07</td><td align="left">0.07</td><td align="left">0.98</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.04</td></tr><tr><td align="left">-0.51</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.05</td><td align="left">1.01</td><td align="left">1.00</td><td align="left">-0.01</td><td align="left">0.08</td><td align="left">0.08</td></tr><tr><td align="left">-0.50</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.05</td><td align="left">0.05</td><td align="left">1.08</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.05</td><td align="left">0.06</td></tr><tr><td align="left">-0.50</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.04</td><td align="left">1.10</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.05</td><td align="left">0.05</td></tr><tr><td align="left">-0.49</td><td align="left">0.99</td><td align="left">0.00</td><td align="left">0.11</td><td align="left">0.11</td><td align="left">1.13</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.04</td></tr><tr><td align="left">-0.47</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.05</td><td align="left">0.05</td><td align="left">1.14</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.04</td></tr><tr><td align="left">-0.45</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.09</td><td align="left">0.09</td><td align="left">1.16</td><td align="left">1.00</td><td align="left">-0.01</td><td align="left">0.07</td><td align="left">0.07</td></tr><tr><td align="left">-0.42</td><td align="left">0.99</td><td align="left">-0.01</td><td align="left">0.13</td><td align="left">0.13</td><td align="left">1.22</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.04</td></tr><tr><td align="left">-0.33</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.07</td><td align="left">0.07</td><td align="left">1.23</td><td align="left">1.00</td><td align="left">-0.02</td><td align="left">0.09</td><td align="left">0.09</td></tr><tr><td align="left">-0.28</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.09</td><td align="left">0.09</td><td align="left">1.43</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.04</td><td align="left">0.04</td></tr><tr><td align="left">-0.27</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.07</td><td align="left">0.07</td><td align="left">1.45</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.04</td></tr><tr><td align="left">-0.23</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.09</td><td align="left">0.09</td><td align="left">1.47</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.04</td><td align="left">0.04</td></tr><tr><td align="left">-0.21</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.07</td><td align="left">0.07</td><td align="left">1.55</td><td align="left">1.00</td><td align="left">-0.01</td><td align="left">0.07</td><td align="left">0.08</td></tr><tr><td align="left">-0.18</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.10</td><td align="left">0.10</td><td align="left">1.60</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.03</td><td align="left">0.03</td></tr><tr><td align="left">-0.15</td><td align="left">0.99</td><td align="left">-0.01</td><td align="left">0.11</td><td align="left">0.11</td><td align="left">1.61</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.05</td><td align="left">0.05</td></tr><tr><td align="left">-0.11</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.06</td><td align="left">0.06</td><td align="left">1.89</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.03</td><td align="left">0.03</td></tr><tr><td align="left">-0.09</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.09</td><td align="left">0.09</td><td align="left">1.91</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.03</td><td align="left">0.03</td></tr><tr><td align="left">-0.05</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.04</td><td align="left">1.95</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.02</td><td align="left">0.02</td></tr><tr><td align="left">-0.05</td><td align="left">1.00</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.04</td><td align="left">2.25</td><td align="left">1.00</td><td align="left">0.00</td><td align="left">0.04</td><td align="left">0.04</td></tr></tbody></table></table-wrap></p></sec><sec id="Sec7"><title>Results on real data</title><sec id="Sec8"><title>Arumugam et al. (2011)&#x02019;s data</title><p>We demonstrated that the enterotype-like cluster can be estimated using the data of Arumugam et al. [<xref ref-type="bibr" rid="CR3">3</xref>]. This data is <italic>N</italic>=33, <italic>K</italic>=55. The data of Arumugam et al. [<xref ref-type="bibr" rid="CR3">3</xref>] does not disclose the total read count. Thus, We used the relative abundance multiplied by 10,000 as <italic>y</italic><sub><italic>nk</italic></sub>. Based on the result of Arumugam et al. [<xref ref-type="bibr" rid="CR3">3</xref>], the number of latent classes in ENIGMA was chosen to be <italic>L</italic>=3. We estimated the parameters using the ENIGMA and setting all <italic>&#x003b2;</italic><sub><italic>mk</italic></sub>=0 in Eq. <xref rid="Equ1" ref-type="">1</xref>. We set the hyperparameters of Dirichlet prior <bold><italic>&#x003b1;</italic></bold>=(1,&#x02026;,1)<sup>&#x022a4;</sup>, which is equivalent to a noninformative prior.</p><p>Arumugam et al. [<xref ref-type="bibr" rid="CR3">3</xref>] showed that the enterotype is characterized by the differences in the abundance of <italic>Bacteroides</italic>, <italic>Prevotella</italic>, and <italic>Ruminococcus</italic>. Estimates of the probability of occurrence of those bacteria in three clusters are shown in the Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>. Class 1 contains high-level <italic>Ruminococcus</italic>, class 2 contains high-level <italic>Bacteroides</italic>, and class 3 contains high-level <italic>Prevotella</italic>. This result is consistent with that of Arumugam et al. (2011) [<xref ref-type="bibr" rid="CR3">3</xref>].
<fig id="Fig5"><label>Fig. 5</label><caption><p>Probability of occurrence in three bacteria</p></caption><graphic xlink:href="12864_2019_5476_Fig5_HTML" id="MO5"/></fig></p></sec><sec id="Sec9"><title>Parkinson&#x02019;s disease data</title><p>To validate the performance of ENIGMA in discovering clusters of microbial communities and associations between microbes and a specific disease, we applied ENIGMA to the real metagenomic sequencing data from Scheperjans et al. [<xref ref-type="bibr" rid="CR14">14</xref>], Hill-Burns et al. [<xref ref-type="bibr" rid="CR15">15</xref>], Heintz-Buschart et al. [<xref ref-type="bibr" rid="CR16">16</xref>] and Hopfner et al. [<xref ref-type="bibr" rid="CR17">17</xref>]. The data was analyzed by sequencing the bacterial 16S ribosomal RNA genes sampled from patients with Parkinson&#x02019;s disease (PD) and controls in Finland, USA, and Germany. Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref> shows the summary statistics of the data. The OTUs were mapped to the SILVA taxonomic reference, version 132 (<ext-link ext-link-type="uri" xlink:href="https://www.arb-silva.de/">https://www.arb-silva.de/</ext-link>) and the abundances of family-level taxa were calculated.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Data summary</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">PD</th><th align="left">CO</th></tr></thead><tbody><tr><td align="left">Finland</td><td align="left">74</td><td align="left">74</td></tr><tr><td align="left">German</td><td align="left">55</td><td align="left">64</td></tr><tr><td align="left">USA</td><td align="left">207</td><td align="left">139</td></tr></tbody></table></table-wrap></p><p>To assess the optimal number of clusters, we used the Calinski-Harabasz (CH) Index. It is defined as: 
<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \text{CH}_{l} = \frac{\text{BC}_{l}/(l-1)}{\text{WC}_{l}/(n-l)} \end{array} $$ \end{document}</tex-math><mml:math id="M62"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mtext>CH</mml:mtext></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mtext>BC</mml:mtext></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>WC</mml:mtext></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5476_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p><p>where BC<sub><italic>l</italic></sub> is the between-cluster sum of squares (i.e. the squared distances between all points <italic>i</italic> and <italic>j</italic>, for which <italic>i</italic> and <italic>j</italic> are not in the same cluster) and WC<sub><italic>l</italic></sub> is the within-clusters sum of squares (i.e. the squared distances between all points <italic>i</italic> and <italic>j</italic>, for which <italic>i</italic> and <italic>j</italic> are in the same cluster). Here, we used Jensen-Shannon divergence (JSD) as the distance. The JSD between samples <bold><italic>a</italic></bold>=(<italic>a</italic><sub>1</sub>,&#x02026;,<italic>a</italic><sub><italic>K</italic></sub>) and <bold><italic>b</italic></bold>=(<italic>b</italic><sub>1</sub>,&#x02026;,<italic>b</italic><sub><italic>K</italic></sub>) is defined as follows: 
<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \text{JSD}(\boldsymbol{a},\boldsymbol{b}) = \frac{1}{2} \left(\sum_{k=1}^{K} a_{k} \log(a_{k}/b_{k})) + \sum_{k=1}^{K} b_{k} \log(b_{k}/a_{k})) \right). \end{array} $$ \end{document}</tex-math><mml:math id="M64"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mspace width="-15.0pt"/><mml:mtext>JSD</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2019_5476_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p><p>When calculating the JSD, we used the normalized abundance obtained by dividing <italic>y</italic><sub><italic>nk</italic></sub> by the total read count, and 0 was replaced with pseudo count 10<sup>&#x02212;6</sup>. We chose the number of clusters <italic>L</italic> such that CH<sub><italic>l</italic></sub> was maximal. To evaluate the CH Index, we use the function index.G1() from the R library clusterSim. The number of latent classes in ENIGMA was chosen to be <italic>L</italic>=3 in Finland and Germany and <italic>L</italic>=2 in USA by the CH indexes (Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>).
<fig id="Fig6"><label>Fig. 6</label><caption><p>The CH indexes in each country</p></caption><graphic xlink:href="12864_2019_5476_Fig6_HTML" id="MO6"/></fig></p><p>First, we evaluated whether the model assumption was satisfied when using this data. According to Arumugam et al. (2011) [<xref ref-type="bibr" rid="CR3">3</xref>], the gender of the host is not related with the enterotype. The genders of the subjects were published in the Finland study. We examined the relationship between gender and enterotype-like cluster using the data from Finland. Table&#x000a0;<xref rid="Tab3" ref-type="table">3</xref> shows there was no correlation between them. We conducted a Chi-squared test for independence as shown in Table&#x000a0;<xref rid="Tab3" ref-type="table">3</xref> and the <italic>p</italic>-value was 0.66.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Cross-tabulation of gender and cluster</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Class</th><th align="left">1</th><th align="left">2</th><th align="left">3</th></tr></thead><tbody><tr><td align="left">Female</td><td align="left">22</td><td align="left">31</td><td align="left">21</td></tr><tr><td align="left">Male</td><td align="left">21</td><td align="left">27</td><td align="left">26</td></tr></tbody></table></table-wrap></p><p>We evaluated whether the model showing that bacteria were associated with PD is better than the model without the associations in terms of marginal likelihood. Marginal likelihood represents the model evidence expressing the preference of the data for different models. Let <inline-formula id="IEq21"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}_{1}$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mi mathvariant="script">&#x02133;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq21.gif"/></alternatives></inline-formula> be the model which is described by Eq. <xref rid="Equ1" ref-type="">1</xref> and <inline-formula id="IEq22"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}_{0}$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi mathvariant="script">&#x02133;</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq22.gif"/></alternatives></inline-formula> be the model setting all <italic>&#x003b2;</italic><sub><italic>mk</italic></sub>=0 in Eq. <xref rid="Equ1" ref-type="">1</xref>. Table&#x000a0;<xref rid="Tab4" ref-type="table">4</xref> shows that the marginal likelihood of <inline-formula id="IEq23"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}_{1}$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mi mathvariant="script">&#x02133;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq23.gif"/></alternatives></inline-formula> was greater than <inline-formula id="IEq24"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}_{0}$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mrow><mml:mi mathvariant="script">&#x02133;</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq24.gif"/></alternatives></inline-formula>. It is preferrd to explain the data by considering the association between the microbiota and PD.
<table-wrap id="Tab4"><label>Table 4</label><caption><p>Comparison marginal likelihood</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Finland</th><th align="left">Germany</th><th align="left">USA</th></tr></thead><tbody><tr><td align="left">
<inline-formula id="IEq25"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}_{0}$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mrow><mml:mi mathvariant="script">&#x02133;</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq25.gif"/></alternatives></inline-formula>
</td><td align="left">-442734.62</td><td align="left">-5913441.14</td><td align="left">-3010279.35</td></tr><tr><td align="left">
<inline-formula id="IEq26"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}_{1}$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mrow><mml:mi mathvariant="script">&#x02133;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq26.gif"/></alternatives></inline-formula>
</td><td align="left">-355079.50</td><td align="left">-3807297.76</td><td align="left">-2063932.02</td></tr></tbody></table></table-wrap></p><p>Figure&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref> shows the estimated probabilities of the occurrences of bacteria for the three latent classes, <bold><italic>p</italic></bold><italic>l</italic>&#x02032;, (<italic>l</italic>=1,2,3). Bacteria detected in fewer three countries were removed. Arumugam et al. [<xref ref-type="bibr" rid="CR3">3</xref>] showed that enterotype is characterized by the differences in the abundance of <italic>Bacteroides</italic>, <italic>Prevotella</italic>, and <italic>Ruminococcus</italic>. The results of ENIGMA showed the same tendency as the previous survey. Figure&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref> shows the <inline-formula id="IEq27"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\boldsymbol {\hat \gamma }_l)'$\end{document}</tex-math><mml:math id="M78"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq27.gif"/></alternatives></inline-formula> values and their credible intervals. The top three microbes in each enterotype-like cluster are shown in excerpts for this plot. According to the results of ENIGMA, the abundance of <italic>Enterobacteriaceae</italic> and <italic>Lachnospiraceae</italic> also differed greatly among clusters. Bacterial abundance differed between countries. In the USA, there was a high abundance of <italic>Verrucomicrobiaceae</italic>, while in Finland, few of these bacteria were detected. In contrast, Finland showed more <italic>Prevotellaceae</italic>, with fewer in the in USA it is less.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Heatmap showing <inline-formula id="IEq28"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\boldsymbol {\hat p}_l'\right).$\end{document}</tex-math><mml:math id="M80"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq28.gif"/></alternatives></inline-formula> These quantities correspond to the probabilities of the occurrences of bacteria for the three latent classes</p></caption><graphic xlink:href="12864_2019_5476_Fig7_HTML" id="MO7"/></fig>
<fig id="Fig8"><label>Fig. 8</label><caption><p>Top three <inline-formula id="IEq29"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\boldsymbol {\hat \gamma }_{l}\right)'$\end{document}</tex-math><mml:math id="M82"><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq29.gif"/></alternatives></inline-formula> in each country</p></caption><graphic xlink:href="12864_2019_5476_Fig8_HTML" id="MO8"/></fig></p><p>Table&#x000a0;<xref rid="Tab5" ref-type="table">5</xref> shows the coefficients whose 95% credible intervals did not contain zero in more than two countries. The microbes with these coefficients indicates that the corresponding microbial composition patterns were significantly related to PD. We found that at the family levels, <italic>Clostridiaceae</italic>, <italic>Comamonadaceae</italic>, <italic>Prevotellaceae</italic>, <italic>Actinomycetaceae</italic>, <italic>Bifidobacteriaceae</italic>, <italic>Enterococcaceae</italic>, <italic>Synergistaceae</italic>, <italic>Verrucomicrobiaceae</italic> and <italic>Victivallaceae</italic>, the signs of the coefficients matched in all countries. These results are consistent with those of previous studies. Hill-Burns et al. [<xref ref-type="bibr" rid="CR15">15</xref>] reported that patients with PD contained high levels of <italic>Bifidobacteriaceae</italic> and <italic>Verrucomicrobiaceae</italic>. Scheperjans et al. [<xref ref-type="bibr" rid="CR14">14</xref>] reported PD patients contained high levels of <italic>Verrucomicrobiaceae</italic> and low levels of <italic>Prevotellaceae</italic>. Hopfner et al. reported that patients with PD have high levels of <italic>Enterococcaceae</italic>.
<table-wrap id="Tab5"><label>Table 5</label><caption><p>Bacteria significantly associated with PD in more than two countries</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="3">Finland</th><th align="left" colspan="3">Germany</th><th align="left" colspan="3">USA</th></tr><tr><th align="left">Family</th><th align="left">
<inline-formula id="IEq30"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\beta }$\end{document}</tex-math><mml:math id="M84"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq30.gif"/></alternatives></inline-formula>
</th><th align="left">Lower bound</th><th align="left">Upper bound</th><th align="left">
<inline-formula id="IEq31"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\beta }$\end{document}</tex-math><mml:math id="M86"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq31.gif"/></alternatives></inline-formula>
</th><th align="left">Lower bound</th><th align="left">Upper bound</th><th align="left">
<inline-formula id="IEq32"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\beta }$\end{document}</tex-math><mml:math id="M88"><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2019_5476_Article_IEq32.gif"/></alternatives></inline-formula>
</th><th align="left">Lower bound</th><th align="left">Upper bound</th></tr></thead><tbody><tr><td align="left">Anaeroplasmataceae</td><td align="justify">-0.87</td><td align="justify">-1.28</td><td align="justify">-0.45</td><td align="justify">-1.69</td><td align="justify">-2.03</td><td align="justify">-1.35</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-</td></tr><tr><td align="left">Bacteroidales S24-7 group</td><td align="justify">-0.52</td><td align="justify">-0.93</td><td align="justify">-0.11</td><td align="justify">0.22</td><td align="justify">-0.12</td><td align="justify">0.56</td><td align="justify">-0.80</td><td align="justify">-1.16</td><td align="justify">-0.44</td></tr><tr><td align="left">Bradyrhizobiaceae</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-0.82</td><td align="justify">-1.17</td><td align="justify">-0.47</td><td align="justify">-1.44</td><td align="justify">-2.21</td><td align="justify">-0.66</td></tr><tr><td align="left">Brevibacteriaceae</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-1.02</td><td align="justify">-1.38</td><td align="justify">-0.66</td><td align="justify">-0.65</td><td align="justify">-1.05</td><td align="justify">-0.25</td></tr><tr><td align="left">Brucellaceae</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-1.69</td><td align="justify">-2.50</td><td align="justify">-0.87</td><td align="justify">-1.34</td><td align="justify">-1.75</td><td align="justify">-0.92</td></tr><tr><td align="left">Clostridiaceae 1</td><td align="justify">-0.54</td><td align="justify">-0.96</td><td align="justify">-0.13</td><td align="justify">-0.08</td><td align="justify">-0.42</td><td align="justify">0.26</td><td align="justify">-0.52</td><td align="justify">-0.88</td><td align="justify">-0.16</td></tr><tr><td align="left">Comamonadaceae</td><td align="justify">-0.85</td><td align="justify">-1.35</td><td align="justify">-0.35</td><td align="justify">-1.27</td><td align="justify">-1.61</td><td align="justify">-0.93</td><td align="justify">-0.21</td><td align="justify">-0.57</td><td align="justify">0.15</td></tr><tr><td align="left">Elusimicrobiaceae</td><td align="justify">-4.17</td><td align="justify">-5.60</td><td align="justify">-2.74</td><td align="justify">-2.11</td><td align="justify">-2.54</td><td align="justify">-1.68</td><td align="justify">2.52</td><td align="justify">1.03</td><td align="justify">4.01</td></tr><tr><td align="left">Intrasporangiaceae</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-3.47</td><td align="justify">-4.86</td><td align="justify">-2.07</td><td align="justify">-3.00</td><td align="justify">-4.72</td><td align="justify">-1.28</td></tr><tr><td align="left">Leuconostocaceae</td><td align="justify">-2.66</td><td align="justify">-4.30</td><td align="justify">-1.02</td><td align="justify">0.50</td><td align="justify">0.13</td><td align="justify">0.86</td><td align="justify">-1.74</td><td align="justify">-2.22</td><td align="justify">-1.25</td></tr><tr><td align="left">Moraxellaceae</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-1.58</td><td align="justify">-1.92</td><td align="justify">-1.24</td><td align="justify">-0.92</td><td align="justify">-1.28</td><td align="justify">-0.56</td></tr><tr><td align="left">Pasteurellaceae</td><td align="justify">-1.62</td><td align="justify">-2.07</td><td align="justify">-1.17</td><td align="justify">0.30</td><td align="justify">-0.04</td><td align="justify">0.64</td><td align="justify">-1.88</td><td align="justify">-2.25</td><td align="justify">-1.51</td></tr><tr><td align="left">Prevotellaceae</td><td align="justify">-2.46</td><td align="justify">-2.87</td><td align="justify">-2.05</td><td align="justify">-0.03</td><td align="justify">-0.37</td><td align="justify">0.30</td><td align="justify">-0.53</td><td align="justify">-0.89</td><td align="justify">-0.17</td></tr><tr><td align="left">Rhodocyclaceae</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-3.53</td><td align="justify">-4.93</td><td align="justify">-2.13</td><td align="justify">-0.75</td><td align="justify">-1.18</td><td align="justify">-0.32</td></tr><tr><td align="left">Actinomycetaceae</td><td align="justify">0.11</td><td align="justify">-0.78</td><td align="justify">1.01</td><td align="justify">0.42</td><td align="justify">0.07</td><td align="justify">0.78</td><td align="justify">0.91</td><td align="justify">0.54</td><td align="justify">1.28</td></tr><tr><td align="left">Bacillaceae</td><td align="justify">1.72</td><td align="justify">0.34</td><td align="justify">3.11</td><td align="justify">-2.35</td><td align="justify">-2.72</td><td align="justify">-1.99</td><td align="justify">0.80</td><td align="justify">0.43</td><td align="justify">1.17</td></tr><tr><td align="left">Bdellovibrionaceae</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-</td><td align="justify">1.43</td><td align="justify">0.40</td><td align="justify">2.46</td><td align="justify">3.07</td><td align="justify">1.78</td><td align="justify">4.36</td></tr><tr><td align="left">Bifidobacteriaceae</td><td align="justify">1.34</td><td align="justify">0.82</td><td align="justify">1.86</td><td align="justify">0.54</td><td align="justify">0.20</td><td align="justify">0.88</td><td align="justify">0.01</td><td align="justify">-0.35</td><td align="justify">0.37</td></tr><tr><td align="left">Campylobacteraceae</td><td align="justify">0.36</td><td align="justify">-0.31</td><td align="justify">1.03</td><td align="justify">4.90</td><td align="justify">4.48</td><td align="justify">5.33</td><td align="justify">0.83</td><td align="justify">0.46</td><td align="justify">1.21</td></tr><tr><td align="left">Cytophagaceae</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-</td><td align="justify">2.45</td><td align="justify">1.56</td><td align="justify">3.34</td><td align="justify">1.70</td><td align="justify">0.27</td><td align="justify">3.13</td></tr><tr><td align="left">Enterococcaceae</td><td align="justify">3.87</td><td align="justify">2.70</td><td align="justify">5.05</td><td align="justify">0.74</td><td align="justify">0.40</td><td align="justify">1.08</td><td align="justify">0.09</td><td align="justify">-0.28</td><td align="justify">0.45</td></tr><tr><td align="left">Lactobacillaceae</td><td align="justify">3.00</td><td align="justify">2.56</td><td align="justify">3.43</td><td align="justify">-0.51</td><td align="justify">-0.85</td><td align="justify">-0.18</td><td align="justify">1.73</td><td align="justify">1.36</td><td align="justify">2.09</td></tr><tr><td align="left">Leptotrichiaceae</td><td align="justify">-0.90</td><td align="justify">-1.89</td><td align="justify">0.09</td><td align="justify">2.57</td><td align="justify">1.88</td><td align="justify">3.26</td><td align="justify">0.82</td><td align="justify">0.36</td><td align="justify">1.27</td></tr><tr><td align="left">Methanobacteriaceae</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-</td><td align="justify">0.93</td><td align="justify">0.59</td><td align="justify">1.27</td><td align="justify">0.67</td><td align="justify">0.30</td><td align="justify">1.04</td></tr><tr><td align="left">Mitochondria</td><td align="justify">0.60</td><td align="justify">-1.27</td><td align="justify">2.46</td><td align="justify">0.73</td><td align="justify">0.11</td><td align="justify">1.36</td><td align="justify">1.57</td><td align="justify">0.95</td><td align="justify">2.20</td></tr><tr><td align="left">Paenibacillaceae</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-</td><td align="justify">2.19</td><td align="justify">1.28</td><td align="justify">3.10</td><td align="justify">1.71</td><td align="justify">1.30</td><td align="justify">2.12</td></tr><tr><td align="left">Planococcaceae</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-</td><td align="justify">1.06</td><td align="justify">0.72</td><td align="justify">1.41</td><td align="justify">3.26</td><td align="justify">2.67</td><td align="justify">3.85</td></tr><tr><td align="left">Rhizobiaceae</td><td align="justify">-</td><td align="justify">-</td><td align="justify">-</td><td align="justify">0.64</td><td align="justify">0.24</td><td align="justify">1.03</td><td align="justify">1.52</td><td align="justify">1.08</td><td align="justify">1.95</td></tr><tr><td align="left">Streptococcaceae</td><td align="justify">0.44</td><td align="justify">0.03</td><td align="justify">0.86</td><td align="justify">0.84</td><td align="justify">0.50</td><td align="justify">1.17</td><td align="justify">0.26</td><td align="justify">-0.10</td><td align="justify">0.62</td></tr><tr><td align="left">Succinivibrionaceae</td><td align="justify">-0.32</td><td align="justify">-0.76</td><td align="justify">0.11</td><td align="justify">0.74</td><td align="justify">0.40</td><td align="justify">1.08</td><td align="justify">4.31</td><td align="justify">3.76</td><td align="justify">4.86</td></tr><tr><td align="left">Synergistaceae</td><td align="justify">1.26</td><td align="justify">0.80</td><td align="justify">1.71</td><td align="justify">0.25</td><td align="justify">-0.10</td><td align="justify">0.61</td><td align="justify">1.44</td><td align="justify">1.06</td><td align="justify">1.82</td></tr><tr><td align="left">Verrucomicrobiaceae</td><td align="justify">1.71</td><td align="justify">1.23</td><td align="justify">2.19</td><td align="justify">1.62</td><td align="justify">1.29</td><td align="justify">1.96</td><td align="justify">-0.06</td><td align="justify">-0.42</td><td align="justify">0.30</td></tr><tr><td align="left">Victivallaceae</td><td align="justify">0.42</td><td align="justify">-0.00</td><td align="justify">0.85</td><td align="justify">0.68</td><td align="justify">0.34</td><td align="justify">1.02</td><td align="justify">0.93</td><td align="justify">0.54</td><td align="justify">1.32</td></tr></tbody></table><table-wrap-foot><p>The &#x0201c;-&#x0201d; notation indicates the bacteria undetected in that country</p></table-wrap-foot></table-wrap></p><p>We compared ENIGMA to the Wilcoxon rank sum test, a classical methods for identifying bacteria related with an environmental factor of interest [<xref ref-type="bibr" rid="CR16">16</xref>]. Table&#x000a0;<xref rid="Tab6" ref-type="table">6</xref> shows the bacteria significantly related to PD with <italic>p</italic>-value &#x0003c;0.05 in more than two countries. We observed that the bacteria detected by the Wilcoxon test were mostly included in those of ENIGMA (Table&#x000a0;<xref rid="Tab5" ref-type="table">5</xref>). Notably, all of the corrected <italic>p</italic>-values in Table&#x000a0;<xref rid="Tab6" ref-type="table">6</xref> are larger than 0.05. This result shows that ENIGMA was superior to the Wilcoxon rank sum test in terms of identifying a larger number of associations between microbiota and PD.
<table-wrap id="Tab6"><label>Table 6</label><caption><p><italic>p</italic>-Value of Wilcoxon test</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Finland</th><th align="left">Germany</th><th align="left">USA</th></tr></thead><tbody><tr><td align="left">Lachnospiraceae</td><td align="left">0.009371</td><td align="left">0.719014</td><td align="left">0.002839</td></tr><tr><td align="left">Lactobacillaceae</td><td align="left">0.030404</td><td align="left">0.077771</td><td align="left">0.000002</td></tr><tr><td align="left">Pasteurellaceae</td><td align="left">0.006493</td><td align="left">0.495315</td><td align="left">0.004232</td></tr><tr><td align="left">Prevotellaceae</td><td align="left">0.001303</td><td align="left">0.030892</td><td align="left">0.194592</td></tr></tbody></table></table-wrap></p><p>Finally, we combined the results of ENIGMA to those of PICRUSt (version 1.1.3) [<xref ref-type="bibr" rid="CR18">18</xref>] in order to evaluate which functions are related to PD. In the present study, PICRUSt was performed using the default settings. The Fig.&#x000a0;<xref rid="Fig9" ref-type="fig">9</xref> shows the functions exhibiting an increase and decrease from the median, which matched in all countries and clusters with respect to PD and control (CO). This result indicates that ENIGMA is a valuable tool for discovering new disease-related functions.
<fig id="Fig9"><label>Fig. 9</label><caption><p>Predicted functional trait abundance in each country and cluster</p></caption><graphic xlink:href="12864_2019_5476_Fig9_HTML" id="MO9"/></fig></p><p>The analyses using real-world data thus show that ENIGMA can identify enterotype-like clusters and the associations between the gut microbiota and PD. Some of the results were strongly supported by those of previous studies.</p></sec></sec><sec id="Sec10" sec-type="conclusion"><title>Conclusion</title><p>We proposed a novel hierarchical Bayesian model, ENIGMA, for discovering the underlying microbial community structures and associations between microbiota and their environmental factors from microbial metagenome data. ENIGMA is based on a probabilistic model of a microbial community structures and supplied with labels for one or more environmental factors of interest for each sample. The structures of each sample are modeled by a multinomial distribution whose parameters are represented independently by group and environmental effects of each sample, which prevents mixing of individual differences and the effects of interest. This framework enables the model to simultaneously learn (<italic>i</italic>) how microbes contribute to an underlying community structures (cluster) and (<italic>ii</italic>) how microbial compositional patterns are explained by environmental factors of interest. The effectiveness of ENIGMA was evaluated through experiments involving both synthetic and read-world datasets. These newly discovered clusters and associations estimated using ENIGMA can provide insight into the the mechanisms of a microbial communities.</p><p>The major limitation of ENIGMA is its scalability and efficiency, as the number of the parameters in the model increase proportionally with the number of taxa when the number of environmental factors of interest is large. Further studies should focus on developing a scalable probabilistic model of microbial compositions to analyze underlying microbial structures with a large number of these effects by using sparse parameter estimation [<xref ref-type="bibr" rid="CR19">19</xref>]. We are also interested in developing a dynamic probabilistic model similar to that reported by Blei and Lafferty [<xref ref-type="bibr" rid="CR20">20</xref>] for analyzing time-varying bacteria compositions during disease progression.</p></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>CH</term><def><p>Calinski-Harabasz</p></def></def-item><def-item><term>CO</term><def><p>Control</p></def></def-item><def-item><term>CP</term><def><p>Coverage probability</p></def></def-item><def-item><term>JSD</term><def><p>Jensen-Shannon divergence</p></def></def-item><def-item><term>MAP</term><def><p>Maximum a posteriori</p></def></def-item><def-item><term>OTU</term><def><p>Operational taxonomic units</p></def></def-item><def-item><term>PD</term><def><p>Parkinson&#x02019;s disease</p></def></def-item><def-item><term>RMSE</term><def><p>Root mean squared error</p></def></def-item><def-item><term>SE</term><def><p>Standard error</p></def></def-item></def-list></glossary><ack><title>Acknowledgements</title><p>Not applicable.</p><sec id="d29e6534"><title>Funding</title><p>This work was supported by Grants-in-Aid from the Ministry of Education, Culture, Sports, Science and Technology of Japan (MEXT); Ministry of Health, Labour and Welfare of Japan (MHLW); Japan Agency for Medical Research and Development (AMED), and the Hori Sciences and Arts Foundation. Publication of this article was sponsored by AMED CREST JP18gm1010002.</p></sec><sec id="d29e6539"><title>Availability of materials</title><p>ENIGMA is implemented with R and is available from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/abikoushi/enigma">https://github.com/abikoushi/enigma</ext-link>).</p></sec><sec id="d29e6549"><title>About this supplement</title><p>This article has been published as part of <italic>BMC Genomics Volume 20 Supplement 2, 2019: Selected articles from the 17th Asia Pacific Bioinformatics Conference (APBC 2019): genomics</italic>. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcgenomics.biomedcentral.com/articles/supplements/volume-20-supplement-2">https://bmcgenomics.biomedcentral.com/articles/supplements/volume-20-supplement-2</ext-link>.</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>KA and TS designed the proposed algorithm. KO and MH designed the experiments. All authors have read and approved the final manuscript.</p></notes><notes notes-type="COI-statement"><sec><title>Ethics approval and consent to participate</title><p>Not applicable.</p></sec><sec><title>Consent for publication</title><p>Not applicable.</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Publisher&#x02019;s Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huttenhower</surname><given-names>C</given-names></name><name><surname>Gevers</surname><given-names>D</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name><name><surname>Abubucker</surname><given-names>S</given-names></name><name><surname>Badger</surname><given-names>JH</given-names></name><name><surname>Chinwalla</surname><given-names>AT</given-names></name><etal/></person-group><article-title>Human Mircrobiome Project Consortium. Structure, function and diversity of the healthy human microbiome</article-title><source>Nature</source><year>2012</year><volume>486</volume><fpage>207</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1038/nature11234</pub-id><pub-id pub-id-type="pmid">22699609</pub-id></element-citation></ref><ref id="CR2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le Chatelier</surname><given-names>E</given-names></name><name><surname>Nielsen</surname><given-names>T</given-names></name><name><surname>Qin</surname><given-names>J</given-names></name><name><surname>Prifti</surname><given-names>E</given-names></name><name><surname>Hildebrand</surname><given-names>F</given-names></name><name><surname>Falony</surname><given-names>G</given-names></name><etal/></person-group><article-title>Richness of human gut microbiome correlates with metabolic markers</article-title><source>Nature</source><year>2013</year><volume>500</volume><fpage>541</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.1038/nature12506</pub-id><pub-id pub-id-type="pmid">23985870</pub-id></element-citation></ref><ref id="CR3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arumugam</surname><given-names>M</given-names></name><name><surname>Raes</surname><given-names>J</given-names></name><name><surname>Pelletier</surname><given-names>E</given-names></name><name><surname>Le Paslier</surname><given-names>D</given-names></name><name><surname>Yamada</surname><given-names>T</given-names></name><name><surname>Mende</surname><given-names>DR</given-names></name><etal/></person-group><article-title>Enterotypes of the human gut microbiome</article-title><source>Nature</source><year>2011</year><volume>473</volume><issue>7346</issue><fpage>174</fpage><pub-id pub-id-type="doi">10.1038/nature09944</pub-id><pub-id pub-id-type="pmid">21508958</pub-id></element-citation></ref><ref id="CR4"><label>4</label><mixed-citation publication-type="other">Moeller AH, Degnan PH, Pusey AE, Wilson ML, Hahn BH, Ochman H. Chimpanzees and humans harbour compositionally similar gut enterotypes. Nat Commun; 3:1179.</mixed-citation></ref><ref id="CR5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hildebrand</surname><given-names>F</given-names></name><name><surname>Nguyen</surname><given-names>TL</given-names></name><name><surname>Brinkman</surname><given-names>B</given-names></name><name><surname>Yunta</surname><given-names>RG</given-names></name><name><surname>Cauwe</surname><given-names>B</given-names></name><name><surname>Vandenabeele</surname><given-names>P</given-names></name><etal/></person-group><article-title>Inflammation-associated enterotypes, host genotype, cage and inter-individual effects drive gut microbiota variation in common laboratory mice</article-title><source>Genome Biol</source><year>2013</year><volume>14</volume><issue>1</issue><fpage>R4</fpage><pub-id pub-id-type="doi">10.1186/gb-2013-14-1-r4</pub-id><pub-id pub-id-type="pmid">23347395</pub-id></element-citation></ref><ref id="CR6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ravel</surname><given-names>J</given-names></name></person-group><article-title>Vaginal microbiome of reproductive-age women</article-title><source>Proc Natl Acad Sci USA</source><year>2011</year><volume>108.Supplement 1</volume><fpage>4680</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1073/pnas.1002611107</pub-id><pub-id pub-id-type="pmid">20534435</pub-id></element-citation></ref><ref id="CR7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koren</surname><given-names>O</given-names></name><name><surname>Knights</surname><given-names>D</given-names></name><name><surname>Gonzalez</surname><given-names>A</given-names></name><name><surname>Waldron</surname><given-names>L</given-names></name><name><surname>Segata</surname><given-names>N</given-names></name><name><surname>Huttenhower</surname><given-names>C</given-names></name><etal/></person-group><article-title>A guide to enterotypes across the human body: meta-analysis of microbial community structures in human microbiome datasets</article-title><source>PLoS Comput Biol</source><year>2013</year><volume>9</volume><issue>1</issue><fpage>e1002863</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002863</pub-id><pub-id pub-id-type="pmid">23326225</pub-id></element-citation></ref><ref id="CR8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>T</given-names></name><name><surname>Schloss</surname><given-names>PD</given-names></name></person-group><article-title>Dynamics and associations of microbial community types across the human body</article-title><source>Nature</source><year>2014</year><volume>509</volume><fpage>357</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1038/nature13178</pub-id><pub-id pub-id-type="pmid">24739969</pub-id></element-citation></ref><ref id="CR9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>Y</given-names></name><name><surname>Mihindukulasuriya</surname><given-names>KA</given-names></name><name><surname>Gao</surname><given-names>H</given-names></name><name><surname>La Rose</surname><given-names>PS</given-names></name><name><surname>Wylie</surname><given-names>KM</given-names></name><name><surname>Martin</surname><given-names>JC</given-names></name><etal/></person-group><article-title>Exploration of bacterial community classes in major human habitats</article-title><source>Genome Biol</source><year>2014</year><volume>15</volume><fpage>R66</fpage><pub-id pub-id-type="doi">10.1186/gb-2014-15-5-r66</pub-id><pub-id pub-id-type="pmid">24887286</pub-id></element-citation></ref><ref id="CR10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knights</surname><given-names>D1</given-names></name><name><surname>Costello</surname><given-names>EK</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name></person-group><article-title>Supervised classification of human microbiota</article-title><source>FEMS Microbiol Rev</source><year>2011</year><volume>35</volume><issue>2</issue><fpage>343</fpage><lpage>59</lpage><pub-id pub-id-type="doi">10.1111/j.1574-6976.2010.00251.x</pub-id><pub-id pub-id-type="pmid">21039646</pub-id></element-citation></ref><ref id="CR11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holmws</surname><given-names>I</given-names></name><name><surname>Harris</surname><given-names>K</given-names></name><name><surname>Quince</surname><given-names>C</given-names></name></person-group><article-title>Dirichlet multinomial mixtures: generative models for microbial metagenomics</article-title><source>PloS ONE</source><year>2012</year><volume>7</volume><issue>2</issue><fpage>e30126</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0030126</pub-id><pub-id pub-id-type="pmid">22319561</pub-id></element-citation></ref><ref id="CR12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shafiei</surname><given-names>M</given-names></name><name><surname>Dunn</surname><given-names>KA</given-names></name><name><surname>Boon</surname><given-names>E</given-names></name><name><surname>MacDonald</surname><given-names>SM</given-names></name><name><surname>Walsh</surname><given-names>DA</given-names></name><name><surname>Gu</surname><given-names>H</given-names></name><etal/></person-group><article-title>BioMiCo: a supervised Bayesian model for inference of microbial community structure</article-title><source>Microbiome</source><year>2015</year><volume>3</volume><issue>1</issue><fpage>8</fpage><pub-id pub-id-type="doi">10.1186/s40168-015-0073-x</pub-id><pub-id pub-id-type="pmid">25774293</pub-id></element-citation></ref><ref id="CR13"><label>13</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bishop</surname><given-names>C</given-names></name></person-group><source>Pattern recognition and machine learning</source><year>2006</year><publisher-loc>New York</publisher-loc><publisher-name>Springer-Verlag</publisher-name></element-citation></ref><ref id="CR14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheperjans</surname><given-names>F</given-names></name><name><surname>Aho</surname><given-names>V</given-names></name><name><surname>Pereira</surname><given-names>PA</given-names></name><name><surname>Koskinen</surname><given-names>K</given-names></name><name><surname>Paulin</surname><given-names>L</given-names></name><name><surname>Pekkonen</surname><given-names>E</given-names></name><etal/></person-group><article-title>Gut microbiota are related to Parkinson&#x02019;s disease and clinical phenotype</article-title><source>Mov Disord</source><year>2015</year><volume>30</volume><issue>3</issue><fpage>350</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1002/mds.26069</pub-id><pub-id pub-id-type="pmid">25476529</pub-id></element-citation></ref><ref id="CR15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hill-Burns</surname><given-names>EM</given-names></name><name><surname>Debelius</surname><given-names>JW</given-names></name><name><surname>Morton</surname><given-names>JT</given-names></name><name><surname>Wissemann</surname><given-names>WT</given-names></name><name><surname>Lewis</surname><given-names>MR</given-names></name><name><surname>Wallen</surname><given-names>ZD</given-names></name><etal/></person-group><article-title>Parkinson&#x02019;s disease and Parkinson&#x02019;s disease medications have distinct signatures of the gut microbiome</article-title><source>Mov Disord</source><year>2017</year><volume>32</volume><issue>5</issue><fpage>739</fpage><lpage>49</lpage><pub-id pub-id-type="doi">10.1002/mds.26942</pub-id><pub-id pub-id-type="pmid">28195358</pub-id></element-citation></ref><ref id="CR16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heintz-Buschart</surname><given-names>A</given-names></name><name><surname>Pandey</surname><given-names>U</given-names></name><name><surname>Wicke</surname><given-names>T</given-names></name><name><surname>Sixel-D&#x000f6;ring</surname><given-names>F</given-names></name><name><surname>Janzen</surname><given-names>A</given-names></name><name><surname>Sittig-Wiegand</surname><given-names>E</given-names></name><etal/></person-group><article-title>The nasal and gut microbiome in Parkinson&#x02019;s disease and idiopathic rapid eye movement sleep behavior disorder</article-title><source>Mov Disord</source><year>2018</year><volume>33</volume><issue>1</issue><fpage>88</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1002/mds.27105</pub-id><pub-id pub-id-type="pmid">28843021</pub-id></element-citation></ref><ref id="CR17"><label>17</label><mixed-citation publication-type="other">Hopfner F, K&#x000fc;nstner A, M&#x000fc;ller SH, K&#x000fc;nzel S, Zeuner KE, Margraf NG, et al. Gut microbiota in Parkinson disease in a northern German cohort. Brain Res; 1667:41&#x02013;5.</mixed-citation></ref><ref id="CR18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langille</surname><given-names>MG</given-names></name><name><surname>Zaneveld</surname><given-names>J</given-names></name><name><surname>Caporaso</surname><given-names>JG</given-names></name><name><surname>McDonald</surname><given-names>D</given-names></name><name><surname>Knights</surname><given-names>D</given-names></name><name><surname>Reyes</surname><given-names>JA</given-names></name><etal/></person-group><article-title>Predictive functional profiling of microbial communities using 16S rRNA marker gene sequences</article-title><source>Nat Biotechnol</source><year>2013</year><volume>31</volume><issue>9</issue><fpage>814</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1038/nbt.2676</pub-id><pub-id pub-id-type="pmid">23975157</pub-id></element-citation></ref><ref id="CR19"><label>19</label><mixed-citation publication-type="other">Yang Y, Chen N, Chen T. mLDM: a new hierarchical Bayesian statistical model for sparse microbioal association discovery. bioRxiv. 2016;:042630. <pub-id pub-id-type="doi">10.1101/042630</pub-id>.</mixed-citation></ref><ref id="CR20"><label>20</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Blei</surname><given-names>DM</given-names></name><name><surname>Lafferty</surname><given-names>JD</given-names></name></person-group><article-title>Dynamic topic models</article-title><source>Proceedings of the 23rd international conference on Machine learning</source><year>2006</year><publisher-loc>New York</publisher-loc><publisher-name>ACM</publisher-name></element-citation></ref></ref-list></back></article>