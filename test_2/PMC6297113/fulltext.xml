<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.5.0//EN//XML?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName art550.dtd?><?SourceDTD.Version 5.5.0?><?ConverterInfo.XSLTName elsevier2nlmx2.xsl?><?ConverterInfo.Version 1?><?origin publisher?><?FILEmeta_YMETH4402 xml ?><?FILEmain xml ?><?FILEgr1 jpg ?><?FILEgr2 jpg ?><?FILEgr3 jpg ?><?FILEgr4 jpg ?><?FILEgr5 jpg ?><?FILEmmc1 docx ?><?FILEsi1 gif ?><?FILEsi2 gif ?><?FILEsi3 gif ?><?FILEsi4 gif ?><?FILEsi5 gif ?><?FILEsi6 gif ?><?FILEsi7 gif ?><?FILEsi8 gif ?><?FILEsi9 gif ?><?FILEsi10 gif ?><?FILEsi11 gif ?><?FILEsi14 gif ?><?FILEsi17 gif ?><?FILEsi18 gif ?><?FILEsi19 gif ?><?FILEsi20 gif ?><?FILEsi21 gif ?><?FILEsi22 gif ?><?FILEsi23 gif ?><?FILEsi24 gif ?><?FILEsi25 gif ?><?FILEsi27 gif ?><?FILEsi28 gif ?><?FILEsi30 gif ?><?FILEsi31 gif ?><?FILEsi32 gif ?><?FILEsi33 gif ?><?FILEsi34 gif ?><?FILEsi35 gif ?><?FILEsi36 gif ?><?FILEsi37 gif ?><?FILEsi38 gif ?><?FILEsi40 gif ?><?FILEsi41 gif ?><?FILEsi42 gif ?><?FILEsi43 gif ?><?FILEsi44 gif ?><?FILEsi45 gif ?><?FILEsi46 gif ?><front><journal-meta><journal-id journal-id-type="nlm-ta">Methods</journal-id><journal-id journal-id-type="iso-abbrev">Methods</journal-id><journal-title-group><journal-title>Methods (San Diego, Calif.)</journal-title></journal-title-group><issn pub-type="ppub">1046-2023</issn><issn pub-type="epub">1095-9130</issn><publisher><publisher-name>Academic Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6297113</article-id><article-id pub-id-type="publisher-id">S1046-2023(17)30498-X</article-id><article-id pub-id-type="doi">10.1016/j.ymeth.2018.02.004</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Bi-clustering of metabolic data using matrix factorization tools</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Gu</surname><given-names>Quan</given-names></name><xref rid="af005" ref-type="aff">a</xref></contrib><contrib contrib-type="author"><name><surname>Veselkov</surname><given-names>Kirill</given-names></name><email>kirill.veselkov04@imperial.ac.uk</email><xref rid="af010" ref-type="aff">b</xref><xref rid="cor1" ref-type="corresp">&#x0204e;</xref></contrib></contrib-group><aff id="af005"><label>a</label>MRC-University of Glasgow Centre for Virus Research, University of Glasgow, Garscube Estate, Glasgow G61 1QH, UK</aff><aff id="af010"><label>b</label>Department of Surgery and Cancer, Faculty of Medicine, Imperial College London, Sir Alexander Fleming Building, Exhibition Road, South Kensington, London SW7 2AZ, UK</aff><author-notes><corresp id="cor1"><label>&#x0204e;</label>Corresponding author. <email>kirill.veselkov04@imperial.ac.uk</email></corresp></author-notes><pub-date pub-type="pmc-release"><day>01</day><month>12</month><year>2018</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="ppub">.--><pub-date pub-type="ppub"><day>01</day><month>12</month><year>2018</year></pub-date><volume>151</volume><fpage>12</fpage><lpage>20</lpage><history><date date-type="received"><day>17</day><month>1</month><year>2018</year></date><date date-type="rev-recd"><day>4</day><month>2</month><year>2018</year></date><date date-type="accepted"><day>6</day><month>2</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; 2018 The Authors</copyright-statement><copyright-year>2018</copyright-year><license license-type="CC BY" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p></license></permissions><abstract abstract-type="author-highlights" id="ab005"><title>Highlights</title><p><list list-type="simple" id="l0005"><list-item id="o0005"><label>&#x02022;</label><p id="p0005">We propose a positive matrix factorization bi-clustering strategy for metabolic data.</p></list-item><list-item id="o0010"><label>&#x02022;</label><p id="p0010">The approach automatically determines the number and composition of bi-clusters.</p></list-item><list-item id="o0015"><label>&#x02022;</label><p id="p0015">We demonstrate its superior performance compared to other techniques.</p></list-item></list></p></abstract><abstract id="ab010"><p>Metabolic phenotyping technologies based on Nuclear Magnetic Spectroscopy (NMR) and Mass Spectrometry (MS) generate vast amounts of unrefined data from biological samples. Clustering strategies are frequently employed to provide insight into patterns of relationships between samples and metabolites. Here, we propose the use of a non-negative matrix factorization driven bi-clustering strategy for metabolic phenotyping data in order to discover subsets of interrelated metabolites that exhibit similar behaviour across subsets of samples. The proposed strategy incorporates bi-cross validation and statistical segmentation techniques to automatically determine the number and structure of bi-clusters. This alternative approach is in contrast to the widely used conventional clustering approaches that incorporate all molecular peaks for clustering in metabolic studies and require <italic>a priori</italic> specification of the number of clusters. We perform the comparative analysis of the proposed strategy with other bi-clustering approaches, which were developed in the context of genomics and transcriptomics research. We demonstrate the superior performance of the proposed bi-clustering strategy on both simulated (NMR) and real (MS) bacterial metabolic data.</p></abstract><kwd-group id="kg005"><title>Keywords</title><kwd>Bi-clustering</kwd><kwd>Matrix factorization</kwd><kwd>Bi-cross validation</kwd><kwd>Metabolic data</kwd></kwd-group></article-meta></front><body><sec id="s0005"><label>1</label><title>Introduction</title><p id="p0020">Modern Nuclear Magnetic Resonance (NMR) spectroscopy and Mass Spectrometry (MS) technologies generate vast amounts of unrefined metabolic data in biomedical studies <xref rid="b0005" ref-type="bibr">[1]</xref>, <xref rid="b0010" ref-type="bibr">[2]</xref>. The metabolic signature of a complex biological mixture (&#x02018;metabolic profile&#x02019;), such as that obtained from analysis of biofluids, consists of overlapping signals of hundreds to thousands of distinct chemical entities influenced by genes, treatment, gut microbiota and other environmental factors. This myriad of factorial influences results in complex inter-relationships between both spectral observations and variables. The clustering and related unsupervised learning tools are frequently used to discover patterns of relationships between samples and metabolites <xref rid="b0015" ref-type="bibr">[3]</xref>, <xref rid="b0020" ref-type="bibr">[4]</xref>.</p><p id="p0025">Given a two-dimensional data matrix X with m rows (samples) and n columns (variables), traditional clustering analysis aims to identify groups of samples (or respectively variables) that exhibit similar behaviour across all variables (or respectively samples). This strategy is useful to perform global partitioning of the data matrix. In &#x0201c;-omics&#x0201d; studies, molecules (e.g., genes or metabolites) can be involved in one or more biological processes and exhibit similar patterns of behaviour across a subset of samples (but not necessarily all). The bi-clustering strategies are more suitable in such cases. The objective of biclustering is to perform simultaneous clustering of both rows and columns in the data matrix <xref rid="b0025" ref-type="bibr">[5]</xref>. This means that clustering derives a global model, while biclustering produces a local model. Each row in a bicluster is selected using only a subset of the columns and each column in a bicluster is selected using only a subset of the rows.</p><p id="p0030">In &#x0201c;omics&#x0201d; sciences, the (bi)clustering methods have been widely applied to gene expression data matrix, where rows represent gene transcripts and column represent conditions/samples. The data matrix element corresponds to the expression level of a gene under a specific condition <xref rid="b0030" ref-type="bibr">[6]</xref>. Unlike clustering algorithms, the goal of the technique is to identify groups of genes that show similar activity patterns under a specific subset of the experimental conditions. Such biclusters are biologically relevant since they not only capture the correlated genes but also identify the genes that do not behave similarly in all conditions <xref rid="b0035" ref-type="bibr">[7]</xref>. Thus, the biclustering algorithms have been shown to discover more biologically relevant clusters, compared to conventional global clustering techniques.</p><p id="p0035">The biological application of biclustering algorithm was first used by Cheng and Church (CC) <xref rid="b0040" ref-type="bibr">[8]</xref> for gene expression data. After this initial approach, a number of biclustering algorithms including Spectral <xref rid="b0045" ref-type="bibr">[9]</xref>, Plaid <xref rid="b0050" ref-type="bibr">[10]</xref>, BiMax <xref rid="b0055" ref-type="bibr">[11]</xref>, Xmotifs <xref rid="b0060" ref-type="bibr">[12]</xref>, OPSM <xref rid="b0065" ref-type="bibr">[13]</xref>, ISA <xref rid="b0070" ref-type="bibr">[14]</xref>, QUBIC <xref rid="b0075" ref-type="bibr">[15]</xref> and FABIA <xref rid="b0080" ref-type="bibr">[16]</xref> have been developed to identify various types of biclusters for gene expression data. A useful criterion to evaluate a biclustering algorithm is based on the identification of the type of biclusters the algorithm is able to find. In broad terms, the types of biclusters can be divided into <xref rid="b0025" ref-type="bibr">[5]</xref>:<list list-type="simple" id="l0010"><list-item id="o0020"><label>1.</label><p id="p0040">Biclusters with constant values.</p></list-item><list-item id="o0025"><label>2.</label><p id="p0045">Biclusters with constant values on rows or columns.</p></list-item><list-item id="o0030"><label>3.</label><p id="p0050">Biclusters with coherent values (addictive model).</p></list-item><list-item id="o0035"><label>4.</label><p id="p0055">Biclusters with coherent values (multiplicative model).</p></list-item><list-item id="o0040"><label>5.</label><p id="p0060">Biclusters with coherent evolutions.</p></list-item></list></p><p id="p0065">The spectroscopic data (NMR or MS), with rows representing the samples and columns representing variables, can be considered as a linear combination of metabolite peaks plus noise, which is corresponding to the biclusters with constant values on columns or overlapped. However, the aforementioned biclustering methods with low anti-disturbing and fault tolerance are only suitable for gene expression data; in this scenario, the rows (genes) and columns (conditions) are fixed without overlapping partitions of conditions from the experiment.</p><p id="p0070">Matrix factorization is a decomposition of a data matrix into a product of matrices, either for regularization or for interpretation. A variety of matrix factorization methods by incorporating different constraints, e.g. singular value decomposition (SVD) <xref rid="b0085" ref-type="bibr">[17]</xref>, principal component analysis (PCA) <xref rid="b0090" ref-type="bibr">[18]</xref>, and non-negative matrix factorization (NMF) <xref rid="b0095" ref-type="bibr">[19]</xref>, could be applied to minimise the dimensionality of the data yielding a representation of conditions as a linear combination of a reduced set of factors <xref rid="b0100" ref-type="bibr">[20]</xref>. The factor scores/loadings represent sets of rows or columns that behave in a strongly correlated manner with the original data. In the gene expression data, various matrix factorization methods have been used to cluster genes or conditions based on local patterns and predict functional relationships <xref rid="b0105" ref-type="bibr">[21]</xref>, <xref rid="b0110" ref-type="bibr">[22]</xref>. Apart from the genomic datasets, the matrix factorization tools could also be used for exploring the spectroscopic datasets for their output matrices represent the relevance of samples and compound variables simultaneously <xref rid="b0115" ref-type="bibr">[23]</xref>.</p><p id="p0075">In this paper, we first present a biclustering technique based on matrix factorization to identify subsets of correlated metabolites exhibiting similar patterns of behaviour across a subset of samples (but not necessarily all). The critical factor is how to select the number of biclusters. We have thus incorporated the bi-cross validation and statistical segmentation techniques to automatically determine the number and structure of bi-clusters. This alternative approach is in contrast to the widely used conventional clustering approaches that use all molecular peaks for clustering in metabolic studies and require <italic>a priori</italic> specification of the number of clusters. We perform the comparative analysis of the proposed strategy with other bi-clustering approaches, which were developed in the context of genomics and transcriptomics research.</p></sec><sec id="s0010"><label>2</label><title>Materials and methods</title><sec id="s0015"><label>2.1</label><title>Synthetic dataset</title><p id="p0080">A bicluster is a subset of rows that exhibit similar behaviour across a subset of columns, and vice versa. Given a data matrix <italic>A</italic>, a bicluster <italic>A<sub>IJ</sub></italic>(<italic>I</italic>,<italic>J</italic>) denotes the submatrix of <italic>A</italic> that contains only the elements <inline-formula><mml:math id="M1" altimg="si1.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> belonging to the submatrix with a set of rows <italic>I</italic> and set of columns <italic>J</italic>.</p><p id="p0085">There are two ways to generate synthetic NMR/MS datasets for evaluating the algorithm performance of the metabolites biclustering. Considering the characteristic of NMR/MS spectroscopic data matrix, the first way is to use biclusters with constant values on columns to simulate the compound. Given the <italic>K</italic> bicluster, the dataset of <italic>i</italic> rows and <italic>j</italic> columns can be built by the equation<disp-formula id="e0005"><label>(1)</label><mml:math id="M2" altimg="si2.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:msub><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003c1;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003ba;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p><p id="p0090">where <inline-formula><mml:math id="M3" altimg="si3.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> represents the element in the bicluster, <inline-formula><mml:math id="M4" altimg="si4.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow></mml:math></inline-formula> is the typical value and <inline-formula><mml:math id="M5" altimg="si5.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the value for column <italic>j</italic> within the within the <italic>k</italic>-th bicluster. <inline-formula><mml:math id="M6" altimg="si6.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003c1;</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M7" altimg="si7.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003ba;</mml:mi></mml:mrow></mml:math></inline-formula> are indicator variables for row <italic>i</italic> and column <italic>j</italic> membership in the bicluster <italic>k</italic>. The noise <inline-formula><mml:math id="M8" altimg="si8.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow></mml:math></inline-formula> is generated from a Gaussian distribution with zero mean and a varying standard deviation, i.e. <inline-formula><mml:math id="M9" altimg="si9.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003b5;</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mtext>,</mml:mtext><mml:mi>&#x003b4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="M10" altimg="si10.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow></mml:math></inline-formula> is the noise level. <xref rid="f0005" ref-type="fig">Fig. 1</xref> provides a simple example of 8&#x0202f;&#x000d7;&#x0202f;8 matrix with <inline-formula><mml:math id="M11" altimg="si11.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow></mml:math></inline-formula>&#x0202f;=&#x0202f;{1,2,3}. The typical value <inline-formula><mml:math id="M12" altimg="si4.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow></mml:math></inline-formula> is set to 0 and the noise level <inline-formula><mml:math id="M13" altimg="si10.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow></mml:math></inline-formula> is set to 0.1.<fig id="f0005"><label>Fig. 1</label><caption><p>A simple example of simulation data matrix with biclusters of constant values on columns.</p></caption><graphic xlink:href="gr1"/></fig></p><p id="p0095">Aside from the method mentioned above, the MetAssimulo <xref rid="b0120" ref-type="bibr">[24]</xref> is an important tool to simulate <sup>1</sup>H NMR spectra of metabolic profiles. MetAssimulo is a package, which can create realistic metabolic profiles containing large numbers of metabolites with a range of user-defined properties based on the concentration information input by the user or constructed automatically from the Human Metabolome Database. For instance, if the concentration information is in the custom mode, the user could set the concentration information of &#x02018;case&#x02019; samples by defining the fold-change of the mean and standard deviation of corresponding concentration in &#x02018;control&#x02019; samples, which is constructed automatically from the Human Metabolome Database. Furthermore, MetAssimulo is able to simulate shifts in NMR peak positions that result from matrix effects (e.g., pH variation), which are often observed in metabolic NMR spectra.</p><p id="p0100">In detail, the schema of building <sup>1</sup>H NMR synthetic data by MetAssimulo is listed as follows:</p><p id="p0105"><bold>Step1:</bold> Given the number of biclusters K <inline-formula><mml:math id="M14" altimg="si14.gif" overflow="scroll"><mml:mrow><mml:mo>&#x02282;</mml:mo></mml:mrow></mml:math></inline-formula> {1,2,&#x02026;,<italic>k</italic>}, the number of samples in each biclusters M <inline-formula><mml:math id="M15" altimg="si14.gif" overflow="scroll"><mml:mrow><mml:mo>&#x02282;</mml:mo></mml:mrow></mml:math></inline-formula> {<italic>m<sub>1</sub></italic>,<italic>m<sub>2</sub></italic>,&#x02026;,<italic>m<sub>k</sub></italic>}, the number of metabolites in each biclusters N <inline-formula><mml:math id="M16" altimg="si14.gif" overflow="scroll"><mml:mrow><mml:mo>&#x02282;</mml:mo></mml:mrow></mml:math></inline-formula> {<italic>n<sub>1</sub></italic>,<italic>n<sub>2</sub></italic>,&#x02026;,<italic>n<sub>k</sub></italic>}.</p><p id="p0110"><bold>Step2:</bold> For <inline-formula><mml:math id="M17" altimg="si17.gif" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M18" altimg="si18.gif" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M19" altimg="si19.gif" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>: set the fold-change of mean and standard deviation of the concentration of <italic>n<sub>k</sub></italic> &#x02013;th metabolite in <italic>m<sub>k</sub></italic> &#x02018;case&#x02019; samples.</p><p id="p0115"><bold>Step3:</bold> Run the MetAssimulo package and simulate <sup>1</sup>H NMR spectra of metabolic profiles, get the data matrix <italic>A</italic> and the median of the data matrix <italic>A</italic><sub>1/2</sub>.</p><p id="p0120"><bold>Step4:</bold> Align and normalize the data matrix.</p><p id="p0125"><bold>Step5:</bold> Logarithm transfers the data matrix <inline-formula><mml:math id="M20" altimg="si20.gif" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mfenced open="|" close="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> for biclustering analysis.</p><sec id="s0020"><label>2.1.1</label><title>Non-negative matrix factorization</title><p id="p0130">Non-negative matrix factorization, also known as the classical NMF model is a useful algorithm in multivariate analysis and linear algebra, which has been successfully applied in chemometrics <xref rid="b0095" ref-type="bibr">[19]</xref>. The technique can be applied to the analysis of multidimensional datasets to reduce the dimensionality, discover latent patterns and aid in the interpretation of the data.</p><p id="p0135">The main difference between NMF and other classical factorization techniques such as SVD <xref rid="b0085" ref-type="bibr">[17]</xref> and PCA <xref rid="b0090" ref-type="bibr">[18]</xref> depends on the non-negativity constraints imposed on both score and loading vectors. In this way, output matrices can be interpreted as parts of the data or as subsets of elements that tend to occur together in sub-portions of the dataset <xref rid="b0100" ref-type="bibr">[20]</xref>. Thus, the factor matrices produced by NMF (i.e., factor scores and factor loadings) that lend themselves to a relatively easy contextual interpretation, while the factor matrices obtained by the other classical factorization approaches, allow themselves to be of the arbitrary sign with no obvious contextual meaning.</p><p id="p0140">The NMF algorithm is described as follows:<disp-formula id="e0010"><label>(2)</label><mml:math id="M21" altimg="si21.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula>where <italic>A</italic> is the positive data matrix with <italic>m</italic> samples and <italic>n</italic> variables, <italic>k</italic> is the number of components with <italic>k</italic> &#x0003c;&#x0003c; min(<italic>m</italic>,<italic>n</italic>).</p><p id="p0145">A solution to the NMF problem can be obtained by solving the following optimization object function:<disp-formula id="e0015"><label>(3)</label><mml:math id="M22" altimg="si22.gif" overflow="scroll"><mml:mstyle displaystyle="true"><mml:munder><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mtext>,</mml:mtext><mml:mi>H</mml:mi></mml:mrow></mml:munder></mml:mstyle><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mtext>,</mml:mtext><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mfenced open="&#x02016;" close="&#x02016;"><mml:mrow><mml:mi>A</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="italic">WH</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></disp-formula>where <italic>W</italic> is a basis matrix, <italic>H</italic> is a coefficient matrix, <inline-formula><mml:math id="M23" altimg="si23.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mfenced open="&#x02016;" close="&#x02016;"><mml:mrow><mml:mo>&#x000b7;</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the Frobenius norm and <italic>W</italic>, <italic>H</italic>&#x0202f;&#x02265;&#x0202f;0 means that all elements of <italic>W</italic> and <italic>H</italic> are non-negative.</p><p id="p0150">Considering the non-negativity of metabolites concentration in NMR/MS spectra, we use the NMF method to find biclusters of metabolites from NMR/MS spectra. As shown in the Eq. <xref rid="e0010" ref-type="disp-formula">(2)</xref>, under the number of biclusters <italic>k</italic>, the classical NMF approximately reproduce a <sup>1</sup>H NMR spectroscopic data matrix <italic>A</italic> of dimension <italic>m</italic> samples and <italic>n</italic> variables as a product of two non-negative constraint matrices <italic>W</italic> and <italic>H</italic>. The <italic>W</italic> factor scores matrix has the dimension of a single array (<italic>m</italic> samples) and <italic>k</italic> biclusters, while the columns of factor loading matrix <italic>H</italic> are known as variable vectors and are in one-to-one correspondence with the NMR/MS spectra data matrix <italic>A</italic>.</p></sec><sec id="s0025"><label>2.1.2</label><title>Bi-cross-validation</title><p id="p0155">Given a large dataset matrix <italic>A</italic> of dimension <inline-formula><mml:math id="M24" altimg="si24.gif" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, several useful methods handle it to produce two matrices <italic>W</italic> and <italic>H</italic>, and the cross-validation(CV) is a practical algorithm to determine the number of rank of <italic>W</italic> and <italic>H</italic>, i.e. the number of component in the large matrix <xref rid="b0085" ref-type="bibr">[17]</xref>. However, the result is affected by the noise of matrix and there is a risk of overfitting. Considering the noise and complexity in spectroscopic data and the overlap between metabolites, the cross-validation is not suitable for predicting the number of biclusters in these data matrices.</p><p id="p0160">As illustrated by Owen and Perry <xref rid="b0085" ref-type="bibr">[17]</xref>, bi-cross-validation algorithm (BCV) is a useful tool that is generally applicable to outer product approximations, just as CV is for independent and identically distributed random variables sampling. The performance and robustness of BCV is better than CV, and is more suitable than CV for the unsupervised learning (e.g. matrix factorization).</p><p id="p0165">In the present study, we use BCV of matrix factorization to predict the number of the biclusters. The schema of algorithm is listed as follows:</p><p id="p0170"><bold>Step1:</bold> Given a data matrix <inline-formula><mml:math id="M25" altimg="si25.gif" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mtext>,</mml:mtext><mml:mi>&#x0221e;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, row and column holdout subset I<sub>l</sub>&#x0202f;=&#x0202f;{1,2, ,m}, J<sub>l</sub>&#x0202f;=&#x0202f;{1,2,&#x02026;,n}, for number of holdout <italic>l&#x0202f;=</italic>&#x0202f;1,2,&#x02026;,<italic>L</italic>, and list of ranks the number of metabolites in each biclusters <italic>K</italic>&#x0202f;=&#x0202f;{1,2,&#x02026;,min(<italic>m</italic>,<italic>n</italic>)}.</p><p id="p0175"><bold>Step2:</bold> For <inline-formula><mml:math id="M26" altimg="si17.gif" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>:<inline-formula><mml:math id="M27" altimg="si27.gif" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">BCV</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02190;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></p><p id="p0180"><bold>Step3:</bold> For <inline-formula><mml:math id="M28" altimg="si28.gif" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mtext>,</mml:mtext><mml:mn>2</mml:mn><mml:mtext>,</mml:mtext><mml:mo>&#x02026;</mml:mo><mml:mtext>,</mml:mtext><mml:mi>L</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M29" altimg="si17.gif" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>:<inline-formula><mml:math id="M30" altimg="si30.gif" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi><mml:mo>&#x02190;</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="M31" altimg="si31.gif" overflow="scroll"><mml:mrow><mml:mi>J</mml:mi><mml:mo>&#x02190;</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, fit the matrix factorization model: <inline-formula><mml:math id="M32" altimg="si32.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:mtext>,</mml:mtext><mml:mo>-</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mi>&#x02250;</mml:mi><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:mtext>,</mml:mtext><mml:mo>-</mml:mo><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:mtext>,</mml:mtext><mml:mo>-</mml:mo><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p><p id="p0185"><bold>Step4:</bold> Reconstruct the matrix and get the confirming residual matrix <inline-formula><mml:math id="M33" altimg="si33.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced open="&#x02016;" close="&#x02016;"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mtext>,</mml:mtext><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mtext>,</mml:mtext><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="M34" altimg="si34.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mtext>,</mml:mtext><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&#x02190;</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mtext>,</mml:mtext><mml:mo>-</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:mtext>,</mml:mtext><mml:mo>-</mml:mo><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:mtext>,</mml:mtext><mml:mo>-</mml:mo><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:mtext>,</mml:mtext><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p id="p0190"><bold>Step5:</bold> Update the <inline-formula><mml:math id="M35" altimg="si35.gif" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">BCV</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02190;</mml:mo><mml:mi mathvariant="italic">BCV</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mfenced open="&#x02016;" close="&#x02016;"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mtext>,</mml:mtext><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mtext>,</mml:mtext><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s0030"><label>2.1.3</label><title>Other methodologies</title><p id="p0195">Apart from matrix factorization, a myriad of bicluster techniques have been proposed for gene expression data <xref rid="b0025" ref-type="bibr">[5]</xref>, <xref rid="b0055" ref-type="bibr">[11]</xref>. In this paper, the spectroscopic data (NMR or MS), rows represent the samples while columns represent variables, can be considered as a linear combination of metabolite peaks plus noise, which is corresponding to the biclusters with constant values on columns. For this reason, we compared our methods with the other biclustering techniques (e.g. Spectral <xref rid="b0045" ref-type="bibr">[9]</xref>, Plaid <xref rid="b0050" ref-type="bibr">[10]</xref>, BiMax <xref rid="b0055" ref-type="bibr">[11]</xref>, Xmotifs <xref rid="b0060" ref-type="bibr">[12]</xref>, ISA <xref rid="b0070" ref-type="bibr">[14]</xref> and FABIA <xref rid="b0080" ref-type="bibr">[16]</xref>) aimed at identifying constant columns.</p><p id="p0200">Among these methods, the algorithms required for rescaling or iteration (e.g., Spectral and ISA) have longer running time on large datasets; the algorithms with methodology based on the binary value (e.g., BiMax, Xmotifs) are more sensitive to the noise of the data. Besides ISA, the performance of these methods is likely affected by the overlap of biclusters. Furthermore, Plaid, ISA and FABIA are also suitable for other bicluster classes. Brief methodological overview and the references of these biclustering techniques are listed in the <xref rid="t0005" ref-type="table">Table 1</xref>.<table-wrap id="t0005" position="float"><label>Table 1</label><caption><p>The summary of methods for identifying biclusters with constant row or column on the gene expression datasets.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Algorithm</th><th>Methodology</th><th>Description</th></tr></thead><tbody><tr><td>BiMax <xref rid="b0055" ref-type="bibr">[11]</xref></td><td>Seeks the rectangles of &#x02018;1&#x02019;&#x02032;s in a binary matrix</td><td>Only suitable for the bicluster with constant up-regulated condition; sensitive to the noise and number of biclusters; affected by the overlap</td></tr><tr><td>Plaid <xref rid="b0050" ref-type="bibr">[10]</xref></td><td>Assume the bicluster is generated as the sum of a background effect, cluster effects, row effects, column effects and random noise</td><td>Both suitable for conditions of the bicluster with constant value and constant row/column; sensitive to the noise; affected by the overlap</td></tr><tr><td>Spectral <xref rid="b0045" ref-type="bibr">[9]</xref></td><td>Advantages over SVD spectral analysis of the original or rescaling raw data</td><td>Both suitable for conditions of the bicluster with constant up- or down- regulated condition; not sensitive to the noise; not suitable for the discrete datasets; limited in running speed on large datasets; affected by the overlap</td></tr><tr><td>Xmotifs <xref rid="b0060" ref-type="bibr">[12]</xref></td><td>A nondeterministic greedy algorithm that seeks biclusters with conserved rows/columns</td><td>Only suitable for conditions of the bicluster with constant row/column; required for dataset discretized and more sensitive to the noise; affected by the overlap limited in running speed on large datasets; affected by the overlap</td></tr><tr><td>FABIA <xref rid="b0080" ref-type="bibr">[16]</xref></td><td>Analysis for bicluster acquisition models the data matrix as the sum of biclusters plus additive noise, bicluster is the outer product of two sparse vectors</td><td>Both suitable for conditions of the bicluster with constant value and constant row/column; not sensitive to the noise and the number of biclusters; affected by the overlap</td></tr><tr><td>ISA <xref rid="b0070" ref-type="bibr">[14]</xref></td><td>A nondeterministic greedy algorithm that seeks biclusters from starting with a seed bicluster and re-running the iteration steps</td><td>Both suitable for conditions of the bicluster with constant value and constant row/column; not sensitive to the noise the number of biclusters, and the overlaps; limited in running speed on large datasets</td></tr></tbody></table></table-wrap></p></sec><sec id="s0035"><label>2.1.4</label><title>Evaluating measurement</title><p id="p0205">In this paper, we calculated the bicluster match score to evaluate the performance of biclsutering method, which was proposed by Prelic et al <xref rid="b0055" ref-type="bibr">[11]</xref>. Without loss of generality, assume that s assigns larger scores to similar biclusters and smaller scores to dissimilar ones. <inline-formula><mml:math id="M36" altimg="si36.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are two sets of biclusters and the bicluster match score of sample <inline-formula><mml:math id="M37" altimg="si37.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> can be calculated by the following equation:<disp-formula id="e0020"><label>(4)</label><mml:math id="M38" altimg="si38.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mfenced open="|" close="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mstyle><mml:mstyle displaystyle="true"><mml:munder><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mstyle><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mfenced open="|" close="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mfenced open="|" close="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:math></disp-formula>where <italic>b</italic><sub>1</sub>, <italic>b</italic><sub>2</sub> are biclusters in the set <inline-formula><mml:math id="M39" altimg="si36.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> respectively, <inline-formula><mml:math id="M40" altimg="si40.gif" overflow="scroll"><mml:mrow><mml:mrow><mml:mfenced open="|" close="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> is the number of data elements in their intersection, and <inline-formula><mml:math id="M41" altimg="si41.gif" overflow="scroll"><mml:mrow><mml:mrow><mml:mfenced open="|" close="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> is the number in their union. Similarity, the bicluster match score of variable <italic>S<sub>v</sub></italic> can be calculated as well. The overall bicluster match score can be defined as <inline-formula><mml:math id="M42" altimg="si42.gif" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>.</p><p id="p0210">Let <italic>E</italic> denote the ground truth bicluster set and <italic>F</italic> denote the set of found biclusters, the recovery score is <italic>S</italic>(<italic>E</italic>, <italic>F</italic>) and relevance score is <italic>S</italic>(<italic>F</italic>, <italic>E</italic>). If the recovery score <italic>S</italic> is maximized, it represents that the algorithm is found in all the expected biclusters. Similarly, if the relevance score <italic>S</italic> is maximized, all the found biclusters were expected.</p><p id="p0215">In this study, we develop a visualization graphical user interface and work on the spectroscopic dataset. The graphical user interface written in Matlab is available by contacting the corresponding author.</p></sec></sec></sec><sec id="s0040"><label>3</label><title>Results and discussion</title><sec id="s0045"><label>3.1</label><title>Evaluation of biclustering on the synthetic dataset</title><p id="p0220">We explored the bicluster model on the synthetic datasets. Firstly, we built a synthetic dataset with only 50 samples and 250 variables for observing the performance of biclustering methods. From the Eq. <xref rid="e0005" ref-type="disp-formula">(1)</xref>, we set the number of biclsuter <italic>k</italic>&#x0202f;=&#x0202f;3 with two of them having overlap. The value in each bilcuster is set as <inline-formula><mml:math id="M43" altimg="si43.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mtext>,</mml:mtext><mml:mn>2</mml:mn><mml:mtext>,</mml:mtext><mml:mo>&#x02026;</mml:mo><mml:mtext>,</mml:mtext><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, the typical value is set as the <inline-formula><mml:math id="M44" altimg="si44.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003bc;</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> meanwhile the noise level is set as <inline-formula><mml:math id="M45" altimg="si45.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mtext>,</mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. Considering the randomness of the realistic datasets from experiment, we randomly permuted the samples (rows) and variables (columns) of the dataset and generated the synthetic dataset 1 (<xref rid="f0010" ref-type="fig">Fig. 2</xref>). The heatmap of the original dataset before rows and columns randomly permutated with the noise level <inline-formula><mml:math id="M46" altimg="si46.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula>. After the permutation of the rows and columns of the synthetic dataset, we calculated the average bicluster match scores to evaluate the performance of different biclustering models. The scheme of NMF model is shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref>.<fig id="f0010"><label>Fig. 2</label><caption><p>General schema of the method NMF approximates the synthetic data 1(noise level <inline-formula><mml:math id="M47" altimg="si10.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow></mml:math></inline-formula>&#x0202f;=&#x0202f;0.25) as a product of two submatrices, W and H. BCV is used for predicted the number of biclusters and thresholding algorithm is used for the identifying the indicator of each bicluster.</p></caption><graphic xlink:href="gr2"/></fig></p><p id="p0225">We also observed the performance of the bicluster algorithm on a synthetic dataset (synthetic data 2) with 30 samples generated by MetAssimulo. MetAssimulo can create realistic metabolic profiles containing large numbers of metabolites with a range of user-defined properties based on the concentration information input by the user or constructed automatically from the Human Metabolome Database. In the present study, the overall number of metabolites is 48, the number of biclusters is set to 3, and the fold-change values of mean and standard deviation of the concentration of metabolites are either positive or negative. <xref rid="t0010" ref-type="table">Table 2</xref> provides the metabolites implanted of each bicluster. Importantly, considering the peak shift of the output of MetAssimulo, the spectroscopic data is required for alignment and normalization. Following the recursive segment-wise peak alignment model <xref rid="b0090" ref-type="bibr">[18]</xref> and logarithm transfer, we generated the synthetic dataset 2. As shown in the <xref rid="s0065" ref-type="sec">Fig. S1 (supplement file)</xref>, the NMF model selects the correct ID of samples and hippuric acid (positive fold change of mean NMR spectra) within the bicluster 1 from the chemical shifts <sup>1</sup>H ppm 7.50&#x02013;7.90.<table-wrap id="t0010" position="float"><label>Table 2</label><caption><p>Metabolites implanted of each bicluster in synthetic data 2 (the metabolites have the negative fold-change are in bold).</p></caption><table frame="hsides" rules="groups"><thead><tr><th>ID of bicluster</th><th>Metabolites in the bicluster</th></tr></thead><tbody><tr><td>1</td><td>Citric acid, Creatine, Succinic acid, Hippuric acid, Serine</td></tr><tr><td>2</td><td>Creatinine, Citric acid, Glycine, <bold>Formic acid</bold>, Trimethylamine, <bold>Hippuric acid</bold></td></tr><tr><td>3</td><td><bold>Creatinine, Formic acid</bold>, Taurine, Betaine, <bold>Guanidoacetic acid</bold>, Trimethylamine</td></tr></tbody></table></table-wrap></p><p id="p0230">Apart from our two synthetic datasets, we also used the simulation dataset generated for gene expression by Eren et al. <xref rid="b0035" ref-type="bibr">[7]</xref> to validate the characteristics of the bicluster models. The matrix contains 500 genes (rows), 200 conditions (columns), and each bicluster with 50 rows and 50 without the overlap.</p><p id="p0235">In this paper, we separately tested the performance of six classical biclustering models, i.e. Spectral <xref rid="b0045" ref-type="bibr">[9]</xref>, Plaid <xref rid="b0050" ref-type="bibr">[10]</xref>, BiMax <xref rid="b0055" ref-type="bibr">[11]</xref>, Xmotifs <xref rid="b0060" ref-type="bibr">[12]</xref>, ISA <xref rid="b0070" ref-type="bibr">[14]</xref> and FABIA <xref rid="b0080" ref-type="bibr">[16]</xref>, and three matrix factorization algorithms, i.e. PCA, NMF and sparse NMF(SNMF) <xref rid="b0125" ref-type="bibr">[25]</xref>. In matrix factorization algorithms, the number of biclusters could be predicted by BCV. Additionally, since the matrix factorization algorithms could only generate score and loading matrices, thresholding algorithms are utilized for selecting the samples and variables in each biclusters.</p><p id="p0240"><xref rid="f0015" ref-type="fig">Fig. 3</xref> summarises the relevance scores as a function of the number of biclusters and varying noise levels of the simulated datasets. We only represent the average relevance scores comparison but not the recovery score due to the similarity of both scores generated.<fig id="f0015"><label>Fig. 3</label><caption><p>The bicluster model experiment on the synthetic datasets. (A) The relevance score of bicluster methods on synthetic gene expression data <xref rid="b0035" ref-type="bibr">[7]</xref> with different noise level; (B) The relevance score of bicluster methods on synthetic gene expression data <xref rid="b0035" ref-type="bibr">[7]</xref> of the different number of biclusters; (C) The relevance score of bicluster methods on synthetic spectroscopic data 1 (<xref rid="f0010" ref-type="fig">Fig. 2</xref>) with different noise level; (D) The average relevance score of bicluster methods on synthetic spectroscopic data 1 (<xref rid="f0010" ref-type="fig">Fig. 2</xref>) the different number of biclusters. The methods: NMF (red circle), PCA (blue circle), Sparse NMF(green circle), BiMax(red triangle), Plaid(green triangle), Spectral(yellow triangle), Xmotifs(blue triangle), Fabia(magenta triangle) and ISA(cyan triangle. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></caption><graphic xlink:href="gr3"/></fig></p><p id="p0245">As expected, compared with six classical biclustering models, the matrix factorization methods have better robustness on the number of biclusters. It also validates the effectiveness of BCV prediction on the number of biclusters, which is an essential prerequisite for high quality performance. We tested the performance of six classical biclustering models and three matrix factorization algorithms on the simulation dataset of gene expression. The results of the average relevance scores for each bicluster model with different noise level and the number of biclusters are separately shown in the <xref rid="f0015" ref-type="fig">Fig. 3</xref>A and B. NMF achieves the highest relevance scores among the models, which validates the effectiveness of NMF model to identify the biclusters on the gene expression data. The methods Xmotif has the poorest performance on this dataset. With regards to the other methods, the performance of Plaid and FABIA is challenging as the number increased (<xref rid="f0015" ref-type="fig">Fig. 3</xref>B), whilst ISA and Spectral are negatively affected by the noise (<xref rid="f0015" ref-type="fig">Fig. 3</xref>A). However, as shown in the Figures, the SNMF is more sensitive to the noise than NMF. The reason is that the biclusters feature selection in sparse NMF is not based on the thresholding algorithm but on the sparseness of loading or score values, which is not stable in case of the overlap of the biclusters.</p><p id="p0250">On the synthetic dataset 1 of spectroscopic data, we tested the performance of the present nine algorithms as well. The plots of the average relevance scores for each bicluster model with different noise level and the number of biclusters are separately given in the <xref rid="f0015" ref-type="fig">Fig. 3</xref>C and D.</p><p id="p0255">As indicated in the <xref rid="f0015" ref-type="fig">Fig. 3</xref>C and D, the overall bicluster match scores of NMF and PCA are obviously highest among all the models. It indicates that the inherent clustering property of matrix factorization is more suitable for the spectroscopic data. As shown in the plot, the algorithms that seek local patterns (e.g., Xmotifs) are more sensitive to the noise, while the algorithms which fit a model of the entire dataset (e.g., ISA, Plaid) are less sensitive. Bimax, which is required for pre-processing of the data matrix into binary, has poor performance although it is effective on the gene expression synthetic datasets. In general, NMF has the best performance among all the algorithms on both synthetic datasets.</p></sec><sec id="s0050"><label>3.2</label><title>Evaluation of biclustering on the biological dataset</title><p id="p0260">We also explored the bicluster model on the MS dataset (negative ion) of nine bacterial species <xref rid="b0145" ref-type="bibr">[29]</xref>, <xref rid="b0150" ref-type="bibr">[30]</xref>. The clusters can be distinguished by the visualization of the first three principal components in the PCA (<xref rid="f0020" ref-type="fig">Fig. 4</xref>A) belonging to Gram-positive <italic>Streptococcus spp</italic>., <italic>Staphylococcus aureus</italic>, Gram-negative <italic>Pseudomonas aeruginosa</italic> and a group consisting of five species that are not separated from each other and that all belong to the Enterobacteriaceae family (<italic>Escherichia coli</italic>, <italic>Citrobacter koseri</italic>, <italic>Klebsiella pneumoniae</italic>, <italic>Serratia marcescens</italic>, and <italic>Proteus mirabilis</italic>). To observe the performance of different algorithms, the MS dataset consisted of 135 samples and 185,001&#x0202f;<italic>m</italic>/<italic>z</italic> ratios that can be replaced by a reduced dataset of peak-picked variables with 135 samples and 1964 variables. <xref rid="f0025" ref-type="fig">Fig. 5</xref> provides the NMF biclustering on this peak-picked dataset. If we reconstruct the selected bicluster, we will identify the samples and variables that are both associated in this bicluster.<fig id="f0020"><label>Fig. 4</label><caption><p>The bicluster model experiment on the bacteria MS spectra<xref rid="b0145" ref-type="bibr">[29]</xref>. (A) The 3-D PCA score plot of dataset. The species: <italic>C. koseri</italic> (red), <italic>K. pneumonia</italic> (green), <italic>P. mirabills</italic> (blue), <italic>S. aureus</italic> (magenta), <italic>S. pyogenes</italic> (yellow), <italic>E. coli</italic> (cyan), <italic>P. aeruginosa</italic> (black), <italic>S. agalactiae</italic> (brown), <italic>S. marcescens</italic> (orange); (B) The average recovery and relevance bicluster match score of different bicluster methods. The methods: NMF (red circle), PCA (blue circle), Sparse NMF(green circle), BiMax(red triangle), Plaid(green triangle), Spectral(yellow triangle), Xmotifs(blue triangle), Fabia(magenta triangle) and ISA(cyan triangle); (C) The running time of the algorithms running by 10 rounds on the peakpick dataset. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></caption><graphic xlink:href="gr4"/></fig><fig id="f0025"><label>Fig. 5</label><caption><p>The biclustering of bacteria MS peak-picked dataset using NMF: The right-bottom subplot shows the median of the MS spectra. The variables (right-bottom) associated with samples within the selected bicluster are separately marked with red. The left-top section of the plot indicates the log transform of fold change according to mean of the MS spectra. The left-bottom subplot represents the recovering of selected bicluster. The samples within the selected bicluster are marked with the magenta in the left colour bar. The right-top section of the plot represents the score and loading of the dataset and the comparison of thresholding algorithms: OTSU(red), FCM(magenta), Iter(cyan) and MaxEn(yellow). The horizontal axis (i.e. <italic>m</italic>/<italic>z</italic> ratio) of the subplot keeps in consistent with each other when selecting the compounds. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></caption><graphic xlink:href="gr5"/></fig></p><p id="p0265"><xref rid="f0020" ref-type="fig">Fig. 4</xref>B provides the overall prediction result on this MS dataset. It indicates that NMF achieves the highest bicluster match score on the metabolic data among the various methods. Moreover, NMF has the fastest speed among the various algorithms (<xref rid="f0020" ref-type="fig">Fig. 4</xref>C).</p><p id="p0270">With a special focus on the thresholding algorithms, OTSU <xref rid="b0130" ref-type="bibr">[26]</xref>, fuzzy c-means (FCM) <xref rid="b0135" ref-type="bibr">[27]</xref>, iterative selection (Iter) <xref rid="b0140" ref-type="bibr">[28]</xref> and maxime entropy (MaxEn) <xref rid="b0130" ref-type="bibr">[26]</xref> are utilized for finding the bicluster from the score and loading generated by the matrix factorization methods. We compared the bicluster match score of these thresholding methods on our synthetic datasets and the bacteria MS (peak-picking) dataset. As shown in <xref rid="t0015" ref-type="table">Table 3</xref>, the OTSU and Iter perform better than FCM and MaxEn. The performance of OTSU/Iter thresholding is still higher despite sparseness on the spectroscopic data, which validates our method (NMF with thresholding) as superior in recognizing the bicluster than SNMF.<table-wrap id="t0015" position="float"><label>Table 3</label><caption><p>The bicluster match score of matrix factorization by thresholding methods on the synthetic data1 (noise level <inline-formula><mml:math id="M48" altimg="si10.gif" overflow="scroll"><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow></mml:math></inline-formula>&#x0202f;=&#x0202f;0.25), synthetic data 2 and bacteria MS peak-pick dataset.</p></caption><table frame="hsides" rules="groups"><thead><tr><th><hr/></th><th>PCA<hr/></th><th><hr/></th><th><hr/></th><th>NMF<hr/></th><th><hr/></th><th><hr/></th></tr><tr><th>Thresholding</th><th>Synthetic data1</th><th>Synthetic data2</th><th>Bacteria MS data</th><th>Synthetic data1</th><th>Synthetic data2</th><th>Bacteria MS data</th></tr></thead><tbody><tr><td>OTSU</td><td>0.72</td><td>0.61</td><td>0.36</td><td>0.91</td><td>0.79</td><td>0.99</td></tr><tr><td>FCM</td><td>0.65</td><td>0.53</td><td>0.44</td><td>0.62</td><td>0.61</td><td>0.87</td></tr><tr><td>Iter</td><td>0.72</td><td>0.61</td><td>0.28</td><td>0.85</td><td>0.77</td><td>0.99</td></tr><tr><td>MaxEn</td><td>0.57</td><td>0.59</td><td>0.23</td><td>0.61</td><td>0.60</td><td>0.47</td></tr></tbody></table></table-wrap></p><p id="p0275">The biclustering method is more useful on the MS dataset with sharp peaks and big signal-to-noise ratio than NMR data. Here, the bacterial dataset contains hundreds of unique spectral features with the signal to noise ratios (SNR) in the order of 10,000 times. High correlation between discriminating signals in each member of the same group. Moreover, the bacterial dataset has a hierarchical structure with the difference between Gram positive and Gramnegative bacteria (family level), representing where most the variance in the global data lies. With NMF (as with k-means), the number of output vectors (factors) is predefined, so the hierarchical nature is bypassed.</p></sec></sec><sec id="s0055"><label>4</label><title>Conclusions</title><p id="p0280">Spectroscopic data commonly contains around a thousand peaks from possibly hundreds of metabolites, is widely used in metabolomics to provide information on metabolite profiles of complex biological mixtures. This work represents a matrix factorization based biclustering model of spectroscopic data. In this paper, we use a novel bi-cross validation to decide the number of factors in the spectroscopic data matrix factorization tools. The simple thresholding methods (e.g., NMF) are used to transfer the spectroscopic data into two matrices. In this paper, we make the comparison among the various bi-clustering schemes on the simulation dataset, and the conclusion is that the simple matrix factorization tool is superior. Moreover, we develop a visualization graphical user interface and work on the bacterial dataset examples to test our biclustering model. The results demonstrate that the proposed matrix factorization based method for biclustering is useful for spectroscopic data. The future work would include the application of the proposed biclustering method on other biological datasets such as gene expression datasets.</p></sec></body><back><ref-list id="bi005"><title>References</title><ref id="b0005"><label>1</label><element-citation publication-type="journal" id="h0005"><person-group person-group-type="author"><name><surname>Dumas</surname><given-names>M.-E.</given-names></name><name><surname>Wilder</surname><given-names>S.P.</given-names></name><name><surname>Bihoreau</surname><given-names>M.-T.</given-names></name><name><surname>Barton</surname><given-names>R.H.</given-names></name><name><surname>Fearnside</surname><given-names>J.F.</given-names></name></person-group><article-title>Direct quantitative trait locus mapping of mammalian metabolic phenotypes in diabetic and normoglycemic rat models</article-title><source>Nat. Genet.</source><volume>39</volume><year>2007</year><fpage>666</fpage><lpage>672</lpage><pub-id pub-id-type="pmid">17435758</pub-id></element-citation></ref><ref id="b0010"><label>2</label><element-citation publication-type="journal" id="h0010"><person-group person-group-type="author"><name><surname>Nicholson</surname><given-names>J.K.</given-names></name><name><surname>Holmes</surname><given-names>E.</given-names></name><name><surname>Kinross</surname><given-names>J.M.</given-names></name><name><surname>Darzi</surname><given-names>A.W.</given-names></name><name><surname>Takats</surname><given-names>Z.</given-names></name></person-group><article-title>Metabolic phenotyping in clinical and surgical environments</article-title><source>Nature</source><volume>491</volume><year>2012</year><fpage>384</fpage><lpage>392</lpage><pub-id pub-id-type="pmid">23151581</pub-id></element-citation></ref><ref id="b0015"><label>3</label><element-citation publication-type="journal" id="h0015"><person-group person-group-type="author"><name><surname>Blaise</surname><given-names>B.J.</given-names></name><name><surname>Shintu</surname><given-names>L.</given-names></name><name><surname>Elena</surname><given-names>B.</given-names></name><name><surname>Emsley</surname><given-names>L.</given-names></name><name><surname>Dumas</surname><given-names>M.-E.</given-names></name></person-group><article-title>Statistical recoupling prior to significance testing in nuclear magnetic resonance based metabonomics</article-title><source>Anal. Chem.</source><volume>81</volume><year>2009</year><fpage>6242</fpage><lpage>6251</lpage><pub-id pub-id-type="pmid">19585975</pub-id></element-citation></ref><ref id="b0020"><label>4</label><element-citation publication-type="journal" id="h0020"><person-group person-group-type="author"><name><surname>Dumas</surname><given-names>M.E.</given-names></name><name><surname>Rothwell</surname><given-names>A.R.</given-names></name><name><surname>Hoyles</surname><given-names>L.</given-names></name><name><surname>Aranias</surname><given-names>T.</given-names></name><name><surname>Chilloux</surname><given-names>J.</given-names></name></person-group><article-title>Microbial-host co-metabolites are prodromal markers predicting phenotypic heterogeneity in behavior, obesity, and impaired glucose tolerance</article-title><source>Cell. Rep.</source><volume>20</volume><year>2017</year><fpage>136</fpage><lpage>148</lpage><pub-id pub-id-type="pmid">28683308</pub-id></element-citation></ref><ref id="b0025"><label>5</label><element-citation publication-type="journal" id="h0025"><person-group person-group-type="author"><name><surname>Madeira</surname><given-names>S.C.</given-names></name><name><surname>Oliveira</surname><given-names>A.L.</given-names></name></person-group><article-title>Biclustering algorithms for biological data analysis: a survey</article-title><source>Ieeeacm Trans. Comput. Biol. Bioinform.</source><volume>1</volume><year>2004</year><fpage>24</fpage><lpage>45</lpage></element-citation></ref><ref id="b0030"><label>6</label><element-citation publication-type="journal" id="h0030"><person-group person-group-type="author"><name><surname>Tanay</surname><given-names>A.</given-names></name><name><surname>Sharan</surname><given-names>R.</given-names></name><name><surname>Shamir</surname><given-names>R.</given-names></name></person-group><article-title>Discovering statistically significant biclusters in gene expression data</article-title><source>Bioinformatics</source><volume>18</volume><year>2002</year><fpage>S136</fpage><lpage>S144</lpage><pub-id pub-id-type="pmid">12169541</pub-id></element-citation></ref><ref id="b0035"><label>7</label><element-citation publication-type="journal" id="h0035"><person-group person-group-type="author"><name><surname>Eren</surname><given-names>K.</given-names></name><name><surname>Deveci</surname><given-names>M.</given-names></name><name><surname>K&#x000fc;&#x000e7;&#x000fc;ktun&#x000e7;</surname><given-names>O.</given-names></name><name><surname>&#x000c7;ataly&#x000fc;rek</surname><given-names>&#x000dc;.V.</given-names></name></person-group><article-title>A comparative analysis of biclustering algorithms for gene expression data</article-title><source>Brief Bioinform.</source><volume>14</volume><year>2013</year><fpage>279</fpage><lpage>292</lpage><pub-id pub-id-type="pmid">22772837</pub-id></element-citation></ref><ref id="b0040"><label>8</label><element-citation publication-type="journal" id="h0040"><person-group person-group-type="author"><name><surname>Cheng</surname><given-names>Y.</given-names></name><name><surname>Church</surname><given-names>G.M.</given-names></name></person-group><article-title>Biclustering of expression data</article-title><source>Proc. Int. Conf. Intell. Syst. Mol. Biol. Ismb. Int. Conf. Intell. Syst. Mol. Biol.</source><volume>8</volume><year>2000</year><fpage>93</fpage><lpage>103</lpage></element-citation></ref><ref id="b0045"><label>9</label><element-citation publication-type="journal" id="h0045"><person-group person-group-type="author"><name><surname>Kluger</surname><given-names>Y.</given-names></name><name><surname>Basri</surname><given-names>R.</given-names></name><name><surname>Chang</surname><given-names>J.T.</given-names></name><name><surname>Gerstein</surname><given-names>M.</given-names></name></person-group><article-title>Spectral biclustering of microarray data: coclustering genes and conditions</article-title><source>Genome Res.</source><volume>13</volume><year>2003</year><fpage>703</fpage><lpage>716</lpage><pub-id pub-id-type="pmid">12671006</pub-id></element-citation></ref><ref id="b0050"><label>10</label><element-citation publication-type="journal" id="h0050"><person-group person-group-type="author"><name><surname>Turner</surname><given-names>H.L.</given-names></name><name><surname>Bailey</surname><given-names>T.C.</given-names></name><name><surname>Krzanowski</surname><given-names>W.J.</given-names></name><name><surname>Hemingway</surname><given-names>C.A.</given-names></name></person-group><article-title>Biclustering models for structured microarray data</article-title><source>Ieeeacm Trans. Comput. Biol. Bioinform. Ieee Acm.</source><volume>2</volume><year>2005</year><fpage>316</fpage><lpage>329</lpage></element-citation></ref><ref id="b0055"><label>11</label><element-citation publication-type="journal" id="h0055"><person-group person-group-type="author"><name><surname>Preli&#x00107;</surname><given-names>A.</given-names></name><name><surname>Bleuler</surname><given-names>S.</given-names></name><name><surname>Zimmermann</surname><given-names>P.</given-names></name><name><surname>Wille</surname><given-names>A.</given-names></name><name><surname>B&#x000fc;hlmann</surname><given-names>P.</given-names></name></person-group><article-title>A systematic comparison and evaluation of biclustering methods for gene expression data</article-title><source>Bioinformatics</source><volume>22</volume><year>2006</year><fpage>1122</fpage><lpage>1129</lpage><pub-id pub-id-type="pmid">16500941</pub-id></element-citation></ref><ref id="b0060"><label>12</label><element-citation publication-type="journal" id="h0060"><person-group person-group-type="author"><name><surname>Murali</surname><given-names>T.M.</given-names></name><name><surname>Kasif</surname><given-names>S.</given-names></name></person-group><article-title>Extracting conserved gene expression motifs from gene expression data</article-title><source>Pac. Symp. Biocomput. Pac. Symp. Biocomput.</source><year>2003</year><fpage>77</fpage><lpage>88</lpage><pub-id pub-id-type="pmid">12603019</pub-id></element-citation></ref><ref id="b0065"><label>13</label><element-citation publication-type="journal" id="h0065"><person-group person-group-type="author"><name><surname>Ben-Dor</surname><given-names>A.</given-names></name><name><surname>Chor</surname><given-names>B.</given-names></name><name><surname>Karp</surname><given-names>R.</given-names></name><name><surname>Yakhini</surname><given-names>Z.</given-names></name></person-group><article-title>Discovering local structure in gene expression data: the order-preserving submatrix problem</article-title><source>J. Comput. Biol. J. Comput. Mol. Cell. Biol.</source><volume>10</volume><year>2003</year><fpage>373</fpage><lpage>384</lpage></element-citation></ref><ref id="b0070"><label>14</label><element-citation publication-type="journal" id="h0070"><person-group person-group-type="author"><name><surname>Bergmann</surname><given-names>S.</given-names></name><name><surname>Ihmels</surname><given-names>J.</given-names></name><name><surname>Barkai</surname><given-names>N.</given-names></name></person-group><article-title>Iterative signature algorithm for the analysis of large-scale gene expression data</article-title><source>Phys. Rev. E Stat. Nonlin Soft Matter. Phys.</source><volume>67</volume><year>2003</year><fpage>031902</fpage><pub-id pub-id-type="pmid">12689096</pub-id></element-citation></ref><ref id="b0075"><label>15</label><element-citation publication-type="journal" id="h0075"><person-group person-group-type="author"><name><surname>Li</surname><given-names>G.</given-names></name><name><surname>Ma</surname><given-names>Q.</given-names></name><name><surname>Tang</surname><given-names>H.</given-names></name><name><surname>Paterson</surname><given-names>A.H.</given-names></name><name><surname>Xu</surname><given-names>Y.</given-names></name></person-group><article-title>QUBIC: a qualitative biclustering algorithm for analyses of gene expression data</article-title><source>Nucleic Acids Res.</source><volume>37</volume><year>2009</year><fpage>e101</fpage><pub-id pub-id-type="pmid">19509312</pub-id></element-citation></ref><ref id="b0080"><label>16</label><element-citation publication-type="journal" id="h0080"><person-group person-group-type="author"><name><surname>Hochreiter</surname><given-names>S.</given-names></name><name><surname>Bodenhofer</surname><given-names>U.</given-names></name><name><surname>Heusel</surname><given-names>M.</given-names></name><name><surname>Mayr</surname><given-names>A.</given-names></name><name><surname>Mitterecker</surname><given-names>A.</given-names></name></person-group><article-title>FABIA: factor analysis for bicluster acquisition</article-title><source>Bioinform. Oxf. Engl.</source><volume>26</volume><year>2010</year><fpage>1520</fpage><lpage>1527</lpage></element-citation></ref><ref id="b0085"><label>17</label><element-citation publication-type="journal" id="h0085"><person-group person-group-type="author"><name><surname>Owen</surname><given-names>A.B.</given-names></name><name><surname>Perry</surname><given-names>P.O.</given-names></name></person-group><article-title>Bi-cross-validation of the SVD and the nonnegative matrix factorization</article-title><source>Ann. Appl. Stat.</source><volume>3</volume><year>2009</year><fpage>564</fpage><lpage>594</lpage></element-citation></ref><ref id="b0090"><label>18</label><element-citation publication-type="journal" id="h0090"><person-group person-group-type="author"><name><surname>Veselkov</surname><given-names>K.A.</given-names></name><name><surname>Lindon</surname><given-names>J.C.</given-names></name><name><surname>Ebbels</surname><given-names>T.M.D.</given-names></name><name><surname>Crockford</surname><given-names>D.</given-names></name><name><surname>Volynkin</surname><given-names>V.V.</given-names></name></person-group><article-title>Recursive segment-wise peak alignment of biological (1)h NMR spectra for improved metabolic biomarker recovery</article-title><source>Anal. Chem.</source><volume>81</volume><year>2009</year><fpage>56</fpage><lpage>66</lpage><pub-id pub-id-type="pmid">19049366</pub-id></element-citation></ref><ref id="b0095"><label>19</label><element-citation publication-type="journal" id="h0095"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>D.D.</given-names></name><name><surname>Seung</surname><given-names>H.S.</given-names></name></person-group><article-title>Learning the parts of objects by non-negative matrix factorization</article-title><source>Nature</source><volume>401</volume><year>1999</year><fpage>788</fpage><lpage>791</lpage><pub-id pub-id-type="pmid">10548103</pub-id></element-citation></ref><ref id="b0100"><label>20</label><element-citation publication-type="journal" id="h0100"><person-group person-group-type="author"><name><surname>Carmona-Saez</surname><given-names>P.</given-names></name><name><surname>Pascual-Marqui</surname><given-names>R.D.</given-names></name><name><surname>Tirado</surname><given-names>F.</given-names></name><name><surname>Carazo</surname><given-names>J.M.</given-names></name><name><surname>Pascual-Montano</surname><given-names>A.</given-names></name></person-group><article-title>Biclustering of gene expression data by non-smooth non-negative matrix factorization</article-title><source>BMC Bioinf.</source><volume>7</volume><year>2006</year><fpage>78</fpage></element-citation></ref><ref id="b0105"><label>21</label><element-citation publication-type="journal" id="h0105"><person-group person-group-type="author"><name><surname>Brunet</surname><given-names>J.-P.</given-names></name><name><surname>Tamayo</surname><given-names>P.</given-names></name><name><surname>Golub</surname><given-names>T.R.</given-names></name><name><surname>Mesirov</surname><given-names>J.P.</given-names></name></person-group><article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title><source>Proc. Natl. Acad. Sci. USA</source><volume>101</volume><year>2004</year><fpage>4164</fpage><lpage>4169</lpage><pub-id pub-id-type="pmid">15016911</pub-id></element-citation></ref><ref id="b0110"><label>22</label><element-citation publication-type="journal" id="h0110"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>P.M.</given-names></name><name><surname>Tidor</surname><given-names>B.</given-names></name></person-group><article-title>Subsystem identification through dimensionality reduction of large-scale gene expression data</article-title><source>Genome Res.</source><volume>13</volume><year>2003</year><fpage>1706</fpage><lpage>1718</lpage><pub-id pub-id-type="pmid">12840046</pub-id></element-citation></ref><ref id="b0115"><label>23</label><element-citation publication-type="journal" id="h0115"><person-group person-group-type="author"><name><surname>Nicholson</surname><given-names>J.K.</given-names></name><name><surname>Connelly</surname><given-names>J.</given-names></name><name><surname>Lindon</surname><given-names>J.C.</given-names></name><name><surname>Holmes</surname><given-names>E.</given-names></name></person-group><article-title>Metabonomics: a platform for studying drug toxicity and gene function</article-title><source>Nat. Rev. Drug Discov.</source><volume>1</volume><year>2002</year><fpage>153</fpage><lpage>161</lpage><pub-id pub-id-type="pmid">12120097</pub-id></element-citation></ref><ref id="b0120"><label>24</label><element-citation publication-type="journal" id="h0120"><person-group person-group-type="author"><name><surname>Muncey</surname><given-names>H.J.</given-names></name><name><surname>Jones</surname><given-names>R.</given-names></name><name><surname>Iorio</surname><given-names>M.D.</given-names></name><name><surname>Ebbels</surname><given-names>T.M.</given-names></name></person-group><article-title>MetAssimulo: simulation of realistic NMR metabolic profiles</article-title><source>BMC Bioinf.</source><volume>11</volume><year>2010</year><fpage>496</fpage></element-citation></ref><ref id="b0125"><label>25</label><element-citation publication-type="journal" id="h0125"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>H.</given-names></name><name><surname>Park</surname><given-names>H.</given-names></name></person-group><article-title>Sparse non-negative matrix factorizations via alternating non-negativity-constrained least squares for microarray data analysis</article-title><source>Bioinformatics</source><volume>23</volume><year>2007</year><fpage>1495</fpage><lpage>1502</lpage><pub-id pub-id-type="pmid">17483501</pub-id></element-citation></ref><ref id="b0130"><label>26</label><element-citation publication-type="journal" id="h0130"><person-group person-group-type="author"><name><surname>Sezgin</surname><given-names>M.</given-names></name><name><surname>Sankur</surname><given-names>B.</given-names></name></person-group><article-title>Survey over image thresholding techniques and quantitative performance evaluation</article-title><source>J. Electron. Imaging</source><volume>13</volume><year>2004</year><fpage>146</fpage><lpage>168</lpage></element-citation></ref><ref id="b0135"><label>27</label><element-citation publication-type="journal" id="h0135"><person-group person-group-type="author"><name><surname>Demb&#x000e9;l&#x000e9;</surname><given-names>D.</given-names></name><name><surname>Kastner</surname><given-names>P.</given-names></name></person-group><article-title>Fuzzy C-means method for clustering microarray data</article-title><source>Bioinformatics</source><volume>19</volume><year>2003</year><fpage>973</fpage><lpage>980</lpage><pub-id pub-id-type="pmid">12761060</pub-id></element-citation></ref><ref id="b0140"><label>28</label><element-citation publication-type="journal" id="h0140"><person-group person-group-type="author"><name><surname>Trussell</surname><given-names>H.J.</given-names></name></person-group><article-title>Comments on &#x0201c;picture thresholding using an iterative selection method&#x0201d;</article-title><source>Ieee Trans. Syst. Man. Cybern.</source><volume>9</volume><year>1979</year><fpage>311</fpage></element-citation></ref><ref id="b0145"><label>29</label><element-citation publication-type="journal" id="h0145"><person-group person-group-type="author"><name><surname>Strittmatter</surname><given-names>N.</given-names></name><name><surname>Jones</surname><given-names>E.A.</given-names></name><name><surname>Veselkov</surname><given-names>K.A.</given-names></name><name><surname>Rebec</surname><given-names>M.</given-names></name><name><surname>Bundy</surname><given-names>J.G.</given-names></name></person-group><article-title>Analysis of intact bacteria using rapid evaporative ionisation mass spectrometry</article-title><source>Chem. Commun.</source><volume>49</volume><year>2013</year><fpage>6188</fpage><lpage>6190</lpage></element-citation></ref><ref id="b0150"><label>30</label><element-citation publication-type="journal" id="h0150"><person-group person-group-type="author"><name><surname>Galea</surname><given-names>D.</given-names></name><name><surname>Inglese</surname><given-names>P.</given-names></name><name><surname>Cammack</surname><given-names>L.</given-names></name><name><surname>Strittmatter</surname><given-names>N.</given-names></name><name><surname>Rebec</surname><given-names>M.</given-names></name></person-group><article-title>Translational utility of a hierarchical classification strategy in biomolecular data analytics</article-title><source>Sci. Rep.</source><volume>7</volume><year>2017</year><fpage>14981</fpage><pub-id pub-id-type="pmid">29101330</pub-id></element-citation></ref></ref-list><sec id="s0065" sec-type="supplementary-material"><label>Appendix A</label><title>Supplementary data</title><p id="p0295"><supplementary-material content-type="local-data" id="m0005"><caption><title>Supplementary data 1</title></caption><media xlink:href="mmc1.docx"/></supplementary-material></p></sec><ack id="ak005"><title>Acknowledgments</title><p>We acknowledge the financial support for bioinformatics developments as part of <funding-source id="gp005">MRC</funding-source> (MC_UU_12014/12), <funding-source id="gp010">BBSRC</funding-source> (BB/L020858/1) and <funding-source id="gp035">EU-METASPACE</funding-source> (34402) projects; KV acknowledges Waters corporation for funding and support throughout this study. Dr Sacheen Kumar (Division of Surgery, <funding-source id="gp020">Imperial College London</funding-source>) is acknowledged for his advice and discussion. We acknowledge Prof Zoltan Takats from the Division of Computational and Systems Medicine, Imperial College London for the previous release and publication of the bacterial datasets as part of the above referenced BBSRC project <xref rid="b0150" ref-type="bibr">[30]</xref>. Dr Tim Ebbels from the Division of Computational and Systems Medicine, Imperial College London is acknowledged for giving an access to the MetAssimulo package for the simulation of NMR datasets of complex chemical mixture.</p></ack><fn-group><fn id="s0060" fn-type="supplementary-material"><label>Appendix A</label><p id="p0290">Supplementary data associated with this article can be found, in the online version, at <ext-link ext-link-type="doi" xlink:href="10.1016/j.ymeth.2018.02.004" id="ir005">https://doi.org/10.1016/j.ymeth.2018.02.004</ext-link>.</p></fn></fn-group></back></article>