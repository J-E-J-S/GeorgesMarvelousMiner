<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?all-math-mml yes?><?use-mml?><?properties open_access?><?properties manuscript?><?origin nihpa?><?iso-abbr Nat. Methods?><?submitter-system nihms?><?submitter-canonical-name Nature Publishing Group?><?submitter-canonical-id NATURE-STRUCTUR?><?submitter-userid 8068858?><?submitter-authority myNCBI?><?submitter-login nature-structure?><?submitter-name Nature Publishing Group?><?domain nihpa?><front><journal-meta><journal-id journal-id-type="nlm-journal-id">101215604</journal-id><journal-id journal-id-type="pubmed-jr-id">32338</journal-id><journal-id journal-id-type="nlm-ta">Nat Methods</journal-id><journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id><journal-title-group><journal-title>Nature methods</journal-title></journal-title-group><issn pub-type="ppub">1548-7091</issn><issn pub-type="epub">1548-7105</issn></journal-meta><article-meta><article-id pub-id-type="pmcid">6341484</article-id><article-id pub-id-type="pmid">30013044</article-id><article-id pub-id-type="doi">10.1038/s41592-018-0054-7</article-id><article-id pub-id-type="manuscript">nihpa970889</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>A synthetic-diploid benchmark for accurate variant calling evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Li</surname><given-names>Heng</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref rid="CR1" ref-type="corresp">&#x02020;</xref></contrib><contrib contrib-type="author"><name><surname>Bloom</surname><given-names>Jonathan M</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Farjoun</surname><given-names>Yossi</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Fleharty</surname><given-names>Mark</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Gauthier</surname><given-names>Laura</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Neale</surname><given-names>Benjamin</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref rid="CR1" ref-type="corresp">&#x02020;</xref></contrib><contrib contrib-type="author"><name><surname>MacArthur</surname><given-names>Daniel</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref rid="CR1" ref-type="corresp">&#x02020;</xref></contrib></contrib-group><aff id="A1"><label>1</label>Broad Institute of Harvard and MIT, Cambridge, MA 02142, USA</aff><aff id="A2"><label>2</label>Analytic and Translational Genetics Unit, Massachusetts General Hospital, Boston, MA 02114, USA</aff><author-notes><fn fn-type="con" id="FN1"><p id="P1"><bold>Author Contributions.</bold> H.L. conceived the study, constructed the benchmark dataset and drafted the manuscript. H.L., J.M.B. and Y.F. designed the experiment. L.G. and M.F. analyzed the data and applied the benchmark. D.M. and B.N. supervised the project. All authors helped to revise the manuscript.</p></fn><corresp id="CR1"><label>&#x02020;</label> To whom correspondence should be addressed. <email>hengli@broadinstitute.org</email>, <email>bneale@broadinstitute.org</email> and <email>danmac@broadinstitute.org</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>8</day><month>11</month><year>2018</year></pub-date><pub-date pub-type="epub"><day>16</day><month>7</month><year>2018</year></pub-date><pub-date pub-type="ppub"><month>8</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>22</day><month>1</month><year>2019</year></pub-date><volume>15</volume><issue>8</issue><fpage>595</fpage><lpage>597</lpage><!--elocation-id from pubmed: 10.1038/s41592-018-0054-7--><permissions><license><license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:<ext-link ext-link-type="uri" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</ext-link></license-p></license></permissions><abstract id="ABS1"><p id="P2">Constructed from the consensus of short-read variant callers, existing benchmark datasets for evaluating variant calling accuracy are biased toward easy regions accessible by known algorithms. We derived a new benchmark dataset from the <italic>de novo</italic> PacBio assemblies of two human cell lines that are homozygous across the whole genome. It provides a more accurate and less biased estimate of the error rate of small variant calls in a realistic context.</p></abstract></article-meta></front><body><p id="P3">Calling genomic sequence variations from resequencing data plays an important role in medical and population genetics, and has become an active research area since the advent of high-throughput sequencing. Many methods have been developed for calling single-nucleotide polymorphisms (SNPs) and short insertions/deletions (INDELs) primarily from short-read data. To measure the accuracy of these methods and ultimately to make accurate variant calls, one typically runs a variant calling pipeline on benchmark datasets where the true variant calls are known. The most widely used benchmark datasets include Genome In A Bottle<sup><xref rid="R1" ref-type="bibr">1</xref></sup> (GIAB) and Platinum Genome<sup><xref rid="R2" ref-type="bibr">2</xref></sup> (PlatGen) for the human sample NA12878. Both come with a set of high-quality variants and a set of confident regions where non-variant sites are deemed to be identical to the reference genome. These two datasets were constructed from the consensus of multiple short-read variant callers, with consideration of pedigree information or structural variations (SVs) found with long-fragment technologies by PacBio or 10X Genomics. A major concern with GIAB and PlatGen is that the sequencing technologies and the variant calling algorithms used to construct the data sets are the same as the ones used for testing. This strong correlation leads to biases in two subtle ways. First, variant calling with short reads is intrinsically difficult in regions with moderately diverged repeats and segmental duplications. We have to exclude such regions from the confident regions as different variant callers fail to reach consensus there. This biases GIAB and PlatGen toward &#x0201c;easy&#x0201d; genomic regions. In fact, both benchmark datasets conclude competent variant callers make a SNP error every few million bases (<xref rid="F1" ref-type="fig">Figure 1a</xref>), while other work suggests we can only achieve an error rate of one per 100&#x02013;200 thousand bases in wider genomic regions<sup><xref rid="R3" ref-type="bibr">3</xref></sup>, nearly an order of magnitude higher. The bias toward easy regions directs the progress in the field to focus on trivial errors while overlooking the major error modes in real applications. Second, as GIAB and PlatGen were constructed using the existing algorithms, they may penalize more advanced algorithms and hamper future method development. These caveats suggest we can only comprehensively evaluate the accuracy of short-read variant calling by constructing benchmark datasets with methods largely orthogonal to and more powerful than short-read sequencing technologies and variant calling algorithms.</p><p id="P4">It may be tempting to construct a new benchmark dataset from a whole genome assembly based on PacBio data<sup><xref rid="R4" ref-type="bibr">4</xref></sup>. However, recent work shows that while PacBio assembly is accurate at the base-pair level for haploid genomes<sup><xref rid="R5" ref-type="bibr">5</xref></sup>, it is not accurate enough to confidently call heterozygotes in diploid mammalian genomes<sup><xref rid="R6" ref-type="bibr">6</xref></sup>. To derive a comprehensive truth dataset, we turned to the <italic>de novo</italic> PacBio assemblies of two complete hydatidiform mole (CHM) cell lines<sup><xref rid="R7" ref-type="bibr">7</xref>,<xref rid="R8" ref-type="bibr">8</xref></sup>. CHM cell lines are almost completely homozygous across the whole genome. This homozygosity enables accurate PacBio consensus sequences of each cell line in two ways. First, the PacBio consensus tool works better with homozygous sequences. Second, we can identify and mask PacBio errors by mapping Illumina short-read contigs to the PacBio contigs. Because for each CHM sample we are calling small base changes on a single haplotype, we can avoid most artifacts in diploid variant calling against a reference genome, which involves three haplotypes and complex genetic variations beyond the capability of short reads.</p><p id="P5">Using the error-masked contigs of each cell line, we combined the two homozygous calls at each locus into a synthetic diploid call, resulting in the new phased benchmark dataset: Syndip (synthetic diploid; <xref rid="F1" ref-type="fig">Figure 1</xref>). This callset consists of 3.57 million SNPs and 0.58 million INDELs in 2.71 gigabases (Gbp) of confident regions, covering 95.5% of the autosomes and X chromosome of GRCh37 excluding assembly gaps.</p><p id="P6">In order to compare Syndip with existing benchmarks and re-evaluate popular short-read variant callers, we evenly mixed DNA from the two CHM cell lines and sequenced the mix with Illumina HiSeq X Ten (<xref rid="F1" ref-type="fig">Figure 1</xref>). By counting supporting reads at heterozygous SNPs after variant calling, we estimated 50.7% of DNA in the mixture comes from one cell line and 49.3% from the other, concluding that the mixture is a good representative of a naturally diploid sample. We mapped the reads from the synthetic-diploid samples to the human genome with BWA-MEM-0.7.15<sup><xref rid="R9" ref-type="bibr">9</xref></sup>, Bowtie2&#x02013;2.2.2<sup><xref rid="R10" ref-type="bibr">10</xref></sup> and minimap2&#x02013;2.5<sup><xref rid="R11" ref-type="bibr">11</xref></sup>, and called variants on the synthetic-diploid samples with FreeBayes-1.0.2<sup><xref rid="R12" ref-type="bibr">12</xref></sup>, Platypus- 0.8.1<sup><xref rid="R13" ref-type="bibr">13</xref></sup>, Samtools-1.3<sup><xref rid="R14" ref-type="bibr">14</xref></sup> and GATK-3.5<sup><xref rid="R15" ref-type="bibr">15</xref></sup>, including the HaplotypeCaller (HC) and UnifiedGenotyper (UG) algorithms. We included multiple variant callers to avoid overemphasizing caller-specific effects. We optionally filtered the initial variant calls with the following rules<sup><xref rid="R3" ref-type="bibr">3</xref></sup>: 1) variant quality &#x02265; 30; 2) read depth at the variant is below <inline-formula><mml:math display="inline" id="M1" overflow="scroll"><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msqrt><mml:mi>d</mml:mi></mml:msqrt></mml:math></inline-formula> with <italic>d</italic> being the average read depth; 3) the fraction of reads supporting the variant allele &#x02265; 30% of total read depth at the variant; 4) Fisher strand p-value &#x02265;0.001; 5) the variant allele is supported by at least one read from each strand.</p><p id="P7">We used RTG&#x02019;s vcfeval<sup><xref rid="R16" ref-type="bibr">16</xref></sup> to evaluate the variant calling accuracy. Given a truth and a test callset, a <italic>true positive</italic> (TP) is a true allele found in the test callset; a <italic>false negative</italic> (FN) is a true allele not found in the test callset; a <italic>false positive</italic> (FP) is an allele in the test callset not found in the truth set. We define %FNR=100&#x000d7;FN/(TP+FN) and FPPM=10<sup>6</sup>&#x000d7;FP/<italic>L</italic>, where <italic>L</italic> is the total length of confident regions. We took FPPM as a metric instead of the more widely used metric &#x0201c;precision&#x0201d; [=TP/(TP+FN)], because FPPM does not depend on the rate of variation and is thus comparable across datasets of different populations or species.</p><p id="P8"><xref rid="F2" ref-type="fig">Figure 2</xref> shows the results of evaluating variant calling pipelines with various benchmarks and conditions. <xref rid="F2" ref-type="fig">Figure 2a</xref> reveals that the FPPM of SNPs estimated from Syndip is often 5&#x02013;10 times higher than FPPM estimated from GIAB or PlatGen. Looking into the Syndip FP SNPs, we found most of them are located in CNVs that are evident in PacBio data in the context of long flanking regions, but look dubious in short-read data alone. GIAB-3.3.2 and PlatGen-1.0 exclude these false positives from the truth variant set based on the pedigree information or orthogonal data. However, in real applications, we often only have access to Illumina data and thus cannot achieve the accuracy suggested by the two benchmark datasets.</p><p id="P9">In our evaluation, we used post-filtered variant calls instead of raw calls. For GATK-HC, filtering reduces sensitivity by only 0.5%, but reduces the number of FPs by four folds (<xref rid="F2" ref-type="fig">Figure 2c</xref>), reduces the number of coding SNPs absent from the 1000 Genomes Project<sup><xref rid="R17" ref-type="bibr">17</xref></sup> by 58%, and reduces the number of loss-of-function (LoF) calls by 30%. We manually inspected 20 filtered LoF calls in IGV<sup><xref rid="R18" ref-type="bibr">18</xref></sup> and confirmed that all of them are either false positives or fall outside confident regions; those outside confident regions look spurious as well. False positives are enriched among LoF calls because real LoF mutations are subjected to strong selection but errors are not. For functional analyses, such as in the study of Mendelian diseases, we recommend applying stringent filtering to avoid variant calling artifacts. We note that the popular metric F1-score, which is the average of sensitivity [=TP/(TP+FP)] and precision, is usually higher for unfiltered calls. For example, on GIAB, the F1-score of unfiltered GATK-HC SNP calls is 0.997, higher than that of filtered calls 0.990. The F1 metric may not reflect the accuracy in many applications.</p><p id="P10">Consistent with our previous finding<sup><xref rid="R3" ref-type="bibr">3</xref></sup>, most FP INDELs come from low-complexity regions<sup><xref rid="R19" ref-type="bibr">19</xref>,<xref rid="R20" ref-type="bibr">20</xref></sup> (LCRs), 2.3% of human genome (<xref rid="F2" ref-type="fig">Figure 2b</xref>). While this finding helps to guide our future development, it over-emphasizes a class of INDELs that often have unknown functional implications. To put the evaluation in a more practical context, we compiled a list of potentially functional regions, which consist of coding regions with 20bp flanking regions, regions conserved in vertebrate or mammalian evolution and variants in the ClinVar or GWAScatalog databases with 100bp flanking regions. Only 0.5% of these regions intersect with LCRs. As a result, the FPPM of INDELs in these regions is much lower.</p><p id="P11">We found that mapping reads to GRCh38 leads to slightly better results than mapping to GRCh37 (<xref rid="F2" ref-type="fig">Figure 2d</xref>), potentially due to the higher quality of the latest build. Although mapping to GRCh37 with decoy sequences further helps to reduce FP calls, this often comes at a minor loss in sensitivity. The choice of read mapping pipelines affects variant calling accuracy more (<xref rid="F2" ref-type="fig">Figure 2e</xref>). Bowtie2 alignment often yields lower FPPM because Bowtie2 intentionally lowers mapping quality of reads with excessive mismatches, which helps to avoid FPs caused by divergent CNVs, but may lead to a bias against regions under balancing selection or reduce sensitivity for species with high heterozygosity. It would be preferable to implement a post-alignment or post-variant filter instead of building the limitation into the mapper. We observed comparable FPPM but varying sensitivity across four independent experiments (<xref rid="F2" ref-type="fig">Figure 2f</xref>). Replicate 4 has the lowest coverage and base quality as well as the lowest variant calling sensitivity. Importantly, replicate 5* in <xref rid="F2" ref-type="fig">Figure 2f</xref> suggests that computationally subsampling and mixing reads sequenced from each CHM cell line separately, which is an easier technical exercise than experimentally mixing DNA to a precise fraction, is adequate for the evaluation of short variant calling.</p><p id="P12">We have manually inspected FPs and FNs called by each variant caller. GATK-HC performs local re-assembly and consistently achieves the highest INDEL sensitivity (<xref rid="F2" ref-type="fig">Figure 2</xref>). However, it may assemble a spurious haplotype around a long INDEL in a long LCR and call a false allele. We believe this can be improved with a better assembly algorithm<sup><xref rid="R3" ref-type="bibr">3</xref></sup>. FreeBayes is efficient and accurate for SNP calling. However, it does not penalize reads with intermediate mapping quality as much as other variant callers, which may lead to high FPPM in regions affected by CNVs. Platypus and SAMtools also demonstrate good SNP accuracy. Nonetheless, they both suffer from an error mode in which they may call a weakly supported false INDEL that is similar but not identical to a correct INDEL call nearby. This affects their FPPM. It is not obvious how to filter such false INDELs without looking at the underlying alignments.</p><p id="P13">Syndip is a special benchmark dataset that has been constructed from high-quality PacBio assemblies of two independent, homozygous cell lines. It leverages the power of long-read sequencing technologies while avoiding the difficulties in calling complex heterozygous variants from relatively noisy data. Syndip is the first benchmark dataset that does not heavily depend on short-read data and short-read variant callers, and thus more honestly reflects the true accuracy of such variant callers. On the other hand, Syndip also has weakness: the PacBio consensus of homozygous genomes is still associated with a small error rate. We have to use Illumina short reads to avoid PacBio errors being identified as wrong FNs in evaluation. Better PacBio assembly would eliminate this step and produce a benchmark dataset fully orthogonal to Illumina data.</p><sec id="S1"><title>Methods</title><sec id="S2"><title>Identifying erroneous regions on PacBio contigs</title><p id="P14">We acquired CHM1 and CHM13 PacBio assemblies<sup><xref rid="R8" ref-type="bibr">8</xref></sup> (accession GCA_001297185 and GCA_000983455, respectively) from NCBI and downloaded Illumina short reads from SRA (accession SRR2842672 and SRR3099549 for CHM1; SRR2088062 and SRR2088063 for CHM13). We assembled the Illumina CHM1 reads with FermiKit<sup><xref rid="R21" ref-type="bibr">21</xref></sup> and mapped the short-read unitigs to the corresponding PacBio assembly to call the sequence differences between the Illumina and the PacBio assemblies. These differences may come from three sources: incorrect PacBio consensus, somatic cell line mutations and collapse of segmental duplications.</p><p id="P15">An incorrect PacBio consensus base leads to a homozygous difference between the Illumina and PacBio assemblies. We found ~62k such homozygous differences from each sample, most of which are 1bp INDELs. A somatic mutation appears to be an isolated heterozygote with read depth close to the genome average. We identified such erroneous heterozygotes by requiring 1) each allele is supported by at least 9 Illumina read bases; 2) read depth is no greater than 50 and 3) the distance between adjacent somatic calls is above 10,000bp. We found 10,498 potential somatic calls in CHM1 and 4,701 in CHM13.</p><p id="P16">Collapse of segmental duplications in the PacBio assemblies lead to elevated read depth and clustered heterozygotes. To pinpoint such regions, we hierarchically clustered heterozygous events as follows: we merged two clusters adjacent on the PacBio assembly if 1) the minimal distance between them is within 10kb and 2) the density of heterozygotes in the merged cluster is at least 1 per 1kb. This resulted in about 3,000 clusters containing three or more heterozygotes from each PacBio assembly.</p><p id="P17">We marked the three types of errors plus 10bp flanking regions on the PacBio contigs. At a later step, we lift these regions over to the human reference coordinate and exclude them from the final list of confident regions. We note that the procedure above is aggressive in that regions we identified may not be associated with PacBio errors. These false regions will not lead to wrong FP/FN classification in evaluation.</p></sec><sec id="S3"><title>Constructing the truth call set and confident regions</title><p id="P18">We aligned each CHM PacBio assembly to GRCh37 with minimap2. To call pseudo-diploid variants from PacBio assemblies, we merged the assembly-to-reference alignments of CHM1 and CHM13. We discarded alignments with mapping quality below 5, dropped aligned segments shorter than 50kb and made an unfiltered call set by calling the alignment differences between each PacBio contig and GRCh37.&#x02028;</p><p id="P19">We constructed the initial set of confident regions from the same alignment. For each PacBio assembly, we say a region on GRCh37 is <italic>orthologous</italic> to the assembly if 1) the region is covered by one PacBio alignment longer than 50kb with mapping quality at least 5; 2) the region is not covered by another PacBio alignment longer than 10kb, with mapping quality at least 5. In downstream evaluation, we later noticed that if a small region harbors excessive variant calls, the region tends to be enriched with errors potentially due to misalignments or structural variations. We thus applied another hierarchical clustering to spot clusters of variations. More precisely, we hierarchically merged two clusters if 1) the minimal distance between two variants is within 250bp and 2) the density of variants in the merged cluster is at least 1 per 50bp. We collected clusters consisting of 10 or more variants and excluded the related regions together with erroneous PacBio regions from the orthologous regions. This gives us the list of confident regions for each sample.</p><p id="P20">The final list of confident regions of Syndip is the intersection of confident regions from each sample. It covers 96.0% of GRCh37, or 95.5% when we also excluded poly-A runs &#x02265;10bp. We applied a similar procedure to both GRCh37 with decoy contigs and GRCh38.&#x02028;</p><p id="P21">To confirm the quality of the Syndip data set, we manually inspected a few hundred discordant calls in IGV<sup><xref rid="R18" ref-type="bibr">18</xref></sup>. We observed that a few percent of false positive and false negative INDEL calls made by HaplotypeCaller appear to have strong support from Illumina reads. Most of them are associated with 1bp deletions in poly-C. They may be remaining PacBio consensus errors we failed to identify. Regardless, a few percent of discrepancy between Illumina and PacBio evidence would not change our general conclusions or the relative performance between calling methods as PacBio contig errors and somatic mutations are not biased toward a particular calling method.</p></sec><sec id="S4"><title>Quantification, normalization and mixing of the CHM samples</title><p id="P22">Initial sample quantification was performed using the Invitrogen Quant-It broad range dsDNA quantification assay kit (Thermo Scientific Catalog: Q33130) with a 1:200 PicoGreen dilution. Following quantification, each sample was normalized to a concentration of 10 ng/&#x003bc;L using a 1X Low TE pH 7.0 solution, then sample concentration was confirmed via PicoGreen. Sample mixing was then performed by combining an equal mass (ng) of each of the two samples (CHM1 &#x00026; CHM13) needed to obtain enough material for the Whole Genome library preparation (500ng). The samples for creating the 4 libraries were normalized and mixed independently (Life Science Reporting Summary).</p></sec><sec id="S5"><title>Preparation of libraries &#x00026; sequencing</title><p id="P23">For PCR-free whole genomes, library construction was performed using Kapa Biosystems reagents with the following modifications: (1) initial genomic DNA input was reduced from 3&#x003bc;g to 500ng, and (2) custom full-length dual-indexed library adapters at a concentration of 15 uM were utilized. Following sample preparation, libraries were quantified using quantitative PCR (kit purchased from Kapa biosystems) with probes specific to adapter ends in an automated fashion on Agilent&#x02019;s Bravo liquid handling platform. Based on qPCR quantification, libraries were normalized and pooled on the Hamilton MiniStar liquid handling platform. For HiSeq X Ten, pooled samples were normalized to 2nM and denatured with 0.1N NaOH for a loading concentration of 200 pM. Cluster amplification of denatured templates and paired-end sequencing was then performed according to the manufacturer&#x02019;s protocol (Illumina) for the HiSeq X Ten, with the following modification: we enabled dual indexing outside of the standard HiSeq control software by altering the sequencing recipe files.</p></sec><sec id="S6"><title>Calling SNPs and short INDELs from Illumina data</title><p id="P24">We mapped the Illumina reads to the human genome GRCh37 with the GATK best-practice pipeline, which uses BWA-MEM for mapping and post-processes alignments with BQSR and INDEL realignment. We additionally mapped the reads from one sample with BWA-MEM to various human genome versions without post processing steps. We have also run minimap2 and Bowtie2 for the same sample. We used the default settings of various mappers, except for tuning the maximal insert size.</p><p id="P25">We called variants on the mixed synthetic-diploid samples with FreeBayes, Platypus, Samtools and GATK, including the HaplotypeCaller (HC) and UnifiedGenotyper (UG) algorithms and filtered the raw variant calls with the set of rules described in the main text. We have tried GATK&#x02019;s VQSR model for filtering. However, as the VQSR training set is biased towards variants in regions with unambiguous mapping, VQSR misses many truth variants without perfect averaged mapping quality. Both GATK and Platypus come with a set of hard filters. However, by not filtering on read depth, one of the most effective filters on single-sample WGS calling, these filters lead to a low precision.</p></sec></sec><sec sec-type="supplementary-material" id="SM1"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>1</label><media xlink:href="NIHMS970889-supplement-1.pdf" orientation="portrait" xlink:type="simple" id="d36e417" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>2</label><media xlink:href="NIHMS970889-supplement-2.zip" orientation="portrait" xlink:type="simple" id="d36e421" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD3"><label>3</label><media xlink:href="NIHMS970889-supplement-3.zip" orientation="portrait" xlink:type="simple" id="d36e425" position="anchor"/></supplementary-material></sec></body><back><ack id="S7"><title>Acknowledgements.</title><p id="P26">This study was supported by NIH grant 5U54DK105566&#x02013;04, 5U01HG009088&#x02013;03 and 1R01HG010040&#x02013;01. We are grateful to Evan Eichler for providing the DNA of CHM cell lines. We thank Andrew Carrol for testing PacBio&#x02019;s new consensus caller Arrow, and thank Mark DePristo, Justin Zook and Brad Chapman for their helpful suggestions.</p></ack><fn-group><fn fn-type="COI-statement" id="FN2"><p id="P27"><bold>Competing Interests.</bold> The authors declare no competing interests.</p></fn><fn id="FN3"><p id="P28"><bold>Data availability.</bold> Illumina reads from this study were deposited to ENA under accession PRJEB13208. Syndip variant calls and confident regions can be acquired from <ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/CHM-eval">https://github.com/lh3/CHM-eval</ext-link>.</p><p id="P29"><bold>Code availability.</bold> Evaluation scripts are available from <ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/CHM-eval">https://github.com/lh3/CHM-eval</ext-link>. The variant calling pipeline and hard filters are implemented in <ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/unicall">https://github.com/lh3/unicall</ext-link>. Source code is also available as <xref rid="SD1" ref-type="supplementary-material">Supplementary Software</xref>.</p></fn></fn-group><ref-list><title>References</title><ref id="R1"><label>1</label><mixed-citation publication-type="journal"><name><surname>Zook</surname><given-names>JM</given-names></name>
<etal/>
<article-title>Integrating human sequence data sets provides a resource of benchmark SNP and indel genotype calls</article-title>. <source>Nat Biotechnol</source>
<volume>32</volume>, <fpage>246</fpage>&#x02013;<lpage>251</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nbt.2835</pub-id> (<year>2014</year>).<pub-id pub-id-type="pmid">24531798</pub-id></mixed-citation></ref><ref id="R2"><label>2</label><mixed-citation publication-type="journal"><name><surname>Eberle</surname><given-names>MA</given-names></name>
<etal/>
<article-title>A reference data set of 5.4 million phased human variants validated by genetic inheritance from sequencing a three-generation 17-member pedigree</article-title>. <source>Genome Res</source>
<volume>27</volume>, <fpage>157</fpage>&#x02013;<lpage>164</lpage>, doi:<pub-id pub-id-type="doi">10.1101/gr.210500.116</pub-id> (<year>2017</year>).<pub-id pub-id-type="pmid">27903644</pub-id></mixed-citation></ref><ref id="R3"><label>3</label><mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>
<article-title>Toward better understanding of artifacts in variant calling from high-coverage samples</article-title>. <source>Bioinformatics</source>
<volume>30</volume>, <fpage>2843</fpage>&#x02013;<lpage>2851</lpage>, doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btu356</pub-id> (<year>2014</year>).<pub-id pub-id-type="pmid">24974202</pub-id></mixed-citation></ref><ref id="R4"><label>4</label><mixed-citation publication-type="journal"><name><surname>Chin</surname><given-names>CS</given-names></name>
<etal/>
<article-title>Phased diploid genome assembly with single-molecule real-time sequencing</article-title>. <source>Nat Methods</source>
<volume>13</volume>, <fpage>1050</fpage>&#x02013;<lpage>1054</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nmeth.4035</pub-id> (<year>2016</year>).<pub-id pub-id-type="pmid">27749838</pub-id></mixed-citation></ref><ref id="R5"><label>5</label><mixed-citation publication-type="journal"><name><surname>Chin</surname><given-names>CS</given-names></name>
<etal/>
<article-title>Nonhybrid, finished microbial genome assemblies from long-read SMRT sequencing data</article-title>. <source>Nat Methods</source>
<volume>10</volume>, <fpage>563</fpage>&#x02013;<lpage>569</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nmeth.2474</pub-id> (<year>2013</year>).<pub-id pub-id-type="pmid">23644548</pub-id></mixed-citation></ref><ref id="R6"><label>6</label><mixed-citation publication-type="journal"><name><surname>Seo</surname><given-names>JS</given-names></name>
<etal/>
<article-title>De novo assembly and phasing of a Korean human genome</article-title>. <source>Nature</source>
<volume>538</volume>, <fpage>243</fpage>&#x02013;<lpage>247</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nature20098</pub-id> (<year>2016</year>).<pub-id pub-id-type="pmid">27706134</pub-id></mixed-citation></ref><ref id="R7"><label>7</label><mixed-citation publication-type="journal"><name><surname>Huddleston</surname><given-names>J</given-names></name>
<etal/>
<article-title>Discovery and genotyping of structural variation from long-read haploid genome sequence data</article-title>. <source>Genome Res</source>
<volume>27</volume>, <fpage>677</fpage>&#x02013;<lpage>685</lpage>, doi:<pub-id pub-id-type="doi">10.1101/gr.214007.116</pub-id> (<year>2017</year>).<pub-id pub-id-type="pmid">27895111</pub-id></mixed-citation></ref><ref id="R8"><label>8</label><mixed-citation publication-type="journal"><name><surname>Schneider</surname><given-names>VA</given-names></name>
<etal/>
<article-title>Evaluation of GRCh38 and de novo haploid genome assemblies demonstrates the enduring quality of the reference assembly</article-title>. <source>Genome Res</source>
<volume>27</volume>, <fpage>849</fpage>&#x02013;<lpage>864</lpage>, doi:<pub-id pub-id-type="doi">10.1101/gr.213611.116</pub-id> (<year>2017</year>).<pub-id pub-id-type="pmid">28396521</pub-id></mixed-citation></ref><ref id="R9"><label>9</label><mixed-citation publication-type="other"><name><surname>Li</surname><given-names>H</given-names></name>
<source>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</source>. <comment>arXiv:1303.3997</comment> (<year>2013</year>).</mixed-citation></ref><ref id="R10"><label>10</label><mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B</given-names></name> &#x00026; <name><surname>Salzberg</surname><given-names>SL</given-names></name>
<article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat Methods</source>
<volume>9</volume>, <fpage>357</fpage>&#x02013;<lpage>359</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id> (<year>2012</year>).<pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation></ref><ref id="R11"><label>11</label><mixed-citation publication-type="other"><name><surname>Li</surname><given-names>H</given-names></name>
<source>Minimap2: versatile pairwise alignment for nucleotide sequences</source>. <comment>arXiv:1708.01492</comment> (<year>2017</year>).</mixed-citation></ref><ref id="R12"><label>12</label><mixed-citation publication-type="other"><name><surname>Garrison</surname><given-names>E</given-names></name> &#x00026; <name><surname>Marth</surname><given-names>G</given-names></name>
<source>Haplotype-based variant detection from short-read sequencing</source>. <comment>arXiv:1207.3907</comment> (<year>2012</year>).</mixed-citation></ref><ref id="R13"><label>13</label><mixed-citation publication-type="journal"><name><surname>Rimmer</surname><given-names>A</given-names></name>
<etal/>
<article-title>Integrating mapping-, assembly- and haplotype-based approaches for calling variants in clinical sequencing applications</article-title>. <source>Nat Genet</source>
<volume>46</volume>, <fpage>912</fpage>&#x02013;<lpage>918</lpage>, doi:<pub-id pub-id-type="doi">10.1038/ng.3036</pub-id> (<year>2014</year>).<pub-id pub-id-type="pmid">25017105</pub-id></mixed-citation></ref><ref id="R14"><label>14</label><mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>
<article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source>
<volume>27</volume>, <fpage>2987</fpage>&#x02013;<lpage>2993</lpage>, doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btr509</pub-id> (<year>2011</year>).<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation></ref><ref id="R15"><label>15</label><mixed-citation publication-type="journal"><name><surname>DePristo</surname><given-names>MA</given-names></name>
<etal/>
<article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nat Genet</source>
<volume>43</volume>, <fpage>491</fpage>&#x02013;<lpage>498</lpage>, doi:<pub-id pub-id-type="doi">10.1038/ng.806</pub-id> (<year>2011</year>).<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation></ref><ref id="R16"><label>16</label><mixed-citation publication-type="other"><name><surname>Cleary</surname><given-names>JG</given-names></name>
<etal/>
<source>Comparing Variant Call Files for Performance Benchmarking of Next-Generation Sequencing Variant Calling Pipelines</source>. <collab>bioRxiv</collab>, doi:<pub-id pub-id-type="doi">10.1101/023754</pub-id> (<year>2015</year>).</mixed-citation></ref><ref id="R17"><label>17</label><mixed-citation publication-type="journal"><name><surname>Consortium</surname><given-names>GP</given-names></name>
<etal/>
<article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>
<volume>526</volume>, <fpage>68</fpage>&#x02013;<lpage>74</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nature15393</pub-id> (<year>2015</year>).<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation></ref><ref id="R18"><label>18</label><mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>JT</given-names></name>
<etal/>
<article-title>Integrative genomics viewer</article-title>. <source>Nat Biotechnol</source>
<volume>29</volume>, <fpage>24</fpage>&#x02013;<lpage>26</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id> (<year>2011</year>).<pub-id pub-id-type="pmid">21221095</pub-id></mixed-citation></ref><ref id="R19"><label>19</label><mixed-citation publication-type="journal"><name><surname>Morgulis</surname><given-names>A</given-names></name>, <name><surname>Gertz</surname><given-names>EM</given-names></name>, <name><surname>Schaffer</surname><given-names>AA</given-names></name> &#x00026; <name><surname>Agarwala</surname><given-names>R</given-names></name>
<article-title>A fast and symmetric DUST implementation to mask low-complexity DNA sequences</article-title>. <source>J Comput Biol</source>
<volume>13</volume>, <fpage>1028</fpage>&#x02013;<lpage>1040</lpage>, doi:<pub-id pub-id-type="doi">10.1089/cmb.2006.13.1028</pub-id> (<year>2006</year>).<pub-id pub-id-type="pmid">16796549</pub-id></mixed-citation></ref><ref id="R20"><label>20</label><mixed-citation publication-type="journal"><name><surname>Mallick</surname><given-names>S</given-names></name>
<etal/>
<article-title>The Simons Genome Diversity Project: 300 genomes from 142 diverse populations</article-title>. <source>Nature</source>
<volume>538</volume>, <fpage>201</fpage>&#x02013;<lpage>206</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nature18964</pub-id> (<year>2016</year>).<pub-id pub-id-type="pmid">27654912</pub-id></mixed-citation></ref><ref id="R21"><label>21</label><mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>
<article-title>FermiKit: assembly-based variant calling for Illumina resequencing data</article-title>. <source>Bioinformatics</source>
<volume>31</volume>, <fpage>3694</fpage>&#x02013;<lpage>3696</lpage>, doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btv440</pub-id> (<year>2015</year>).<pub-id pub-id-type="pmid">26220959</pub-id></mixed-citation></ref></ref-list></back><floats-group><fig id="F1" orientation="portrait" position="float"><label>Fig. 1</label><caption><p id="P30">Constructing the Syndip benchmark dataset. CHM1 and CHM13 cell lines were sequenced with PacBio and <italic>de novo</italic> assembled independently. Assembly contigs were aligned to the human reference genome. Differences in the alignment were taken as &#x02018;true&#x02019; SNPs and INDELs; regions covered by exactly one contig from each CHM assembly were identified as confident regions where true variants can be called to high accuracy. For the evaluation of diploid variant calling with short reads, equal quantities of DNA from the two cell lines were experimentally mixed. A PCR-free library was constructed from the mix and sequenced to ~45-fold coverage with 151bp paired-end reads. Variants called from the short reads were compared to the PacBio variants as truth to measure variant caller accuracy.</p></caption><graphic xlink:href="nihms-970889-f0001"/></fig><fig id="F2" orientation="portrait" position="float"><label>Fig. 2</label><caption><p id="P31">Evaluating variant calling accuracy with Syndip. %FNR denotes percent false negative rate, and FPPM is the number of false positives per million bases. (a) Comparison of Syndip, GIAB and PlatGen benchmark datasets on filtered calls. For GIAB and PlatGen, variants were called from the HiSeq X Ten run &#x02018;NA12878_L7_S7&#x02019; available from the Illumina BaseSpace. (b) Effect of evaluation regions. Low-complexity regions were identified with the symmetric DUST algorithm. The &#x02018;hard-to-call&#x02019; regions include low-complexity regions, regions unmappable with 75bp single-end reads and regions susceptible to common copy number variations. Panels (c)&#x02013;(f) only show metrics in &#x02018;coding+conserved&#x02019; regions. (c) Effect of variant filters. Green bars applied Platypus built-in filters. (d) Effect of the human genome reference build. Decoy sequences<sup><xref rid="R17" ref-type="bibr">17</xref></sup> are real human sequences that are missing from GRCh37. (e) Effect of the mapping algorithms and post-processing. BWA-MEM* represents alignment post-processed with base quality recalibration and INDEL realignment; other alignments were not processed with these steps. (f) Effect of replicates. Replicate 1&#x02013;4 were sequenced from four independent libraries, respectively, by mixing equal amount of DNA prior to library construction. Replicate 5* was generated by computationally subsampling and mixing reads sequenced from the two CHM cell lines separately. Replicate 1 is used in panels (a)&#x02013;(e). Numerical data and the script to generate the figure are available as <xref rid="SD1" ref-type="supplementary-material">Supplementary Data</xref>.</p></caption><graphic xlink:href="nihms-970889-f0002"/></fig></floats-group></article>