<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Sci Rep</journal-id><journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id><journal-title-group><journal-title>Scientific Reports</journal-title></journal-title-group><issn pub-type="epub">2045-2322</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6367407</article-id><article-id pub-id-type="publisher-id">38231</article-id><article-id pub-id-type="doi">10.1038/s41598-018-38231-w</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Functional random forest with applications in dose-response predictions</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Rahman</surname><given-names>Raziur</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Dhruba</surname><given-names>Saugato Rahman</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Ghosh</surname><given-names>Souparno</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Pal</surname><given-names>Ranadip</given-names></name><address><email>ranadip.pal@ttu.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2186 7496</institution-id><institution-id institution-id-type="GRID">grid.264784.b</institution-id><institution>Texas Tech University, Department of Electrical and Computer Engineering, </institution></institution-wrap>Lubbock, Texas 79409 USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2186 7496</institution-id><institution-id institution-id-type="GRID">grid.264784.b</institution-id><institution>Texas Tech University, Department of Mathematics and Statistics, </institution></institution-wrap>Lubbock, Texas 79409 USA </aff></contrib-group><pub-date pub-type="epub"><day>7</day><month>2</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>7</day><month>2</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>9</volume><elocation-id>1628</elocation-id><history><date date-type="received"><day>29</day><month>5</month><year>2018</year></date><date date-type="accepted"><day>20</day><month>12</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">Drug sensitivity prediction for individual tumors is a significant challenge in personalized medicine. Current modeling approaches consider prediction of a single metric of the drug response curve such as <italic>AUC</italic> or <italic>IC</italic><sub>50</sub>. However, the single summary metric of a dose-response curve fails to provide the entire drug sensitivity profile which can be used to design the optimal dose for a patient. In this article, we assess the problem of predicting the complete dose-response curve based on genetic characterizations. We propose an enhancement to the popular ensemble-based Random Forests approach that can directly predict the entire functional profile of a dose-response curve rather than a single summary metric. We design functional regression trees with node costs modified based on dose/response region dependence methodologies and response distribution based approaches. Our results relative to large pharmacological databases such as CCLE and GDSC show a higher accuracy in predicting dose-response curves of the proposed functional framework in contrast to univariate or multivariate Random Forest predicting sensitivities at different dose levels. Furthermore, we also considered the problem of predicting functional responses from functional predictors <italic>i</italic>.<italic>e</italic>., estimating the dose-response curves with a model built on dose-dependent expression data. The superior performance of Functional Random Forest using functional data as compared to existing approaches have been shown using the HMS-LINCS dataset. In summary, Functional Random Forest presents an enhanced predictive modeling framework to predict the entire functional response profile considering both static and functional predictors instead of predicting the summary metrics of the response curves.</p></abstract><funding-group><award-group><funding-source><institution>National Institute of Health (NIH)</institution></funding-source></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par2">Precision medicine plays an important role in the push towards advancing cancer therapy. A significant step in the process involves mapping genetic characterizations to the applied drug sensitivity response. A multitude of approaches have been proposed to address the issue of predictive modeling of drug sensitivity but the results still indicate a significant scope for improvement<sup><xref ref-type="bibr" rid="CR1">1</xref>&#x02013;<xref ref-type="bibr" rid="CR4">4</xref></sup>. Crowd-sourced initiatives such as NCI-DREAM conducted Drug Sensitivity Prediction Challenge<sup><xref ref-type="bibr" rid="CR2">2</xref></sup> enabled the performance evaluation of multiple algorithms on the same dataset while being restricted to smaller number of samples. Recently, a number of pharmacological databases<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR6">6</xref></sup> have been made public to assist researchers in validating their predictive algorithms using larger biological datasets.</p><p id="Par3">Drug sensitivity information in the form of responses for different doses represented as a curve is becoming more prevalent for cancerous cell lines with the advent of advanced data collection techniques. Such datasets are often referred as <italic>functional</italic> data<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. Typical approaches for sensitivity prediction predict a summary metric of the entire drug response curve such as <italic>Area Under the Curve</italic> (<italic>AUC</italic>) or <italic>IC</italic><sub>50</sub>. The problem of predicting a summary metric of the drug response curve has been tackled using a diverse set of regression approaches such as linear regression with regularization, nonlinear regression, kernel based techniques and ensemble based approaches<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR8">8</xref>&#x02013;<xref ref-type="bibr" rid="CR10">10</xref></sup>. Additionally, drug sensitivity prediction modeling has also been proposed based on features extracted using Principal Component Analysis (PCA)<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>.</p><p id="Par4">A primary concern in using a certain drug sensitivity response summary metric is that they fail to describe the entire dose-response effect <italic>i</italic>.<italic>e</italic>., they represent just a particular scenario such as the drug concentration to achieve 50% cell viability (<italic>IC</italic><sub>50</sub>) or the inflection point of the dose-response fitted curve (<italic>EC</italic><sub>50</sub>) or the maximal activity reached in the curve (<italic>A</italic><sub><italic>max</italic></sub>)<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> or the area under the fitted curve (<italic>AUC</italic>). Meanwhile, various functional regression models have been proposed in other research areas to predict the entire response curve<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Yu <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> have presented each response curve as a linear combination of known basis functions and grown regression trees using the coefficients of this expansion, while Nerini <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> have proposed functional PCA in the classification method for easy representation of regression trees. The knowledge of the entire drug response curve can answer clinically relevant questions such as what will be the sensitivity at the highest non-toxic dose concentration (toxicity can be estimated using experimentations on normal cells or computational modeling) or the sensitivity at the drug concentration available at the targeted organ (pharmacokinetics estimated using micro-dosing) for that specific patient? Furthermore, a summary metric such as AUC for two different dose response curves might be same even when they might offer different information such as very high sensitivity for high doses for drug A as compared to relatively moderate sensitivity over all drug doses for drug B. Note that drug A at high doses might be better in killing most cancer cells as compared to drug B which will not be apparent through AUC prediction.</p><p id="Par5">Thus, there is a need for entire dose response curve prediction which is not handled directly by existing regression models. In one of our previous works<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, we have used each dose-response point to build individual regression models for prediction purposes. However, the individual models lack incorporation of the continuous nature of the dose-response curve. In this paper, we are proposing the incorporation of dose-response points or distributions in the generation of regression tree node cost and leaf nodes to improve the accuracy of Random Forest (RF) model for sensitivity prediction. At each regression tree node, region-wise response points or distributions (Gaussian) are considered to calculate the node cost. The leaf nodes store the functional data used to predict the entire dose-response profile for test samples, while the model input consists of genomic characterization in regular form or continuous curve form. We present methodologies that can consider both regular and functional inputs. For analysis purposes, each response curve has been approximated by a linear combination of B-spline functions<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> and thus, the framework can also be applied in scenarios different from drug sensitivity prediction. We validate our proposed <italic>Functional Random Forest</italic> (FRF) approach using data from the well-known pharmacological databases of Cancer Cell Line Encyclopedia (CCLE)<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> and Genomics of Drug Sensitivity for Cancer (GDSC)<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>.</p><p id="Par6">The article is organized as follows: The Materials and Methods section compiles the basic steps involved in designing FRF models while discussing the impact of storing functional data in forest leaf nodes and highlighting the region-wise node cost procedures. The Results section provides the performance evaluation of FRF model for both synthetic experiments and actual pharmacological data. Furthermore, it also presents the biological importance of genes selected by FRF. Finally, the Discussion section points out the advantages of using FRF to predict the dose-response curves in the larger context of drug sensitivity prediction and provides possible future research directions.</p></sec><sec id="Sec2" sec-type="materials|methods"><title>Materials and Methods</title><p id="Par7">The idea of Functional Random Forest is based on regular regression tree based Random Forest. Thus, we will first describe the design procedure for regular regression trees and subsequently present the construction of functional regression tree based FRF approach. Before delving into the details of tree construction, we describe the datasets used for this study which will help us establish a number of theoretical assumptions in the methodology.</p><sec id="Sec3"><title>Datasets and Preprocessing</title><p id="Par8">For our experiments, we have considered two most comprehensive publicly available cancer pharmacogenomics databases: Cancer Cell Line Encyclopedia (CCLE)<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> and Genomics of Drug Sensitivity for Cancer (GDSC)<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. CCLE database was generated by Broad Institute and Novartis Institutes for Biomedical Research. This database includes genetic and pharmacological characterization of 947 human cancer cell lines, together with pharmacological profiling of 24 small molecules (anticancer compounds) across ~500 of these cell lines that encompasses 36 tumor types<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. The response of a cell line to a specific drug is reported for 7 to 8 dose points ranging from 0.0025&#x02009;<italic>&#x003bc;M</italic> to 8&#x02009;<italic>&#x003bc;M</italic>. Additionally, four different drug sensitivity measures <italic>EC</italic><sub>50</sub>, <italic>IC</italic><sub>50</sub>, <italic>A</italic><sub><italic>max</italic></sub> and <italic>AUC</italic> are listed. Note that these measures are features of a dose-response curve fitted from the observed dose-response points. GDSC database was created as part of the Cancer Genome Project<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> and contains gene expression data for 789 cell lines and drug responses for 714 cell lines. Each cell line has 22,277 probe sets for gene expression yielding a high dimensional feature space. Similar to CCLE, each cell line&#x02019;s response to the drugs are reported for 7 to 9 dose points where minimum dose ranges from 3&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;5</sup>&#x02009;<italic>&#x003bc;M</italic> to 15.625&#x02009;<italic>&#x003bc;M</italic> and maximum dose ranges from 0.008&#x02009;<italic>&#x003bc;M</italic> to 4000&#x02009;<italic>&#x003bc;M</italic>. For our experiment, we utilize GDSC <italic>v</italic>5 that lists two drug sensitivity measures <italic>IC</italic><sub>50</sub> and <italic>AUC</italic> along with 105 different <italic>IC</italic> values for different levels of cell viability from 0.1% to 100% in each cell line for each drug. Note that these <italic>IC</italic> values are extracted from the complete dose-response curves fitted from the observed dose-response points and extrapolated to 100% cell viability as the curves do not reach 100% at maximum dose for most cell line&#x02013;drug pairs. Both CCLE and GDSC provide observed dose-response points or fitted curve points which could be utilized as our functional response data. However, the genomic characterization data are available in the stationary format as the expressions are measured before any drug application. Therefore, to demonstrate the functional input and output scenario for our FRF model, we have used data from the Harvard Medical School Library of Integrated Network-Based Cellular Signatures (HMS-LINCS) database, which to our knowledge, is the only publicly available source offering functional responses as well as predictors. HMS-LINCS offers genomic characterization data in the form of Reverse Phase Protein Array (RPPA) expression data for 21 proteins where Phosphorylation state and protein levels were measured in 10 BRAF<sup><italic>V</italic>600E/D</sup> melanoma cell lines at 7 different doses and 5 different time points<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. The cellular response data consists of viability and apoptosis measured in the same cell lines using Fluorescence imaging apoptosis assay for the same 7 doses but 3 different time points<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. The database contains data for 9 BRAF<sup><italic>V</italic>600E</sup> and 1 BRAF<sup><italic>V</italic>600D</sup> melanoma cell lines that were exposed to 4 RAF inhibitors and 1 MEK inhibitor at 7 different doses ranging from 3.2&#x02009;<italic>nM</italic> to 3.2&#x02009;<italic>&#x003bc;M</italic>. Protein expression data is available for 5 different time points: 1, 5, 10, 24 and 48&#x02009;hours post drug application and apoptosis data is available for 24, 48 and 72&#x02009;hours post drug application. For compound sensitivity assessment, two different measures are available: relative viability and mean apoptosis fraction, computed using the number of apoptotic cells and the total number of cells normalized with the DMSO control<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>.</p><p id="Par9">Figure&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> illustrates the pictorial representations of genomic and functional characterizations data, where the left half shows the static and functional format of genomic characterizations and the right half demonstrates the dose-response curves for various cell line&#x02013;drug pairs and different summary metrics extracted from such a curve.<fig id="Fig1"><label>Figure 1</label><caption><p>Pictorial representation of the commonly used genomic and functional characterizations.</p></caption><graphic xlink:href="41598_2018_38231_Fig1_HTML" id="d29e500"/></fig></p></sec><sec id="Sec4"><title>Random Forest Regression</title><p id="Par10">Random Forest consists of a set of <italic>T</italic> un-pruned ensemble of regression trees<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> that are generated based on bootstrap sampling from the original training data. The bootstrap resampling of the data for training each tree increases the diversity between the trees. Each tree is composed of root node, branch nodes and leaf nodes. For each node of a tree, the optimal node splitting feature is selected from a set of <italic>m</italic> features that are again randomly selected from a feature space of size <italic>M</italic>. If <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m\ll M$$\end{document}</tex-math><mml:math id="M2"><mml:mi>m</mml:mi><mml:mo>&#x0226a;</mml:mo><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq1.gif"/></alternatives></inline-formula>, the selection of the node splitting feature from a random set of features decreases the correlation between different trees and thus, the average response of multiple regression trees is expected to have lower variance than the individual regression trees. However, there exists a trade-off as a larger <italic>m</italic> can improve the predictive capability of individual trees but also can increase the correlation between trees and void any gains from averaging multiple predictions.</p><sec id="Sec5"><title>Process of splitting a node</title><p id="Par11">Let <italic>x</italic><sub><italic>tr</italic></sub>(<italic>i</italic>, <italic>j</italic>) and <italic>y</italic>(<italic>i</italic>) denote the training input feature <italic>j</italic> and output response, respectively, for sample <italic>i</italic> where <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=1,2,\ldots ,n,\,j=1,2,\ldots ,M$$\end{document}</tex-math><mml:math id="M4"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>&#x02026;</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mspace width=".25em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>&#x02026;</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq2.gif"/></alternatives></inline-formula>. At any node <italic>&#x003b7;</italic><sub><italic>P</italic></sub>, we aim to select a feature <italic>j</italic><sub><italic>s</italic></sub> from a random set of <italic>m</italic> (&#x0003c;<italic>M</italic>) features and a threshold <italic>z</italic> to partition the node into two child nodes <italic>&#x003b7;</italic><sub><italic>L</italic></sub> (left node with samples satisfying <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{tr}(i\in {\eta }_{P},{j}_{s})\le z$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02264;</mml:mo><mml:mi>z</mml:mi></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq3.gif"/></alternatives></inline-formula>) and <italic>&#x003b7;</italic><sub><italic>R</italic></sub> (right node with samples satisfying <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{tr}(i\in {\eta }_{P},{j}_{s}) &#x0003e; z$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mi>z</mml:mi></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq4.gif"/></alternatives></inline-formula>). We consider the node cost as sum of square deviances (SSD), <italic>i</italic>.<italic>e</italic>.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D({\eta }_{P})=\sum _{i\in {\eta }_{P}}\,{(y(i)-\mu ({\eta }_{P}))}^{2}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mspace width=".1em"/><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu ({\eta }_{P})={\mathbb{E}}[y(i\in {\eta }_{P})],\,{\mathbb{E}}[\,\cdot \,]$$\end{document}</tex-math><mml:math id="M12"><mml:mi>&#x003bc;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width=".25em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mspace width="-.25em"/><mml:mo>&#x022c5;</mml:mo><mml:mspace width="-.25em"/><mml:mo stretchy="false">]</mml:mo></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq5.gif"/></alternatives></inline-formula> denotes the Expected value. Thus, the reduction in cost (<italic>i</italic>.<italic>e</italic>., <italic>reward</italic> function) for partition <italic>&#x003b3;</italic> at node <italic>&#x003b7;</italic><sub><italic>P</italic></sub> is given in Eq. (<xref rid="Equ2" ref-type="">2</xref>), where the goal is to select the partition <italic>&#x003b3;</italic>*&#x02009;&#x02208;&#x02009;<italic>&#x003b7;</italic><sub><italic>P</italic></sub> that maximizes the reward <italic>or</italic>, minimizes the cost.<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{rcl}C(\gamma ,{\eta }_{P}) &#x00026; = &#x00026; D({\eta }_{P})-D({\eta }_{L})-D({\eta }_{R})\\ {\gamma }^{\ast } &#x00026; = &#x00026; {\rm{\arg }}\mathop{{\rm{\max }}}\limits_{\gamma }\,C(\gamma ,{\eta }_{P})\end{array}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b3;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mo>&#x0204e;</mml:mo></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="normal">arg</mml:mi><mml:munder><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:munder><mml:mspace width=".1em"/><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b3;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par12">Note that for a continuous feature with <italic>n</italic> samples, a total of <italic>n</italic> partitions needs to be checked <italic>i</italic>.<italic>e</italic>., the computational complexity of each node split is <italic>O</italic>(<italic>mn</italic>). During tree generation, a node with <italic>n</italic>&#x02009;&#x02264;&#x02009;<italic>n</italic><sub><italic>size</italic></sub> samples is not partitioned any further where <italic>n</italic><sub><italic>size</italic></sub> is a pre-specified sample size threshold.</p><p id="Par13">Several other approaches have been proposed for tree construction such as applying <italic>Principal Component Analysis</italic> (<italic>PCA</italic>)<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> in the response matrix<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. The principal components (PC) not only serve the purpose of dimensionality reduction but is also expected to increase the robustness of the trees. Here, the node cost used to build the trees is given by<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D({\eta }_{P})=\sum _{i\in {\eta }_{P}}\,{(\zeta (i)-\bar{\zeta }(r))}^{T}\,(\zeta (i)-\bar{\zeta }(r))$$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mspace width=".1em"/><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b6;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>&#x003b6;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mspace width=".1em"/><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b6;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>&#x003b6;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <italic>&#x003b6;</italic>(<italic>i</italic>) denotes a PC based response vector and <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\zeta }(r)$$\end{document}</tex-math><mml:math id="M18"><mml:mover accent="true"><mml:mi>&#x003b6;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq6.gif"/></alternatives></inline-formula> is the mean vector of PCs<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. Yu <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> have also considered the use of basis functions to represent the response variables with the node cost written as<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D({\eta }_{P})=\sum _{i\in {\eta }_{P}}\,{({\bf{c}}(i)-{\mu }_{c}({\eta }_{P}))}^{T}\,{\rm{\Phi }}({\bf{c}}(i)-{\mu }_{c}({\eta }_{P}))$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mspace width=".1em"/><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mspace width=".1em"/><mml:mi mathvariant="normal">&#x003a6;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <bold>c</bold>(<italic>i</italic>) denotes the vector of basis coefficients, <inline-formula id="IEq7"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mu }_{c}({\eta }_{P})={\mathbb{E}}[{\bf{c}}(i)]$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq7.gif"/></alternatives></inline-formula> and &#x003a6; denotes the matrix of basis vector inner products<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>.</p></sec><sec id="Sec6"><title>Forest Prediction</title><p id="Par14">Using the randomized feature selection process, we fit the tree based on <italic>bootstrap</italic> samples <inline-formula id="IEq8"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{({{\bf{X}}}_{1},{Y}_{1}),({{\bf{X}}}_{2},{Y}_{2}),\ldots ,({{\bf{X}}}_{n},{Y}_{n})\}$$\end{document}</tex-math><mml:math id="M24"><mml:mo stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>&#x02026;</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq8.gif"/></alternatives></inline-formula> from training data. Let us consider the prediction based on a test sample <bold>x</bold> for the tree &#x00398;. Assume that <inline-formula id="IEq9"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\gamma }({\bf{x}},{\rm{\Theta }})$$\end{document}</tex-math><mml:math id="M26"><mml:mover accent="true"><mml:mi>&#x003b3;</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq9.gif"/></alternatives></inline-formula> be the partition containing <bold>x</bold>, the tree response takes the following form<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup> with corresponding weights <italic>w</italic><sub><italic>i</italic></sub>(<bold>x</bold>, &#x00398;)<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y({\bf{x}},{\rm{\Theta }})=\sum _{i=1}^{n}\,{w}_{i}({\bf{x}},{\rm{\Theta }})\,y(i)$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mspace width=".1em"/><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width=".1em"/><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{i}({\bf{x}},{\rm{\Theta }})=\frac{{{\bf{1}}}_{\{{{\bf{x}}}_{tr}(i)\in \tilde{\gamma }({\bf{x}},{\rm{\Theta }})\}}}{\#\{r:{{\bf{x}}}_{tr}(i)\in \tilde{\gamma }({{\bf{x}}}_{tr}(r),{\rm{\Theta }})\}}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02208;</mml:mo><mml:mover accent="true"><mml:mi>&#x003b3;</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>#</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>r</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02208;</mml:mo><mml:mover accent="true"><mml:mi>&#x003b3;</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par15">Let the <italic>T</italic> trees of RF be denoted by <inline-formula id="IEq10"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\rm{\Theta }}}_{1},{{\rm{\Theta }}}_{2},\ldots ,{{\rm{\Theta }}}_{T}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x00398;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x00398;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x02026;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x00398;</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq10.gif"/></alternatives></inline-formula> and <italic>w</italic><sub><italic>i</italic></sub>(<bold>x</bold>) to be the average weights over the forest. Then, the average RF prediction for the test sample <bold>x</bold> is given by weighted average of predictions of all <italic>T</italic> trees using the weight vector in (<xref rid="Equ7" ref-type="">7</xref>).<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{i}({\bf{x}})=\frac{1}{T}\,\sum _{j=1}^{T}\,{w}_{i}({\bf{x}},{{\rm{\Theta }}}_{j})$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mspace width=".1em"/><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mspace width=".1em"/><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x00398;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{y}({\bf{x}})=\sum _{i=1}^{n}\,{w}_{i}\,({\bf{x}})\,y(i)$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mspace width=".1em"/><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width=".1em"/><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width=".1em"/><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p></sec></sec><sec id="Sec7"><title>Multivariate Random Forest</title><p id="Par16">Multivariate Random Forest (MRF)<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> is the extension of the regular RF for joint prediction of multivalued output responses that can be useful in different response scenarios. The primary difference between MRF and the regular RF is in the tree generation step where the node cost is different from <inline-formula id="IEq11"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D({\eta }_{P})$$\end{document}</tex-math><mml:math id="M38"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq11.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ1" ref-type="">1</xref>). In a multivariate output scenario, the difference between a sample point response and the multivariate mean distribution is desirable and can be achieved by using the SSD of the <italic>Mahalanobis distance</italic> measure.<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{rcl}{D}_{MRF}({\eta }_{P}) &#x00026; = &#x00026; \sum _{i\in {\eta }_{P}}\,{({\bf{y}}(i)-\mu ({\eta }_{P}))}^{T}\,{{\rm{\Sigma }}}^{-1}\,({\bf{y}}(i)-\mu ({\eta }_{P}))\\ {\rm{where}}\,{\bf{y}}(i) &#x00026; = &#x00026; [y(i,1)\,y(i,2)\,\cdots \,y(i,m)]\end{array}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>R</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mspace width=".1em"/><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mspace width=".1em"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">&#x003a3;</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width=".1em"/><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">where</mml:mi><mml:mspace width=".25em"/><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width=".5em"/><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width=".5em"/><mml:mo>&#x022ef;</mml:mo><mml:mspace width=".5em"/><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where &#x003a3; is the covariance matrix, <italic>m</italic> denotes the number of response points, and <inline-formula id="IEq12"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu ({\eta }_{P})={\mathbb{E}}[{\bf{y}}(i\in {\eta }_{P})]$$\end{document}</tex-math><mml:math id="M42"><mml:mi>&#x003bc;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq12.gif"/></alternatives></inline-formula>. The inverse covariance matrix &#x003a3;<sup>&#x02212;1</sup> is a precision matrix that provides a measure of conditional dependence between multiple random variables. For our analysis, we consider MRF modeling on 8 dose-response points similar to our earlier published study<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>.</p></sec><sec id="Sec8"><title>Functional Random Forest</title><p id="Par17">Regular classification and regression trees (CART) work on non-functional variables <italic>e</italic>.<italic>g</italic>., discrete gene expression values and summary metrics shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>. In this section, we consider incorporating functional responses (<italic>e</italic>.<italic>g</italic>., dose-response curves shown in right half of Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>) for building functional random forest (FRF). For this purpose, we have introduced two novel alterations in the regression trees&#x02013; first, in node cost calculation and second, in regression of the leaf node samples.</p><sec id="Sec9"><title>Node cost calculation</title><p id="Par18">For the construction of regular regression tree based models, partitioning and accuracy measure for each node <italic>&#x003b7;</italic><sub><italic>P</italic></sub> is achieved using the <italic>deviance criterion</italic> in Eq. (<xref rid="Equ1" ref-type="">1</xref>). However, this criterion only considers a single parameter (<italic>&#x003bc;</italic>) of the drug sensitivity response while neglecting the shapes of the dose-response curves at each node. To incorporate the shape information of a dose-response curve into the deviance calculation, we propose to <italic>discretize</italic> the entire curve into multiple regions to calculate the node cost in each region separately and then sum the individual deviances to get the total deviance at each node, <italic>i</italic>.<italic>e</italic>.<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{D}}_{FRF}({\eta }_{P})=\sum _{j=1}^{q}\,{\hat{D}}_{r}({r}_{j})$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mi>R</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:mspace width=".1em"/><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq13"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{D}}_{r}({r}_{j})$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq13.gif"/></alternatives></inline-formula> is the deviance calculated from the <italic>j</italic><sup>th</sup> region <italic>r</italic><sub><italic>j</italic></sub>, and <italic>q</italic> is the total number of regions. For the discretization scheme, we choose to discretize the coordinate values as appropriate for the observed data (<italic>e</italic>.<italic>g</italic>., we use the 8 given dose points to divide the dose-response curves into 8 regions in CCLE as compared to GDSC where we utilize the ~100 <italic>IC</italic> response values for discretization). Furthermore, we propose two distinct algorithms for node cost calculation where (i) either the observed dose-response points are used directly or, (ii) the underlying distribution is extracted from these points and various divergence criteria are applied.</p></sec><sec id="Sec10"><title>Node cost calculation using dose-response points</title><p id="Par19">For this approach, we use the observed dose-response data directly and assume the complete curve to be made up of multiple regions each belonging to an observed dose point or response point. Then, the total deviance at each node <italic>&#x003b7;</italic><sub><italic>P</italic></sub> is measured by calculating the SSD per region<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> as a measure of <inline-formula id="IEq14"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{D}}_{r}({r}_{j})$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq14.gif"/></alternatives></inline-formula> and subsequently using (<xref rid="Equ10" ref-type="">10</xref>).<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{D}}_{r}({r}_{j})=\sum _{i\in {\eta }_{P}}\,\parallel {y}_{j}(i)-{\bar{y}}_{j}{\parallel }^{2}$$\end{document}</tex-math><mml:math id="M50" display="block"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mspace width=".1em"/><mml:mo stretchy="false">&#x02225;</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">&#x02225;</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where <italic>y</italic><sub><italic>j</italic></sub>(<italic>i</italic>) denotes the response in region <italic>r</italic><sub><italic>j</italic></sub> at dose <italic>d</italic><sub><italic>j</italic></sub> for sample <italic>i</italic>, and <inline-formula id="IEq15"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{y}}_{j}={\mathbb{E}}[{y}_{j}(i\in {\eta }_{P})]$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq15.gif"/></alternatives></inline-formula>. The criterion described in Eq. (<xref rid="Equ11" ref-type="">11</xref>) considers the region-wise differences rather than the difference in an overall feature of the curve.</p></sec><sec id="Sec11"><title>Node cost calculation using dose-response distributions</title><p id="Par20">In the previous approach, each region consists of <inline-formula id="IEq16"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{P}={\sum }_{i\in {\eta }_{P}}\,i$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mspace width=".1em"/><mml:mo>&#x02208;</mml:mo><mml:mspace width=".1em"/><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mspace width=".1em"/><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq16.gif"/></alternatives></inline-formula> response points (<italic>i</italic>.<italic>e</italic>., the number of cell lines examined for the applied drug) at a specific dose <italic>d</italic><sub><italic>j</italic></sub> and these discrete responses are used to compute the node deviance in (<xref rid="Equ10" ref-type="">10</xref>). However, if a study performs multiple experiments at a certain dose for each individual cell line (<italic>i</italic>.<italic>e</italic>., technical replicates), we can potentially generate a distribution from all the replicates at that specific dose. Therefore, instead of considering a single response value <italic>y</italic><sub><italic>j</italic></sub>(<italic>i</italic>) for cell line <italic>i</italic> at dose <italic>d</italic><sub><italic>j</italic></sub>, we can alternatively calculate the node cost by approximating the response by a probability distribution, <italic>f</italic><sub><italic>j</italic></sub>. The modified splitting criterion for this scenario is given by<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{D}}_{r}({r}_{j})=\sum _{i\in {\eta }_{P}}\,{C}_{f}({{\rm{\Phi }}}_{i},\hat{{\rm{\Phi }}})$$\end{document}</tex-math><mml:math id="M56" display="block"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mspace width=".1em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003a6;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">&#x003a6;</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{where}}\,{C}_{f}({{\rm{\Phi }}}_{i},\hat{{\rm{\Phi }}})=\sum _{{\rm{\Omega }}}\,\hat{{\rm{\Phi }}}{f}_{j}(\frac{{{\rm{\Phi }}}_{i}}{\hat{{\rm{\Phi }}}})$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mi mathvariant="normal">where</mml:mi><mml:mspace width=".5em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003a6;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">&#x003a6;</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:munder><mml:mrow><mml:mspace width=".1em"/><mml:mover accent="true"><mml:mi mathvariant="normal">&#x003a6;</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003a6;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">&#x003a6;</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par21">Here, <inline-formula id="IEq17"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{f}(\,\cdot \,,\cdot \,)$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mspace width="-.25em"/><mml:mo>&#x022c5;</mml:mo><mml:mspace width="-.25em"/><mml:mo>,</mml:mo><mml:mo>&#x022c5;</mml:mo><mml:mspace width="-.25em"/><mml:mo stretchy="false">)</mml:mo></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq17.gif"/></alternatives></inline-formula> is called the <italic>f-divergence</italic> of the probability distribution, &#x003a9; is the distribution range, and <inline-formula id="IEq18"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{{\rm{\Phi }}}$$\end{document}</tex-math><mml:math id="M62"><mml:mover accent="true"><mml:mi mathvariant="normal">&#x003a6;</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq18.gif"/></alternatives></inline-formula> is the mean distribution at node <italic>&#x003b7;</italic><sub><italic>P</italic></sub> derived using mixture distribution<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. There are various ways to calculate the <italic>f-divergence</italic> depending on the divergence measure <italic>f</italic><sub><italic>j</italic></sub>(<italic>u</italic>) in Eq. (<xref rid="Equ13" ref-type="">13</xref>). For instance, the <italic>Kullback-Leibler</italic> (<italic>KL</italic>) <italic>divergence</italic><sup><xref ref-type="bibr" rid="CR22">22</xref></sup> is obtained with <inline-formula id="IEq19"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${f}_{j}(u)=u\,\mathrm{ln}(u)$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mspace width=".1em"/><mml:mi>ln</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq19.gif"/></alternatives></inline-formula><disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{f}({{\rm{\Phi }}}_{i},\hat{{\rm{\Phi }}})=\sum _{{\rm{\Omega }}}\,{{\rm{\Phi }}}_{i}\,\mathrm{ln}(\frac{{{\rm{\Phi }}}_{i}}{\hat{{\rm{\Phi }}}})$$\end{document}</tex-math><mml:math id="M66" display="block"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003a6;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">&#x003a6;</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:munder><mml:mrow><mml:mspace width=".1em"/><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003a6;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width=".1em"/><mml:mi>ln</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003a6;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">&#x003a6;</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par22">And, the <italic>Hellinger Distance</italic><sup><xref ref-type="bibr" rid="CR23">23</xref></sup> is generated using <inline-formula id="IEq20"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${f}_{j}(u)={(\sqrt{u}-1)}^{2}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msqrt><mml:mi>u</mml:mi></mml:msqrt><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq20.gif"/></alternatives></inline-formula><disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{f}({{\rm{\Phi }}}_{i},\hat{{\rm{\Phi }}})=\sum _{{\rm{\Omega }}}\,{(\sqrt{{{\rm{\Phi }}}_{i}}-\sqrt{\hat{{\rm{\Phi }}}})}^{2}$$\end{document}</tex-math><mml:math id="M70" display="block"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003a6;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">&#x003a6;</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:munder><mml:mrow><mml:mspace width=".1em"/><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003a6;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt><mml:mo>&#x02212;</mml:mo><mml:msqrt><mml:mover accent="true"><mml:mi mathvariant="normal">&#x003a6;</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover></mml:msqrt></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec12"><title>Functional regression using dose-response curves</title><p id="Par23">Regular regression tree response for a new sample is based on averaging the responses in the leaf node reached by the new sample. Since the responses considered in a regular regression tree are individual points, a simple averaging of the values suffices. For our FRF scenario, each leaf node consists of a set of functional responses and therefore, we need to modify the final prediction as described below.</p><p id="Par24">Given that we have dose-response points, we can potentially fit a spline curve through these points to represent the dose-response as a continuous curve. In recent pharmacological studies, the curve fitting normally consists of sigmoidal, linear or constant functions<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. In our algorithm, we have considered the <italic>generalized B-spline</italic> fitting for the dose-response curves. To perform Functional Random Forest (FRF) prediction using the spline-fitted curves, we store the curve points for each sample in the leaf nodes instead of a specific feature (<italic>i</italic>.<italic>e</italic>., <italic>IC</italic><sub>50</sub> or <italic>AUC</italic>). In the prediction step, for a test sample <bold>x</bold>, we consider the training response set <inline-formula id="IEq21"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\bf{y}}}_{j}={y}_{j}(i\in {\eta }_{P})$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq21.gif"/></alternatives></inline-formula> at each dose <italic>d</italic><sub><italic>j</italic></sub> separately from the stored dose-response curves in node <italic>&#x003b7;</italic><sub><italic>P</italic></sub> and fit a Gaussian distribution <italic>N</italic><sub><italic>j</italic></sub>. The mode of this distribution (<italic>i</italic>.<italic>e</italic>., peak) indicates the highest response probability for <bold>x</bold> at <italic>d</italic><sub><italic>j</italic></sub> and we pick the corresponding response value <inline-formula id="IEq22"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_{j}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq22.gif"/></alternatives></inline-formula> as our final prediction.<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{rcl}{{\bf{y}}}_{j} &#x00026; \sim  &#x00026; {N}_{j}({\bf{y}};\,{\mu }_{j},{\sigma }_{j}^{2})\,{\rm{where}}\,{\mu }_{j}\,:\,={\mathbb{E}}[{{\bf{y}}}_{j}],\,{\sigma }_{j}^{2}\,:\,=\mathrm{Var}[{{\bf{y}}}_{j}]\\ {\hat{y}}_{j}({\bf{x}}) &#x00026; = &#x00026; {\rm{\arg }}\mathop{{\rm{\max }}}\limits_{y}\,{N}_{j}({\bf{y}};\,{\mu }_{j},{\sigma }_{j}^{2})\end{array}$$\end{document}</tex-math><mml:math id="M76" display="block"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mo>&#x0223c;</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>;</mml:mo><mml:mspace width=".25em"/><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mspace width=".5em"/><mml:mi mathvariant="normal">where</mml:mi><mml:mspace width=".5em"/><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width=".25em"/><mml:mo>:</mml:mo><mml:mspace width="-.25em"/><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width=".25em"/><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mspace width=".25em"/><mml:mo>:</mml:mo><mml:mspace width="-.25em"/><mml:mo>=</mml:mo><mml:mi>Var</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x002c6;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="normal">arg</mml:mi><mml:munder><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:munder><mml:mspace width=".1em"/><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>;</mml:mo><mml:mspace width=".25em"/><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par25">The process is then repeated for all dose levels to generate the functional prediction, <inline-formula id="IEq23"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{{\bf{y}}}({\bf{x}})$$\end{document}</tex-math><mml:math id="M78"><mml:mover accent="true"><mml:mi mathvariant="bold">y</mml:mi><mml:mo mathvariant="bold">&#x002c6;</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq23.gif"/></alternatives></inline-formula>. Figure&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> illustrates a representative case where the different response probability distributions are displayed for multiple dose levels. Here, the asterisks (*) on the 3D surface denote the distribution modes at different doses that are used to perform the functional prediction. Subsequently, we can use this predicted curve to estimate the conventional drug sensitivity measures such as <italic>AUC</italic>, <italic>IC</italic><sub>50</sub> and <italic>EC</italic><sub>50</sub>.<fig id="Fig2"><label>Figure 2</label><caption><p>Drug sensitivity probability distributions at a node for Functional Random Forest prediction where the asterisks (*) indicate modes of distributions at 8 dose points ranging from 0.0025&#x02009;<italic>&#x003bc;M</italic> to 8&#x02009;<italic>&#x003bc;M</italic>.</p></caption><graphic xlink:href="41598_2018_38231_Fig2_HTML" id="d29e3499"/></fig></p></sec></sec><sec id="Sec13"><title>Function-to-function regression with FRF</title><p id="Par26">Drug sensitivity predictive algorithms normally train regression models on genomic characterizations represented by stationary values such as pre-treatment gene expression (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). However, if gene (or protein) expression can be measured post drug application at different doses and/or various time points, the input variables can be modeled as curves representing the dose-expression functions at the corresponding dose points. An example of such functional data is shown in lower left half of Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> where the functional input-output data is obtained from the HMS-LINCS<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup> database. In this section, we consider a scenario where the HMS-LINCS protein expressions following drug administration is available along with the resulting dose-responses in terms of cell viability.</p><p id="Par27">Here, we consider a couple of ways to convert the functional data into functional features which are eventually used as model inputs. Similar to the drug sensitivity summary metrics generated from the dose-response curves, we can use the genomic characterization curve to extract features such as <italic>AUC</italic> and <italic>IC</italic><sub>50</sub>. For calculating <italic>AUC</italic>, a reference line (similar to the zero viability line for drug sensitivity) is required and we utilize the available DMSO-treated control RPPA data<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> for this purpose. Figure&#x000a0;<xref rid="MOESM1" ref-type="media">S1</xref> displays a representative dose-expression curve post drug application with the DMSO-treated control line where the shaded area in between is the desired <italic>AUC</italic>. For this representative protein (p-S6), the expression values are decreasing with increases in dose levels which is the most common scenario. However, for a few cases, the protein expressions either remain almost similar or go up as dose increases. For such proteins, we only consider the expression values below our reference DMSO-treated control line (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>). Along with <italic>AUC</italic>, we also calculate different <italic>IC</italic> values <italic>i</italic>.<italic>e</italic>., <italic>IC</italic><sub>25</sub>, <italic>IC</italic><sub>50</sub> and <italic>IC</italic><sub>75</sub> to be considered as predictor features. To arrive at the <italic>IC</italic> values, we perform 3<sup><italic>rd</italic></sup> degree polynomial fitting on the observed protein expression data at different doses and record the different <italic>IC</italic> values using the corresponding percentile points between the lowest and highest expression values (<italic>e</italic>.<italic>g</italic>., <italic>IC</italic><sub>25</sub> is the dose where the 25<sup>th</sup> percentile point is located). Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> illustrates three representative protein expression fitted curves with corresponding <italic>IC</italic><sub>25</sub>, <italic>IC</italic><sub>50</sub> and <italic>IC</italic><sub>75</sub> points demonstrating the different behaviors described above <italic>i</italic>.<italic>e</italic>., expression values are either (a) mostly decreasing, (b) almost unchanged, or (c) mostly increasing with dose.<fig id="Fig3"><label>Figure 3</label><caption><p>Illustration of obtaining different <italic>IC</italic> values using observed protein expression points and the corresponding 3<sup><italic>rd</italic></sup> degree polynomial fitted curve overlaid after AZ-628 administration in cell line C32 for (<bold>a</bold>) protein <italic>p-S</italic>6 with a decreasing trend, (<bold>b</bold>) protein <italic>p-mTOR</italic> with minor changes, and (<bold>c</bold>) protein <italic>cPARP</italic> with an increasing trend.</p></caption><graphic xlink:href="41598_2018_38231_Fig3_HTML" id="d29e3658"/></fig></p><p id="Par28">Another way of extracting the functional curve features is to rank the curves according to their slopes (<italic>i</italic>.<italic>e</italic>., rate of change). Furthermore, a curve can be ranked by its position compared to the other curves <italic>i</italic>.<italic>e</italic>., if a curve contains &#x0003e;50% dose points with higher protein expression values compared to another curve, the former will get a higher rank than the later and the process will go on until all curves are ranked.</p></sec><sec id="Sec14"><title>Accession codes</title><p id="Par29">Source code for Functional Random Forest is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/razrahman/Functional-Random-forest">https://github.com/razrahman/Functional-Random-forest</ext-link>.</p></sec></sec><sec id="Sec15" sec-type="results"><title>Results</title><p id="Par30">In this section, we apply Functional Random Forest modeling on both synthetic and experimental datasets for performance evaluation and comparison analysis with both univariate and Multivariate Random Forest models.</p><sec id="Sec16"><title>Application of FRF on synthetic data</title><p id="Par31">We first evaluate the performance of FRF using a synthetic experiment. The design matrix has been generated by extracting 10 different features from five different clusters. Each cluster is derived from a Gaussian distribution and the range of the distribution for each cluster has limited overlap with others. Furthermore, we add 10 additional noise features to increase the correlation between samples from different clusters. Subsequently, we have a design matrix of size 75&#x02009;&#x000d7;&#x02009;20 (15 samples each from 5 clusters and 20 covariates with 10 relevant &#x00026; 10 spurious features). For the output, we create a target matrix of size 75&#x02009;&#x000d7;&#x02009;101 where 101 is the number of different synthetic dose levels. The response values are sampled from the 4-parameter sigmoidal model<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> in Eq. (<xref rid="Equ17" ref-type="">17</xref>) and shown in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> for both noiseless and noisy cases, <italic>i</italic>.<italic>e</italic>.<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y(d)={A}_{0}+\frac{{A}_{{\rm{\max }}}-{A}_{0}}{1+{(\frac{I{C}_{50}}{d})}^{\theta }}$$\end{document}</tex-math><mml:math id="M80" display="block"><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mi>d</mml:mi></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>where <italic>A</italic><sub>0</sub>, <italic>A</italic><sub>max</sub> &#x00026; <italic>&#x003b8;</italic> are fixed but <italic>IC</italic><sub>50</sub> differs slightly for each curve in a certain cluster while <italic>d</italic> is the applied dose level. We also look into the effect of additive noise in targets as shown in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> where (a) displays the target curves <italic>without</italic> noise, and (b) displays the targets with 5% <italic>additive noise</italic>. Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref> shows the performance of FRF as compared to regular RF for different numbers of trees, folds and noise levels (%). From Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>, we observe that FRF displays an overall superior performance to RF in all cases, especially improving the model performance by as much as 25% as the noise level increases. A potential reason for this performance boost is the ability of FRF to incorporate the <italic>shape</italic> of the response curves, as shown in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5(a)</xref> where FRF is able to follow a noisy synthetic data curve which RF fails to predict, especially for higher doses.<fig id="Fig4"><label>Figure 4</label><caption><p>Synthetic dose-response curve examples&#x02013; (<bold>a</bold>) without noise, (<bold>b</bold>) 5% additive noise.</p></caption><graphic xlink:href="41598_2018_38231_Fig4_HTML" id="d29e3842"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Normalized Mean Absolute Errors (NMAE) for prediction of synthetic data dose-responses with varying noise levels using RF and FRF.</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">#Trees</th><th rowspan="2">#Folds</th><th colspan="2">Noiseless</th><th colspan="2">5% Noise</th><th colspan="2">10% Noise</th><th colspan="2">20% Noise</th></tr><tr><th>RF</th><th>FRF</th><th>RF</th><th>FRF</th><th>RF</th><th>FRF</th><th>RF</th><th>FRF</th></tr></thead><tbody><tr><td rowspan="2">50</td><td>5</td><td>0.037</td><td><bold>0</bold>.<bold>029</bold></td><td>0.039</td><td><bold>0</bold>.<bold>034</bold></td><td>0.045</td><td><bold>0</bold>.<bold>034</bold></td><td>0.063</td><td><bold>0</bold>.<bold>051</bold></td></tr><tr><td>10</td><td>0.036</td><td><bold>0</bold>.<bold>028</bold></td><td>0.034</td><td><bold>0</bold>.<bold>028</bold></td><td>0.043</td><td><bold>0</bold>.<bold>035</bold></td><td>0.060</td><td><bold>0</bold>.<bold>049</bold></td></tr><tr><td rowspan="2">100</td><td>5</td><td>0.039</td><td><bold>0</bold>.<bold>030</bold></td><td>0.039</td><td><bold>0</bold>.<bold>034</bold></td><td>0.044</td><td><bold>0</bold>.<bold>036</bold></td><td>0.063</td><td><bold>0</bold>.<bold>049</bold></td></tr><tr><td>10</td><td>0.036</td><td><bold>0</bold>.<bold>029</bold></td><td>0.035</td><td><bold>0</bold>.<bold>030</bold></td><td>0.042</td><td><bold>0</bold>.<bold>035</bold></td><td>0.059</td><td><bold>0</bold>.<bold>047</bold></td></tr><tr><td rowspan="2">150</td><td>5</td><td>0.041</td><td><bold>0</bold>.<bold>034</bold></td><td>0.036</td><td><bold>0</bold>.<bold>030</bold></td><td>0.047</td><td><bold>0</bold>.<bold>037</bold></td><td>0.060</td><td><bold>0</bold>.<bold>049</bold></td></tr><tr><td>10</td><td>0.031</td><td><bold>0</bold>.<bold>027</bold></td><td>0.034</td><td><bold>0</bold>.<bold>029</bold></td><td>0.042</td><td><bold>0</bold>.<bold>034</bold></td><td>0.060</td><td><bold>0</bold>.<bold>047</bold></td></tr><tr><td colspan="2">Improvement</td><td/><td>24%</td><td/><td>17%</td><td/><td>25%</td><td/><td>25%</td></tr></tbody></table><table-wrap-foot><p>The different numbers of folds are used in training &#x00026; test data separation. Bold values indicate the best performances.</p></table-wrap-foot></table-wrap><fig id="Fig5"><label>Figure 5</label><caption><p>Performance comparison for Functional Random Forest and Random Forest for both synthetic data and CCLE data. (<bold>a</bold>) For noisy synthetic data, FRF can follow the actual response variations even though it was modeled using noisy data while RF fails to follow the trend in higher dose levels, (<bold>b</bold>) For fitted dose-response curve in CCLE Liver cell line SNU449 post Erlotinib administration, FRF prediction again outperforms RF prediction.</p></caption><graphic xlink:href="41598_2018_38231_Fig5_HTML" id="d29e4218"/></fig></p></sec><sec id="Sec17"><title>Application of FRF on biological data</title><p id="Par32">For performance evaluation of Functional Random Forest using actual biological data, we have used three different sources&#x02013; CCLE, GDSC and HMS-LINCS. The sections below provide the results and corresponding discussion for all three databases.</p><sec id="Sec18"><title>Application on CCLE dataset</title><p id="Par33">CCLE provides cell line sensitivity data with 7 to 8 dose-response points. For our analysis, we consider the cell lines with 8 points only and thus, we have 8 different regions for node cost calculation in Eq.&#x000a0;<xref rid="Equ10" ref-type="">10</xref>. Tables&#x000a0;<xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref> display the predictive performance of FRF for both node cost calculation algorithms <italic>i</italic>.<italic>e</italic>., using observed dose-response points and underlying distributions. For node cost calculation using distributions, we provide results for both KL divergence and Hellinger distance measures in Eqs (<xref rid="Equ14" ref-type="">14</xref> and <xref rid="Equ15" ref-type="">15</xref>). Additionally, we compare the results from the FRF models with standard RF methodology. Tables&#x000a0;<xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref> provide overall performance comparisons for three different models: (a) regular Random Forest (RF), (b) Functional Random Forest with conventional averaging at the Leaf node (FRFL), and (c) Functional Random Forest with averaging of the dose-response curves at the leaf node (FRF). Note that FRF considers the functional curves for both node cost evaluation <italic>and</italic> response prediction at the leaf nodes, whereas FRFL considers the functional curves for node cost evaluation only and generates the prediction using the conventional means of averaging of a specific summary metric (<italic>e</italic>.<italic>g</italic>., <italic>IC</italic><sub>50</sub> or <italic>AUC</italic>) stored at the leaf node. All the results are reported for 5 fold cross-validation with 150 trees in each model along with 10 features for node splitting (<italic>m</italic>&#x02009;=&#x02009;10) and minimum leaf size of 10. We note that both functional approaches (<italic>i</italic>.<italic>e</italic>., FRFL and FRF) perform better than the regular RF model for all the presented scenarios. We also compare the results with a different set of parameters which also support the previous conclusion that both FRFL and FRF perform better than the RF. Figure&#x000a0;<xref rid="Fig5" ref-type="fig">5(b)</xref> shows a representative example of both FRF and RF prediction. Note that we are demonstrating a case where the responses are changing gradually for different doses. Although the performances of both FRF and RF were not stellar in general, the FRF prediction still outperforms RF prediction, especially for higher doses.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of predictive performance for AUC from three different approaches: RF, FRFL and FRF with two different model constructions using CCLE data.</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Drug</th><th colspan="3">Correlation</th><th colspan="3">MAE</th></tr><tr><th>RF</th><th>FRFL</th><th>FRF</th><th>RF</th><th>FRFL</th><th>FRF</th></tr></thead><tbody><tr><td colspan="7">Model parameters: #Tree&#x02009;=&#x02009;150, <italic>m</italic>&#x02009;=&#x02009;10, minimum leaf size&#x02009;=&#x02009;10</td></tr><tr><td>Erlotinib</td><td>0.4408</td><td>0.4498</td><td><bold>0</bold>.<bold>4641</bold></td><td>0.0546</td><td>0.0541</td><td><bold>0</bold>.<bold>0464</bold></td></tr><tr><td>Nilotinib</td><td>0.3886</td><td>0.4318</td><td><bold>0</bold>.<bold>4564</bold></td><td>0.0465</td><td>0.0464</td><td><bold>0</bold>.<bold>0376</bold></td></tr><tr><td>PD-0325901</td><td>0.4716</td><td>0.5057</td><td><bold>0</bold>.<bold>5658</bold></td><td>0.1353</td><td><bold>0</bold>.<bold>1335</bold></td><td>0.1377</td></tr><tr><td>PLX-4720</td><td>0.2957</td><td>0.3137</td><td><bold>0</bold>.<bold>4365</bold></td><td>0.0494</td><td>0.0487</td><td><bold>0</bold>.<bold>0396</bold></td></tr><tr><td>TAE-684</td><td>0.2757</td><td>0.3385</td><td><bold>0</bold>.<bold>3743</bold></td><td>0.0728</td><td>0.0717</td><td><bold>0</bold>.<bold>0684</bold></td></tr><tr><td colspan="7">Model parameters: #Tree&#x02009;=&#x02009;500, <italic>m</italic>&#x02009;=&#x02009;50, minimum leaf size&#x02009;=&#x02009;5</td></tr><tr><td>Erlotinib</td><td>0.4381</td><td>0.4420</td><td><bold>0</bold>.<bold>4701</bold></td><td>0.0563</td><td>0.0557</td><td><bold>0</bold>.<bold>0474</bold></td></tr><tr><td>Nilotinib</td><td>0.4216</td><td><bold>0</bold>.<bold>4393</bold></td><td>0.4288</td><td>0.0470</td><td>0.0471</td><td><bold>0</bold>.<bold>0391</bold></td></tr><tr><td>PD-0325901</td><td>0.5928</td><td>0.5929</td><td><bold>0</bold>.<bold>6381</bold></td><td>0.1287</td><td><bold>0</bold>.<bold>1282</bold></td><td>0.1322</td></tr><tr><td>PLX-4720</td><td>0.3738</td><td>0.4195</td><td><bold>0</bold>.<bold>5352</bold></td><td>0.0492</td><td>0.0480</td><td><bold>0</bold>.<bold>0393</bold></td></tr><tr><td>TAE-684</td><td>0.3645</td><td>0.3888</td><td><bold>0</bold>.<bold>4211</bold></td><td>0.0711</td><td>0.0708</td><td><bold>0</bold>.<bold>0679</bold></td></tr></tbody></table><table-wrap-foot><p>For FRFL and FRF, node cost is calculated using 8 dose regions. Bold values indicate the best performances.</p></table-wrap-foot></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>Comparison of predictive performance for AUC from three different approaches: RF, FRFL and FRF using CCLE data.</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="3">Drug</th><th colspan="5">Correlation</th><th colspan="5">MAE</th></tr><tr><th/><th colspan="2">KL divergence</th><th colspan="2">Hellinger Distance</th><th/><th colspan="2">KL divergence</th><th colspan="2">Hellinger Distance</th></tr><tr><th>RF</th><th>FRFL</th><th>FRF</th><th>FRFL</th><th>FRF</th><th>RF</th><th>FRFL</th><th>FRF</th><th>FRFL</th><th>FRF</th></tr></thead><tbody><tr><td>Erlotinib</td><td>0.4408</td><td>0.4473</td><td>0.4620</td><td>0.4265</td><td><bold>0</bold>.<bold>4643</bold></td><td>0.0546</td><td>0.0544</td><td><bold>0</bold>.<bold>0466</bold></td><td>0.0552</td><td>0.0472</td></tr><tr><td>Nilotinib</td><td>0.3886</td><td>0.4263</td><td>0.4601</td><td>0.4475</td><td><bold>0</bold>.<bold>5009</bold></td><td>0.0465</td><td>0.0459</td><td>0.0375</td><td>0.0457</td><td><bold>0</bold>.<bold>0373</bold></td></tr><tr><td>PD-0325901</td><td>0.4716</td><td>0.5149</td><td><bold>0</bold>.<bold>5775</bold></td><td>0.4920</td><td>0.5633</td><td>0.1353</td><td><bold>0</bold>.<bold>1330</bold></td><td>0.1370</td><td>0.1352</td><td>0.1386</td></tr><tr><td>PLX-4720</td><td>0.2957</td><td>0.3168</td><td>0.4308</td><td>0.3314</td><td><bold>0</bold>.<bold>4491</bold></td><td>0.0494</td><td>0.0489</td><td>0.0398</td><td>0.0492</td><td><bold>0</bold>.<bold>0397</bold></td></tr><tr><td>TAE-684</td><td>0.2757</td><td>0.3245</td><td><bold>0</bold>.<bold>3689</bold></td><td>0.2860</td><td>0.3337</td><td>0.0728</td><td>0.0723</td><td><bold>0</bold>.<bold>0688</bold></td><td>0.0730</td><td>0.0697</td></tr></tbody></table><table-wrap-foot><p>For FRFL and FRF, node cost is calculated using f-divergences (KL divergence or Hellinger distance) of the response distributions at 8 different doses. Bold values indicate the best performances.</p></table-wrap-foot></table-wrap></p><p id="Par34">Note that Table&#x000a0;<xref rid="Tab3" ref-type="table">3</xref> considers the dose-responses as probability distributions generated based on the mean and standard deviation (SD) of the responses provided by CCLE. We have fitted a Gaussian distribution using the provided mean and SD of responses for each dose point. The mean distribution at a node is calculated using a mixture of Gaussian distribution assumption. Note that the results in both Tables&#x000a0;<xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref> provide measures for only 5 representative drugs. Table&#x000a0;<xref rid="MOESM1" ref-type="media">S1</xref> provides the results for all 24 CCLE drugs.</p><p id="Par35">Both Tables&#x000a0;<xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref> show the performance measures for 5 fold cross-validation. To demonstrate the robustness of our FRF model compared to RF, we also perform our analysis using bootstrap samples of CCLE data. Considering the total number of samples available for each drug, we extract 50 bootstrap sets of samples to build individual FRF and RF models for each set and then perform sensitivity prediction using the built models. Figure&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> illustrates the distributions of differences between MAE values for FRF and RF model predictions against the number of bootstrap samples for four representative drugs (Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">S2</xref> provides these distributions for all 24 CCLE drugs). For majority of the sets, MAE of FRF is lower than that of RF yielding negative values in x-coordinate. These distributions clearly demonstrate the superior predictive performance and robustness of FRF as compared to a standard RF. Additionally, Table&#x000a0;<xref rid="Tab4" ref-type="table">4</xref> compares the performance of FRF with that of an MRF model, which also demonstrates the overall superior performance of FRF over MRF for the 8 dose points.<fig id="Fig6"><label>Figure 6</label><caption><p>Distributions of MAE differences between FRF and RF predictions for the 50 bootstrap sets using CCLE data.</p></caption><graphic xlink:href="41598_2018_38231_Fig6_HTML" id="d29e4983"/></fig><table-wrap id="Tab4"><label>Table 4</label><caption><p>Comparison of predictive performances of FRF and MRF for 8 different dose points using CCLE data.</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Drug</th><th rowspan="2">Model</th><th colspan="9">Correlation</th></tr><tr><th>Dose 1</th><th>Dose 2</th><th>Dose 3</th><th>Dose 4</th><th>Dose 5</th><th>Dose 6</th><th>Dose 7</th><th>Dose 8</th><th>Mean</th></tr></thead><tbody><tr><td rowspan="2">Erlotinib</td><td>MRF</td><td>0.0293</td><td><bold>0</bold>.<bold>2014</bold></td><td>0.1877</td><td>0.2901</td><td>0.3915</td><td>0.4813</td><td>0.4942</td><td>0.4071</td><td>0.3103</td></tr><tr><td>FRF</td><td><bold>0</bold>.<bold>0662</bold></td><td>0.1781</td><td><bold>0</bold>.<bold>2138</bold></td><td><bold>0</bold>.<bold>3256</bold></td><td><bold>0</bold>.<bold>4378</bold></td><td><bold>0</bold>.<bold>4955</bold></td><td><bold>0</bold>.<bold>5094</bold></td><td><bold>0</bold>.<bold>4100</bold></td><td><bold>0</bold>.<bold>3296</bold></td></tr><tr><td rowspan="2">Nilotinib</td><td>MRF</td><td>&#x02212;0.0725</td><td><bold>0</bold>.<bold>1966</bold></td><td>0.1550</td><td>0.2860</td><td>0.3734</td><td>0.4255</td><td>0.3888</td><td>0.1830</td><td>0.2420</td></tr><tr><td>FRF</td><td>&#x02212;<bold>0</bold>.<bold>0776</bold></td><td>0.1360</td><td><bold>0</bold>.<bold>2186</bold></td><td><bold>0</bold>.<bold>3306</bold></td><td><bold>0</bold>.<bold>4182</bold></td><td><bold>0</bold>.<bold>4546</bold></td><td><bold>0</bold>.<bold>4310</bold></td><td><bold>0</bold>.<bold>2502</bold></td><td><bold>0</bold>.<bold>2702</bold></td></tr><tr><td rowspan="2">PD-0325901</td><td>MRF</td><td>0.1402</td><td>0.3722</td><td>0.4842</td><td>0.5395</td><td>0.5776</td><td>0.5871</td><td>0.5668</td><td>0.5181</td><td>0.4732</td></tr><tr><td>FRF</td><td><bold>0</bold>.<bold>2013</bold></td><td><bold>0</bold>.<bold>4397</bold></td><td><bold>0</bold>.<bold>5239</bold></td><td><bold>0</bold>.<bold>5798</bold></td><td><bold>0</bold>.<bold>6067</bold></td><td><bold>0</bold>.<bold>6078</bold></td><td><bold>0</bold>.<bold>5952</bold></td><td><bold>0</bold>.<bold>5426</bold></td><td><bold>0</bold>.<bold>5121</bold></td></tr><tr><td rowspan="2">PLX-4720</td><td>MRF</td><td>&#x02212;<bold>0</bold>.<bold>0522</bold></td><td>&#x02212;0.0137</td><td>0.0885</td><td>0.1818</td><td>0.3986</td><td>0.4682</td><td><bold>0</bold>.<bold>5018</bold></td><td>0.3732</td><td>0.2433</td></tr><tr><td>FRF</td><td>&#x02212;0.0045</td><td><bold>0</bold>.<bold>1297</bold></td><td><bold>0</bold>.<bold>1259</bold></td><td><bold>0</bold>.<bold>2434</bold></td><td><bold>0</bold>.<bold>4028</bold></td><td><bold>0</bold>.<bold>4779</bold></td><td>0.4973</td><td><bold>0</bold>.<bold>3772</bold></td><td><bold>0</bold>.<bold>2812</bold></td></tr><tr><td rowspan="2">TAE-684</td><td>MRF</td><td><bold>0</bold>.<bold>1068</bold></td><td>0.1485</td><td>0.0045</td><td>0.1509</td><td>0.3236</td><td>0.3448</td><td>0.2914</td><td>0.2874</td><td>0.2072</td></tr><tr><td>FRF</td><td>0.0978</td><td><bold>0</bold>.<bold>1615</bold></td><td><bold>0</bold>.<bold>0541</bold></td><td><bold>0</bold>.<bold>2358</bold></td><td><bold>0</bold>.<bold>3654</bold></td><td><bold>0</bold>.<bold>3867</bold></td><td><bold>0</bold>.<bold>3736</bold></td><td><bold>0</bold>.<bold>3008</bold></td><td><bold>0</bold>.<bold>2470</bold></td></tr></tbody></table><table-wrap-foot><p>All the models are built using 150 trees, <italic>m</italic>&#x02009;=&#x02009;10 node splitting features and minimum leaf size of 10.</p></table-wrap-foot></table-wrap></p></sec><sec id="Sec19"><title>Application on GDSC dataset</title><p id="Par36">To demonstrate the versatility of FRF model performance as compared to a traditional RF model, we performed the predictive analysis using another publicly available larger database GDSC. Instead of dose-response points, GDSC v5 provides 105 different <italic>IC</italic> points for dose-response values, extracted from response curves fitted with sigmoidal functions<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> and extrapolated to reach 100% cellular viability. This extrapolation causes the dose values for <italic>IC</italic><sub>90</sub> or <italic>IC</italic><sub>100</sub> to be very high and therefore, we consider only the <italic>IC</italic> values indicating &#x02264;80% viability in our models. We design a single FRF model to predict the complete dose-response curve from <italic>IC</italic><sub>1</sub> to <italic>IC</italic><sub>80</sub> and thereafter, the <italic>AUC</italic>. However, RF is unable to replicate this procedure and therefore, we design 8 separate models to predict 8 different <italic>IC</italic> values in an interval of 10 (<italic>i</italic>.<italic>e</italic>., <inline-formula id="IEq24"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I{C}_{10},I{C}_{20},\ldots ,I{C}_{80}$$\end{document}</tex-math><mml:math id="M82"><mml:mi>I</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x02026;</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>80</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2018_38231_Article_IEq24.gif"/></alternatives></inline-formula>) and one additional model to predict the <italic>AUC</italic>. Table&#x000a0;<xref rid="Tab5" ref-type="table">5</xref> provides the MAE values measured at the 8/<italic>IC</italic> points and <italic>AUC</italic> for both FRF and RF for 5 representative drugs (Table&#x000a0;<xref rid="MOESM1" ref-type="media">S2</xref> provides the performance comparison for all 140 GDSC (v5) drugs). For all 5 drugs, FRF displays a superior performance in predicting different <italic>IC</italic> and <italic>AUC</italic> values as compared to RF. These results demonstrate the higher efficacy of FRF in the larger context of drug sensitivity prediction for various dose or response points.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Comparison of predictive performance on GDSC dataset for multiple drug sensitivity measures (<italic>AUC</italic> and 8 <italic>IC</italic> values) using both RF and FRF.</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Drug</th><th rowspan="2">Model</th><th colspan="10">MAE</th></tr><tr><th>
<italic>AUC</italic>
</th><th>
<italic>IC</italic>
<sub>10</sub>
</th><th>
<italic>IC</italic>
<sub>20</sub>
</th><th>
<italic>IC</italic>
<sub>30</sub>
</th><th>
<italic>IC</italic>
<sub>40</sub>
</th><th>
<italic>IC</italic>
<sub>50</sub>
</th><th>
<italic>IC</italic>
<sub>60</sub>
</th><th>
<italic>IC</italic>
<sub>70</sub>
</th><th>
<italic>IC</italic>
<sub>80</sub>
</th><th>Mean</th></tr></thead><tbody><tr><td rowspan="2">Erlotinib</td><td>RF</td><td>0.0596</td><td>2.0831</td><td>1.7472</td><td>1.5039</td><td>1.3291</td><td>1.1948</td><td>1.0692</td><td>1.0133</td><td>1.0304</td><td>1.3714</td></tr><tr><td>FRF</td><td><bold>0</bold>.<bold>0486</bold></td><td><bold>1</bold>.<bold>9813</bold></td><td><bold>1</bold>.<bold>6597</bold></td><td><bold>1</bold>.<bold>4382</bold></td><td><bold>1</bold>.<bold>2694</bold></td><td><bold>1</bold>.<bold>1357</bold></td><td><bold>1</bold>.<bold>0361</bold></td><td><bold>0</bold>.<bold>9867</bold></td><td><bold>1</bold>.<bold>0095</bold></td><td><bold>1</bold>.<bold>3146</bold></td></tr><tr><td rowspan="2">Rapamycin</td><td>RF</td><td>0.0640</td><td><bold>4</bold>.<bold>3771</bold></td><td>3.4771</td><td>2.9370</td><td>2.5294</td><td>2.2000</td><td>2.0355</td><td>2.0207</td><td>2.5359</td><td>2.7641</td></tr><tr><td>FRF</td><td><bold>0</bold>.<bold>0636</bold></td><td>4.3905</td><td><bold>3</bold>.<bold>4525</bold></td><td><bold>2</bold>.<bold>8895</bold></td><td><bold>2</bold>.<bold>4642</bold></td><td><bold>2</bold>.<bold>1379</bold></td><td><bold>1</bold>.<bold>9446</bold></td><td><bold>2</bold>.<bold>0046</bold></td><td><bold>2</bold>.<bold>4707</bold></td><td><bold>2</bold>.<bold>7193</bold></td></tr><tr><td rowspan="2">Sunitinib</td><td>RF</td><td>0.0963</td><td>1.5494</td><td>1.5297</td><td>1.5542</td><td>1.6105</td><td>1.6518</td><td>1.7013</td><td>1.7750</td><td>1.8728</td><td>1.6556</td></tr><tr><td>FRF</td><td><bold>0</bold>.<bold>0902</bold></td><td><bold>1</bold>.<bold>5306</bold></td><td><bold>1</bold>.<bold>5119</bold></td><td><bold>1</bold>.<bold>5378</bold></td><td><bold>1</bold>.<bold>5750</bold></td><td><bold>1</bold>.<bold>6276</bold></td><td><bold>1</bold>.<bold>6812</bold></td><td><bold>1</bold>.<bold>7428</bold></td><td><bold>1</bold>.<bold>8372</bold></td><td><bold>1</bold>.<bold>6305</bold></td></tr><tr><td rowspan="2">PHA-665752</td><td>RF</td><td>0.0370</td><td>1.4403</td><td>1.2665</td><td>1.1492</td><td>1.0658</td><td>1.0002</td><td>0.9555</td><td>0.9539</td><td>0.9485</td><td>1.0975</td></tr><tr><td>FRF</td><td><bold>0</bold>.<bold>0259</bold></td><td><bold>1</bold>.<bold>3522</bold></td><td><bold>1</bold>.<bold>2051</bold></td><td><bold>1</bold>.<bold>0999</bold></td><td><bold>1</bold>.<bold>0149</bold></td><td><bold>0</bold>.<bold>9546</bold></td><td><bold>0</bold>.<bold>9054</bold></td><td><bold>0</bold>.<bold>8954</bold></td><td><bold>0</bold>.<bold>9097</bold></td><td><bold>1</bold>.<bold>0422</bold></td></tr><tr><td rowspan="2">MG-132</td><td>RF</td><td>0.1246</td><td>1.6207</td><td>1.6688</td><td>1.7445</td><td>1.7830</td><td>1.8549</td><td>1.9289</td><td>2.0313</td><td>2.1509</td><td>1.8479</td></tr><tr><td>FRF</td><td><bold>0</bold>.<bold>1070</bold></td><td><bold>1</bold>.<bold>6062</bold></td><td><bold>1</bold>.<bold>6479</bold></td><td><bold>1</bold>.<bold>6968</bold></td><td><bold>1</bold>.<bold>7541</bold></td><td><bold>1</bold>.<bold>8117</bold></td><td><bold>1</bold>.<bold>8794</bold></td><td><bold>1</bold>.<bold>9619</bold></td><td><bold>2</bold>.<bold>0857</bold></td><td><bold>1</bold>.<bold>8055</bold></td></tr></tbody></table><table-wrap-foot><p>For FRF, node cost is calculated using 8 different <italic>IC</italic> regions. Bold values indicate the best performance.</p></table-wrap-foot></table-wrap></p><p id="Par37">Figure&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref> illustrates the difference between MAE values of FRF and RF predictions for Mean <italic>IC</italic> and <italic>AUC</italic> values for 70 drugs from GDSC. For mean <italic>IC</italic>, FRF shows superior performance in 68 out of 70 applied drugs, while FRF outperforms RF in 58 out of 70 applied drugs for <italic>AUC</italic> prediction. These results support the conclusion achieved from CCLE data analysis that FRF provides higher predictive accuracy than a regular RF. Figure&#x000a0;<xref rid="MOESM1" ref-type="media">S3</xref> provides the performance comparison of the rest of the 140 GDSC (v5) drugs.<fig id="Fig7"><label>Figure 7</label><caption><p>Difference between MAEs of FRF and RF for (i) Mean <italic>IC</italic> values, and (ii) <italic>AUC</italic> values for 70 drugs from GDSC.</p></caption><graphic xlink:href="41598_2018_38231_Fig7_HTML" id="d29e6393"/></fig></p></sec><sec id="Sec20"><title>Function-to-function regression using HMS-LINCS</title><p id="Par38">As described earlier, the HMS-LINCS database provides functional data for input proteomic expressions (for 21 proteins) and output cellular viability<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup> post application of 5 different drugs at 7 different doses in 10 melanoma cell lines at multiple time points. For our analysis, we only use the 48-hour data since it contains complete records for both input and output. Thus, we have 50 samples in total with 143 predictors (<italic>i</italic>.<italic>e</italic>., 21&#x02009;&#x000d7;&#x02009;7&#x02009;&#x02212;&#x02009;4&#x02009;=&#x02009;143, since we exclude 4 proteins due to missing values). The detailed description of the data extraction framework is provided in section Function-to-function regression with FRF with a pictorial representation in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>. For our function-to-function regression using FRF, we either consider the 143 predictors directly as input features, or extract the 3<sup>rd</sup> degree polynomial-fitted dose-expression curve features to use as predictors. As the curve features, we estimate 3 different <italic>IC</italic> points at <italic>IC</italic><sub>25</sub>, <italic>IC</italic><sub>50</sub> and <italic>IC</italic><sub>75</sub> and the overall <italic>AUC</italic>, as shown in Figs&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> &#x00026; <xref rid="MOESM1" ref-type="media">S1</xref> for all 21 proteins. Table&#x000a0;<xref rid="Tab6" ref-type="table">6</xref> displays the function-to-function regression results for 3 different input scenarios using FRF. We compare these performances with the performances of dose-wise standard RF models using the 143 expression values as input features for the 50 samples. From Table&#x000a0;<xref rid="Tab6" ref-type="table">6</xref>, we observe that FRF provides superior performance as compared to RF for all 3 scenarios while the usage of curve <italic>IC</italic> features provides the highest reduction (~20%) in prediction error. These results clearly demonstrate the potential of FRF in enhancing the predictive modeling performance <italic>via</italic> utilizing the functional input curve features.<fig id="Fig8"><label>Figure 8</label><caption><p>Data extraction procedure for Functional Regression Tree model. From each of the 21 observed protein expression curves, we calculate the <italic>AUC</italic>, <italic>IC</italic><sub>25</sub>, <italic>IC</italic><sub>50</sub> and <italic>IC</italic><sub>75</sub> values resulting in a complete feature matrix of 21&#x02009;&#x000d7;&#x02009;4. For response modeling, the entire cellular viability curve post drug application is used directly.</p></caption><graphic xlink:href="41598_2018_38231_Fig8_HTML" id="d29e6486"/></fig><table-wrap id="Tab6"><label>Table 6</label><caption><p>Comparison of predictive performance of RF and FRF with functional data input from HMS-LINCS where <italic>AUC</italic>, <italic>IC</italic><sub>25</sub>, <italic>IC</italic><sub>50</sub> &#x00026; <italic>IC</italic><sub>75</sub> values of proteomic dose-expression curves are used as input features.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Model</th><th>Input Feature Description</th><th>#Features</th><th>#Models</th><th>MAE</th></tr></thead><tbody><tr><td>RF</td><td>Protein Expression</td><td>143</td><td>7</td><td>0.2656</td></tr><tr><td rowspan="3">FRF</td><td>Protein Expression</td><td>143</td><td>1</td><td>0.2602</td></tr><tr><td><italic>AUC</italic>, <italic>IC</italic><sub>25</sub>, <italic>IC</italic><sub>50</sub> &#x00026; <italic>IC</italic><sub>75</sub> of dose-expression curve</td><td>84</td><td>1</td><td>0.2255</td></tr><tr><td><italic>IC</italic><sub>25</sub>, <italic>IC</italic><sub>50</sub> &#x00026; <italic>IC</italic><sub>75</sub> of dose-expression curve</td><td>63</td><td>1</td><td><bold>0</bold>.<bold>2154</bold></td></tr></tbody></table><table-wrap-foot><p>Bold value indicates the best performance.</p></table-wrap-foot></table-wrap></p></sec></sec><sec id="Sec21"><title>Biological validation of the models</title><p id="Par39">A potential model validation approach is to consider the <italic>variable importance measure</italic> (VIM) of the genes. We expect that a better model will have higher feature scores for the significant genes, and thus, in turn will result in a higher biological relevance. Typically in RF based models, VIM (or feature score) is calculated from either the frequency of feature selection, out of bag errors, or permutation measures<sup><xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR25">25</xref></sup>. In this section, we use the frequency based approach to calculate the VIM score from the number of times a gene is considered and the number of times it actually gets selected in splitting the nodes.<disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\rm{VIM}}}_{j}=\frac{\#{\rm{times}}\,{\rm{gene}}\,j\,{\rm{is}}\,{\rm{selected}}}{\#{\rm{times}}\,{\rm{gene}}\,j\,{\rm{is}}\,{\rm{considered}}}=\frac{{m}_{j}^{{\rm{selected}}}}{{m}_{j}^{{\rm{picked}}}}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:msub><mml:mrow><mml:mi mathvariant="normal">VIM</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>#</mml:mo><mml:mi mathvariant="normal">times</mml:mi><mml:mspace width=".25em"/><mml:mi mathvariant="normal">gene</mml:mi><mml:mspace width=".25em"/><mml:mi>j</mml:mi><mml:mspace width=".25em"/><mml:mi mathvariant="normal">is</mml:mi><mml:mspace width=".25em"/><mml:mi mathvariant="normal">selected</mml:mi></mml:mrow><mml:mrow><mml:mo>#</mml:mo><mml:mi mathvariant="normal">times</mml:mi><mml:mspace width=".25em"/><mml:mi mathvariant="normal">gene</mml:mi><mml:mspace width=".25em"/><mml:mi>j</mml:mi><mml:mspace width=".25em"/><mml:mi mathvariant="normal">is</mml:mi><mml:mspace width=".25em"/><mml:mi mathvariant="normal">considered</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">selected</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">picked</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41598_2018_38231_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par40">For our FRF models, we have selected the parameters values as #Trees&#x02009;=&#x02009;500, <italic>m</italic>&#x02009;=&#x02009;50, minimum leaf size&#x02009;=&#x02009;5 for a 5 fold cross-validation of CCLE data. Based on these values, all 18,405 CCLE genes gets picked around 600 to 900 times, giving each a fair chance to contribute to the model. The top features of the models (<italic>i</italic>.<italic>e</italic>., genes with higher VIM scores) are then biologically validated in terms of protein-protein interaction (PPI) network enrichment analysis.</p><p id="Par41">There are a number of Bioinformatics resources (<italic>e</italic>.<italic>g</italic>., STRING<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, GeneMANIA, DAVID etc.) available for evaluation of the number of observed PPIs in a set of selected genes. These interactions have been determined using prior knowledge and information from various interaction sources such as literature text-mining, experiment results, genomic/proteomic databases, gene co-expressions, gene neighborhood, gene fusion and co-occurrences. For CCLE, we have used Affymetrix HG-U133A mapping to convert the top features into corresponding genes. These genes are then provided as the inputs in the STRING database (<ext-link ext-link-type="uri" xlink:href="http://string-db.org/">http://string-db.org/</ext-link>) to extract the known PPI network. Table&#x000a0;<xref rid="Tab7" ref-type="table">7</xref> shows the PPI analysis results for entire genome with a minimum interaction score of 0.15 for the 5 previously considered drugs for both FRF and equivalent RF models. We observe a higher level of connectivity enrichment for the top 200 FRF features as compared to the top 200 RF features in terms of PPI enrichment <italic>p</italic>-value and the ratio of observed to expected number of edges<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, resulting from possibly the functional collaborations between the products of the FRF genes.<table-wrap id="Tab7"><label>Table 7</label><caption><p>Protein-protein interaction enrichment analysis for top 200 genes picked from RF and FRF using the whole genome statistical background with a minimum interaction score of 0.15.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Drug</th><th>Model</th><th>#Nodes</th><th>#Edges</th><th>Expected #edges</th><th>Ratio of observed to expected #edges</th><th>PPI enrichment <italic>p</italic>-value</th></tr></thead><tbody><tr><td rowspan="2">Erlotinib</td><td>RF</td><td>107</td><td>132</td><td>127</td><td>1.04</td><td>0.356</td></tr><tr><td>FRF</td><td>105</td><td>170</td><td>142</td><td><bold>1</bold>.<bold>20</bold></td><td><bold>0</bold>.<bold>013</bold></td></tr><tr><td rowspan="2">Nilotinib</td><td>RF</td><td>102</td><td>185</td><td>162</td><td>1.14</td><td>0.044</td></tr><tr><td>FRF</td><td>101</td><td>173</td><td>144</td><td><bold>1</bold>.<bold>20</bold></td><td><bold>0</bold>.<bold>010</bold></td></tr><tr><td rowspan="2">PD-0325901</td><td>RF</td><td>107</td><td>191</td><td>187</td><td>1.02</td><td>0.407</td></tr><tr><td>FRF</td><td>113</td><td>153</td><td>139</td><td><bold>1</bold>.<bold>10</bold></td><td><bold>0</bold>.<bold>134</bold></td></tr><tr><td rowspan="2">PLX-4720</td><td>RF</td><td>106</td><td>159</td><td>147</td><td>1.08</td><td>0.164</td></tr><tr><td>FRF</td><td>111</td><td>217</td><td>187</td><td><bold>1</bold>.<bold>16</bold></td><td><bold>0</bold>.<bold>018</bold></td></tr><tr><td rowspan="2">TAE-684</td><td>RF</td><td>103</td><td>159</td><td>141</td><td>1.13</td><td>0.078</td></tr><tr><td>FRF</td><td>106</td><td>180</td><td>151</td><td><bold>1</bold>.<bold>19</bold></td><td><bold>0</bold>.<bold>011</bold></td></tr></tbody></table></table-wrap></p></sec></sec><sec id="Sec22" sec-type="discussion"><title>Discussion</title><p id="Par42">In this article, we have presented an enhancement to Random Forest modeling that can incorporate both stationary and functional inputs to predict functional output. The ability to predict the complete functional dose-response profile can be instrumental in various scenarios. For instance, there can be multiple dose-response curves with similar values of the extracted features (<italic>i</italic>.<italic>e</italic>., <italic>AUC</italic> or <italic>IC</italic><sub>50</sub>) but they can significantly differ in cytotoxicity or cell viability rate at higher doses. Figure&#x000a0;<xref rid="Fig9" ref-type="fig">9</xref> shows an example of this phenomenon where two different dose-response curves for two distinct cell lines in CCLE after AZD-6244 administration have almost the same <italic>AUC</italic> values (<italic>AUC</italic><sub>1</sub>&#x02009;=&#x02009;0.0945, <italic>AUC</italic><sub>2</sub>&#x02009;=&#x02009;0.095) but different rates of cell viability change at doses &#x02265;0.25&#x02009;<italic>&#x003bc;M</italic>. Figure&#x000a0;<xref rid="Fig9" ref-type="fig">9</xref> also demonstrates that FRF is capable of capturing the different response curve behaviors for the two cell lines.<fig id="Fig9"><label>Figure 9</label><caption><p>Illustration of different dose-response curves for two cell lines in CCLE post AZD-6244 application with similar AUC values but different responses at higher doses. The complete dose-response profile prediction using Functional Random Forest is able to capture the difference in response behaviors for majority of the doses.</p></caption><graphic xlink:href="41598_2018_38231_Fig9_HTML" id="d29e7102"/></fig></p><p id="Par43">Through the application on both synthetic and actual biological data, we have established the superior performance of FRF in predicting dose-response curve summary metrics such as <italic>AUC</italic> and <italic>IC</italic><sub>50</sub> as compared to na&#x000ef;ve Random Forest model trained on these metrics as output. Furthermore, FRF predicts the entire dose-response profile incorporating the continuous nature of the curve that separate RF models for individual doses fails to capture. We have illustrated this behavior for GDSC dataset by modeling 8 <italic>IC</italic> points using 8 different RFs to generate the dose-response profile which has an inferior performance compared to the continuous curve prediction from FRF (Table&#x000a0;<xref rid="Tab5" ref-type="table">5</xref>). Moreover, a major advantage of predicting a complete curve is the visualization of the changes in response across different doses. Figure&#x000a0;<xref rid="Fig10" ref-type="fig">10</xref> shows two representative cases of Curve<sup>(1)</sup> and Curve<sup>(2)</sup> that has same <italic>IC</italic><sub>50</sub> values and similar <italic>AUC</italic> values but their dose-response profiles are significantly different. For instance, a small dose increase above <italic>IC</italic><sub>50</sub> will produce significantly higher sensitivity for Curve<sup>(1)</sup> whereas Curve<sup>(2)</sup> will have minimal change for dose increases above the <italic>IC</italic><sub>50</sub> value. This behavior will not be captured if we only predict the <italic>AUC</italic> or <italic>IC</italic><sub>50</sub> summary metric as both the curves have similar <italic>IC</italic><sub>50</sub> and <italic>AUC</italic> values. This example illustrates the need for complete dose-response profile prediction in the larger context of drug sensitivity prediction.<fig id="Fig10"><label>Figure 10</label><caption><p>Two different dose-response curves with the same <italic>IC</italic><sub>50</sub> and <italic>AUC</italic> values.</p></caption><graphic xlink:href="41598_2018_38231_Fig10_HTML" id="d29e7187"/></fig></p><p id="Par44">There are a number of adjustable parameters available in any regression tree based model (<italic>i</italic>.<italic>e</italic>., minimum leaf size, maximum features used for split, and number of trees in the forest) that we can change to get optimal performance, as illustrated in Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>. Note that increasing the model complexity has similar impact on both RF and FRF models with FRF retaining its superior performance over RF but with a higher computational demand. However, we also observed several drugs in CCLE (e.g., 17-AAG, AZD-6244, Paclitaxel, PD-0325901) for which the prediction errors (MAE) for both FRF and RF are quite high. For these drugs, the dose-response points at different doses for the available cell lines are stretched out and the resulting fitted curves or summary metrics show significant variations which cannot be captured by any Random Forest based model since it employs an smoothing strategy (averaging) in the leaf nodes to provide estimates around the mean prediction. We are currently looking at different types of regression modeling to solve this issue of bias in prediction. We also hope to further extend this work <italic>via</italic> the incorporation of joint prediction of multiple correlated dose-response profiles while preserving the output dependency structure.</p></sec><sec sec-type="supplementary-material"><title>Supplementary information</title><sec id="Sec23"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="41598_2018_38231_MOESM1_ESM.pdf"><caption><p>Supplementary: Functional Random Forest with applications in dose response predictions</p></caption></media></supplementary-material>
</p></sec></sec></body><back><fn-group><fn><p><bold>Publisher&#x02019;s note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><sec><title>Electronic supplementary material</title><p><bold>Supplementary information</bold> accompanies this paper at 10.1038/s41598-018-38231-w.</p></sec><ack><title>Acknowledgements</title><p>This work has been supported by NIH grant R01GM122084-01.</p></ack><notes notes-type="author-contribution"><title>Author Contributions</title><p>R.R., S.G. and R.P. conceived of and designed the experiments. R.R. and S.R.D. performed the experiments. R.R. and R.P. analyzed the data. R.R., S.R.D. and R.P. wrote the paper. All authors have read and approved the final manuscript.</p></notes><notes notes-type="COI-statement"><sec id="FPar1"><title>Competing Interests</title><p>The authors declare no competing interests.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barretina</surname><given-names>J</given-names></name><etal/></person-group><article-title>The cancer cell line encyclopedia enables predictive modelling of anticancer drug sensitivity</article-title><source>Nature</source><year>2012</year><volume>483</volume><fpage>603</fpage><lpage>607</lpage><pub-id pub-id-type="doi">10.1038/nature11003</pub-id><pub-id pub-id-type="pmid">22460905</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Costello</surname><given-names>JC</given-names></name><etal/></person-group><article-title>A community effort to assess and improve drug sensitivity prediction algorithms</article-title><source>Nature biotechnology</source><year>2014</year><volume>32</volume><fpage>1202</fpage><lpage>1212</lpage><pub-id pub-id-type="doi">10.1038/nbt.2877</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wan</surname><given-names>Q</given-names></name><name><surname>Pal</surname><given-names>R</given-names></name></person-group><article-title>An ensemble based top performing approach for nci-dream drug sensitivity prediction challenge</article-title><source>PloS one</source><year>2014</year><volume>9</volume><fpage>e101183</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0101183</pub-id><pub-id pub-id-type="pmid">24978814</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="other">Pal, R. <italic>Predictive Modeling of Drug Sensitivity</italic> (Academic Press, 2016).</mixed-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>W</given-names></name><etal/></person-group><article-title>Genomics of drug sensitivity in cancer (gdsc): a resource for therapeutic biomarker discovery in cancer cells</article-title><source>Nucleic acids research</source><year>2013</year><volume>41</volume><fpage>D955</fpage><lpage>D961</lpage><pub-id pub-id-type="doi">10.1093/nar/gks1111</pub-id><pub-id pub-id-type="pmid">23180760</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seashore-Ludlow</surname><given-names>B</given-names></name><etal/></person-group><article-title>Harnessing connectivity in a large-scale small-molecule sensitivity dataset</article-title><source>Cancer discovery</source><year>2015</year><volume>5</volume><fpage>1210</fpage><lpage>1223</lpage><pub-id pub-id-type="doi">10.1158/2159-8290.CD-15-0235</pub-id><pub-id pub-id-type="pmid">26482930</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="other">Sirski, M. <italic>On the statistical analysis of functional data arising from designed experiments</italic>. Ph.D. thesis, University of Manitoba (Canada) (2012).</mixed-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riddick</surname><given-names>G</given-names></name><etal/></person-group><article-title>Predicting in vitro drug sensitivity using random forests</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><fpage>220</fpage><lpage>224</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq628</pub-id><pub-id pub-id-type="pmid">21134890</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rahman</surname><given-names>R</given-names></name><name><surname>Haider</surname><given-names>S</given-names></name><name><surname>Ghosh</surname><given-names>S</given-names></name><name><surname>Pal</surname><given-names>R</given-names></name></person-group><article-title>Design of probabilistic random forests with applications to anticancer drug sensitivity prediction</article-title><source>Cancer informatics</source><year>2015</year><volume>14</volume><fpage>57</fpage><?supplied-pmid 27081304?><pub-id pub-id-type="pmid">27081304</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="other">Rahman, R., Otridge, J. &#x00026; Pal, R. Integratedmrf: random forest-based framework for integrating prediction from different data types. <italic>Bioinformatics</italic> (<italic>Oxford</italic>, <italic>England</italic>) (2017).</mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="other">Dhruba, S. R., Rahmanl, R., Matlockl, K., Ghosh, S. &#x00026; Pal, R. Dimensionality reduction based transfer learning applied to pharmacogenomics databases. In <italic>2018 40th Annual International Conference of the IEEE Engineering in Medicine and Biology Society</italic> (<italic>EMBC</italic>), 1246&#x02013;1249 (IEEE, 2018).</mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="other">Ramsay, J. O. <italic>Functional data analysis</italic> (Wiley Online Library, 2006).</mixed-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>Y</given-names></name><name><surname>Lambert</surname><given-names>D</given-names></name></person-group><article-title>Fitting trees to functional data, with an application to time-of-day patterns</article-title><source>Journal of Computational and graphical Statistics</source><year>1999</year><volume>8</volume><fpage>749</fpage><lpage>762</lpage></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nerini</surname><given-names>D</given-names></name><name><surname>Ghattas</surname><given-names>B</given-names></name></person-group><article-title>Classifying densities using functional regression trees: Applications in oceanology</article-title><source>Computational Statistics &#x00026; Data Analysis</source><year>2007</year><volume>51</volume><fpage>4984</fpage><lpage>4993</lpage><pub-id pub-id-type="doi">10.1016/j.csda.2006.09.028</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="other">Rahman, R. &#x00026; Pal, R. Analyzing drug sensitivity prediction based on dose response curve characteristics. In <italic>Biomedical and Health Informatics</italic> (<italic>BHI</italic>), <italic>2016 IEEE-EMBS International Conference on</italic>, 140&#x02013;143 (IEEE, 2016).</mixed-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fallahi-Sichani</surname><given-names>M</given-names></name><etal/></person-group><article-title>Systematic analysis of brafv600e melanomas reveals a role for jnk/c-jun pathway in adaptive resistance to drug-induced apoptosis</article-title><source>Molecular Systems Biology</source><year>2015</year><volume>11</volume><fpage>797</fpage><pub-id pub-id-type="doi">10.15252/msb.20145877</pub-id><pub-id pub-id-type="pmid">25814555</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="other">Matlock, K., Dhruba, S. R., Nazir, M. &#x00026; Pal, R. An investigation of proteomic data for application in precision medicine. In <italic>Biomedical &#x00026; Health Informatics</italic> (<italic>BHI</italic>), <italic>2018 IEEE EMBS International Conference on</italic>, 377&#x02013;380 (IEEE, 2018).</mixed-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breiman</surname><given-names>L</given-names></name></person-group><article-title>Random forests</article-title><source>Machine learning</source><year>2001</year><volume>45</volume><fpage>5</fpage><lpage>32</lpage><pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wold</surname><given-names>S</given-names></name><name><surname>Esbensen</surname><given-names>K</given-names></name><name><surname>Geladi</surname><given-names>P</given-names></name></person-group><article-title>Principal component analysis</article-title><source>Chemometrics and intelligent laboratory systems</source><year>1987</year><volume>2</volume><fpage>37</fpage><lpage>52</lpage><pub-id pub-id-type="doi">10.1016/0169-7439(87)80084-9</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meinshausen</surname><given-names>N</given-names></name></person-group><article-title>Quantile regression forests</article-title><source>Journal of Machine Learning Research</source><year>2006</year><volume>7</volume><fpage>983</fpage><lpage>999</lpage></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biau</surname><given-names>G</given-names></name></person-group><article-title>Analysis of a random forests model</article-title><source>Journal of Machine Learning Research</source><year>2012</year><volume>13</volume><fpage>1063</fpage><lpage>1095</lpage></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kullback</surname><given-names>S</given-names></name><name><surname>Leibler</surname><given-names>RA</given-names></name></person-group><article-title>On information and sufficiency</article-title><source>The annals of mathematical statistics</source><year>1951</year><volume>22</volume><fpage>79</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1214/aoms/1177729694</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hellinger</surname><given-names>E</given-names></name></person-group><article-title>Neue begr&#x000fc;ndung der theorie quadratischer formen von unendlichvielen ver&#x000e4;nderlichen</article-title><source>Journal f&#x000fc;r die reine und angewandte Mathematik</source><year>1909</year><volume>136</volume><fpage>210</fpage><lpage>271</lpage></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Archer</surname><given-names>KJ</given-names></name><name><surname>Kimes</surname><given-names>RV</given-names></name></person-group><article-title>Empirical characterization of random forest variable importance measures</article-title><source>Computational Statistics &#x00026; Data Analysis</source><year>2008</year><volume>52</volume><fpage>2249</fpage><lpage>2260</lpage><pub-id pub-id-type="doi">10.1016/j.csda.2007.08.015</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haider</surname><given-names>S</given-names></name><name><surname>Rahman</surname><given-names>R</given-names></name><name><surname>Ghosh</surname><given-names>S</given-names></name><name><surname>Pal</surname><given-names>R</given-names></name></person-group><article-title>A copula based approach for design of multivariate random forests for drug sensitivity prediction</article-title><source>PloS one</source><year>2015</year><volume>10</volume><fpage>e0144490</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0144490</pub-id><pub-id pub-id-type="pmid">26658256</pub-id></element-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szklarczyk</surname><given-names>D</given-names></name><etal/></person-group><article-title>String v10: protein&#x02013;protein interaction networks, integrated over the tree of life</article-title><source>Nucleic acids research</source><year>2014</year><volume>43</volume><fpage>D447</fpage><lpage>D452</lpage><pub-id pub-id-type="doi">10.1093/nar/gku1003</pub-id><pub-id pub-id-type="pmid">25352553</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taguchi</surname><given-names>Y</given-names></name></person-group><article-title>Principal components analysis based unsupervised feature extraction applied to gene expression analysis of blood from dengue haemorrhagic fever patients</article-title><source>Scientific reports</source><year>2017</year><volume>7</volume><fpage>44016</fpage><pub-id pub-id-type="doi">10.1038/srep44016</pub-id><pub-id pub-id-type="pmid">28276456</pub-id></element-citation></ref></ref-list></back></article>