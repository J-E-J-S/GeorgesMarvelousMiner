<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nat Commun</journal-id><journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id><journal-title-group><journal-title>Nature Communications</journal-title></journal-title-group><issn pub-type="epub">2041-1723</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6715686</article-id><article-id pub-id-type="publisher-id">11857</article-id><article-id pub-id-type="doi">10.1038/s41467-019-11857-8</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Identification of somatic mutations in single cell DNA-seq using a spatial model of allelic imbalance</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6968-9043</contrib-id><name><surname>Luquette</surname><given-names>Lovelace J.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4063-4844</contrib-id><name><surname>Bohrson</surname><given-names>Craig L.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5297-9252</contrib-id><name><surname>Sherman</surname><given-names>Max A.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9378-960X</contrib-id><name><surname>Park</surname><given-names>Peter J.</given-names></name><address><email>peter_park@hms.harvard.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution>Department of Biomedical Informatics, </institution><institution>Harvard Medical School, </institution></institution-wrap>Boston, MA USA </aff><aff id="Aff2"><label>2</label>Ludwig Center at Harvard, Boston, MA USA </aff></contrib-group><pub-date pub-type="epub"><day>29</day><month>8</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>29</day><month>8</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>10</volume><elocation-id>3908</elocation-id><history><date date-type="received"><day>16</day><month>10</month><year>2018</year></date><date date-type="accepted"><day>8</day><month>8</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">Recent advances in single cell technology have enabled dissection of cellular heterogeneity in great detail. However, analysis of single cell DNA sequencing data remains challenging due to bias and artifacts that arise during DNA extraction and whole-genome amplification, including allelic imbalance and dropout. Here, we present a framework for statistical estimation of allele-specific amplification imbalance at any given position in single cell whole-genome sequencing data by utilizing the allele frequencies of heterozygous single nucleotide polymorphisms in the neighborhood. The resulting allelic imbalance profile is critical for determining whether the variant allele fraction of an observed mutation is consistent with the expected fraction for a true variant. This method, implemented in SCAN-SNV (Single Cell ANalysis of SNVs), substantially improves the identification of somatic variants in single cells. Our allele balance framework is broadly applicable to genotype analysis of any variant type in any data that might exhibit allelic imbalance.</p></abstract><abstract id="Abs2" abstract-type="web-summary"><p id="Par2">Single cell whole-genome sequencing data harbors information about somatic genetic variation but is challenging to analyze. Here, the authors develop a spatial model to correct for allelic amplification imbalance and a somatic SNV genotyper SCAN-SNV for analyzing single cell DNA sequencing data.</p></abstract><kwd-group kwd-group-type="npg-subject"><title>Subject terms</title><kwd>Genomics</kwd><kwd>Statistical methods</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000051</institution-id><institution>U.S. Department of Health &#x00026; Human Services | NIH | National Human Genome Research Institute (NHGRI)</institution></institution-wrap></funding-source><award-id>T32HG002295</award-id><principal-award-recipient><name><surname>Park</surname><given-names>Peter J.</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par3">Single-cell DNA sequencing (scDNA-seq) has recently emerged as an efficient and scalable tool to study genetic heterogeneity in multicellular organisms. Although whole-genome sequencing of bulk tissues has been used to identify somatic mutations, its sensitivity for mutations present in a low fraction of cells is limited. For example, mutations shared by fewer than 5% of cells are difficult to detect even with 100&#x02009;&#x000d7; sequencing. scDNA-seq, on the other hand, offers the possibility of detecting mutations of essentially any frequency as long as they are present in the selected single cell. In addition, co-occurrence patterns among multiple mutations across multiple single cells can define subclonal populations and reveal evolutionary dynamics within a cell population. Recent applications of scDNA-seq have elucidated subclonal evolution processes in breast carcinoma<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> and revealed a biological mechanism capable of generating chromothripsis, disastrous DNA damage often observed in cancer cells<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. In our own work, we have used scDNA-seq to reconstruct cellular lineage in the brain using somatic mutations as markers<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> and to uncover the accumulation of single nucleotide mutations in aging human neurons<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>.</p><p id="Par4">The genome of a single cell must first be extracted and extensively amplified to produce sufficient DNA for sequencing on standard high-throughput sequencing platforms. Of the handful of whole-genome amplification (WGA) protocols currently available<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, multiple displacement amplification (MDA) is presently considered the most suitable for genome-wide detection of single nucleotide variants (SNVs) and short insertions and deletions due its ability to amplify the majority of a human genome with a high-fidelity polymerase<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>. However, MDA is a non-linear amplification process and therefore suffers from non-uniform amplification of the genome, creating high variability in sequencing depth along the genome. The same non-uniform amplification process can also cause differences in amplification between homologous copies of the same DNA because they are amplified essentially independently<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). In human cells, for example, the maternal copy of a gene can be amplified to a different level than the paternal copy, leading to a large disparity in the number of sequencing reads generated from each allele. This allelic imbalance is common in MDA-amplified DNA libraries and substantially complicates the identification of somatic mutations&#x02014;which appear as heterozygous variants&#x02014;in scDNA-seq data.<fig id="Fig1"><label>Fig. 1</label><caption><p>scDNA-seq artifacts. scDNA-seq analysis is complicated by a combination of imbalanced amplification of homologous alleles (allelic imbalance) and early artifacts that affect a large fraction of initial DNA. <bold>a</bold> MDA is a non-linear amplification process. DNA strands displaced by replication are immediately available for repeated rounds of replication, which can lead to imbalanced amplification between homologous alleles. Single cell sequencing depth is the sum of allele-specific sequencing depths, represented by a stacked depth plot. Pink: sequencing depth of maternal allele; blue: paternal allele. <bold>b</bold> Routine DNA damage during extraction protocols can disproportionately impact single cell DNA. Bulk DNA damage is mostly washed out since spontaneous errors are unlikely to recur independently on multiple molecules. However, damage to a single cell&#x02019;s&#x000a0;genome can affect a large amount (25%; single-stranded error) of the initial template. In an idealized MDA process, MDA replicates all four initial strands (two molecules) of DNA to produce eight strands (four molecules). A random polymerase misincorporation error would affect 1 out of 8 DNA strands, affecting 12.5% of the DNA. <bold>c</bold> Allelic imbalance affects the VAF of both true mutations and artifacts. Over amplification of an allele harboring early single-stranded damage (red) can inflate the artifact to a mutation-like VAF while a true mutation (green) can be reduced to low VAF. <bold>d</bold> Without allelic imbalance, heterozygous SNV VAFs would be tightly distributed around 50% due to random sampling effects. However, allelic imbalance causes VAFs in scDNA-seq to be significantly over-dispersed symmetrically around 50%</p></caption><graphic xlink:href="41467_2019_11857_Fig1_HTML" id="d29e295"/></fig></p><p id="Par5">In scDNA-seq applications aiming to identify somatic SNVs, computational filtering of physical artifacts that arise spontaneously during cell lysis, DNA extraction, library preparation, and WGA is essential, as the number of artifacts can vastly exceed the number of true somatic mutations and obscure biologically relevant signals. Artifacts occurring before amplification or in the early stages of amplification could affect a substantial fraction of the few DNA copies at any genomic locus (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). Subsequently, allelic imbalance can further confound detection of such artifacts by over-amplifying the artifact-harboring allele relative to its homolog and can make true mutations harder to detect by under-amplifying the mutation-harboring allele (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). As a result, variant allele fraction (VAF)&#x02014;the fraction of sequencing reads supporting a heterozygous variant&#x02014;may deviate substantially from the expected ~50% and is not as informative as it is in bulk sequencing for distinguishing artifacts from true mutations. The effect of allelic imbalance on VAF is often substantial and is evident by examining the VAFs of known heterozygous SNPs in single-cell data (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). Because the VAF of true heterozygous variants in single-cell data should follow the fraction of DNA amplicons from the variant-harboring allele while artifacts do not, the observed VAF of a putative mutation must be appraised considering the allelic-specific amplification balance at that position.</p><p id="Par6">To properly evaluate VAFs in the context of genotyping, we developed a spatial model to estimate allele-specific amplification balance (AB) at any genomic locus. A genome-wide AB curve is constructed by measuring AB at a large set of heterozygous SNPs (obtained prior to scDNA-seq) and inferring AB in the intervening regions. Specifically, the model considers how AB measurements at heterozygous SNPs (hSNPs) correlate with AB away from hSNPs and how to properly combine information from multiple hSNPs in a large neighborhood. This approach proves particularly fruitful in MDA-amplified libraries in which the characteristically long amplicon lengths (typically ~5&#x02013;10&#x02009;kb) cause the AB to change relatively slowly along the genome.</p><p id="Par7">The AB model enabled the development of a novel somatic SNV genotyper called SCAN-SNV (single-cell analysis of SNVs). SCAN-SNV removes scDNA-seq artifacts by requiring candidate sSNV VAFs to both match the estimated local AB and not match VAFs consistent with common scDNA-seq artifacts. SCAN-SNV also employs a novel method to estimate artifact burden and an upper limit on the number of true somatic mutations prior to genotyping, which helps to address situations in which the artefactual mutations substantially outnumber somatic mutations. Standard SNV genotypers designed for bulk data have been shown to perform very poorly when applied to single cells, primarily by calling a large number of artifacts as true mutations<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup>. Our comparative analyses show that SCAN-SNV substantially outperforms both Monovar<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> and SCcaller<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, with a &#x0003e;3-fold decrease in false discovery rate while maintaining similar sensitivity.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><sec id="Sec3"><title>Distinguishing artifacts from mutations using allele balance</title><p id="Par8">Below, we demonstrate how allelic imbalance can lead to false positive (FP) variant calls in practice and how estimating AB can help to avoid such erroneous calls. We also show how to approximate the prevalence of single-cell artifacts and bound the somatic mutation rate prior to genotyping, which can help to control the false discovery rate (FDR). Finally, we integrate these ideas into our sSNV genotyper SCAN-SNV and apply it to a scDNA-seq benchmarking data set.</p><p id="Par9">In general, candidate mutations supported by a high fraction of sequencing reads are less likely to be artifacts than low VAF candidates. However, even high VAF candidates must be carefully examined in scDNA-seq data because a considerable number of single-cell artifacts attain high VAF due to allelic imbalance. In Fig. <xref rid="Fig2" ref-type="fig">2a</xref>, we provide an example of a high VAF (44%) artifact present in a single neuron<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. Although the high VAF is promising initially, the nearby hSNP rs10872298 (a well-characterized polymorphism, also found in bulk samples of the same individuals) is supported by 94% of reads, indicating that the region is severely affected by allelic imbalance. Therefore, acceptable candidate mutation VAFs should be similar to either 6 or 94% since all reads from the mutated allele should support the sSNV. On the other hand, a single-stranded, pre-amplification artifact on the over-amplified allele would be supported by half of reads from that allele on average (94%/2&#x02009;=&#x02009;47%, Fig. <xref rid="Fig1" ref-type="fig">1c</xref>), which closely matches the observed VAF. This suggests the candidate sSNV should be rejected despite its high VAF and demonstrates the utility of AB in evaluating the fraction of reads supporting a mutation.<fig id="Fig2"><label>Fig. 2</label><caption><p>The allele balance model helps to identify single cell artifacts. <bold>a</bold> A single cell artifact (left, green) attains high VAF (44%). The region is affected by allelic imbalance as evidenced by the hSNP with VAF 94% (right, blue). The candidate sSNV should present with VAF&#x02009;&#x02248;&#x02009;6% or VAF&#x02009;&#x02248;&#x02009;94%. <bold>b</bold> MDA polymerase (green) randomly dissociates from the template DNA belonging to one allele (black), creating amplicons (gray) of various lengths. Nearby sites are highly likely to be amplified by the same polymerase, but the probability decreases for more distant sites. This creates a correlation in allele-specific amplification levels between nearby sites (blue, orange). The process occurs independently on both homologous alleles, leading to a stable allele balance in a small genomic locus. <bold>c</bold> Long amplicons cause allele-specific read depths (blue, paternal allele; pink, maternal allele) to change more slowly along the genome. When each allele is more stable, so is the allelic balance. The AB correlation function quantifies allele balance stability. <bold>d</bold> Illustration of AB modeling and estimation. Reads at hSNPs can be assigned to alleles based on whether they contain reference- or variant-supporting bases. This allows allele-specific depth, and therefore AB, to be estimated at the hSNP. AB outside of hSNP loci is inferred (thick black line) using a Gaussian process parameterized by the AB correlation function. A binomial read sampling model determines how closely the inferred AB curve should follow the noisy hSNP measurements (error bars: 95% confidence intervals). Phasing hSNPs allows the paternal SNP (blue) VAF to be adjusted to (1 &#x02013; VAF) to be consistent with the surrounding maternal SNPs, which is necessary to produce long-range allele balance estimates. The shown candidate sSNV, despite achieving very high VAF, is likely an error since it does not match the local amplification balance. <bold>e</bold> The AB model applied to a 200&#x02009;kb window around the candidate sSNV shown in (<bold>a</bold>). The artifact (red) at VAF&#x02009;=&#x02009;44% is highly inconsistent with the model&#x02019;s estimated AB of 89% (black line) and falls well outside of the 95% probability interval (gray envelope)</p></caption><graphic xlink:href="41467_2019_11857_Fig2_HTML" id="d29e373"/></fig></p><p id="Par10">However, this simple method to estimate AB and apply it to candidate sSNVs is problematic. First, although the hSNP in Fig. <xref rid="Fig2" ref-type="fig">2a</xref> is very close (20&#x02009;bp) to the candidate sSNV, the average distance between credible hSNPs in the data analyzed here is ~1500&#x02009;bp. Thus, a robust estimate of AB should account for the distance from the neighboring hSNPs. Second, VAF at an hSNP can be a noisy estimator of AB at typical whole-genome sequencing depths. For example, an approximate 95% AB confidence interval in Fig. <xref rid="Fig2" ref-type="fig">2a</xref> ranges from 86 to 100% and would widen at lower sequencing depth. It is therefore important to model this noise and to incorporate data from as many informative hSNPs as possible to increase the precision of the estimate.</p></sec><sec id="Sec4"><title>Estimating allele balance genome-wide</title><p id="Par11">To address these issues, we developed a genome-wide AB model that conceptualizes AB as a smooth curve along the genome representing the fraction of DNA amplicons derived from one (arbitrarily chosen) of the two alleles. The model is based on the principle that AB measured at an hSNP is most applicable in the immediate vicinity and becomes increasingly less informative at more distant loci. This happens because amplification products covering the hSNP site also cover nearby genomic loci with high probability, leading to similar levels of amplification and therefore similar AB (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). Sites further away from the hSNP are less likely to be amplified together, allowing for different amplification levels and possibly different AB. Therefore, the distance at which AB measurements remain correlated depends on the distribution of amplicon sizes, with larger sizes corresponding to slowly changing AB curves (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>). Average amplicon sizes for MDA can range from ~5 to 10&#x02009;kb but can vary substantially between samples even when the same amplification protocol is followed. We employ a Gaussian process to formally model how AB correlation decays as a function of distance and to combine information from multiple hSNPs in a statistically principled way for prediction of the AB at any genomic position (see Methods section).</p><p id="Par12">Figure <xref rid="Fig2" ref-type="fig">2d</xref> illustrates how the model is trained and applied. The input data are the locations of phased, credible hSNPs from an external source (e.g., matched bulk sequencing data or a SNP database) and the number of reads supporting the variant and reference alleles at each hSNP&#x000a0;in the single cell. To determine the likely AB values at the hSNP, read counts&#x02014;not VAFs&#x02014;are used in a binomial model to account for random fluctuations due read sampling. If adjacent hSNPs are located on opposite alleles, a sudden, but spurious, change in AB might appear (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>, gray line), and this could severely impede learning the AB correlation properties. We solve this by phasing hSNPs and standardizing all AB measurements to an arbitrary but consistent allele. The AB model is trained by choosing the AB correlation function that maximizes the model likelihood over phased hSNPs. To infer AB at a site of interest, the Gaussian process produces a Bayesian posterior AB distribution using the learned correlation function to automatically find and combine information from all informative hSNPs. To evaluate candidate sSNV mutations, we built three statistical tests based on AB predictions: (1) an allele balance consistency (ABC) test to determine whether a candidate is consistent with the local AB; (2) a test for pre-amplification artifacts which looks for candidate mutations occurring on roughly half of reads from either allele; and (3) a test for early amplification artifacts which, under an ideal amplification process, occur on one quarter of reads from either allele (see Methods).</p><p id="Par13">We applied the AB model to a 200&#x02009;kb window around the locus in Fig. <xref rid="Fig2" ref-type="fig">2a</xref>. As shown in Fig. <xref rid="Fig2" ref-type="fig">2e</xref>, the FP sSNV (red) is visually inconsistent with the AB in its region, lying well outside of the 95% confidence interval (gray envelope). The candidate sSNV is rejected by the ABC test with <italic>p</italic>-value 1.8&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;6</sup> and is instead consistent with a pre-amplification artifact (<italic>p</italic>-value&#x02009;=&#x02009;0.54).</p><p id="Par14">Despite the improved ability to reject scDNA-seq artifacts made possible by our model, it remains difficult to predict AB in large genomic regions devoid of hSNPs. The model is also susceptible to errors in hSNP phasing in which the variant is assigned to the incorrect allele. However, phasing errors are infrequent and only produce a noticeable shift in AB in imbalanced regions. It is important to note that the model does not account for copy number changes or structural variations, which can alter VAF and affect the apparent AB, and assumes that the two strands of DNA from a single allele are equally amplified. If a single DNA strand went completely unamplified, then physical scDNA-seq artifacts could present at the same VAF as true mutations. Finally, in regions with specific AB values, VAF alone may not be sufficient to distinguish artifacts from true sSNVs regardless of sequencing depth. For example, when the allele balance is 2:1, both a true sSNV on the under-amplified allele and a pre-amplification artifact on the over-amplified allele would attain VAF&#x02009;=&#x02009;1/3 on average. SCAN-SNV rejects both true sSNVs and artifacts in such regions by the pre-amplification artifact test; a similar argument applies to regions with 4:1 allele balance and the amplification artifact test. As a result, SCAN-SNV rarely has power to call SNVs with VAF&#x02009;&#x0003c;&#x02009;~40% at typical whole-genome sequencing depths of 30&#x000d7;.</p></sec><sec id="Sec5"><title>Tuning calling thresholds to account for artifact prevalence</title><p id="Par15">For the statistical tests derived from the AB model, <italic>p</italic>-value thresholds for calling must be set. Because scDNA-seq artifacts tend to be enriched at low VAF (Fig. <xref rid="Fig3" ref-type="fig">3</xref>, red curve), we reasoned that increasing the stringency of <italic>p</italic>-value thresholds for low VAF candidate mutations would increase accuracy. In particular, a <italic>p</italic>-value threshold <italic>&#x003b1;</italic> can be related to the false discovery rate by<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{FDR}} \approx \frac{{\alpha N_{\mathrm{A}}}}{{\alpha N_{\mathrm{A}} + \left( {1 - \beta } \right)N_{\mathrm{T}}}},$$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="normal">FDR</mml:mi><mml:mo>&#x02248;</mml:mo><mml:mfrac><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>&#x003b2;</mml:mi></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>&#x003b2;</italic> is the type II error rate resulting from the choice of <italic>&#x003b1;</italic>; <italic>N</italic><sub>T</sub>, and <italic>N</italic><sub>A</sub> are the number of true mutations and artifacts in the candidate sSNV set, respectively. Given suitable estimators of <italic>N</italic><sub>T</sub> and <italic>N</italic><sub>A</sub>, it would be possible to adjust <italic>p</italic>-value thresholds <italic>&#x003b1;</italic> to target a user-supplied FDR.<fig id="Fig3"><label>Fig. 3</label><caption><p>SCAN-SNV FDR tuning strategy. Somatic SNVs and hSNPs are supported by 50% of DNA prior to amplification in single cells. The shapes of VAF distributions for the two mutation types should be similar because both are equally affected by allelic imbalance, but artifacts in the candidate sSNV set (red line) usually create an enrichment at low VAF compared with hSNPs (black line). VAFs for the unknown number of true mutation among candidate sSNVs (green area) should be distributed similarly to hSNPs. Potential values for the total number of true sSNVs <italic>N</italic> (dashed lines) can be evaluated by first distributing the <italic>N</italic> mutations according to the hSNP VAFs and then ensuring the predicted numbers of sSNVs at each VAF do not exceed the number of candidates at that VAF. The largest such <italic>N</italic> provides an upper bound on the number of somatic mutations. Given <italic>N</italic>, a lower bound on the fraction of artifacts amongst sSNVs at any VAF can be estimated</p></caption><graphic xlink:href="41467_2019_11857_Fig3_HTML" id="d29e548"/></fig></p><p id="Par16">We therefore developed a method to estimate an upper bound on <italic>N</italic><sub>T</sub> by exploiting the fact that hSNPs and somatic SNVs are present on 50% of DNA molecules prior to amplification and are equally affected by allelic imbalance. Under the assumption that somatic SNVs occur in diploid regions and are approximately uniformly scattered across the genome, VAF distributions for hSNPs and sSNVs should be similarly shaped. The unknown subset of true sSNVs resides in the larger set of candidate sSNVs and should form a VAF distribution similar to that of hSNPs (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). We employ a heuristic to find the largest number of true sSNVs <italic>N</italic><sub>T</sub> that fits beneath the candidate VAF distribution when distributed according to the hSNP VAFs (see Methods). <italic>N</italic><sub>T</sub> can be combined with the hSNP VAF distribution to estimate the number of true mutations and artifacts at each specific VAF, allowing the determination of VAF-specific <italic>p</italic>-value thresholds corresponding to the desired FDR (see Methods). This does not constitute formal FDR control, but rather provides a rough guide to increasing stringency for sSNV classes that are contaminated by a large artifact burden.</p></sec><sec id="Sec6"><title>SCAN-SNV: genotyping sSNVs in MDA-amplified single cells</title><p id="Par17">We combined the AB model and automatic threshold tuning to create SCAN-SNV (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). An overview of the method follows. First, GATK<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> HaplotypeCaller is jointly applied to both single cell and bulk sequencing data to generate a genome-wide list of non-reference sites and their respective variant and reference read counts. The calls in the matched bulk data are taken as hSNPs, which are then phased by SHAPEIT2<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> and used to train the AB model.<fig id="Fig4"><label>Fig. 4</label><caption><p>SCAN-SNV workflow. GATK HaplotypeCaller determines sites with non-reference evidence and discovers germline or clonal hSNPs from bulk. Phased hSNPs serve as a training set to learn AB correlation patterns, predict AB at candidate sSNV loci and estimate artifact prevalence. Only candidate sSNVs passing all filters are reported as putative mutations</p></caption><graphic xlink:href="41467_2019_11857_Fig4_HTML" id="d29e597"/></fig></p><p id="Par18">Somatic SNV genotyping begins by defining a set of candidate sSNVs using the lenient read support requirements shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. Their VAF distribution is then compared with the phased hSNP VAF distribution to estimate the artifact burden and somatic mutation rate. The AB model&#x02019;s correlation function is fit separately for each chromosome by inspecting single-cell reads at phased hSNPs. Finally, AB is estimated at every candidate sSNV and several filters designed to remove single cell artifacts are applied. Primary filters are based on the AB model and include the three previously described statistical tests. The artifact statistical tests are tuned at every candidate site to obey a user-specified target false discovery rate given the estimates of artifact prevalence. Secondary filters remove candidate sSNVs covered by an excessive number of reads containing indels or clipped reads compared with reads at the same locus in the bulk sample. Candidate sSNVs passing all filters are emitted as putative somatic SNVs. Finally, when multiple related single cells are sequenced, an optional joint calling mode which relies on repeated observations of allele balance consistency across samples can be applied (see Methods).</p></sec><sec id="Sec7"><title>Assessing the performance of SCAN-SNV</title><p id="Par19">It is difficult to validate somatic SNVs in scDNA-seq data because the genome of a single cell is consumed during WGA, i.e., DNA extraction and amplification cannot be replicated to identify artifacts. Validation of putative sSNVs by deep sequencing of excess amplified DNA not used for initial sequencing can be confounded by the artifacts that were introduced in the amplified DNA; validation in the original tissue by very high-depth amplicon sequencing is possible<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> but only for clonal sSNVs with VAFs that are not too small. We therefore assessed SCAN-SNV and other callers using two approaches: a synthetic data set and a kindred cell system.</p></sec><sec id="Sec8"><title>Performance assessment on simulated data</title><p id="Par20">We first assessed SCAN-SNV using a synthetic diploid (SD) male chromosome X benchmarking data set. Hemizygous male X chromosomes have been previously exploited in single-cell studies for estimating FDR<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, utilizing the fact all true mutations on the hemizygous chromosome should have VAF close to 100%. However, a hemizygous X chromosome cannot reproduce the challenge of calling variants on a diploid chromosome because the AB should be either 0 or 1 along most of the chromosome. We therefore created synthetic diploid (SDs) X chromosomes by mixing chromosome X reads from the single cells of two different male donors with spiked-in mutations serving as a truth set. Unlike purely simulated approaches, the SD X chromosomes retain the patterns and characteristics of true MDA artifacts. Disadvantages of SDs include the fact that data from different amplifications are combined (although the same amplification protocol was followed) and that chromosome X has a lower SNP density than autosomes, which can disadvantage callers that depend on local hSNPs (such as SCAN-SNV and SCcaller).</p><p id="Par21">Briefly, reads from single cells were processed prior to mixing by first identifying endogenous SNPs and sSNVs and then spiking in 500 randomly placed mutations using BAMSurgeon<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>, see Methods). Processed reads from 16 single cells from two male donors<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> were then downsampled and merged to create eight SDs with mean 30&#x000d7; depth (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). A matching synthetic diploid bulk sample was created by mixing bulk data for the two male donors. To allow benchmarking of multi-sample genotypers, some of the spike-in mutations were shared across multiple SDs according to the phylogeny depicted in Fig. <xref rid="Fig5" ref-type="fig">5b</xref>.<fig id="Fig5"><label>Fig. 5</label><caption><p>Synthetic diploid construction and performance. <bold>a</bold> Synthetic diploid X chromosomes (chrX) are generated by merging chrX reads from single cells of two male donors. After chrX reads are extracted, pseudoautosomal regions (PARs) are removed and SNPs and sSNVs are identified on the hemizygous regions of chrX. New, randomly placed somatic mutations are spiked into the reads. This process is repeated for a second male donor and the two sets of reads are merged to create a synthetic diploid (SD). <bold>b</bold> Each SD contains 1000 spike-in mutations with 750 mutations shared by other SDs. For example, 250 spike-ins are shared by all SDs, another 250 are shared by four SDs and so on. <bold>c</bold> Each point represents genotyper performance on one SD. Only spike-in mutations are used to compute sensitivity. False positive rate is the number of FPs divided by the number of non-PAR megabases on chrX. <bold>d</bold> Spike-in sensitivity for private spike-ins (clonality&#x02009;=&#x02009;1), spike-ins shared by two samples (clonality&#x02009;=&#x02009;2), etc</p></caption><graphic xlink:href="41467_2019_11857_Fig5_HTML" id="d29e661"/></fig></p><p id="Par22">SCAN-SNV achieved the lowest false positive rate (FPR), improving by ~3-fold over SCcaller and Monovar in single-sample mode and by ~30-fold over Monovar in joint mode (Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). When both shared and private spike-in mutations were considered, sensitivity was very similar across the four single cell genotypers (mean sensitivity 30&#x02013;35%) with Monovar in joint mode achieving the highest average recall. Notably, Monovar&#x02019;s allowance for up to one mutation supporting read in the matched normal sample and lack of dbSNP filtration may lead to higher sensitivity at the cost of increased FPR. The highest sensitivity was attained by MuTect<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> and GATK as expected, but the number of FPs committed by these callers renders them impractical for studies where low- to moderate mutation burdens are expected.</p><p id="Par23">To better assess multi-sample genotypers, sensitivity was also assessed for shared spike-in mutations (Fig. <xref rid="Fig5" ref-type="fig">5d</xref>). As expected, single-sample callers do not show increased sensitivity for mutations supported by multiple samples. SCAN-SNV&#x02019;s joint mode, which calls mutations with good allele balance consistency across several samples (see Methods), committed 10-fold fewer errors than Monovar in joint mode and matched or exceeded Monovar&#x02019;s sensitivity for sSNVs shared by fewer than eight samples. Although GATK HaplotypeCaller (90% sensitivity target) performed well, the difference between its target (90%) and actual performance (40&#x02013;60% spike-in sensitivity) suggests that it would be difficult to tune in practice.</p></sec><sec id="Sec9"><title>Performance assessment using a kindred cell system</title><p id="Par24">We also validate the performance of our method using a kindred cell system, in which one amplifies and sequences two or more very closely related single cells (e.g., separated by &#x0003c;5 cell divisions) so that essentially all somatic mutations are shared. This enables discrimination between true mutations, which are shared between cells, from spontaneous artifacts, which are unlikely to recur at the same positions in multiple amplifications.</p><p id="Par25">We therefore assessed the performance of SCAN-SNV with a previously published kindred system<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> which contains two MDA-amplified single cells (IL-11 and IL-12) and an unamplified, single cell-derived clone (IL-1c). Their experimental design (Fig. <xref rid="Fig6" ref-type="fig">6a</xref>) also contains six non-kindred MDA-amplified single cells, three unamplified single cell-derived clones and an unamplified bulk sample that serves the role of a matched normal tissue.<fig id="Fig6"><label>Fig. 6</label><caption><p>SCAN-SNV performance assessed by a kindred cell system. <bold>a</bold> Twelve single cell-derived samples from a human fibroblast cell line<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Somatic mutations are defined as mutations not observed in the cell line bulk. A kindred cell system comprising three very closely related samples mimics biological replicates of single cells and enables assessment. True mutations (green stars) are likely to be supported by several kindred samples; scDNA-seq artifacts, however, should be private. <bold>b</bold> sSNVs in kindred samples with non-kindred support may be subclonal sSNVs. If true, each single cell sample inheriting the subclonal sSNV provides an independent VAF measurement. For true subclonal mutations, the average VAF over many samples should be ~50%. <bold>c</bold> Single cell genotyper performance on kindred cell IL-12. TRE sensitivity, percent of triple exclusive sites (TREs) recovered; FDR, fraction of total calls classified as likely FPs. <bold>d</bold> sSNV calls for both genotypers are binned by VAF and classified as either TRE, likely TP or likely FP based on which of the 13 samples contain read support for the mutation. Triple exclusive (TRE) sites are high-quality sites supported by all kindred samples and no other samples. Monovar is run in single-sample mode. (Bottom) hSNP VAFs provide a reference distribution for sSNVs. <bold>e</bold> Trinucleotide mutation signatures for TREs and genotyper calls in kindred cell IL-12. Monovar is run in single-sample mode. Arrows indicate mutation contexts which create homopolymers. <bold>f</bold> Same as (<bold>c</bold>) for kindred cell IL-11. <bold>g</bold> Same as (<bold>d</bold>) for kindred cell IL-11. The VAF distribution of both hSNPs and TRE sSNVs is very different from IL-12, suggesting substantial differences in amplification or cell quality</p></caption><graphic xlink:href="41467_2019_11857_Fig6_HTML" id="d29e730"/></fig></p><p id="Par26">In the previous analysis of the kindred group<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, sSNVs were considered validated if they were called in a kindred single cell and supported by 4 or more reads in the unamplified kindred clone (IL-1c). This analysis relies solely on the unamplified cell line bulk to prevent the validation of recurrent artifacts; however, this strategy is questionable because the unamplified cell line bulk cannot account for recurrent artifacts caused by amplification. (We also found systematic alignment differences because the cell line bulk and kindred group samples were sequenced using different read lengths, 100&#x02009;bp vs. 250&#x02009;bp).</p><p id="Par27">We undertook a more comprehensive approach to validation, taking advantage of the information provided by the additional nine single cell-derived samples (mean total coverage ~264x) from the same cell line. We integrated calls from both GATK and samtools<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> to classify sSNVs as likely TPs, likely FPs, and unknown, depending on the patterns of shared support across all 12 single cell-derived samples (see Methods, Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>). Briefly, likely TP sSNVs must be supported by at least 50 total reads across all 13 samples, a minimum number of mutation-harboring reads across the kindred group (number determined by a mock analysis of non-kindred samples, see Methods, Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>) and by at least two kindred samples. Furthermore, to exclude recurrent artifacts, they must not be supported any of the remaining non-kindred samples. Likely TP sSNVs supported by all three kindred samples&#x000a0;exclusively (&#x02018;triple exclusive&#x02019;; TRE) are the highest confidence somatic mutations and are used to assess genotyper sensitivity. The remaining sSNVs, which are either supported by one kindred sample (singletons) or by samples outside of the kindred group, are classified as likely FPs (see Methods, Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>). Most singletons are physical scDNA-seq artifacts and the small number of true mutations private to a single cell cannot be validated by the kindred system. sSNVs supported by out-of-kindred group samples (which could be true, subclonal mutations) also appear to be primarily FPs, since they occur with reproducibly low VAFs across samples (mean VAF&#x02009;=&#x02009;16%) when true somatic mutations inherited by multiple single-cell samples should not have consistently low VAFs (Fig. <xref rid="Fig6" ref-type="fig">6b</xref>). We therefore assessed FDR by the fraction of likely FP sSNV calls over all positive calls.</p><p id="Par28">SCAN-SNV called 397 sSNVs in the kindred single cell IL-12 with an estimated FDR of 24% and an estimated sensitivity of 44% (Fig. <xref rid="Fig6" ref-type="fig">6c</xref>). As previously discussed, sSNVs and hSNPs should have similar VAF distributions. Indeed, above VAF&#x02009;=&#x02009;50%, mutations called by SCAN-SNV follow the hSNP distribution (Fig. <xref rid="Fig6" ref-type="fig">6d</xref> bottom) reasonably well. However, there were very few SCAN-SNV calls below VAF&#x02009;=&#x02009;50%, due to reduced power to distinguish low VAF true mutations from artifacts. Power to resolve the two cases depends on sequencing depth, and we anticipate that SCAN-SNV is capable of detecting more low VAF mutations in samples with higher depth.</p><p id="Par29">SCAN-SNV performs favorably compared with SCcaller, which showed slightly increased sSNV sensitivity (44 vs. 50% of TREs recovered) but produced a call set highly enriched for likely FPs, leading to a ~3-fold increase in estimated FDR (24 vs. 64%). Independent of our assessment scheme, the large number of likely FPs called by SCcaller is evident by a considerable skew toward low VAF sSNVs that is not observed for hSNPs (Fig. <xref rid="Fig6" ref-type="fig">6d</xref>, middle compared with bottom). Monovar achieved the highest sensitivity when run jointly on all eight single cells (54%) but was comparatively low when run on a single sample (34%). However, Monovar produced a very large number of FP calls in both modes (FDR: 92% single, 98% joint).</p><p id="Par30">As shown in Fig. <xref rid="Fig6" ref-type="fig">6e</xref>, mutation signatures based on trinucleotide frequencies<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> for TRE sSNVs are characterized by the pattern of C&#x02009;&#x0003e;&#x02009;A mutations similar to a previously observed signature associated with cell culture<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. This is consistent with the anticipated mutagenic process acting in these samples, which were all taken from a human fibroblast cell line. The mutational pattern for SCAN-SNV calls in IL-12 was concordant with that of TRE sSNVs. However, SCcaller sSNVs for IL-12 were generally enriched for T&#x02009;&#x0003e;&#x02009;C and T&#x02009;&#x0003e;&#x02009;G mutations and contained pronounced peaks for mutations that would create homopolymer runs (e.g., ACA&#x02009;&#x0003e;&#x02009;AAA, GCG&#x02009;&#x0003e;&#x02009;GGG, etc.). We speculate that these peaks may correspond to artefactual calls in repetitive regions such as microsatellites, where accurate alignment is particularly difficult. Monovar calls contained peaks at all ANA and TNT contexts (first and last columns of each color group) and shared SCcaller&#x02019;s enrichment for T&#x02009;&#x0003e;&#x02009;C and T&#x02009;&#x0003e;&#x02009;G mutations in general. Monovar in multi-sample mode shared these characteristics and also contained a striking peak for TCA&#x02009;&#x0003e;&#x02009;TAA mutations, which may point to a reason for the increase in FPR (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>).</p></sec><sec id="Sec10"><title>Detection of atypical MDA amplification</title><p id="Par31">SCAN-SNV was also applied to the other kindred single cell, IL-11. In this cell, 196 sSNVs were called with an estimated FDR of 26% and TRE sensitivity of 19% (Fig. <xref rid="Fig6" ref-type="fig">6f</xref>). SCAN-SNV again compared favorably with SCcaller in FDR, attaining a ~3-fold reduction (26 vs. 74%), similar to IL-12. But it showed marked reduction in sSNV sensitivity compared with SCcaller (19 vs. 39%) and its own performance on IL-12 (explained below). Monovar&#x02019;s single-sample sensitivity also suffered (8 vs. 34%), but its sensitivity in joint mode was unaffected (56 vs. 54%). Again, however, Monovar&#x02019;s FDR remained exceptionally high (97&#x02013;99%).</p><p id="Par32">Despite the fact that both kindred cells were very closely related and processed according to the same protocols, SCAN-SNV immediately revealed two clear differences in the quality of the two sequencing libraries that may explain the change in genotyping accuracy. First, hSNPs in IL-11 were considerably more concentrated around VAF&#x02009;=&#x02009;50% than in IL-12 (Fig. <xref rid="Fig6" ref-type="fig">6d, g</xref>, bottom). Second, AB correlation decayed more quickly at short distances in IL-11 than in IL-12. hSNP VAF distributions and AB correlation functions for the six additional, non-kindred MDA-amplified single cells also closely matched the VAF and AB patterns of either IL-11 or IL-12 (Fig. <xref rid="Fig7" ref-type="fig">7a, b</xref>), forming two distinct classes: well-balanced MDA products resembling IL-11 and imbalanced products resembling IL-12. The same two classes could also be created by separating single cells on the basis of genome-wide copy number profiles, which were computed for all samples using Ginkgo<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>). It is natural to assume these differences are caused by random variability in the quality of WGA; however, the observation that samples cluster into two distinct classes rather than varying more continuously is inconsistent with this hypothesis.<fig id="Fig7"><label>Fig. 7</label><caption><p>SCAN-SNV recognizes atypical MDA amplification and reveals an accidental doublet. <bold>a</bold> Chromosome 1 hSNP VAF distributions for eight MDA-amplified single cells fall into one of two classes. Distributions concentrated near half are well-balanced (IL-11-like) whereas flat distribution with peaks near 0 or 1 are imbalanced (IL-12-like). Dashed line: a simulation of a single cell with increased initial DNA content resembles the well-balanced class. <bold>b</bold> Chromosome 1 AB correlation functions for each MDA-amplified single cell. Well-balanced products are less correlated at short distance than imbalanced products. Dashed line: the increased initial DNA content simulation resembles well-balanced samples. <bold>c</bold> When two cells are amplified instead of one (an accidental doublet), some somatic mutations will be shared by both cells while others will not. Unshared mutations are supported by only 25% of DNA before amplification. If there are enough unshared somatic SNVs, a doublet sSNV VAF distribution will resemble a mixture of peaks near 25 and 50%. A similar pattern is not expected for a G2/M phase cell. <bold>d</bold> sSNV VAF distributions are estimated using triple exclusive (TRE) sSNVs (blue). hSNPs show the correct VAF distribution for shared sSNVs and the expectation for unshared sSNVs (dashed line) is obtained by downsampling hSNPs. The peak near VAF&#x02009;=&#x02009;25% for IL-11 indicates a large number of unshared variants, identifying the sample as an accidental doublet</p></caption><graphic xlink:href="41467_2019_11857_Fig7_HTML" id="d29e827"/></fig></p></sec><sec id="Sec11"><title>Identification of an accidental doublet</title><p id="Par33">One explanation&#x000a0;for the well-balanced MDA products is that the cells had increased DNA content prior to amplification. For example, when amplification begins with two genomes rather than one, the additional copies reduce the variability in read depth and lead to more balanced amplification between alleles&#x02014;a fact which has been exploited previously<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. In the present data set, the increase in DNA content could have been due to (i) cells in G2 or early M phase; or (ii) the accidental isolation of two cells rather than one (a doublet). In either scenario, AB correlation should decay more rapidly since each allele is initially represented by two copies which are amplified independently. Indeed, when we simulated this increased DNA content by combining reads from two imbalanced samples (see Methods), its hSNP VAF distributions and AB correlation functions matched those of well-balanced products (Fig. <xref rid="Fig7" ref-type="fig">7a, b</xref>, dashed lines).</p><p id="Par34">Further analysis of sSNV VAF distributions revealed that IL-11 is highly likely to be a doublet. Unlike hSNPs, sSNVs may or may not be shared by both cells in the doublet. Unshared sSNVs would be present on 25% of DNA prior to amplification whereas shared sSNVs would be supported by 50% (Fig. <xref rid="Fig7" ref-type="fig">7c</xref>). Therefore, a positive indicator for a doublet is a peak at VAF&#x02009;=&#x02009;25% in sSNV VAFs. We computed sSNV distributions for IL-11 and IL-12 using TREs to avoid genotyper bias (Fig. <xref rid="Fig7" ref-type="fig">7d</xref>) and confirmed the doublet hypothesis for IL-11 by observing the characteristic peak at VAF&#x02009;=&#x02009;25% for IL-11 but not in IL-12.</p><p id="Par35">An accidental doublet explains SCAN-SNV&#x02019;s reduced sensitivity for IL-11: sSNVs not shared by both cells in the doublet would be filtered because they occur at the same VAF expected by our model of pre-amplification artifacts.</p></sec><sec id="Sec12"><title>Performance on single tumor cells</title><p id="Par36">SCAN-SNV was developed with the assumption that all DNA sequences are diploid. When this assumption does not hold, e.g., when sequencing single cells from tumors, it may perform suboptimally. To test its performance in aneuploid cells, we applied it and other callers to four single estrogen receptor positive breast cancer (ERBC) cells that harbor several chromosome-level copy number changes<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. This data set was not sufficient to construct a truth set, so callers were judged by the fraction of sSNVs that were supported either in bulk sequencing of the same ERBC cancer cell population or in multiple single cells (clonal support). SCAN-SNV&#x02019;s calls were most frequently clonally supported (55% clonal support, 955 total sSNV calls, Supplementary Fig. <xref rid="MOESM1" ref-type="media">4a</xref>) whereas other callers either produced relatively few calls (SCcaller, 35% clonal support, 532 calls) or recovered more clonally supported sSNVs at the cost of many suspect calls (Monovar and MuTect, 5&#x02013;7% clonal support and 18,049&#x02013;66,008 calls) (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4b</xref>). Clonal support rates for SCAN-SNV calls were computed separately for haploid, diploid and triploid chromosomes to explore the effects of violating the diploid assumption (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4c</xref>). Haploid chromosomes showed slightly increased clonal support (mean 60%) compared with diploid and triploid chromosomes (48% and 52%, respectively). Increased performance on haploid chromosomes is expected since true mutations will have VAFs near 100% while the similar performance for diploids and triploids provides evidence that SCAN-SNV can gracefully handle some violations of its diploid assumption. We caution that chromosome-level copy number changes are mild violations of the diploid assumption and that performance may degrade under more severe violations such as chromothripsis, structural variants, and sub-chromosomal copy number variants (CNVs).</p></sec></sec><sec id="Sec13" sec-type="discussion"><title>Discussion</title><p id="Par37">Analysis of scDNA-seq data presents many challenges. For sSNV detection, they include filtration of high VAF artifacts caused by cell lysis, whole-genome amplification and recurrent analysis artifacts such as read misalignments. Our analyses suggest that most single-cell genotypers have similar sensitivities for detecting somatic SNVs in diploid cells but commit false positive errors at substantially different rates. SCAN-SNV achieves unprecedented specificity by estimating allelic imbalance and only calling mutations when sufficient power is available to avoid false positives. The efficacy of our methodology was further confirmed by the unanticipated detection of a doublet.</p><p id="Par38">In particular, SCAN-SNV outperforms SCcaller, the only published genotyper for non-clonal SNVs in scDNA-seq data. The only other genotyper designed for single cells is Monovar, but it is intended for joint calling across multiple cells, and its authors specifically advise users to remove private calls. Although SCcaller also attempts to remove artifacts by estimating AB from hSNPs, the lower false discovery rate (~3-fold reduction) for SCAN-SNV stems from major improvements to both the method of estimating AB and the genotyping procedure: (i) SCcaller estimates AB by computing weighted moving averages of hSNP VAFs over a fixed size sliding window, but these weights and window sizes are not learned from real MDA data, not fit to individual samples, and do not account for sequencing depth (i.e., a VAF&#x02009;=&#x02009;50% hSNP covered by 10 reads will be treated the same as a VAF&#x02009;=&#x02009;50% hSNP covered by 100 reads, despite the fact that the higher depth SNP contains more information); (ii) SCcaller does not phase the VAFs used in the moving average and limits its model to estimating the fraction of DNA from the most amplified allele; (iii) SCcaller does not provide probability intervals for AB estimates; (iv) SCcaller&#x02019;s genotyping procedure does not include a model for pre-amplification scDNA-seq errors, which are expected to attain the highest VAFs; (v) SCcaller only provides parameters to control sensitivity to germline hSNPs rather than the FDR, which is more critical in scDNA-seq applications where true mutations are often scarce compared with artifacts; (vi) finally, SCcaller does not include power calculations to determine which conditions (e.g., read depth, candidate sSNV VAF, AB) are necessary to reliably distinguish mutations from artifacts.</p><p id="Par39">We anticipate that our genotyping method, which primarily depends on VAF, can be extended and improved through integration with non-VAF information such as physical read linkage<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. The linkage approach can evaluate sSNV candidates that reside on the same sequencing read as nearby hSNPs by computing the apparent number of haplotypes at the locus. scDNA-seq artifacts usually occur on a subset of reads from one allele, creating evidence for three haplotypes at the locus when a single cell should contain only two. Although linkage can resolve sSNVs intractable to VAF analysis, its main disadvantage is that it applies only to a relatively small fraction of the genome (~20&#x02013;25%).</p><p id="Par40">Further, our AB model can also aid detection of CNVs in scDNA-seq data. AB values in regions affected by CNVs will not oscillate around AB&#x02009;=&#x02009;1/2 as they would in diploid regions, e.g., AB in a single-copy gain region should oscillate around 1/3 or 2/3 whereas AB in a single-copy loss would tend toward AB&#x02009;=&#x02009;0 or 1. To distinguish CNVs from artefactual shifts in AB caused by imbalanced amplification, one could determine the typical size of such AB&#x02009;&#x02260;&#x02009;1/2 regions resulting from allelic imbalance from our model. Candidate CNVs significantly longer than allelic imbalance segments are more likely to be true events.</p><p id="Par41">In summary, our model of AB, approach to single-cell sSNV genotyping and benchmarking processes are highly useful in their current form and will likely provide a solid foundation for future improvements to single-cell genotyping. The AB framework developed here is likely to be helpful for detecting other point-like mutation types (indels) or mutations with point-like features (i.e., breakpoints for structural rearrangements).</p></sec><sec id="Sec14"><title>Methods</title><sec id="Sec15"><title>hSNP training set construction</title><p id="Par42">SCAN-SNV determines hSNPs by joint application of GATK HaplotypeCaller to all single cell and bulk BAMs and subsequently applying SHAPEIT2 to autosomal, biallelic, single nucleotide non-reference sites called in the bulk sample. The 1000 Genomes Phase 3 integrated haplotype panel dated October 2014 is used for analyses in this report. Only heterozygous SNPs that were successfully phased by this process were treated as credible hSNPs.</p></sec><sec id="Sec16"><title>Modeling allele balance</title><p id="Par43">Let <italic>Y</italic><sub><italic>i</italic></sub>, <italic>D</italic><sub><italic>i</italic></sub>, and <italic>X</italic><sub><italic>i</italic></sub> be the observed number of mutation supporting reads, total reads and genomic position (in base pairs) at locus <italic>i</italic>. We model the allele balance <italic>B</italic><sub><italic>i</italic></sub> as a latent variable by<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}Y_i|D_i,X_i,B_i\sim {\mathrm{Bin}}\left( {D_i,\frac{1}{{1 + {\mathrm{e}}^{ - B_i}}}} \right),\\ B_i|X_i,a,b,c,d\sim {\mathrm{GP}}\left( {0,k\left( {X_i,x} \right)} \right),\\ k\left( {x_1,x_2} \right) = {\mathrm{exp}}\left( {a - \frac{{\left( {x_1 - x_2} \right)^2}}{{b^2}}} \right) + {\mathrm{exp}}\left( {c - \frac{{\left( {x_1 - x_2} \right)^2}}{{d^2}}} \right),\end{array}$$\end{document}</tex-math><mml:math id="M4"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="normal">Bin</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>~</mml:mo><mml:mi mathvariant="normal">GP</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>k</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>a</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where GP refers to a Gaussian process, <italic>k</italic>(<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>) is the covariance function (an unnormalized version of the correlation function discussed in the main text) and <italic>a</italic>, <italic>b</italic>, <italic>c</italic>, and <italic>d</italic> are model parameters. All observations (<italic>Y</italic><sub><italic>i</italic></sub> and <italic>D</italic><sub><italic>i</italic></sub>) are conditionally independent given <italic>B</italic><sub><italic>i</italic></sub>. A latent variable model is appropriate for modeling AB since it is a property of the amplified DNA that is only indirectly observed by sequencing reads. Because a Gaussian process is used to model AB, we allow <italic>B</italic><sub><italic>i</italic></sub> to range over (&#x02212;&#x0221e;, &#x0221e;) and convert it to a value in [0, 1] using the logistic transform <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1/(1 + {\mathrm{e}}^{ - B_i})$$\end{document}</tex-math><mml:math id="M6"><mml:mn>1</mml:mn><mml:mo>&#x02215;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_11857_Article_IEq1.gif"/></alternatives></inline-formula>. Although we will often refer to <italic>B</italic><sub><italic>i</italic></sub> as allele balance, the logistic transform must be applied to arrive at the intuitive interpretation of AB as the fraction of amplified DNA derived from one allele. The form of the covariance function is an arbitrary choice. We chose to combine two radial basis functions so that one could account for very short-range effects, which tend to inflate correlation due to shared reads between loci, and the other could account for medium- to long-range effects driven by MDA amplicon size. A noteworthy property of <italic>k</italic>(<italic>x</italic><sub><italic>i</italic></sub>, <italic>x</italic><sub><italic>j</italic></sub>) is that it gives the covariance between two AB values at positions <italic>x</italic><sub><italic>i</italic></sub> and <italic>x</italic><sub><italic>j</italic></sub> using only the distance between the two sites <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left| {x_i - x_j} \right|$$\end{document}</tex-math><mml:math id="M8"><mml:mfenced close="&#x02223;" open="&#x02223;" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_11857_Article_IEq2.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec17"><title>Fitting the allele balance correlation function</title><p id="Par44">The covariance function <italic>k</italic> contains all model parameters. Parameters are fit separately for each chromosome by maximizing the likelihood function using a grid search. The likelihood function is<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}{\cal{L}}\left( {a,b,c,d{\mathrm{|}}\overrightarrow {\bf{Y}} ,\overrightarrow {\bf{D}} ,\overrightarrow {\bf{X}} } \right) = {\int}_{{\Bbb R}^n} {\underbrace {P\left( {\overrightarrow {\bf{Y}} {\mathrm{|}}\overrightarrow {\bf{B}} ,\overrightarrow {\bf{D}} } \right)}_{{\mathrm{Binomial}}\,{\mathrm{PMF}}}\underbrace {P\left( {\overrightarrow {\bf{B}} {\mathrm{|}}\overrightarrow {\bf{X}} ,a,b,c,d} \right)}_{{\mathrm{Multivariate}}\,{\mathrm{normal}}\,{\mathrm{PDF}}}} d\overrightarrow {\bf{B}} ,\\ = {\int}_{{\Bbb R}^n} {\left( {\mathop {\prod }\limits_i {\mathrm{Bin}}\left( {Y_i; D_i,\frac{1}{{1 + {\mathrm{e}}^{ - B_i}}}} \right)} \right) \cdot {\mathrm{det}}\left( {2\pi K} \right)^{ - \frac{1}{2}}{\mathrm{exp}}\left\{ { - \frac{1}{2}\overrightarrow {\bf{B}} ^T{\bf{K}}^{ - 1}\overrightarrow {\bf{B}} } \right\}d\overrightarrow {\bf{B}} ,} \\ \propto {\mathrm{det}}\left( {2\pi {\bf{K}}} \right)^{ - \frac{1}{2}} \int_{{\Bbb R}}^{n} {\exp \left\{ {\overrightarrow {\bf{B}} ^T\overrightarrow {\bf{Y}} - \mathop {\sum}\limits_{i = 1}^n {\mathop {\sum }\limits_{i = 1}^n D_i{\mathrm{log}}\left( {1 + {\mathrm{e}}^{B_i}} \right)--\frac{1}{2}\overrightarrow {\bf{B}} ^T{\bf{K}}^{ - 1}\overrightarrow {\bf{B}} } } \right\}d\overrightarrow {\bf{B}} ,} \\ \left( {\bf{K}} \right)_{i,j} = k\left( {X_i,X_j} \right).\end{array}$$\end{document}</tex-math><mml:math id="M10"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="script">L</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi mathvariant="normal">&#x02223;</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Y </mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>&#x0222b;</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Y </mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mi mathvariant="normal">&#x02223;</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo stretchy="true">&#x023df;</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Binomial</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">PMF</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mi mathvariant="normal">&#x02223;</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo stretchy="true">&#x023df;</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Multivariate</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">normal</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">PDF</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>&#x0222b;</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo>&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">Bin</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>&#x022c5;</mml:mo><mml:mi mathvariant="normal">det</mml:mi><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mi mathvariant="normal">exp</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mo>&#x0221d;</mml:mo><mml:mi mathvariant="normal">det</mml:mi><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:mi mathvariant="bold">K</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mo> &#x0222b;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mi>exp</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Y </mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par45">Here, <italic>n</italic> denotes the number of hSNPs on the chromosome being fit (which typically ranges from 10<sup>4</sup> to 10<sup>5</sup>) and the parameters <italic>a</italic>, <italic>b</italic>, <italic>c</italic>, and <italic>d</italic> are required to calculate the covariance matrix <italic>K</italic>, but are suppressed for brevity. The vectors <inline-formula id="IEq3"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec Y,\vec D,{\mathrm{and}}\,\vec X$$\end{document}</tex-math><mml:math id="M12"><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="0.25em"/><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2019_11857_Article_IEq3.gif"/></alternatives></inline-formula> contain all <italic>n</italic> observations on the chromosome being fit. Computing this likelihood function is difficult: the integrand has no closed form solution and is also impractical to approximate numerically because it involves integrating over the very high dimensional space <inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Bbb R}^n$$\end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_11857_Article_IEq4.gif"/></alternatives></inline-formula>. We therefore employ two approximations to compute <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{L}}$$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="script">L</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_11857_Article_IEq5.gif"/></alternatives></inline-formula> in reasonable time: (1) each chromosome is divided into non-overlapping blocks of 100 hSNPs, which are treated as independent, and (2) the Laplace approximation is applied to estimate the reduced-dimension integral. The resulting approximation for a single chromosome is<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{L}}\left( {a,b,c,d{\mathrm{|}}\overrightarrow {\bf{Y}} ,\overrightarrow {\bf{D}} ,\overrightarrow {\bf{X}} } \right) \approx \mathop {\prod }\limits_{b = 1}^{n/100} \hat {\cal{L}}_{{\mathrm{Laplace}}}\left( {a,b,c,d{\mathrm{|}}\overrightarrow {\bf{Y}} _b,\overrightarrow {\bf{D}} _b,\overrightarrow {\bf{X}} _b} \right),$$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="script">L</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi mathvariant="normal">&#x02223;</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Y </mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>&#x02248;</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02215;</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Laplace</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi mathvariant="normal">&#x02223;</mml:mi><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Y </mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where the vectors <inline-formula id="IEq6"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec {\bf{Y}}_b,\vec {\bf{D}}_b,\vec {\bf{X}}_b$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Y </mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_11857_Article_IEq6.gif"/></alternatives></inline-formula> refer to observations for the <italic>b</italic>th block of 100 hSNPs. The basic idea behind the Laplace approximation is to replace the intractable integrand with an easy-to-integrate Gaussian function. To do this, a second order Taylor expansion around the maximizer of the unapproximated distribution is used, giving the multivariate normal posterior<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}\overrightarrow {\bf{B}} _{{\mathrm{hSNP}}}|\overrightarrow {\bf{Y}} ,\overrightarrow {\bf{D}} ,\overrightarrow {\bf{X}} \sim {\mathrm{MVN}}\left( {\widehat {\bf{B}}_{{\mathrm{hSNP}}},\left( {{\bf{K}} + {\bf{W}}^{ - 1}} \right)^{ - 1}} \right),\\ \widehat {\bf{B}}_{{\mathrm{hSNP}}} = \mathop {{{\mathrm{arg}}\,{\mathrm{max}}}}\limits_{\vec B \in {\Bbb R}^n} \left\{ {\left( {\mathop {\prod }\limits_i {\mathrm{Bin}}\left( {Y_i; D_i,\frac{1}{{1 + {\mathrm{e}}^{ - B_i}}}} \right)} \right) \cdot {\mathrm{det}}\left( {2\pi {\bf{K}}} \right)^{ - \frac{1}{2}}{\mathrm{exp}}\left\{ { - \frac{1}{2}\overrightarrow {\bf{B}} ^T{\bf{K}}^{ - 1}\overrightarrow {\bf{B}} } \right\}} \right\},\\ {\bf{W}} = - \nabla \nabla _{\vec B}\log P\left( {\overrightarrow {\bf{Y}} |\widehat {\bf{B}}_{{\mathrm{hSNP}}},\overrightarrow {\bf{D}} } \right).\end{array}$$\end{document}</tex-math><mml:math id="M22"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hSNP</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Y </mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>~</mml:mo><mml:mi mathvariant="normal">MVN</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hSNP</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">K</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hSNP</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">arg</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo>&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">Bin</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>&#x022c5;</mml:mo><mml:mi mathvariant="normal">det</mml:mi><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:mi mathvariant="bold">K</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mi mathvariant="normal">exp</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="bold">W</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mo>&#x02207;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x02207;</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mi>log</mml:mi><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Y </mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hSNP</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par46">To compute these values and the final approximate log likelihood, we use algorithm 3.1 from ref. <sup><xref ref-type="bibr" rid="CR20">20</xref></sup> with the modification<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log P\left( {Y_i{\mathrm{|}}B_i,D_i} \right) = Y_iB_i - D_i\log \left( {1 + {\mathrm{e}}^{B_i}} \right).$$\end{document}</tex-math><mml:math id="M24"><mml:mi>log</mml:mi><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">&#x02223;</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>log</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par47">The maximizer <inline-formula id="IEq7"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat {\bf{B}}_{{\mathrm{hSNP}}}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hSNP</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_11857_Article_IEq7.gif"/></alternatives></inline-formula> is approximated by Newton-Raphson iteration. Iteration continues until the <italic>n</italic>th iteration&#x02019;s estimate of the log-likelihood function log&#x02009;<italic>P</italic><sup>(n)</sup> satisfies<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{\left| {\log P^{(n)} - \log P^{(n - 1)}} \right|}}{{\left| {\log P^{(n)}} \right|}} \le \varepsilon ,$$\end{document}</tex-math><mml:math id="M28"><mml:mfrac><mml:mrow><mml:mfenced close="&#x02223;" open="&#x02223;" separators=""><mml:mrow><mml:mi>log</mml:mi><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mi>log</mml:mi><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="&#x02223;" open="&#x02223;" separators=""><mml:mrow><mml:mi>log</mml:mi><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>&#x02264;</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>with <inline-formula id="IEq8"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon = \sqrt {2.2 \times 10^{ - 16}}$$\end{document}</tex-math><mml:math id="M30"><mml:mi>&#x003b5;</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mn>2.2</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:math><inline-graphic xlink:href="41467_2019_11857_Article_IEq8.gif"/></alternatives></inline-formula> or the number of iterations exceeds <italic>n</italic>&#x02009;=&#x02009;50.</p></sec><sec id="Sec18"><title>Predicting allele balance at somatic SNV candidates</title><p id="Par48">AB at each sSNV candidate locus is predicted following algorithm 3.2<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, except that we are interested only in the mean and variances of the latent GP. Only hSNPs within 200&#x02009;kb of each candidate sSNV are considered. Since this is an order of magnitude longer than typical MDA amplicon sizes, all relevant hSNPs should be included. Like the fitting process, prediction also requires an approximation of the true distribution due to analytical intractability. First, hSNP ABs in the window centered at the candidate sSNV are approximated by the Laplace approximation described in the previous section, which provides <inline-formula id="IEq9"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat {\bf{B}}_{{\mathrm{hSNP}}}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hSNP</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_11857_Article_IEq9.gif"/></alternatives></inline-formula> and the Hessian <bold>W</bold>. The posterior distribution of the AB at candidate location <italic>X</italic><sub>sSNV</sub> is then the normal distribution given by:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}B_{{\mathrm{sSNV}}}|X_{{\mathrm{sSNV}}},\widehat {\bf{B}}_{{\mathrm{hSNP}}},\overrightarrow {\bf{X}} \sim N\left( {\mu ,\sigma ^2} \right),\\ \mu = k\left( {X_{{\mathrm{sSNV}}},\overrightarrow {\bf{X}} } \right)^T{\bf{K}}^{ - 1}\widehat {\bf{B}}_{{\mathrm{hSNP}}},\\ \sigma ^2 = k\left( {X_{{\mathrm{sSNV}}},X_{{\mathrm{sSNV}}}} \right) - k\left( {X_{{\mathrm{sSNV}}},\overrightarrow {\bf{X}} } \right)^T\left( {{\bf{K}} + {\bf{W}}^{ - 1}} \right)^{ - 1}k\left( {X_{{\mathrm{sSNV}}},\overrightarrow {\bf{X}} } \right).\end{array}$$\end{document}</tex-math><mml:math id="M34"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sSNV</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sSNV</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hSNP</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>&#x003bc;</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>&#x003bc;</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sSNV</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hSNP</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sSNV</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sSNV</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sSNV</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">K</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>k</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sSNV</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec19"><title>Allele balance consistency test</title><p id="Par49">The allele balance consistency (ABC) test ensures that candidate sSNVs reasonably match the local AB. The AB model estimates the fraction of amplicons derived from one of the two alleles, but a somatic mutation could occur on either. We therefore choose the AB that most closely matches the VAF of the candidate sSNV using the heuristic<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu ^ \ast \equiv \mathop {{{\mathrm{arg}}\,{\mathrm{min}}}}\limits_{x \in \left\{ {\mu , - \mu } \right\}} \left\{ {\left| {{\mathrm{VAF}} - \frac{1}{{1 + {\mathrm{e}}^{ - x}}}} \right|} \right\}.$$\end{document}</tex-math><mml:math id="M36"><mml:msup><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02261;</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">arg</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi>&#x003bc;</mml:mi><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mi>&#x003bc;</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:munder><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfenced close="&#x02223;" open="&#x02223;" separators=""><mml:mrow><mml:mi mathvariant="normal">VAF</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par50">The ABC null model is then<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}Y|B\sim {\mathrm{Bin}}\left( {D,\frac{1}{{1 + {\mathrm{e}}^{ - B}}}} \right),\\ B|\mu ^ \ast ,\sigma ^2\sim N\left( {\mu ^ \ast ,\sigma ^2} \right).\end{array}$$\end{document}</tex-math><mml:math id="M38"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>Y</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi>B</mml:mi><mml:mo>~</mml:mo><mml:mi mathvariant="normal">Bin</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>B</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par51">The probability of <italic>y</italic> reads supporting the sSNV is found by marginalizing over the posterior AB distribution<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {Y = y|\mu ^ \ast ,\sigma ^2} \right) = {\int} {P\left( {Y = y|B = b} \right) \cdot P\left( {B = b|\mu ^ \ast ,\sigma ^2} \right){\mathrm{d}}b}$$\end{document}</tex-math><mml:math id="M40"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>&#x0222b;</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x022c5;</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">d</mml:mi><mml:mi>b</mml:mi></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {Y = y|\mu ^ \ast ,\sigma ^2} \right) = {\int_{ - \infty }^\infty} {\left( {\begin{array}{*{20}{c}} D \\ y \end{array}} \right)\left( {\frac{1}{{1 + {\mathrm{e}}^{ - b}}}} \right)^y\left( {\frac{{{\mathrm{e}}^{ - b}}}{{1 + {\mathrm{e}}^{ - b}}}} \right)^{D - y}\frac{1}{{\sqrt {2\pi \sigma ^2} }}{\mathrm{e}}^{ - \frac{{(b - \mu ^ \ast )^2}}{{2\sigma ^2}}}{\mathrm{d}}b}$$\end{document}</tex-math><mml:math id="M42"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>&#x0222b;</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>&#x0221e;</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x0221e;</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>D</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>y</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>-</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>b</mml:mi></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par52">The integral is approximated using Gauss-Hermite quadrature with 128 nodes<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. Let <italic>k</italic> be the observed number of variant-supporting reads at a locus. The ABC <italic>p</italic>-value <italic>p</italic><sub>ABC</sub> is computed by summing all events with lower probability of occurrence than <italic>k</italic>:<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{{\mathrm{ABC}}} = \mathop {\sum }\limits_{y = 0}^D P\left( {Y = y|\mu ^ \ast ,\sigma ^2} \right) \cdot I\left\{ {P\left( {Y = y|\mu ^ \ast ,\sigma ^2} \right) \le P\left( {Y = k|\mu ^ \ast ,\sigma ^2} \right)} \right\},$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ABC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>&#x022c5;</mml:mo><mml:mi>I</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>&#x02264;</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>where <italic>I</italic>(&#x000b7;) is the indicator function.</p></sec><sec id="Sec20"><title>Artifact statistical tests</title><p id="Par53">Artifact statistical tests are designed to detect scDNA-seq errors with the greatest chance of attaining high VAF: pre-amplification errors, which often occur during cell lysis, and first-round amplification errors. The artifact tests follow the ABC test except that the null model includes the possibility of the error occurring on either allele, meaning there is no need to compute <italic>&#x003bc;</italic>*. Let allele 1 be the allele directly modeled by <italic>B</italic> and allele 2 be the other allele. Then the null artifact model is the mixture distribution given by<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}Y|B,{\mathrm{allele1}}\sim {\mathrm{Bin}}\left( {D,\frac{1}{f}\frac{1}{{1 + {\mathrm{e}}^{ - B}}}} \right),\quad Y|B,{\mathrm{allele}}\,{\mathrm{2}}\sim {\mathrm{Bin}}\left( {D,\frac{1}{f}\left( {1 - \frac{1}{{1 + {\mathrm{e}}^{ - B}}}} \right)} \right)\\ P(Y|B) = \frac{1}{2}P\left( {Y|D,{\mathrm{allele}}\,{\mathrm{1}}} \right) + \frac{1}{2}P\left( {Y|D,{\mathrm{allele}}\,{\mathrm{2}}} \right).\end{array}$$\end{document}</tex-math><mml:math id="M46"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>Y</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">allele1</mml:mi><mml:mo>~</mml:mo><mml:mi mathvariant="normal">Bin</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="1.0em"/><mml:mi>Y</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">allele</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">2</mml:mi><mml:mo>~</mml:mo><mml:mi mathvariant="normal">Bin</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Y</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>Y</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">allele</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">1</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>Y</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">allele</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">2</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par54">For pre-amplification artifacts <italic>f</italic>&#x02009;=&#x02009;2, meaning that a pre-amplification artifact is expected to occur on half of amplicons derived from the artifact-harboring allele. This corresponds to two assumptions: (1) pre-amplification artifacts are single-stranded and (2) the two strands are equally amplified. Amplification artifacts are modeled with <italic>f</italic>&#x02009;=&#x02009;4, reflecting the following ideal amplification scenario. DNA from one allele is initially double-stranded. Suppose both strands of the allele are fully replicated exactly once before any other replication occurs, producing four strands of DNA. Polymerase incorporation errors occurring during this process will therefore be present on one-fourth of strands from this allele. Assume amplification of the four strands continues without additional errors, eventually producing approximately equal numbers of amplicons from each strand. A misincorporation error in the first round will therefore be supported by one-quarter of molecules in the amplicon pool for this allele.</p></sec><sec id="Sec21"><title>Estimating artifact prevalence</title><p id="Par55">Under certain assumptions, it is possible to bound the number of true sSNVs in a set of candidate sSNVs using a large enough set of high confidence hSNPs. The necessary assumptions are that true sSNVs are present on 50% of DNA molecules prior to amplification (e.g., as would occur for a fully diploid genome) and that true sSNVs are not too concentrated in specific genomic regions, so that the sSNV VAF distribution resembles hSNP VAFs. Under these assumptions, the fraction of somatic SNVs at a specific VAF should not be too different from the fraction of hSNPs at that same VAF. Using hSNPs as a guide, the expected number of true sSNVs at each VAF can be computed for any <italic>N</italic><sub>T</sub>&#x02009;&#x0003e;&#x02009;0. When <italic>N</italic><sub>T</sub> is too large, the predicted number of true sSNVs for some VAFs will exceed the number of candidate sSNVs at that VAF, making it evident that the chosen <italic>N</italic><sub>T</sub> is likely inconsistent with the data.</p><p id="Par56">We use a multinomial simulation to evaluate the consistency of several possible values of <italic>N</italic><sub>T</sub> with the observed hSNPs and candidate sSNVs. Only successfully phased hSNPs are used for these simulations. hSNPs <italic>H</italic><sub><italic>v</italic></sub> and sSNVs <italic>S</italic><sub><italic>v</italic></sub> falling into 20 equally sized VAF bins are counted such that:<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}{l}} {H_1 = \# \left\{ {{\mathrm{hSNPs}}\hskip -3pt:0.00 \le {\mathrm{VAF}} \, &#x0003c; \, 0.05} \right\},} \hfill &#x00026; {} \hfill &#x00026; {S_1 = \# \left\{ {{\mathrm{sSNVs}}\hskip -3pt:0.00 \le {\mathrm{VAF}} \, &#x0003c; \, 0.05} \right\},} \hfill \\ {H_2 = \# \left\{ {{\mathrm{hSNPs}}\hskip -3pt:0.05 \le {\mathrm{VAF}} \, &#x0003c; \, 0.10} \right\},} \hfill &#x00026; {} \hfill &#x00026; {S_2 = \# \left\{ {{\mathrm{sSNVs}}\hskip -3pt:0.05 \le {\mathrm{VAF}} \, &#x0003c; \, 0.10} \right\},} \hfill \\ {} \hfill &#x00026; \vdots \hfill &#x00026; {} \hfill \\ {H_{20} = \# \left\{ {{\mathrm{hSNPs}}\hskip -3pt:0.95 \le {\mathrm{VAF}} \le 1.00} \right\},} \hfill &#x00026; {} \hfill &#x00026; {S_{20} = \# \left\{ {{\mathrm{sSNVs}}\hskip -3pt:0.95 \le {\mathrm{VAF}} \le 1.00} \right\}.} \hfill \end{array}$$\end{document}</tex-math><mml:math id="M48"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>#</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi mathvariant="normal">hSNPs</mml:mi><mml:mo>:</mml:mo><mml:mn>0.00</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi mathvariant="normal">VAF</mml:mi><mml:mspace width="0.25em"/><mml:mo>&#x0003c;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0.05</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>#</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi mathvariant="normal">sSNVs</mml:mi><mml:mo>:</mml:mo><mml:mn>0.00</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi mathvariant="normal">VAF</mml:mi><mml:mspace width="0.25em"/><mml:mo>&#x0003c;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0.05</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>#</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi mathvariant="normal">hSNPs</mml:mi><mml:mo>:</mml:mo><mml:mn>0.05</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi mathvariant="normal">VAF</mml:mi><mml:mspace width="0.25em"/><mml:mo>&#x0003c;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0.10</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>#</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi mathvariant="normal">sSNVs</mml:mi><mml:mo>:</mml:mo><mml:mn>0.05</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi mathvariant="normal">VAF</mml:mi><mml:mspace width="0.25em"/><mml:mo>&#x0003c;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0.10</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd columnalign="left"/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>#</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi mathvariant="normal">hSNPs</mml:mi><mml:mo>:</mml:mo><mml:mn>0.95</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi mathvariant="normal">VAF</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mn>1.00</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>#</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi mathvariant="normal">sSNVs</mml:mi><mml:mo>:</mml:mo><mml:mn>0.95</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi mathvariant="normal">VAF</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mn>1.00</mml:mn></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par57">We assess the consistency of any value of <italic>N</italic><sub>T</sub>&#x02009;&#x0003e;&#x02009;0 with the data as follows. First, we simulate the numbers of sSNVs in each VAF bin 1000 times by drawing from a multinomial distribution with parameters matching the binned hSNPs<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {S^{\left( i \right)}\sim {\mathrm{Multinom}}\left( {N_{\mathrm{T}},\frac{{H_1}}{H}, \cdots ,\frac{{H_{20}}}{H}} \right)} \right\}_{i = 1}^{1000},\quad H = \mathop {\sum }\limits_{v = 1}^{20} H_v.$$\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>~</mml:mo><mml:mi mathvariant="normal">Multinom</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mspace width="0.25em"/><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1000</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="1.0em"/><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par58">The fraction <inline-formula id="IEq10"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{N_{\mathrm{T}}}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_11857_Article_IEq10.gif"/></alternatives></inline-formula> of simulations consistent with the observed sSNV candidate counts evaluates the fit of <italic>N</italic><sub>T</sub> to the data.<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{N_{\mathrm{T}}} = \frac{1}{{1000}}\mathop {\sum }\limits_{i = 1}^{1000} I\left( {S_1^{(i)} \le S_1 \wedge \cdots \wedge S_{20}^{(i)} \le S_{20}} \right).$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1000</mml:mn></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1000</mml:mn></mml:mrow></mml:munderover><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02227;</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>&#x02227;</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par59">This process is repeated for several values of <italic>N</italic><sub>T</sub> ranging from 1 to the total number of sSNV candidates. The upper bound on the somatic mutation burden is the largest <italic>N</italic><sub>T</sub> such that <inline-formula id="IEq11"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{N_{\mathrm{T}}} \ge 0.005$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>0.005</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_11857_Article_IEq11.gif"/></alternatives></inline-formula>. We choose such a lenient criterion to account for the fact that inconsistency occurs even if only a single VAF bin out of 20 exceeds the candidate sSNV count at that VAF.</p><p id="Par60">Given the estimate of <italic>N</italic><sub>T</sub>, the expected numbers of true sSNVs and artifacts in VAF bin <italic>i</italic> are<disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{{\mathrm{T}},i} = N_{\mathrm{T}}\frac{{H_i}}{H},\quad N_{{\mathrm{A}},i} = \max \left\{ {N_{\mathrm{T}}\left( {1 - \frac{{H_i}}{H}} \right),0.1} \right\}.$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1.0em"/><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2019_11857_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par61">Since these values represent expectations, they may be &#x0003c;1. The arbitrary minimum value of 0.1 for the artifact burden is to avoid FDR estimates of 0%.</p><p id="Par62">The preceding procedure is applied separately to sSNVs and hSNPs with the same sequencing depth; all sSNVs and hSNPs with depth greater than the 90th percentile of hSNPs are treated together. This produces <italic>N</italic><sub>T<italic>,i,D</italic></sub> and <italic>N</italic><sub>A<italic>,i,D</italic></sub>, which estimate the number of true mutations and artifacts for each VAF and depth.</p></sec><sec id="Sec22"><title>Determining <italic>p</italic>-value cutoffs</title><p id="Par63">The ABC test uses a fixed cutoff of 0.05. <italic>p</italic>-value cutoffs for both artifact tests are tuned at every sSNV candidate to obey a user-supplied false discovery rate <italic>&#x003b8;</italic>. This is possible because the alternative hypothesis of an artifact test&#x02014;that the site is a true mutation&#x02014;provides a specific model with which statistical power (1 &#x02212; <italic>&#x003b2;</italic>) can be computed for any <italic>p</italic>-value cutoff <italic>&#x003b1;</italic>. Highest density regions<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> are used to account for the multi-modal nature of the artifact models and the integer read counts. Given the artifact prevalence estimates from the previous section for the VAF and depth of the candidate sSNV, the expected FDR for a <italic>p</italic>-value cutoff <italic>&#x003b1;</italic> can be computed using the relationship provided in the main text. The largest <italic>&#x003b1;</italic> satisfying the requested FDR <italic>&#x003b8;</italic> at each sSNV is used. This procedure does not formally control the FDR, as this would require formal models of <italic>N</italic><sub>T</sub> and <italic>N</italic><sub>A</sub> rather than the heuristics used here.</p></sec><sec id="Sec23"><title>Multi-sample calling</title><p id="Par64">SCAN-SNV&#x02019;s joint calling model is based on the idea that true mutations should match the estimated AB in every sample in which they are observed. We define a joint statistic <italic>J</italic> as the product of ABC <italic>p</italic>-values for all samples with any mutation supporting reads. Each ABC <italic>p</italic>-value is subject to a penalty factor of 1/10 if the standard deviation of the GP at the locus exceeds 1. <italic>J</italic>-statistics are also computed for 4000 randomly selected hSNPs which are then grouped based on the number of single cells supporting the hSNP. Ninetieth percentiles are computed for each group of hSNP <italic>J</italic>-statistics and used as thresholds for sSNVs supported by the same number of samples. Unlike single-sample calls, joint calls are not filtered by the artifact statistical tests or excess indel and read clipping filters.</p></sec><sec id="Sec24"><title>Excess indel and read clipping filters</title><p id="Par65">Artefactual sSNVs may result from nearby misalignments or areas of poor alignment. These may be single-cell specific if, e.g., an MDA chimera<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> event occurred. One sign that a locus may be compromised in a single cell is a large number of sequencing reads with indels or soft- or hard clipping which is not also seen in the matched bulk. BWA-MEM reports these events in the CIGAR string as D, I, S, and H operations. We therefore sought to determine how many indel (I, D) or clipping (H, S) operations should be tolerated at somatic SNV candidates by comparing to the rate of the same CIGAR operations in bulk at the same locus. We therefore compute the fraction of reads containing indel and clip operations for both bulk and single cell at each candidate sSNV and a set of 4000 randomly chosen hSNPs. The hSNPs are used to build 2-dimensional empirical distributions (<italic>F</italic><sub>Single cell,OP</sub>, <italic>F</italic><sub>Bulk,OP</sub>), where <italic>F</italic><sub>T,OP</sub> is the fraction of CIGAR operations of type OP (either indel or clip) spanning a single hSNP in the specified sample type <italic>T</italic>. Similar quantities are computed for each candidate somatic SNV. Candidates are filtered if they exceed the 90th percentile of either (i.e., indel or clip) hSNP empirical distribution.</p></sec><sec id="Sec25"><title>Running SCAN-SNV</title><p id="Par66">SCAN-SNV is implemented using Snakemake<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> and distributed as a Conda<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> package. SCAN-SNV and all dependencies were installed using Conda into a blank environment and the scansnv script was run with default parameters. External databases used were the human reference genome b37d5 (--ref), dbSNP 147 common variants (--dbsnp), and the 1000 Genomes Project phase 3 with X chromosome dated October 2014 provided by SHAPEIT2 (--shapeit-panel). SCAN-SNV was run on a SLURM cluster using the --drmaa flag. Candidate sSNVs that pass the ABC test, pre-amplification and amplification artifact tests using a target FDR of 10%, and excess indel and clipping tests are reported.</p></sec><sec id="Sec26"><title>Running other somatic SNV callers</title><p id="Par67">SCcaller version 1.1 was run as previously reported<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. BAMs were converted to pileups using samtools version 1.3.1 with the option -C50 and hSNPs were defined using dbSNP version 146. Single cell somatic SNVs were called by applying SCcaller&#x02019;s -a varcall, -a cutoff and reasoning v1.0 script in sequence with default parameters. As recommended on the Github README, passing somatic mutations were required to have VAF&#x02009;&#x0003e;&#x02009;1/8, filter status&#x02009;=&#x02009;PASS, bulk status&#x02009;=&#x02009;refgenotype and must not have been observed in dbSNP. The stringent artifact threshold corresponding to <italic>&#x003b1;</italic>&#x02009;=&#x02009;0.01 was used for assessment.</p><p id="Par68">Monovar commit 7b47571 was downloaded and the somatic calling strategy reported previously<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> was mimicked as closely as possible; no script is provided for identifying somatic mutations. Single cell BAMs were input to samtools version 1.9 with options -BQ0 -d10000 -q 40, which was piped into the monovar.py script with options -p 0.002 -a 0.2 -t 0.05 -m 2 as recommended by the authors. To determine whether SNVs were somatic or germline, samtools was run with the same options on matched bulk data. Somatic SNVs were determined by the following filters: Monovar&#x02019;s genotype string must not match ./. or 0/0; minimum sequencing depth of 10 with at least 3 reads supporting the mutation; at least 6 reads in bulk with no more than 1 mutation supporting read; and single-cell VAF&#x02009;&#x02265;&#x02009;10% for sSNVs with &#x0003e;100 depth or VAF&#x02009;&#x02265;&#x02009;15% for sSNVs with depth between 20 and 100. Finally, sSNVs were filtered if any other call occurred within 10&#x02009;bp. For joint calling, the VCF column FILTER=PASS was also required.</p><p id="Par69">MuTect calls were produced by MuTect version 1.1.7. Although MuTect 2 is now preferred, it relies on an external panel of normals for proper filtration. We chose to use MuTect 1 because it is unclear to what extent MuTect 2 performance would depend upon this panel and because no reference panel of normals is publicly available. MuTect was run with default parameters except -dt None and COSMIC v72<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> and dbSNP 147 (common variants) were passed to parameters --cosmic and --dbsnp, respectively. All sSNVs with FILTER=PASS were retained.</p><p id="Par70">GATK HaplotypeCaller was run jointly on all SD samples and mixed bulk with the extra parameters -mmq 60 -rf BadCigar --dontUseSoftClippedBases followed by VQSR with -mode SNP and GATK best practices parameters for the HapMap, Omni, 1000 Genomes and dbSNP databases. Somatic SNVs were filtered from the raw calls by requiring 0 mutation supporting reads, depth&#x02009;&#x02265;&#x02009;10 and genotype string 0/0 in bulk, any single-cell genotype string other than ./. and 0/0, absence from dbSNP 147 common and a VQSR tranche status of at least 90% or 99% for sensitivity targets 90% and 99%, respectively.</p></sec><sec id="Sec27"><title>Synthetic diploid read mixing</title><p id="Par71">Aligned and processed BAMs for individuals 5087 and 5532 were downloaded from dbGaP study phs001485.v1.p1. Reads aligned to chromosome X were extracted from each BAM and downsampled to an average of 15&#x000d7; using samtools view&#x02019;s -s option. Spike-in mutations were then added to each downsampled BAM as described below. Finally, a downsampled, spike-in carrying BAM from each individual was mixed with samtools merge to create a single BAM with ~30&#x000d7; mean depth (Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>).</p></sec><sec id="Sec28"><title>Synthetic diploid spike-ins</title><p id="Par72">First, a genomic blacklist was created to ensure that spike-in mutations would not intersect with endogenous variants or artifacts, pseudoautosomal regions (PARs), assembly gaps or common variant sites as reported by dbSNP 147. To identify potential endogenous variants and artifacts, GATK HaplotypeCaller was run jointly on all full-depth BAMs with default parameters. A 5&#x02009;bp window centered at each position with non-reference reads output by GATK was added to the blacklist. Similarly, 5&#x02009;bp windows centered at the position of every record in dbSNP 147 common were also added. Finally, the blacklist was completed by adding 26 assembly gaps annotated by UCSC (hgdownload.cse.ucsc.edu/goldenPath/hg19/database/gap.txt.gz) and the hg19 coordinates for PAR1 (60,001&#x02013;2,699,520) and PAR2 (154,931,044&#x02013;155,260,560). In total, 3750 spike-in mutations (corresponding to 15 branches with 250 mutations each) were created by choosing random positions from the non-blacklisted genome and a random non-reference base. Two hundred and fifty mutations were assigned to each branch of the phylogeny and spiked into one of the two downsampled donor BAMs for all descendent SDs using BAMSurgeon (Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>). Spike-ins were added at 100% VAF. A spike-in was considered successful if at least 1 alternate read survived BAMSurgeon&#x02019;s mutation and realignment process. The number of successful spike-ins ranged from 180 to 446, depending primarily on the breadth of coverage of each single cell. BAMSurgeon was run with the following parameters: --force --mindepth 0 --maxdepth 10000 --minmutreads 0 --ignoresnps --aligner mem. BAMSurgeon was modified by adding the parameters -I 400,90 to the BWA-MEM command because BWA often cannot infer insert size characteristics in the small windows around spike in mutations. Without this addition, the PROPER_PAIR BAM flag is often not set, causing some mutation-carrying reads to be ignored by samtools. Actual insert size mean and standard deviations ranged from 388 to 428 and 81 to 93, respectively, across all donor chromosome X BAMs.</p></sec><sec id="Sec29"><title>Synthetic diploid assessment</title><p id="Par73">Sensitivity was calculated as the fraction of successful spike-ins recovered. The number of FPs per SD was the number of sSNV calls that were not known spike-ins or endogenous sSNVs. Endogenous sSNVs were determined by examining the full-depth single cell and bulk BAMs with samtools mpileup with -q 60 at every site called by any genotyper. A site was considered a putative endogenous sSNV if either: (1) the mean VAF of the sSNV across all samples with at least 2 alternate reads was &#x02265;80% and bulk contained at least 2 reads at the locus with none supporting the sSNV; or (2) the mean VAF of the sSNV across all samples with at least 2 alternate reads was &#x02265;90%, at least two single cells supported the sSNV and the bulk contained no reads at the locus.</p></sec><sec id="Sec30"><title>Kindred cell system</title><p id="Par74">Aligned and processed BAMs for the kindred system were downloaded from the NCBI Sequence Read Archive (SRA) using accession number SRP067062. All 13 BAMs were analyzed jointly by GATK HaplotypeCaller (with -rf BadCigar --dontUseSoftClippedBases) and bcftools call (with -mvV indels -P 0.5) using minimum mapping qualities (MQs) of both 1 and 60. The -P 0.5 option was chosen to greatly increase samtools&#x02019; sensitivity. All sites output by samtools and GATK with MQ&#x02009;&#x02265;&#x02009;60 non-reference reads in any sample were classified using the following criteria. First, sites were classified as supported in bulk if mutation supporting reads were observed in sample SRR2976567 in either of the MQ&#x02009;=&#x02009;60 or MQ&#x02009;=&#x02009;1 runs. Sites with no mutation supporting reads across all ten non-kindred samples and at least 50 total reads across all samples were considered kindred exclusive and further separated into those supported by 1, 2, or 3 of the kindred samples. Kindred exclusive sites supported by all three samples are designated triple exclusive (TRE). An additional class consisting of sSNVs supported by all three kindred samples and at most 1 supporting read in a non-kindred sample was also created to account for sequencing errors since base quality scores were not considered. All remaining sites were classified as FPs. Site classifications were further refined by a mock kindred group analysis (described below). Finally, samtools and GATK classifications were integrated according to Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref> to create the TRE, likely TP, likely FP and unknown designations in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. In total, 569 TRE sites were used to compute sensitivity.</p></sec><sec id="Sec31"><title>Mock kindred group analysis</title><p id="Par75">Clonal sSNVs or artifacts may be exclusive to the kindred group due to chance alone (e.g., due to chance dropout in the remaining samples or differences in read lengths). We therefore applied the same classification procedure described above to mock kindred groups consisting of three randomly chosen samples. All possible mock groups were created except the group of three clonally expanded samples and groups containing heat lysed single cells. For each mock kindred exclusive mutation supported by two or three samples, we counted the total number of mutation supporting reads across the mock kindred group. Cutoffs corresponding to the 99th (samtools) and 75th (GATK) percentiles of total mutation supporting reads were separately computed for mock sites supported by two or three of the mock kindred samples. Finally, kindred exclusive sites from the true kindred group were classified as filtered if the total number of mutation supporting reads across the kindred group did not exceed the appropriate cutoff. For GATK, cutoffs were 5 and 7 for kindred exclusive sites with two or three supporting kindred samples, respectively. Samtools cutoffs were 5 and 9. See Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref> for a detailed mock analysis of TREs.</p></sec><sec id="Sec32"><title>Increased DNA content simulation</title><p id="Par76">BAMs for two single-cell samples with imbalanced hSNP VAF distributions (IL-12 and IL-3) were downsampled by 50% and combined into a single BAM using samtools. The two other imbalanced samples, HL-1 and HL-2, were not used because a different, heat-based cell lysis protocol was used that may have affected the shapes of their VAF distributions. Downsampling was repeated 10 times to account for potential variance due to read sampling. AB models were fit by SCAN-SNV on chromosome 1 for each mixed BAM. The 10 replicates are summarized by a single, representative curve in Fig. <xref rid="Fig7" ref-type="fig">7</xref> since essentially no variation between the trials was observed.</p></sec><sec id="Sec33"><title>Cancer analysis</title><p id="Par77">Raw FASTQ files for four ERBC tumor cells (BC1-4), tumor bulk (BCT) and matched normal bulk (BCN) were downloaded from the NCBI SRA, accession SRP013572. Reads were aligned with BWA-MEM to GRCh37 with decoy and postprocessed using Picard MarkDuplicates, GATK indel realignment and GATK base quality score recalibration. Putative sSNVs from all callers were gathered and samtools mpileup -q 60 was used to determine read support for each mutation across all six samples. sSNVs were then classified according to Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>. Haploid, diploid, and triploid chromosomes were identified by previously reported copy number profiles obtained by sequencing the bulk tumor population and 50 single cells<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>.</p></sec><sec id="Sec34"><title>Reporting summary</title><p id="Par78">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p></sec></sec><sec sec-type="supplementary-material"><title>Supplementary information</title><sec id="Sec35"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="41467_2019_11857_MOESM1_ESM.pdf"><caption><p>Supplementary Information</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="41467_2019_11857_MOESM2_ESM.pdf"><caption><p>Reporting Summary</p></caption></media></supplementary-material>
</p></sec></sec></body><back><fn-group><fn><p><bold>Peer review information:</bold>
<italic>Nature Communications</italic> thanks Yong Wang and other anonymous reviewer(s) for their contribution to the peer review of this work.</p></fn><fn><p><bold>Publisher&#x02019;s note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><sec><title>Supplementary information</title><p><bold>Supplementary Information</bold> accompanies this paper at 10.1038/s41467-019-11857-8.</p></sec><ack><title>Acknowledgements</title><p>This work was supported by the Bioinformatics and Integrative Genomics training grant (T32HG002295) from the National Human Genome Research Institute (L.J.L., C.L.B), a Brain Somatic Mosaicism Network grant (U01MH106883) from the National Institute of Mental Health (P.J.P., M.A.S.), and Ludwig Center at Harvard Medical School (P.J.P.).</p></ack><notes notes-type="author-contribution"><title>Author contributions</title><p>L.J.L. conceived and implemented the method, supervised by P.J.P. L.J.L., C.L.B. and M.A.S. performed analyses.</p></notes><notes notes-type="data-availability"><title>Data availability</title><p>Source single-cell sequencing data for synthetic diploid X chromosomes were downloaded from dbGaP study phs001485.v1.p1. Single-cell sequencing data for the kindred cell system were downloaded from NCBI SRA project SRP067062. Sequencing data for single tumor cells were downloaded from NCBI SRA project SRP013572. All other relevant data are available upon request.</p></notes><notes notes-type="data-availability"><title>Code availability</title><p>Source code for SCAN-SNV is available for download at <ext-link ext-link-type="uri" xlink:href="https://www.github.com/parklab/scan-snv">https://github.com/parklab/scan-snv</ext-link>. SCAN-SNV version 0.9 and r-scansnv version 0.1 were used to produce all results in this study.</p></notes><notes notes-type="COI-statement"><title>Competing interests</title><p id="Par79">The authors declare no competing interests.</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Clonal evolution in breast cancer revealed by single nucleus genome sequencing</article-title><source>Nature</source><year>2014</year><volume>512</volume><fpage>155</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1038/nature13600</pub-id><pub-id pub-id-type="pmid">25079324</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>CZ</given-names></name><etal/></person-group><article-title>Chromothripsis from DNA damage in micronuclei</article-title><source>Nature</source><year>2015</year><volume>522</volume><fpage>179</fpage><lpage>184</lpage><pub-id pub-id-type="doi">10.1038/nature14493</pub-id><pub-id pub-id-type="pmid">26017310</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lodato</surname><given-names>M</given-names></name><etal/></person-group><article-title>Somatic mutation in single human neurons tracks developmental and transcriptional history</article-title><source>Science</source><year>2015</year><volume>350</volume><fpage>94</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1126/science.aab1785</pub-id><pub-id pub-id-type="pmid">26430121</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lodato</surname><given-names>M</given-names></name><etal/></person-group><article-title>Aging and neurodegeneration are associated with increased mutations in single human neurons</article-title><source>Science</source><year>2018</year><volume>359</volume><fpage>555</fpage><lpage>559</lpage><pub-id pub-id-type="doi">10.1126/science.aao4426</pub-id><pub-id pub-id-type="pmid">29217584</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>L</given-names></name><name><surname>Ma</surname><given-names>F</given-names></name><name><surname>Chapman</surname><given-names>A</given-names></name><name><surname>Lu</surname><given-names>S</given-names></name><name><surname>Xie</surname><given-names>XS</given-names></name></person-group><article-title>Single-cell whole-genome amplification and sequencing: methodology and applications</article-title><source>Annu. Rev. Genomics Hum. Genet.</source><year>2015</year><volume>16</volume><fpage>79</fpage><lpage>102</lpage><pub-id pub-id-type="doi">10.1146/annurev-genom-090413-025352</pub-id><pub-id pub-id-type="pmid">26077818</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evrony</surname><given-names>G</given-names></name><name><surname>Lee</surname><given-names>E</given-names></name><name><surname>Park</surname><given-names>PJ</given-names></name><name><surname>Walsh</surname><given-names>CA</given-names></name></person-group><article-title>Resolving rates of mutation in the brain using single-neuron genomics</article-title><source>eLife</source><year>2016</year><volume>5</volume><fpage>e12966</fpage><pub-id pub-id-type="doi">10.7554/eLife.12966</pub-id><pub-id pub-id-type="pmid">26901440</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Bourcy</surname><given-names>CFA</given-names></name><etal/></person-group><article-title>A quantitative comparison of single-cell whole genome amplification methods</article-title><source>PLoS One</source><year>2014</year><volume>9</volume><fpage>e105585</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0105585</pub-id><pub-id pub-id-type="pmid">25136831</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>CZ</given-names></name><etal/></person-group><article-title>Calibrating genomic and allelic coverage bias in single-cell sequencing</article-title><source>Nat. Commun.</source><year>2015</year><volume>6</volume><fpage>6822</fpage><pub-id pub-id-type="doi">10.1038/ncomms7822</pub-id><pub-id pub-id-type="pmid">25879913</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zafar</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Nakhleh</surname><given-names>L</given-names></name><name><surname>Navin</surname><given-names>N</given-names></name><name><surname>Chen</surname><given-names>K</given-names></name></person-group><article-title>Monovar: single-nucleotide variant detection in single cells</article-title><source>Nat. Methods</source><year>2016</year><volume>13</volume><fpage>505</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3835</pub-id><pub-id pub-id-type="pmid">27088313</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dong</surname><given-names>X</given-names></name><etal/></person-group><article-title>Accurate identification of single-nucleotide variants in whole-genome-amplified single cells</article-title><source>Nat. Methods</source><year>2017</year><volume>14</volume><fpage>491</fpage><lpage>493</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4227</pub-id><pub-id pub-id-type="pmid">28319112</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DePristo</surname><given-names>MA</given-names></name><etal/></person-group><article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title><source>Nat. Genet.</source><year>2011</year><volume>43</volume><fpage>491</fpage><lpage>498</lpage><pub-id pub-id-type="doi">10.1038/ng.806</pub-id><pub-id pub-id-type="pmid">21478889</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delaneau</surname><given-names>O</given-names></name><name><surname>Marchini</surname><given-names>J</given-names></name><collab>The 1000 Genomes Project Consortium.</collab></person-group><article-title>Integrating sequence and array data to create an improved 1000 Genomes Project haplotype reference panel</article-title><source>Nat. Commun.</source><year>2014</year><volume>5</volume><fpage>3934</fpage><pub-id pub-id-type="doi">10.1038/ncomms4934</pub-id><pub-id pub-id-type="pmid">25653097</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ewing</surname><given-names>A</given-names></name><etal/></person-group><article-title>Combining tumor genome simulation with crowdsourcing to benchmark somatic single-nucleotide-variant detection</article-title><source>Nat. Methods</source><year>2015</year><volume>12</volume><fpage>623</fpage><lpage>630</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3407</pub-id><pub-id pub-id-type="pmid">25984700</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cibulskis</surname><given-names>K</given-names></name><etal/></person-group><article-title>Sensitive detection of somatic point mutations in impure and heterogeneous cancer samples</article-title><source>Nat. Biotechnol.</source><year>2013</year><volume>31</volume><fpage>213</fpage><lpage>219</lpage><pub-id pub-id-type="doi">10.1038/nbt.2514</pub-id><pub-id pub-id-type="pmid">23396013</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><fpage>2987</fpage><lpage>2993</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr509</pub-id><pub-id pub-id-type="pmid">21903627</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexandrov</surname><given-names>L</given-names></name><etal/></person-group><article-title>Signatures of mutational processes in human cancer</article-title><source>Nature</source><year>2013</year><volume>500</volume><fpage>415</fpage><lpage>421</lpage><pub-id pub-id-type="doi">10.1038/nature12477</pub-id><pub-id pub-id-type="pmid">23945592</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blokzijl</surname><given-names>F</given-names></name><etal/></person-group><article-title>Tissue-specific mutation accumulation in human adult stem cells during life</article-title><source>Nature</source><year>2016</year><volume>538</volume><fpage>260</fpage><lpage>264</lpage><pub-id pub-id-type="doi">10.1038/nature19768</pub-id><pub-id pub-id-type="pmid">27698416</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garvin</surname><given-names>T</given-names></name><etal/></person-group><article-title>Interactive analysis and assessment of single-cell copy-number variations</article-title><source>Nat. Methods</source><year>2015</year><volume>12</volume><fpage>1058</fpage><lpage>1060</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3578</pub-id><pub-id pub-id-type="pmid">26344043</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bohrson</surname><given-names>C</given-names></name><etal/></person-group><article-title>Linked-read analysis identifies mutations in single-cell DNA sequencing data</article-title><source>Nat. Genet.</source><year>2019</year><volume>51</volume><fpage>749</fpage><lpage>754</lpage><pub-id pub-id-type="doi">10.1038/s41588-019-0366-2</pub-id><pub-id pub-id-type="pmid">30886424</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="other">Rasmussen, C. &#x00026; Williams, C. <italic>Gaussian Processes for Machine Learning</italic> (The MIT Press, 2006).</mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="other">Blocker, A. W. fastGHQuad: Fast Rcpp implementation of Gauss-Hermite quadrature. R package version 1.0. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=fastGHQuad">https://CRAN.R-project.org/package=fastGHQuad</ext-link>.</mixed-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hyndman</surname><given-names>RobJ</given-names></name></person-group><article-title>Computing and graphing highest density regions</article-title><source>Am. Stat.</source><year>1996</year><volume>50</volume><fpage>120</fpage><lpage>126</lpage></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lasken</surname><given-names>R</given-names></name><name><surname>Stockwell</surname><given-names>T</given-names></name></person-group><article-title>Mechanism of chimera formation during the Multiple Displacement Amplification reaction</article-title><source>BMC Biotechnol.</source><year>2007</year><volume>7</volume><fpage>19</fpage><pub-id pub-id-type="doi">10.1186/1472-6750-7-19</pub-id><pub-id pub-id-type="pmid">17430586</pub-id></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>K&#x000f6;ster</surname><given-names>J</given-names></name><name><surname>Rahmann</surname><given-names>S</given-names></name></person-group><article-title>Snakemake&#x02014;a scalable bioinformatics workflow engine</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>2520</fpage><lpage>2522</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id><pub-id pub-id-type="pmid">22908215</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="other">Conda, <ext-link ext-link-type="uri" xlink:href="http://conda.io">http://conda.io</ext-link>.</mixed-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tate</surname><given-names>J</given-names></name><etal/></person-group><article-title>COSMIC: the catalogue of somatic mutations in cancer</article-title><source>Nucleic Acids Res.</source><year>2019</year><volume>47</volume><fpage>D941</fpage><lpage>D947</lpage><pub-id pub-id-type="doi">10.1093/nar/gky1015</pub-id><pub-id pub-id-type="pmid">30371878</pub-id></element-citation></ref></ref-list></back></article>