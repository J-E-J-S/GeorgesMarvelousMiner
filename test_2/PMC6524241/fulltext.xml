<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Med Genomics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Med Genomics</journal-id><journal-title-group><journal-title>BMC Medical Genomics</journal-title></journal-title-group><issn pub-type="epub">1755-8794</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6524241</article-id><article-id pub-id-type="publisher-id">508</article-id><article-id pub-id-type="doi">10.1186/s12920-019-0508-5</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>NeoMutate: an ensemble machine learning framework for the prediction of somatic mutations in cancer</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Anzar</surname><given-names>Irantzu</given-names></name><address><email>irantzu@oncoimmunity.com</email></address><xref ref-type="aff" rid="Aff1"/></contrib><contrib contrib-type="author"><name><surname>Sverchkova</surname><given-names>Angelina</given-names></name><address><email>angelina@oncoimmunity.com</email></address><xref ref-type="aff" rid="Aff1"/></contrib><contrib contrib-type="author"><name><surname>Stratford</surname><given-names>Richard</given-names></name><address><email>richard@oncoimmunity.com</email></address><xref ref-type="aff" rid="Aff1"/></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9896-0613</contrib-id><name><surname>Clancy</surname><given-names>Trevor</given-names></name><address><email>trevor@oncoimmunity.com</email></address><xref ref-type="aff" rid="Aff1"/></contrib><aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.458653.9</institution-id><institution>OncoImmunity AS, Oslo Cancer Cluster, </institution></institution-wrap>Ullernchausseen 64/66, 0379 Oslo, Norway </aff></contrib-group><pub-date pub-type="epub"><day>16</day><month>5</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>16</day><month>5</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>12</volume><elocation-id>63</elocation-id><history><date date-type="received"><day>28</day><month>8</month><year>2018</year></date><date date-type="accepted"><day>22</day><month>4</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s). 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p id="Par1">The accurate screening of tumor genomic landscapes for somatic mutations using high-throughput sequencing involves a crucial step in precise clinical diagnosis and targeted therapy. However, the complex inherent features of cancer tissue, especially, tumor genetic intra-heterogeneity coupled with the problem of sequencing and alignment artifacts, makes somatic variant calling a challenging task. Current variant filtering strategies, such as rule-based filtering and consensus voting of different algorithms, have previously helped to increase specificity, although comes at the cost of sensitivity.</p></sec><sec><title>Methods</title><p id="Par2">In light of this, we have developed the NeoMutate framework which incorporates 7 supervised machine learning (ML) algorithms to exploit the strengths of multiple variant callers, using a non-redundant set of biological and sequence features. We benchmarked NeoMutate by simulating more than 10,000 bona fide cancer-related mutations into three well-characterized Genome in a Bottle (GIAB) reference samples.</p></sec><sec><title>Results</title><p id="Par3">A robust and exhaustive evaluation of NeoMutate&#x02019;s performance based on 5-fold cross validation experiments, in addition to 3 independent tests, demonstrated a substantially improved variant detection accuracy compared to any of its individual composite variant callers and consensus calling of multiple tools.</p></sec><sec><title>Conclusions</title><p id="Par4">We show here that integrating multiple tools in an ensemble ML layer optimizes somatic variant detection rates, leading to a potentially improved variant selection framework for the diagnosis and treatment of cancer.</p></sec><sec><title>Electronic supplementary material</title><p>The online version of this article (10.1186/s12920-019-0508-5) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Somatic variant detection</kwd><kwd>Machine learning</kwd><kwd>Cancer genomics</kwd><kwd>Precision medicine</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100005416</institution-id><institution>Norges Forskningsr&#x000e5;d</institution></institution-wrap></funding-source><award-id>256891/O20</award-id><principal-award-recipient><name><surname>Clancy</surname><given-names>Trevor</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par17">One of the hallmarks of cancer is the accumulation of somatic genomic alterations, acquired during a cell&#x02019;s life cycle and development [<xref ref-type="bibr" rid="CR1">1</xref>]. Throughout cancer progression, some of these variants may dictate clinical response to therapy [<xref ref-type="bibr" rid="CR2">2</xref>]. The reliable detection of mutations in cancer genomes is therefore key to our understanding of the genomic basis of tumorigenesis and patient survival. Unfortunately, the accurate prediction of somatic variants from tumor and matched normal samples using next generation sequencing (NGS) data remains challenging [<xref ref-type="bibr" rid="CR3">3</xref>&#x02013;<xref ref-type="bibr" rid="CR5">5</xref>]. The complex features of tumor tissue, particularly intra-tumor heterogeneity and structural rearrangements, in addition to normal tissue admixtures, intrinsic sequencing errors and mapping ambiguities, are sources of noise and complexity in the analysis. As a result, the current somatic variant calling strategies generate high false prediction rates [<xref ref-type="bibr" rid="CR4">4</xref>].</p><sec id="Sec3"><title>Background to the main individual variant callers: strengths and weaknesses</title><p id="Par18">The advent of NGS technologies has enabled the comprehensive detection of de novo DNA aberrations in a tumor. The continued advancements in variant detection in the last decade has resulted in a wide collection of bioinformatics tools based on different underlying statistical models. However, their results vary widely as demonstrated in several benchmarking studies [<xref ref-type="bibr" rid="CR3">3</xref>&#x02013;<xref ref-type="bibr" rid="CR11">11</xref>] and none have emerged as a gold standard and been universally adopted by the field. The specific mathematical algorithms operating each variant caller plus the enormous experimental and biological variability in tumor samples creates ambiguities in performance across different datasets. One of the biggest challenges is to accurately discriminate between low allele frequencies of true somatic variants (particularly relevant in impure samples or heterogeneous tumors) and sequencing or alignment artifacts.</p><p id="Par19">VarScan2 [<xref ref-type="bibr" rid="CR12">12</xref>] and VarDict [<xref ref-type="bibr" rid="CR13">13</xref>], apply a heuristic methodology followed by a Fisher&#x02019;s test to increase the reliability of the detected somatic variants. An appropriate parameter fine-tuning and threshold selection in heuristic tools can achieve a good performance in low-frequency variant detection; unfortunately optimal parameter values are frequently unknown and dependent on the specific dataset [<xref ref-type="bibr" rid="CR14">14</xref>]. SomaticSniper [<xref ref-type="bibr" rid="CR15">15</xref>], based on a joint genotype analysis, is designed for single nucleotide variants (SNVs) detection on low-coverage data. However, low-depth coupled with the underlying diploid assumption in tumor genomes, means that the method is not optimal for detecting of low frequency variants. Modeling joint allele frequencies instead of joint genotypes, as done by Strelka [<xref ref-type="bibr" rid="CR16">16</xref>], is a straightforward way to call low-frequency variants. Strelka2 [<xref ref-type="bibr" rid="CR17">17</xref>], a variant calling method which builds upon its predecessor Strelka, applies an additional random forest based variant re-scoring step to improve accuracy on liquid and late-stage tumours. Finally, methods like MuTect2 (available in GATK &#x0003e;&#x02009;3.5) [<xref ref-type="bibr" rid="CR18">18</xref>], Freebayes [<xref ref-type="bibr" rid="CR19">19</xref>] and Lancet [<xref ref-type="bibr" rid="CR20">20</xref>] follow a haplotype-based strategy, where the reads are locally assembled representing the candidate haplotypes in De Bruijn graphs, aiding the detection of co-occurring variants.</p><p id="Par20">Unfortunately, identifying the most appropriate variant calling tool for each scenario, in addition to the adequate fine-tuning of its parameters for optimal performance, is a complex and time-consuming task [<xref ref-type="bibr" rid="CR3">3</xref>&#x02013;<xref ref-type="bibr" rid="CR9">9</xref>], which complicates the ability to make rational clinical decisions based on called variants in an actionable timeframe [<xref ref-type="bibr" rid="CR3">3</xref>].</p></sec><sec id="Sec4"><title>The effect of integrating variant callers: their union or intersection</title><p id="Par21">Due to the low concordance between individual tools, it is natural to address the challenge of somatic variant calling through the integration of two or more tools. Integrating the results of two or three somatic variant callers in a consensus voting filtering strategy has emerged as a standard protocol in many recent studies [<xref ref-type="bibr" rid="CR21">21</xref>&#x02013;<xref ref-type="bibr" rid="CR24">24</xref>] . However, although these consensus calling approaches may help to increase the calling of specific candidates, this often comes at the cost of sensitivity when candidates are identified using the intersection between component tools, and can introduce enormous amount of false positives when they are identified using the union between component tools. Consensus calling may lead to the loss of valuable true positive variants, particularly those that are present at low variant allelic frequencies (VAF). Recent studies have shown that some clinically relevant mutations are miscalled using intersection based approach, such as treatment-induced secondary mutations [<xref ref-type="bibr" rid="CR25">25</xref>], and thus the intersection of tools is arguably a sub-optimal solution.</p></sec><sec id="Sec5"><title>The emergence of machine learning approaches</title><p id="Par22">A relatively recent progression in the variant calling field to address these aforementioned problems is the application of supervised machine learning (ML). In the ML approaches, variant calling can be reduced to a classification problem, whereby each considered genomic position is labeled with its mutation status. Those base pairs that differ from the reference genome in the tumor sample, and are not present in the normal sample, will be subsequently labelled as somatic mutations.</p><p id="Par23">Variant calling strategies that take advantage of supervised ML can be classified into two main categories: (1) variant calling algorithms directly based on ML and (2) ensemble ML approaches that integrate multiple variant callers. SNooPer [<xref ref-type="bibr" rid="CR26">26</xref>], MutationSeq [<xref ref-type="bibr" rid="CR27">27</xref>], TNscope [<xref ref-type="bibr" rid="CR28">28</xref>] and DeepVariant [<xref ref-type="bibr" rid="CR29">29</xref>] are examples of the former. SNooPer is based on a random forest (RF) classifier primarily focused on low-depth sequencing data, resulting in a suboptimal method for low VAF detection. Moreover, SNooPer&#x02019;s training dataset is based on the GATK HaplotypeCaller [<xref ref-type="bibr" rid="CR30">30</xref>], which is not well suited to extreme allele frequencies and therefore not recommended for somatic (cancer) variant discovery. The MutationSeq study involved building a feature-based classifier to provide guidelines based on a comparison of four ML algorithms applied to 106 manually selected features, and only focuses on SNVs. Many of the 106 selected features are redundant and used by several variant callers themselves, however in one sense, this indicated an emergence toward ensemble ML to address the problem of selecting arbitrary thresholds by each individual tool for selected features. TNScope, like Mutect2, is haplotype-based variant caller that applies rule-based approach by default. TNScope also provides a ML model trained using a RF from the Genome in a Bottle (GIAB) data [<xref ref-type="bibr" rid="CR31">31</xref>]. DeepVariant uses labeled true genotypes if and when they are available and has the goal of generalizing across sequencing technologies, genome builds, and experimental designs. It applies deep learning using convolutional neural networks to achieve high sensitivity and low specificity, and has not been developed or tested specifically for somatic variant calling.</p><p id="Par24">In the category of ensemble based variant callers it is first worth mentioning BAYSIC [<xref ref-type="bibr" rid="CR32">32</xref>]. While BAYSIC uses an unsupervised learning approach based on Bayesian statistics, it does also attempt to integrate four variant callers in a common framework. It is however restricted to scale by the need to intimately understand the estimated error rates of each individual tool, as it produces poster probabilities based on these estimates. Additionally, BAYSIC comes with the limitation that arbitrary thresholds depending on the tolerance for sensitivity versus specificity predetermine its performance. SomaticSeq [<xref ref-type="bibr" rid="CR33">33</xref>] and SMuRF [<xref ref-type="bibr" rid="CR34">34</xref>] are tools that use the ensemble of several variant callers in a supervised ML approach. SMuRF, although trained on the International Cancer Genome Consortium (ICGC) community-curated data that is not simulated, it is restricted to a limited amount of training data from only two tumors (both of them having high tumor purity (cancer-cell fraction &#x0003e;&#x02009;0.92)) and focused on whole genome sequencing data. SomaticSeq integrates five third-party variant callers through the use of &#x0003e;&#x02009;70 features into an ensemble of decision trees. Unfortunately, as with MutationSeq, these large number features are somewhat redundant, subject to arbitrary thresholds, and variation between the individual tools and VCF formats, dramatically affecting the portability of the tool. These limitations may also affect the scalability of such approaches and thereby the subsequent benefits that can be reaped from integrating multiple callers in ensemble ML framework.</p><p id="Par25">Following the concept of aggregating the results from multiple variant calling algorithms in an ensemble ML layer, to yield an overall improved performance compared to the individual component tools or consensus of tools, we have developed NeoMutate. In this study, NeoMutate combines the relative sensitivities of 7 state-of-the-art variant calling tools, including MuTect2 [<xref ref-type="bibr" rid="CR18">18</xref>], Strelka2 [<xref ref-type="bibr" rid="CR17">17</xref>], SomaticSniper [<xref ref-type="bibr" rid="CR15">15</xref>], VarScan2 [<xref ref-type="bibr" rid="CR12">12</xref>], VarDict [<xref ref-type="bibr" rid="CR13">13</xref>], Lancet [<xref ref-type="bibr" rid="CR20">20</xref>], Freebayes [<xref ref-type="bibr" rid="CR19">19</xref>], in order to gain improved performance. NeoMutate extracts 17 core non-redundant biological and sequencing features from the aligned BAM files. These features, for each candidate site, are incorporated with only three of the essential variant annotations provided by the individual tools. This design facilitates the scalability of the solution to in principle encompass an unlimited number of variant callers. Unlike the previous two ensemble based supervised ML approaches (SMuRF and SomaticSeq), a comprehensive survey of ML classifiers is profiled (including logistic regression, support vector machines, Gaussian Na&#x000ef;ve Bayes, random forests, gradient boosting decision trees and neural networks). All of the ensemble ML models in NeoMutate were trained with more than 3000 bona fide cancer variants from Catalogue of Somatic Mutations in Cancer (COSMIC) [<xref ref-type="bibr" rid="CR35">35</xref>]. Standard 5-fold cross validation and independent tests demonstrated an improved variant detection accuracy compared to the individual tools and consensus voting strategies. In particular, decision-tree type models stood out as having surpassed the standard filtering approaches and individual tools. Using a range of metrics, we demonstrate how the NeoMutate framework optimizes simultaneously for sensitivity and specificity. This is achieved using the minimal required, albeit precise features that are most relevant to accurate variant calling, rendering NeoMutate with a high degree of scalability and portability.</p></sec></sec><sec id="Sec6"><title>Methods</title><sec id="Sec7"><title>Generation of synthetic tumor variant datasets and NGS data processing</title><p id="Par26">Following the methodology used by ICGC-TCGA DREAM Somatic Mutation Calling Challenge for the synthetic dataset generation, BamSurgeon was used to spike mutations into three different well-known datasets included in the 1000 Genome Project (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>). The three WES sample files were downloaded in BAM format. In order to test all the functionalities of the NeoMutate workflow, the BAM files were converted back to fastq format using Picard SamToFastq (2.6.0) utility [<xref ref-type="bibr" rid="CR36">36</xref>] (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). Fastq files were then processed using NeoMutate, including data quality control, adapter clipping, alignment and alignment post-processing. Quality assessment of the fastq files was checked using FastQC (v0.11.5) [<xref ref-type="bibr" rid="CR37">37</xref>] and subsequently, adapter clipping, artefact removal, quality trimming through BBduk (37.50) [<xref ref-type="bibr" rid="CR38">38</xref>] was conducted when required. The high quality paired-end reads were aligned to the human hs37d5 reference genome, which included data from GRCh37, the rCRS mitochondrial sequence, Human herpesvirus 4 type 1 and the concatenated decoy sequences, leading to a better mapping quality. Alignment was performed using BWA-MEM (0.7.17-r1188) [<xref ref-type="bibr" rid="CR39">39</xref>], based on the Burrows-Wheeler transformation. The resulting alignment files (BAM) were cleaned following the recommended standardized GATK practices [<xref ref-type="bibr" rid="CR40">40</xref>], including duplicate marking, BQSR and Indel realignment. To check the quality of the raw and intermediate BAM files produced at each post-alignment step, several metrics were collected and measured using SAMtools (1.5) [<xref ref-type="bibr" rid="CR41">41</xref>], such as: number of reads mapped/unmapped, average length, mismatches (see Additional&#x000a0;file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Table S1, for a detailed overview of collected metrics).<table-wrap id="Tab1"><label>Table 1</label><caption><p>List of GIAB datasets used for NeoMutate benchmarking. The data was downloaded in BAM format and converted back to fastq in order to fully test all the functionalities of the workflow. (WES: whole-exome sequencing; PE: paired-end)</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Sample ID</th><th>Lab</th><th>Project</th><th>Library type</th><th>Read length</th><th>Insert size</th><th>File format</th><th>Number of reads before trimming</th><th>Number of reads after trimming</th><th>% kept reads</th></tr></thead><tbody><tr><td>NA12878</td><td>Broad Institute</td><td>CEU Trio Analysis (son)</td><td>WES, PE</td><td>76&#x02009;bp</td><td>155&#x02009;bp</td><td>BAM</td><td>118,969,048</td><td>89,151,231</td><td>74.94</td></tr><tr><td>NA12891</td><td>Broad Institute</td><td>CEU Trio Analysis (father)</td><td>WES, PE</td><td>76&#x02009;bp</td><td>155&#x02009;bp</td><td>BAM</td><td>116,639,621</td><td>88,079,244</td><td>75.51</td></tr><tr><td>NA24631</td><td>Oslo University Hospital</td><td>Asian (Han chinese) Trio (son)</td><td>WES, PE</td><td>125&#x02009;bp</td><td>202&#x02009;bp</td><td>BAM</td><td>61,001,625</td><td>60,852,682</td><td>99.76</td></tr></tbody></table></table-wrap><fig id="Fig1"><label>Fig. 1</label><caption><p>In silico variant simulation workflow on real data using BamSurgeon: NA12878, NA12891 and NA24631 real datasets were spiked-in with non-overlapping variant subsets at different allele frequencies (ranging from 0.01 to 1) extracted from COSMIC database for S1, S2 and S3 simulation experiments. An additional simulation was performed using NA24631 dataset and non-COSMIC random mutations having VAF&#x02009;&#x0003c;&#x02009;=0.2. Text boxes coloured with blue borders represent steps embedded in NeoMutate workflow</p></caption><graphic xlink:href="12920_2019_508_Fig1_HTML" id="MO1"/></fig></p><p id="Par27">The analysis-ready BAM files, one per sample, were randomly sampled into two non-overlapping subsets of equal size for NA12878 and NA12891, and in 0.4/0.6 ratio for the NA24631 in order to slightly increase variability (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). Four different simulations, S1, S2, S3 and S4 (Additional&#x000a0;file&#x000a0;<xref rid="MOESM2" ref-type="media">2</xref> S1 - S4) were performed using the three genomes and non-overlapping spectrum of synthetic mutations for an exhaustive benchmark of NeoMutate (Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>). After checking coverage using BEDTOOLS program (v2.26.0) [<xref ref-type="bibr" rid="CR42">42</xref>], covered cancer related variants were randomly selected from COSMIC database (v83) [<xref ref-type="bibr" rid="CR35">35</xref>] for S1, S2 and S3 simulations, including SNVs and indels, and added to one of the sampled sub-BAMs using BAMSurgeon forming the tumor bam file. The VAFs of the synthetic added mutation ranged from 0.01 to 1, allowing simulation of multiple subclones or sample contamination. The S4 simulation was implemented using variants not present in COSMIC dataset, but those generated at random positions in the genome to avoid the bias of some third-party tools towards COSMIC related mutations. Moreover, a more stringent VAF range was chosen for S4, having all the variants VAF&#x02009;&#x0003c;&#x02009;=0.2 (730 of them falling in the category of low allele frequency variants (VAF&#x02009;&#x0003c;&#x02009;=0.05)), in order to increase the complexity of the analysis (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3, for synthetic mutation spectrum VAF detailed overview). It is important to mention that due to the internal considerations in BAMSurgeon, not all chosen spike-in variants were successfully added probably because their location on low depth genomic regions or their extremely low VAF (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). However, the overall successful rate for spike-in variants was higher than 0.9 for most of the cases, as those variants were considered as ground truth for evaluating the models performance.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Simulation experiments design overview</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Simulation ID</th><th>Sample ID</th><th>is_COSMIC</th><th>VAF range</th><th>All</th><th>SNV</th><th>Insertions</th><th>Deletions</th></tr></thead><tbody><tr><td>S1</td><td>NA12878</td><td>yes</td><td>0.01&#x02013;1</td><td>3600</td><td>3000</td><td>300</td><td>300</td></tr><tr><td>S2</td><td>NA12891</td><td>yes</td><td>0.01&#x02013;1</td><td>6000</td><td>5000</td><td>500</td><td>500</td></tr><tr><td>S3</td><td>NA24631</td><td>yes</td><td>0.01&#x02013;1</td><td>6000</td><td>4000</td><td>1000</td><td>1000</td></tr><tr><td>S4</td><td>NA24631</td><td>no</td><td>0.01&#x02013;0.2</td><td>5000</td><td>3000</td><td>1012</td><td>988</td></tr></tbody></table></table-wrap></p></sec><sec id="Sec8"><title>Ensemble variant calling</title><p id="Par28">NeoMutate, in this study, incorporated an ensemble of 7 different state-of-the art tools, including: MuTect2, Strelka2, VarScan2, VarDict, SomaticSniper, Freebayes and Lancet (Table&#x000a0;<xref rid="Tab3" ref-type="table">3</xref>), which were executed having as input the tumor-normal paired BAM files with the embedded synthetic mutations. Nearly all default parameters suggested by the developer of each caller were used for running the tools, these are generally considered to be the optimal settings for most data types. (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5). Each somatic caller implements its own assumptions and has specific statistical models to exclude true genetic variations from background noise, which are optimal for certain datatypes but generate worse results for others. Integrating the different algorithms and selecting the union call-set seems a sensible approach for raising sensitivity and adaptability to the different tumor scenarios, the main purpose of this ensemble approach.<table-wrap id="Tab3"><label>Table 3</label><caption><p>List of individual somatic variant callers embedded in NeoMutate</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Tool</th><th>Version</th><th>Methodology</th></tr></thead><tbody><tr><td>MuTect2</td><td>3.8</td><td>Bayesian classifier</td></tr><tr><td>Strelka2</td><td>2.8.4</td><td>Bayesian model of admixture</td></tr><tr><td>VarScan2</td><td>2.4.3</td><td>Heuristic methodology with statistical test</td></tr><tr><td>VarDict</td><td>1.4</td><td>Combined heuristic and statistical algorithm</td></tr><tr><td>SomaticSniper</td><td>1.0.5.0</td><td>Bayesian approach for estimating genotype probabilities</td></tr><tr><td>Freebayes</td><td>0.1.2</td><td>Bayesian model with error probabilities</td></tr><tr><td>Lancet</td><td>1.0.5</td><td>Colored de Bruijn graphs</td></tr></tbody></table></table-wrap></p></sec><sec id="Sec9"><title>Feature selection</title><p id="Par29">Several sequencing and biological features were extracted at the BAM and VCF level in order to collect as much non-redundant information as possible for each variant candidate (Table&#x000a0;<xref rid="Tab4" ref-type="table">4</xref>). The bam-readcount program (0.8.0) [<xref ref-type="bibr" rid="CR43">43</xref>] was called to query and retrieve the requested metrics directly from the BAM files. The features were classified into four distinct groups depending on the carried information (detailed information about each specific feature is provided in Table <xref rid="Tab4" ref-type="table">4</xref>). Each variant site reported by at least one of the tools in the ensemble variant calling (i.e. the union of the 7 algorithms) was coupled with the different set of features, in addition to each tool call status (detected or non-detected). Using BAMSurgeon ground truth VCF file, each candidate site was categorized with the proper somatic status label (&#x0201c;somatic&#x0201d; or &#x0201c;non-somatic&#x0201d;), forming the adequate input data for training the supervised machine learning classifiers. To prevent over-fitting on training data, those features represented as continuous variables were normalized using MinMaxScaler module available in sklearn python library, shrinking their range between 0 and 1.<table-wrap id="Tab4"><label>Table 4</label><caption><p>List of biological and sequencing features selected for downstream ML analysis</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Feature name</th><th>Source</th><th>Group</th><th>Description</th></tr></thead><tbody><tr><td>indel_or_snp</td><td>BAM</td><td>3</td><td>Is the given variant a SNP, insertion or deletion?</td></tr><tr><td>ts_or_tv</td><td>BAM</td><td>3</td><td>Transition or transversion</td></tr><tr><td>depth_TUM</td><td>BAM</td><td>1</td><td>Coverage in tumor sample for the given variant position</td></tr><tr><td>alt_counts_TUM</td><td>BAM</td><td>1</td><td>Alternative read counts (number of reads supporting the variant)</td></tr><tr><td>alt_avg_MQ_TUM</td><td>BAM</td><td>2</td><td>Average mapping quality of reads containing the variant. Quantification of the probability that a read is misplaced.</td></tr><tr><td>alt_avg_BQ_TUM</td><td>BAM</td><td>2</td><td>Average base quality of the reads containing the variant. Accuracy of a base sequenced by the sequencing machine.</td></tr><tr><td>alt_plus_TUM</td><td>BAM</td><td>1</td><td>Number of reads on the plus/forward strand supporting the variant</td></tr><tr><td>alt_minus_TUM</td><td>BAM</td><td>1</td><td>Number of reads on the minus/reverse strand supporting the variant</td></tr><tr><td>ref_plus_TUM</td><td>BAM</td><td>1</td><td>Number of reads on the plus/forward strand supporting the reference allele</td></tr><tr><td>ref_minus_TUM</td><td>BAM</td><td>1</td><td>Number of reads on the minus/reverse strand supporting the reference allele</td></tr><tr><td>VAF</td><td>BAM</td><td>1</td><td>Variant allele frequency</td></tr><tr><td>depth_WT</td><td>BAM</td><td>1</td><td>Coverage in normal sample for the given variant position</td></tr><tr><td>alt_counts_WT</td><td>BAM</td><td>1</td><td>Number of reads supporting the variant in normal sample (germline risk)</td></tr><tr><td>ref_counts_WT</td><td>BAM</td><td>1</td><td>Number of reads supporting the reference in normal sample</td></tr><tr><td>num_of_indels_closeby</td><td>BAM</td><td>3</td><td>Are there indels closeby? (false positive risk factor)</td></tr><tr><td>GC_content</td><td>BAM</td><td>3</td><td>Number of GC bases relative to the total number of bases located +&#x02009;&#x02212;&#x02009;20&#x02009;bp for the given variant position</td></tr><tr><td>shannon_entropy</td><td>BAM</td><td>3</td><td>A mathematical measure of the degree of randomness in a set of data. The smaller the entropy value, the less complex the sequence is.</td></tr><tr><td>detection_status</td><td>VCF</td><td>4</td><td>Classification status (&#x0201c;somatic&#x0201d; or &#x0201c;non somatic&#x0201d;) for the given variant caller</td></tr><tr><td>&#x0201c;Tool&#x0201d;_F</td><td>VCF</td><td>4</td><td>Quality tag in FILTER column (&#x0201c;PASS&#x0201d; or &#x0201c;non PASS&#x0201d;)</td></tr><tr><td>&#x0201c;Tool&#x0201d;_alt_counts</td><td>VCF</td><td>1, 4</td><td>Number of reads supporting the variant reported by the specific tool</td></tr><tr><td>&#x0201c;Tool&#x0201d;_ref_counts</td><td>VCF</td><td>1, 4</td><td>Number of reads supporting the reference reported by the specific tool</td></tr></tbody></table></table-wrap></p><p id="Par30">The ensemble variant calling along with the feature set served as input to the 7 supervised machine learning classifiers: Logistic Regression (LR), Support Vector Machine with linear kernel (SVMl), Gaussian Na&#x000ef;ve Bayes (GNB), Decision Tree (DT), Random Forest (RF), Gradient Boosting Decision Tree (GBDT) and Neural Network (NN).</p></sec><sec id="Sec10"><title>Variant evaluation by ensemble machine learning framework</title><p id="Par31">Classifiers were comprehensively evaluated in CV experiments and on independent tests with labelled data through a robust and exhaustive set of performance measurements (Table&#x000a0;<xref rid="Tab5" ref-type="table">5</xref>). The area under the curve (AUC) of a receiver operating characteristic (ROC) and precision-recall (PR) curves was calculated using the predicted probabilities for each candidate site. PR curves were chosen as they are known to be more informative than ROC curves when the class distribution of the data is unbalanced [<xref ref-type="bibr" rid="CR44">44</xref>], as is common in somatic variant calling.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Definition of selected performance metrics used for algorithm evaluation. The four variables present in a 2&#x02009;&#x000d7;&#x02009;2 contingency table: true positive (TP) (variants predicted and validated), true negative (TN) (variants not predicted and not validated), false positive (FP) (variants predicted but failed in validation), and false negative (FN) (variants not predicted but validated) are used to calculate the metrics and assess model performance</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Metric</th><th>Formula</th><th>Definition</th></tr></thead><tbody><tr><td>Accuracy</td><td>
<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{TP+ TN}{\left( TP+ TN+ FP+ FN\right)} $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">TN</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">TN</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">FP</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">FN</mml:mi></mml:mrow></mml:mfenced></mml:mfrac></mml:math><inline-graphic xlink:href="12920_2019_508_Article_IEq1.gif"/></alternatives></inline-formula>
</td><td>The ratio of correct calls out of the total number of positions.</td></tr><tr><td>Precision</td><td>
<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{TP}{\left( TP+ FP\right)} $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:mfrac><mml:mi mathvariant="italic">TP</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">FP</mml:mi></mml:mrow></mml:mfenced></mml:mfrac></mml:math><inline-graphic xlink:href="12920_2019_508_Article_IEq2.gif"/></alternatives></inline-formula>
</td><td>The ratio of correct variant calls out of the total number of variant calls.<break/>Synonyms: Positive predictive value (PPV)</td></tr><tr><td>Recall</td><td>
<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{TP}{\left( TP+ FN\right)} $$\end{document}</tex-math><mml:math id="M6" display="inline"><mml:mfrac><mml:mi mathvariant="italic">TP</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">FN</mml:mi></mml:mrow></mml:mfenced></mml:mfrac></mml:math><inline-graphic xlink:href="12920_2019_508_Article_IEq3.gif"/></alternatives></inline-formula>
</td><td>The ratio of correct variant calls out of the total number of variant positions.<break/>Synonyms: Sensitivity, true-positive rate (TPR).</td></tr><tr><td>False discovery rate (FDR)</td><td>
<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{FP}{\left( TP+ FP\right)} $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:mfrac><mml:mi mathvariant="italic">FP</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">FP</mml:mi></mml:mrow></mml:mfenced></mml:mfrac></mml:math><inline-graphic xlink:href="12920_2019_508_Article_IEq4.gif"/></alternatives></inline-formula>
</td><td>The ratio of incorrect calls out of the total number of variant calls.</td></tr><tr><td>F1-Score</td><td>
<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{2\ast Precision\ast Recall}{\left( Precision+ Recall\right)} $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>&#x02217;</mml:mo><mml:mtext mathvariant="italic">Precision</mml:mtext><mml:mo>&#x02217;</mml:mo><mml:mtext mathvariant="italic">Recall</mml:mtext></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtext mathvariant="italic">Precision</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">Recall</mml:mtext></mml:mrow></mml:mfenced></mml:mfrac></mml:math><inline-graphic xlink:href="12920_2019_508_Article_IEq5.gif"/></alternatives></inline-formula>
</td><td>Harmonic mean of precision and recall, where 1 is the best score and 0 the worst.<break/>Synonyms: F-score</td></tr><tr><td>Matthews correlation coefficient (MCC)</td><td>
<inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{TP\ast TN- FP\ast FN}{\sqrt{\left( TP+ FP\left)\right( TP+ FN\right)\left( TN+ FP\right)\left( TN+ FN\right)}} $$\end{document}</tex-math><mml:math id="M12" display="inline"><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi><mml:mo>&#x02217;</mml:mo><mml:mi mathvariant="italic">TN</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi mathvariant="italic">FP</mml:mi><mml:mo>&#x02217;</mml:mo><mml:mi mathvariant="italic">FN</mml:mi></mml:mrow><mml:msqrt><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">FP</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="italic">TP</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">FN</mml:mi></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">TN</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">FP</mml:mi></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">TN</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">FN</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msqrt></mml:mfrac></mml:math><inline-graphic xlink:href="12920_2019_508_Article_IEq6.gif"/></alternatives></inline-formula>
</td><td>A measure of the quality of binary (two-class) classifications. The MCC represents the correlation coefficient between the observed and predicted binary classifications, where &#x02212;1 indicates a completely wrong binary classifier while 1 indicates a completely correct classifier.</td></tr></tbody></table></table-wrap></p></sec></sec><sec id="Sec11"><title>Results</title><sec id="Sec12"><title>The NeoMutate workflow for robust and scalable ML based ensemble variant calling</title><p id="Par32">NeoMutate attempts to address the inherent complexities of somatic variant calling in cancer by applying an ensemble based supervised ML approach to improve performance. Full details of NeoMutate&#x02019;s methodology are described in the methods section. NeoMutate integrates different variant calling tools in an all-inclusive modular pipeline to capture a more comprehensive mutational profile and performs an ensemble ML based step for boosting detection accuracy (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>). The workflow can be divided in two main components: (1) an ensemble variant calling pipeline and (2) an ensemble machine learning framework. The former follows the best practices of the genome analysis toolkit (GATK) [<xref ref-type="bibr" rid="CR40">40</xref>] in a high-performance robust automated workflow, which consist of data preprocessing, alignment, post-alignment processing, followed by the integration of 7 variant calling algorithms. For the purpose of this study, the high-quality processed BAM files are provided as input into 7 state-of-the-art somatic variant calling tools (Table <xref rid="Tab3" ref-type="table">3</xref>). However, it is worth noting that NeoMutate&#x02019;s modular architecture confers a high flexibility and adaptability to the incorporation of any number of variant calling tools. NeoMutate leverages the strengths of each independent somatic variant calling tool with the aim of increasing sensitivity while maintaining accuracy and capture the full mutational profile from the sequencing data of tumor-normal pairs. The ML based step begins with the annotation of each candidate variant included in the combined set of calls of from the entire ensemble of variant calling with additional genomic and sequencing features. There were 17 non-redundant features extracted from the BAM files and four features extracted from each VCF file. The selected features can be categorized in four groups: 1) read depth, strand bias and allele frequency, 2) base and mapping qualities, 3) variant type and genomic context, and 4) detection status for each caller. The combined individual variant caller annotations together with the additional features are given as input to train the 7 models available in NeoMutate&#x02019;s ML framework (logistic regression classifier (LRC); support vector machine classifier with linear kernel (SVMl); decision tree (DT); Gaussian Na&#x000ef;ve Bayes (GNB); random forest classifier (RFC); gradient boosting decision tree (GBDT); neural network (NN)), to attempt to capture and infer the interplays of features in order to reduce false positive predictions without discarding true events.<fig id="Fig2"><label>Fig. 2</label><caption><p>NeoMutate workflow: This figure illustrates the main steps executed during NeoMutate framework, where raw reads from nearly any sequencing technology platform are transformed into an accurate list of prioritized somatic variants. Its modular architecture consists in quality control of the raw data, alignment and BAM post-processing, ensemble variant calling and machine learning boosted variant filtering step. 7 machine learning models are trained using the ensemble calling plus a set of biological and sequencing relevant features. Each algorithm will provide a mutational status classification per variant yielding a high-confidence somatic mutation call set</p></caption><graphic xlink:href="12920_2019_508_Fig2_HTML" id="MO2"/></fig></p></sec><sec id="Sec13"><title>A comprehensive profiling of ML classifiers demonstrates improved performance over standard approaches for variant detection</title><p id="Par33">In order to simulate synthetic ground truth somatic variants, we spiked in bona fide variants from the COSMIC database [<xref ref-type="bibr" rid="CR35">35</xref>] using BAMSurgeon [<xref ref-type="bibr" rid="CR45">45</xref>], into three well studied genomes from the GIAB Consortium (NA12878, NA12891 and NA24631). Four different simulations (S1- S4) were conducted to probe effectiveness of the ensemble ML based approaches. A total number of 3421, 5573, 5763 randomly selected COSMIC variants (SNVs and indels, VAF range 0.01&#x02013;1) were successfully added into NA12878, NA12891 and NA24631 samples, for the S1, S2 and S3 simulations, respectively. Additionally, 4894 non-COSMIC variants (&#x0003c;= 0.2 VAF) were spiked into NA24631 dataset for the S4 simulation. The BAMSurgeon ground truth variants allowed us to assign labels (&#x0201c;somatic&#x0201d; or &#x0201c;non-somatic&#x0201d;) to each candidate site reported in the final call sets for each experiment, allowing for a correct evaluation of the performance. Each candidate mutation was tagged with the validation status determined by the ground truth, in addition to a call status (detected or not detected) for each variant calling tool, classifying them as true-positive or false-positive.</p><p id="Par34">NeoMutate&#x02019;s performance on somatic variant detection was first evaluated through 5-fold cross-validation (CV) experiments using the reported call set from the S1 simulation experiment. The combined call set from all 7 callers consisted of 12,153 variants, 3235 (26.62%) of which were ground truth somatic mutations (see Additional&#x000a0;file&#x000a0;<xref rid="MOESM3" ref-type="media">3</xref> for individual and combined tool results). Each candidate variant was annotated with the ground truth status, in addition to the status of each variant calling tool and additional genomic features.</p><p id="Par35">The performance of all 7 ML models was compared against commonly used standard filtering approaches (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6), in addition to the results from the individual variant callers. Systematic evaluation of the results was performed using a comprehensive set of performance metrics derived from contingency tables that captured the relationship between the prediction status assigned by the method and labels from the ground truth data (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>, and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). The winning method for each considered metric is highlighted in bold in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The most stringent considered standard filtering approach, consisting of the intersection between MuTect2 and Strelka2 high quality variants (tagged as PASS in their correspondent VCF files), achieved the highest precision and therefore the lowest FDR. This approach removes a high degree of false positives (FP) at the cost of true positives (TP). The somatic variant calls reported by at least any two callers, won the performance for recall, at the expense of poorer precision. The ML models accomplished the highest balance retrieved TP and FP, as shown in the F1-Score and Mathews Correlation Coefficient (MCC) in Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1. While the rule-based and consensus voting approaches struggle to balance recall and precision scores, the ML models, particularly the GBDT model, achieved a higher recall rate (&#x0003e;&#x02009;0.96) without negatively impacting on precision (&#x0003e;&#x02009;0.98). Similar behavior was observed using the GBDT model in relation to the different mutation types tested, achieving a F1-Score of 0.976, 0.952 and 0.966 for SNVs, insertions and deletions respectively (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1).<fig id="Fig3"><label>Fig. 3</label><caption><p>Comprehensive performance evaluation of different approaches. Only those approaches having a sensible recall (&#x0003e;&#x02009;0.5) were chosen for the comparison. <bold>a</bold>) Individual variant callers raw results evaluation. <bold>b</bold>) Standard filtering results evaluation. <italic>m2&#x02009;s2</italic>: mutect2 and strelka2 calls intersection; <italic>m2s2_HQ</italic>: mutect2 and strelka2 HQ (only variants tagged as `PASS`) calls intersection; <italic>cons_n</italic>: consensus voting (intersection) of at least n tools; <italic>cons_2_HQ</italic>: consensus voting of the HQ call sets of least 2 tools. <bold>b</bold>) ML results evaluation. <italic>LRC</italic>: logistic regression classifier; <italic>SVMl</italic>: support vector machine classifier with linear kernel; <italic>DT</italic>: decision tree; <italic>GNB</italic>: Gaussian Na&#x000ef;ve Bayes; <italic>RFC</italic>: random forest classifier; <italic>GBDT</italic>: gradient boosting decision tree; <italic>NN</italic>: neural network</p></caption><graphic xlink:href="12920_2019_508_Fig3_HTML" id="MO3"/></fig></p><p id="Par36">The results between the various approaches were further assessed in a correlation matrix between each pair of methods (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>). As reported in previous studies [<xref ref-type="bibr" rid="CR3">3</xref>&#x02013;<xref ref-type="bibr" rid="CR11">11</xref>] the individual variant callers had a large degree of disagreement between each other. Consensus strategies have an improved concordance between each other, and the ML methods overall showed a much improved and higher positive correlation (although predictions made by the 7 ML classifiers are from the same training data set, generated from the ensemble results of the seven variant callers). Nevertheless, the ML predictions were not only consistent between each other, but also consistently accurate, with a mean accuracy of 0.9833 (0.0031); mean precision: 0.9813 (0.0111); mean recall 0.9555 (0.0075), mean F1-Score 0.9682 (0.0057), mean FDR: 0.0187 (0.0111), mean MCC: 0.957 (0.0079) and mean AUC: 0.9901 (0.0069).<fig id="Fig4"><label>Fig. 4</label><caption><p>Correlation matrix plot: Pairwise comparison correlation matrix heatmap of some methods results. Half heatmap is represented with colors while the other half is represented with numbers (both halfs represent the same). For those variant callers having FILTER column (&#x0201c;toolname&#x0201d;_HQ), only those variants having &#x0201c;PASS&#x0201d; tag were selected. The methods were divided in three main strategies for better visualization: Machine learning based (blue), standard filtering based (red) and individual tools results (green)</p></caption><graphic xlink:href="12920_2019_508_Fig4_HTML" id="MO4"/></fig></p></sec><sec id="Sec14"><title>Robust performance of ensemble ML based classifiers across mutation types and decreasing variant allelic frequencies</title><p id="Par37">The effective interrogation of low-frequency mutations has a great impact in how the performance of variant callers results agree with each other [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR46">46</xref>]. Thus, the performance of each approach was evaluated across a range of VAFs (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>a) and different mutation types (SNV, small insertion and deletion) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). The F1-score was selected as a suitable metric to illustrate both precision and sensitivity simultaneously. The ML models outperform both the individual variant callers and standard filtering protocols across all the VAF scenarios and for all mutation types. The GBDT model offered improved performance overall, but considerably greater performance for those variants thought to be difficult to detect (VAF&#x02009;&#x0003c;&#x02009;0.05) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a).<fig id="Fig5"><label>Fig. 5</label><caption><p><bold>a</bold>) F1-Scores of each evaluated method for each VAF range. <bold>b</bold>) F1-Scores of each evaluated method according to variant type. The methods were divided in three main strategies in the x-axis: Machine learning based (blue), standard filtering based (red) and individual tools results (green). Each VAF range considered is represented with a different color</p></caption><graphic xlink:href="12920_2019_508_Fig5_HTML" id="MO5"/></fig></p><p id="Par38">The results of GBDT were examined in more depth through precision-recall (PR) and standard receiver operating characteristic (ROC) curves, for each allele frequency range, and for each variant type in order to evaluate the classifier under the different conditions (Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>). The PR curves are more informative due to the unbalanced distribution of the data, which comprised of 8918 negative and 3235 positive variants, conferring an over optimistic view in the ROC curves as observed in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. As expected, an overall reduction in accuracy at lower VAFs and in indels was observed, due to the additional complexity in the detection of genomic alterations that arise in subclonal tumor cell populations (low-frequency tumor variants), or affecting more than one base pair in the genome.<fig id="Fig6"><label>Fig. 6</label><caption><p>Precision-recall (PR) and Receiver operating characteristic (ROC) curves for GBDT attending to variant type and variant allele frequency (VAF). Correspondent AUC values were computed for all the curves</p></caption><graphic xlink:href="12920_2019_508_Fig6_HTML" id="MO6"/></fig></p><p id="Par39">In addition to VAF, tumor read depth was also evaluated as having a high impact (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). Not surprisingly, the vast majority of FP calls originated in low VAF or in those regions with low coverage. Notably, the GBDT classifier was able to discard a substantial number of those FP calls without losing true somatic mutations. The importance of each feature that contributes to the prediction of the correct somatic variant status in the high performing GBDT model was then assessed. Figure&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref> shows the computed relative importance of each feature. Once the trees in GBDT were constructed, the importance scores were retrieved for each feature, allowing attributes to be ranked and compared to each other. The Strelka2 filter status (Strelka2_F) contributed most to the learning, followed by tool specific read counts and base and mapping qualities. As can be observed in Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>, the majority of input features provide useful information to the learning model supporting the minimalized but appropriate feature selection process. Moreover, additional experiments excluding different feature sets were carried out for the ML training (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7), and their exclusion had a significant detrimental impact on predictive performance, reinforcing the importance of the selected feature subset.<fig id="Fig7"><label>Fig. 7</label><caption><p>Bar chart of 5-CV GBDT feature importance ranking. The importance of a feature is computed as the (normalized) total reduction of the criterion brought by that feature. The features contributing most to the prediction variable are represented in the left of the plot with highest relative importance scores. The error bar represents the standard deviation across the 5 folds</p></caption><graphic xlink:href="12920_2019_508_Fig7_HTML" id="MO7"/></fig></p></sec><sec id="Sec15"><title>Model consistency in independent tests</title><p id="Par40">The S2, S3 and S4 simulations were used as independent tests to evaluate further the performance of the S1 trained ML models. The goal of these independent tests was to highlight model adaptability to different datasets and to evaluate overfitting on the training data. GBDT was trained using the S1 in silico variants and then tested on the S2, S3 and S4 datasets, separately. The performance for GBDT in the independent tests was significantly higher than each of the standard filtering approaches as previously reported by the 5-fold CV experiment (Table&#x000a0;<xref rid="Tab6" ref-type="table">6</xref>). GBDT substantially outperformed the best F1-Score score obtained using strict standard filter (the consensus of at least four variant calling tools). Additionally, the concordance of the results was higher in GBDT too, giving more reproducible results across the independent experiments than the other methods, probably due to the model&#x02019;s ability to infer the interplay between different biological annotations and thus, perform more effective parameter combination (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: S2 - S4).<table-wrap id="Tab6"><label>Table 6</label><caption><p>F1-Scores obtained for the best standard filtering approach and best ML classifier across the different simulations. The consensus call of at least four out of the 7 tools was the winner option for the first category while GBDT model for the second</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Method</th><th>Category</th><th>Description</th><th>S1</th><th>S2</th><th>S3</th><th>S4</th></tr></thead><tbody><tr><td>GBDT</td><td>ML</td><td>Gradient boosting decision tree</td><td>0.9742</td><td>0.9762</td><td>0.9658</td><td>0.8748</td></tr><tr><td>cons_4</td><td>Standard filtering</td><td>Consensus of &#x0003e;&#x02009;=&#x02009;4 tools</td><td>0.9139</td><td>0.9326</td><td>0.9203</td><td>0.8044</td></tr></tbody></table></table-wrap></p></sec></sec><sec id="Sec16"><title>Discussion</title><p id="Par41">Rule-based filtering and consensus voting of multiple variant calling methods can often remove the vast majority of FP calls, unfortunately at the expense missing many TP hits. However, the NeoMutate workflow tries to correct this by taking advantage of ML algorithms that may enhance specificity and methods that reinforce sensitivity, potentially capturing a more complete mutational profile of the tumor with a significant improvement in detection accuracy.</p><p id="Par42">In order to simulate somatic variants in a bona fide cancer context, we used cancer relevant mutations from COSMIC to spike in variants into actual whole-exome sequencing (WES) data from GIAB reference samples. The performance of 7 ML classifiers was comprehensively evaluated under CV and independent tests. We showed that ensemble variant calling boosted with ML, led to a substantially improved performance over standard filtering protocols, in particular decision-tree type models, which displayed a higher sensitivity and specificity balance compared to all of the individual variant callers. Additionally, NeoMutate also outperformed rule-based filtering and simple consensus approaches across a range of variant allele frequencies and mutation types. Performance of GBDT was consistent between the CV on the training data and on the independent test sets, indicating that the model was not subject to overfitting. The GBDT classifier had improved performance overall, but considerably greater performance for those variants thought to be difficult to detect (VAF&#x02009;&#x0003c;&#x02009;0.05). Several studies have shown the significance of the low frequency variants in terms of their correlation with response to treatment, due to the acquisition of treatment-resistant genetic alterations in the tumor subclones [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR25">25</xref>]. Thus, the correct detection of low frequency variants in the primary tumor becomes a crucial analysis that will dramatically influence the choice of therapy [<xref ref-type="bibr" rid="CR11">11</xref>].</p><p id="Par43">Each candidate variant was annotated with non-redundant biological and sequence features. The motivation behind curating the minimal amount of non-redundant features and not all possible features across all possible variant callers is based on the assumption that doing the latter would decrease the portability and scalability of the model. One of the main advantages of using an ensemble of multiple callers boosted by ML as a variant filtering strategy is that the classifiers do not rely on manually defined parameters. The ML models may automatically over time learn these parameters and attempt to capture the interplay between different features. This study incorporated 7 different state-of-the art tools, however, as new variant calling methods are developed, they can be integrated easily due to NeoMutate&#x02019;s degree of modularity and adaptability. However, the benefit of adding new tools may have the greatest value if the new tool contributes to the detection of de novo true positive predictions. Since the ML framework is built upon an ensemble of embedded tools, incorporating a novel algorithm that can uniquely detect challenging variants could lead to an improved detection accuracy.</p></sec><sec id="Sec17"><title>Conclusions</title><p id="Par44">The NeoMutate workflow incorporates a ML framework, where the strengths of multiple callers are exploited using a non-redundant set of biological and sequence features to boost accuracy. We have shown substantially improved performance over standard filtering protocols, specially balancing the trade-off between sensitivity to low-frequency variants and calling too many false positives, critical for an adequate decision making in personalized medicine. Moreover, ML does not rely on user-defined parameters, providing enough flexibility to deal with the common challenges present in clinical tumor samples, such as intra-heterogeneity and normal tissue admixtures. Given the unique and complex characteristics of each tumor, we demonstrate here that integrating multiple tools comprehensively in an ensemble ML layer optimizes somatic variant detection rates, leading to a potential enhancement in cancer diagnosis and treatment response.</p></sec><sec sec-type="supplementary-material"><title>Additional files</title><sec id="Sec18"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="12920_2019_508_MOESM1_ESM.pdf"><label>Additional file 1:</label><caption><p>Supplementary materials and methods. Detailed description of all the data generated during the study, including input data overview, in silico spiked-in variants summary, BAMSurgeon performance evaluation, used third-party tools commands. (PDF 1188 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="12920_2019_508_MOESM2_ESM.xlsx"><label>Additional file 2:</label><caption><p>Comprehensive survey of ensemble ML, consensus filtering strategies and individual variant caller results across the four (S1 &#x02013; S4) experiments. (XLSX 124 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="12920_2019_508_MOESM3_ESM.pdf"><label>Additional file 3:</label><caption><p>Evaluation of individual and combined variant callers on S1 experiment. Exhaustive evaluation of the composite variant callers and all possible unions and intersections between the included algorithms. (PDF 695 kb)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>GBDT</term><def><p id="Par5">Gradient boosting decision tree</p></def></def-item><def-item><term>GIAB</term><def><p id="Par6">Genome in a Bottle</p><p id="Par7">SNV</p><p id="Par8">Single nucleotide variant</p><p id="Par9">VAF</p><p id="Par10">Variant allele frequency</p><p id="Par11">ML</p><p id="Par12">Machine learning</p></def></def-item><def-item><term>NGS</term><def><p id="Par13">Next generation sequencing</p></def></def-item><def-item><term>PR</term><def><p id="Par14">Precision-recall</p></def></def-item><def-item><term>ROC</term><def><p id="Par15">Receiver operating characteristic</p></def></def-item><def-item><term>WES</term><def><p id="Par16">Whole exome sequencing</p></def></def-item></def-list></glossary><ack><title>Acknowledgements</title><p>We thank Dr. Chris Rose for providing statistical guidance and thoughtful discussions during the development of NeoMutate&#x02019;s ML framework.</p><sec id="FPar1"><title>Funding</title><p id="Par45">This work was funded by the Norwegian Research Council (Norges forskningsr&#x000e5;d), grant number 256891/O20. The funding body had no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p></sec><sec id="FPar2" sec-type="data-availability"><title>Availability of data and materials</title><p id="Par46">The datasets analyzed during the current study are available in the GIAB and 1000 Genomes repositories:<list list-type="bullet"><list-item><p id="Par47"><bold>NA12878</bold>: <ext-link ext-link-type="uri" xlink:href="ftp://ftptrace.ncbi.nih.gov/1000genomes/ftp/technical/working/20120117_ceu_trio_b37_decoy/CEUTrio.HiSeq.WEx.b37_decoy.NA12878.clean.dedup.recal.20120117.bam">ftp://ftptrace.ncbi.nih.gov/1000genomes/ftp/technical/working/20120117_ceu_trio_b37_decoy/CEUTrio.HiSeq.WEx.b37_decoy.NA12878.clean.dedup.recal.20120117.bam</ext-link></p></list-item><list-item><p id="Par48"><bold>NA12891</bold>: <ext-link ext-link-type="uri" xlink:href="ftp://ftptrace.ncbi.nih.gov/1000genomes/ftp/technical/working/20120117_ceu_trio_b37_decoy/CEUTrio.HiSeq.WEx.b37_decoy.NA12891.clean.dedup.recal.20120117.bam">ftp://ftptrace.ncbi.nih.gov/1000genomes/ftp/technical/working/20120117_ceu_trio_b37_decoy/CEUTrio.HiSeq.WEx.b37_decoy.NA12891.clean.dedup.recal.20120117.bam</ext-link></p></list-item><list-item><p id="Par49"><bold>NA24631</bold>: <ext-link ext-link-type="uri" xlink:href="ftp://ftptrace.ncbi.nlm.nih.gov/giab/ftp/data/ChineseTrio/HG005_NA24631_son/OsloUniversityHospital_Exome/151002_7001448_0359_AC7F6GANXX_Sample_HG005-EEogPU_v02-KIT-Av5_CGCATACA_L008.posiSrt.markDup.bam">ftp://ftptrace.ncbi.nlm.nih.gov/giab/ftp/data/ChineseTrio/HG005_NA24631_son/OsloUniversityHospital_Exome/151002_7001448_0359_AC7F6GANXX_Sample_HG005-EEogPU_v02-KIT-Av5_CGCATACA_L008.posiSrt.markDup.bam</ext-link></p></list-item></list></p><p id="Par50">Access to NeoMutate is available upon reasonable request to the authors.</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>TC and IA conceived the study. IA, RS, AS and TC designed the experiments. IA performed the development and experiments. IA, TC, AS and RS interpreted and analyzed the results. IA drafted the manuscript. IA and TC wrote the manuscript. IA, TC, AS and RS revised the manuscript. All authors read and approved the final manuscript.</p></notes><notes><title>Ethics approval and consent to participate</title><p id="Par51">Not applicable.</p></notes><notes><title>Consent for publication</title><p id="Par52">Not applicable.</p></notes><notes notes-type="COI-statement"><title>Competing interests</title><p id="Par53">All the authors declare they have an affiliation to the OncoImmunity company.</p></notes><notes><title>Publisher&#x02019;s Note</title><p id="Par54">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>Z</given-names></name></person-group><article-title>Genomic instability and cancer: an introduction</article-title><source>J Mol Cell Biol</source><year>2011</year><volume>3</volume><issue>1</issue><fpage>1</fpage><lpage>3</lpage><pub-id pub-id-type="pmid">21278445</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dancey</surname><given-names>JE</given-names></name><etal/></person-group><article-title>The genetic basis for cancer treatment decisions</article-title><source>Cell</source><year>2012</year><volume>148</volume><issue>3</issue><fpage>409</fpage><lpage>420</lpage><pub-id pub-id-type="pmid">22304912</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alioto</surname><given-names>TS</given-names></name><etal/></person-group><article-title>A comprehensive assessment of somatic mutation detection in cancer using whole-genome sequencing</article-title><source>Nat Commun</source><year>2015</year><volume>6</volume><fpage>p. 10001</fpage></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>H</given-names></name><etal/></person-group><article-title>Comparison of somatic mutation calling methods in amplicon and whole exome sequence data</article-title><source>BMC Genomics</source><year>2014</year><volume>15</volume><fpage>244</fpage><pub-id pub-id-type="pmid">24678773</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kroigard</surname><given-names>AB</given-names></name><etal/></person-group><article-title>Evaluation of nine somatic variant callers for detection of somatic mutations in exome and targeted deep sequencing data</article-title><source>PLoS One</source><year>2016</year><volume>11</volume><issue>3</issue><fpage>p. e0151664</fpage></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Q</given-names></name><etal/></person-group><article-title>Detecting somatic point mutations in cancer genome sequencing data: a comparison of mutation callers</article-title><source>Genome Med</source><year>2013</year><volume>5</volume><issue>10</issue><fpage>91</fpage><pub-id pub-id-type="pmid">24112718</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roberts</surname><given-names>ND</given-names></name><etal/></person-group><article-title>A comparative analysis of algorithms for somatic SNV detection in cancer</article-title><source>Bioinformatics</source><year>2013</year><volume>29</volume><issue>18</issue><fpage>2223</fpage><lpage>2230</lpage><pub-id pub-id-type="pmid">23842810</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>C</given-names></name></person-group><article-title>A review of somatic single nucleotide variant calling algorithms for next-generation sequencing data</article-title><source>Comput Struct Biotechnol J</source><year>2018</year><volume>16</volume><fpage>15</fpage><lpage>24</lpage><pub-id pub-id-type="pmid">29552334</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cai</surname><given-names>L</given-names></name><etal/></person-group><article-title>In-depth comparison of somatic point mutation callers based on different tumor next-generation sequencing depth data</article-title><source>Sci Rep</source><year>2016</year><volume>6</volume><fpage>36540</fpage><pub-id pub-id-type="pmid">27874022</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Rawe</surname><given-names>J</given-names></name><etal/></person-group><article-title>Low concordance of multiple variant-calling pipelines: practical implications for exome and genome sequencing</article-title><source>Genome Med</source><year>2013</year><volume>5</volume><issue>3</issue><fpage>28</fpage><pub-id pub-id-type="pmid">23537139</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bohnert</surname><given-names>R</given-names></name><name><surname>Vivas</surname><given-names>S</given-names></name><name><surname>Jansen</surname><given-names>G</given-names></name></person-group><article-title>Comprehensive benchmarking of SNV callers for highly admixed tumor data</article-title><source>PLoS One</source><year>2017</year><volume>12</volume><issue>10</issue><fpage>e0186175</fpage><pub-id pub-id-type="pmid">29020110</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koboldt</surname><given-names>DC</given-names></name><etal/></person-group><article-title>VarScan 2: somatic mutation and copy number alteration discovery in cancer by exome sequencing</article-title><source>Genome Res</source><year>2012</year><volume>22</volume><issue>3</issue><fpage>568</fpage><lpage>576</lpage><pub-id pub-id-type="pmid">22300766</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lai</surname><given-names>Z</given-names></name><etal/></person-group><article-title>VarDict: a novel and versatile variant caller for next-generation sequencing in cancer research</article-title><source>Nucleic Acids Res</source><year>2016</year><volume>44</volume><issue>11</issue><fpage>e108</fpage><pub-id pub-id-type="pmid">27060149</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>C</given-names></name><etal/></person-group><article-title>Detecting very low allele fraction variants using targeted DNA sequencing and a novel molecular barcode-aware variant caller</article-title><source>BMC Genomics</source><year>2017</year><volume>18</volume><issue>1</issue><fpage>5</fpage><pub-id pub-id-type="pmid">28049435</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larson</surname><given-names>DE</given-names></name><etal/></person-group><article-title>SomaticSniper: identification of somatic point mutations in whole genome sequencing data</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><issue>3</issue><fpage>311</fpage><lpage>317</lpage><pub-id pub-id-type="pmid">22155872</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saunders</surname><given-names>CT</given-names></name><etal/></person-group><article-title>Strelka: accurate somatic small-variant calling from sequenced tumor-normal sample pairs</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><issue>14</issue><fpage>1811</fpage><lpage>1817</lpage><pub-id pub-id-type="pmid">22581179</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="other">Kim S, et al. Strelka2: fast and accurate calling of germline and somatic variants. Nat Methods. 2018.</mixed-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cibulskis</surname><given-names>K</given-names></name><etal/></person-group><article-title>Sensitive detection of somatic point mutations in impure and heterogeneous cancer samples</article-title><source>Nat Biotechnol</source><year>2013</year><volume>31</volume><issue>3</issue><fpage>213</fpage><lpage>219</lpage><pub-id pub-id-type="pmid">23396013</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="other">Garrison, E. and G. Marth, Haplotype-based variant detection from short-read sequencing<italic>.</italic> arXiv preprint arXiv:1207.3907, 2012.</mixed-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Narzisi</surname><given-names>G</given-names></name><etal/></person-group><article-title>Genome-wide somatic variant calling using localized colored de Bruijn graphs</article-title><source>Communications Biology</source><year>2018</year><volume>1</volume><issue>1</issue><fpage>20</fpage><pub-id pub-id-type="pmid">30271907</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goode</surname><given-names>DL</given-names></name><etal/></person-group><article-title>A simple consensus approach improves somatic mutation prediction accuracy</article-title><source>Genome Med</source><year>2013</year><volume>5</volume><issue>9</issue><fpage>90</fpage><pub-id pub-id-type="pmid">24073752</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chiara</surname><given-names>M</given-names></name><etal/></person-group><article-title>CoVaCS: a consensus variant calling system</article-title><source>BMC Genomics</source><year>2018</year><volume>19</volume><issue>1</issue><fpage>120</fpage><pub-id pub-id-type="pmid">29402227</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>ZK</given-names></name><etal/></person-group><article-title>A three-caller pipeline for variant analysis of cancer whole-exome sequencing data</article-title><source>Mol Med Rep</source><year>2017</year><volume>15</volume><issue>5</issue><fpage>2489</fpage><lpage>2494</lpage><pub-id pub-id-type="pmid">28447726</pub-id></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rashid</surname><given-names>M</given-names></name><etal/></person-group><article-title>Cake: a bioinformatics pipeline for the integrated analysis of somatic variants in cancer genomes</article-title><source>Bioinformatics</source><year>2013</year><volume>29</volume><issue>17</issue><fpage>2208</fpage><lpage>2210</lpage><pub-id pub-id-type="pmid">23803469</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shin</surname><given-names>HT</given-names></name><etal/></person-group><article-title>Prevalence and detection of low-allele-fraction variants in clinical cancer samples</article-title><source>Nat Commun</source><year>2017</year><volume>8</volume><issue>1</issue><fpage>1377</fpage><pub-id pub-id-type="pmid">29123093</pub-id></element-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spinella</surname><given-names>JF</given-names></name><etal/></person-group><article-title>SNooPer: a machine learning-based method for somatic variant identification from low-pass next-generation sequencing</article-title><source>BMC Genomics</source><year>2016</year><volume>17</volume><issue>1</issue><fpage>912</fpage><pub-id pub-id-type="pmid">27842494</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>J</given-names></name><etal/></person-group><article-title>Feature-based classifiers for somatic mutation detection in tumour-normal paired sequencing data</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><issue>2</issue><fpage>167</fpage><lpage>175</lpage><pub-id pub-id-type="pmid">22084253</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="other">Freed, D., R. Pan, and R. Aldana, <italic>TNscope: Accurate Detection of Somatic Mutations with Haplotype-based Variant Candidate Detection and Machine Learning Filtering.</italic> bioRxiv, 2018: p. 250647.</mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="other">Poplin R, et al. Creating a universal SNP and small indel variant caller with deep neural networks. BioRxiv. 2017:092890.</mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="other">Poplin, R., et al., <italic>Scaling accurate genetic variant discovery to tens of thousands of samples.</italic> bioRxiv, 2017: p. 201178.</mixed-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zook</surname><given-names>JM</given-names></name><etal/></person-group><article-title>Integrating human sequence data sets provides a resource of benchmark SNP and indel genotype calls</article-title><source>Nat Biotechnol</source><year>2014</year><volume>32</volume><issue>3</issue><fpage>246</fpage><lpage>251</lpage><pub-id pub-id-type="pmid">24531798</pub-id></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cantarel</surname><given-names>BL</given-names></name><etal/></person-group><article-title>BAYSIC: a Bayesian method for combining sets of genome variants with improved specificity and sensitivity</article-title><source>BMC Bioinformatics</source><year>2014</year><volume>15</volume><fpage>104</fpage><pub-id pub-id-type="pmid">24725768</pub-id></element-citation></ref><ref id="CR33"><label>33.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fang</surname><given-names>LT</given-names></name><etal/></person-group><article-title>An ensemble approach to accurately detect somatic mutations using SomaticSeq</article-title><source>Genome Biol</source><year>2015</year><volume>16</volume><fpage>197</fpage><pub-id pub-id-type="pmid">26381235</pub-id></element-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="other">Huang, W., et al., <italic>SMuRF: portable and accurate ensemble-based somatic variant calling.</italic> bioRxiv, 2018: p. 270413.</mixed-citation></ref><ref id="CR35"><label>35.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bamford</surname><given-names>S</given-names></name><etal/></person-group><article-title>The COSMIC (catalogue of somatic mutations in Cancer) database and website</article-title><source>Br J Cancer</source><year>2004</year><volume>91</volume><issue>2</issue><fpage>355</fpage><lpage>358</lpage><pub-id pub-id-type="pmid">15188009</pub-id></element-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="other">Institute, B., Picard Tools<italic>.</italic> Broad institute, GitHub repository.</mixed-citation></ref><ref id="CR37"><label>37.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Andrews</surname><given-names>S</given-names></name></person-group><source>FastQC: a quality control tool for high throughput sequence data</source><year>2010</year></element-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bushnell</surname><given-names>B</given-names></name><name><surname>Rood</surname><given-names>J</given-names></name><name><surname>Singer</surname><given-names>E</given-names></name></person-group><article-title>BBMerge - accurate paired shotgun read merging via overlap</article-title><source>PLoS One</source><year>2017</year><volume>12</volume><issue>10</issue><fpage>e0185056</fpage><pub-id pub-id-type="pmid">29073143</pub-id></element-citation></ref><ref id="CR39"><label>39.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><source>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</source><year>2013</year></element-citation></ref><ref id="CR40"><label>40.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DePristo</surname><given-names>MA</given-names></name><etal/></person-group><article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title><source>Nat Genet</source><year>2011</year><volume>43</volume><issue>5</issue><fpage>491</fpage><lpage>498</lpage><pub-id pub-id-type="pmid">21478889</pub-id></element-citation></ref><ref id="CR41"><label>41.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><etal/></person-group><article-title>The sequence alignment/map format and SAMtools</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><issue>16</issue><fpage>2078</fpage><lpage>2079</lpage><pub-id pub-id-type="pmid">19505943</pub-id></element-citation></ref><ref id="CR42"><label>42.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quinlan</surname><given-names>AR</given-names></name><name><surname>Hall</surname><given-names>IM</given-names></name></person-group><article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><issue>6</issue><fpage>841</fpage><lpage>842</lpage><pub-id pub-id-type="pmid">20110278</pub-id></element-citation></ref><ref id="CR43"><label>43.</label><mixed-citation publication-type="other"><italic>bam-readcount</italic>. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/genome/bam-readcount">https://github.com/genome/bam-readcount</ext-link>.</mixed-citation></ref><ref id="CR44"><label>44.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saito</surname><given-names>T</given-names></name><name><surname>Rehmsmeier</surname><given-names>M</given-names></name></person-group><article-title>The precision-recall plot is more informative than the ROC plot when evaluating binary classifiers on imbalanced datasets</article-title><source>PLoS One</source><year>2015</year><volume>10</volume><issue>3</issue><fpage>e0118432</fpage><pub-id pub-id-type="pmid">25738806</pub-id></element-citation></ref><ref id="CR45"><label>45.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ewing</surname><given-names>AD</given-names></name><etal/></person-group><article-title>Combining tumor genome simulation with crowdsourcing to benchmark somatic single-nucleotide-variant detection</article-title><source>Nat Methods</source><year>2015</year><volume>12</volume><issue>7</issue><fpage>623</fpage><lpage>630</lpage><pub-id pub-id-type="pmid">25984700</pub-id></element-citation></ref><ref id="CR46"><label>46.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kassahn</surname><given-names>KS</given-names></name><etal/></person-group><article-title>Somatic point mutation calling in low cellularity tumors</article-title><source>PLoS One</source><year>2013</year><volume>8</volume><issue>11</issue><fpage>e74380</fpage><pub-id pub-id-type="pmid">24250782</pub-id></element-citation></ref></ref-list></back></article>