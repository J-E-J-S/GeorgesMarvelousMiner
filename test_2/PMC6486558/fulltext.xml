<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id><journal-id journal-id-type="publisher-id">nar</journal-id><journal-title-group><journal-title>Nucleic Acids Research</journal-title></journal-title-group><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6486558</article-id><article-id pub-id-type="doi">10.1093/nar/gkz116</article-id><article-id pub-id-type="publisher-id">gkz116</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methods Online</subject></subj-group></article-categories><title-group><article-title>SuperCT: a supervised-learning framework for enhanced characterization of single-cell transcriptomic profiles</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Xie</surname><given-names>Peng</given-names></name><xref ref-type="aff" rid="AFF1">1</xref><xref ref-type="author-notes" rid="FN1"/></contrib><contrib contrib-type="author"><name><surname>Gao</surname><given-names>Mingxuan</given-names></name><xref ref-type="aff" rid="AFF2">2</xref><xref ref-type="author-notes" rid="FN1"/></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-2374-5342</contrib-id><name><surname>Wang</surname><given-names>Chunming</given-names></name><xref ref-type="aff" rid="AFF3">3</xref></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Jianfei</given-names></name><xref ref-type="aff" rid="AFF3">3</xref></contrib><contrib contrib-type="author"><name><surname>Noel</surname><given-names>Pawan</given-names></name><xref ref-type="aff" rid="AFF4">4</xref></contrib><contrib contrib-type="author"><name><surname>Yang</surname><given-names>Chaoyong</given-names></name><xref ref-type="aff" rid="AFF2">2</xref></contrib><contrib contrib-type="author"><name><surname>Von&#x000a0;Hoff</surname><given-names>Daniel</given-names></name><xref ref-type="aff" rid="AFF4">4</xref></contrib><contrib contrib-type="author"><name><surname>Han</surname><given-names>Haiyong</given-names></name><xref ref-type="aff" rid="AFF4">4</xref></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Michael Q</given-names></name><!--<email>michael.zhang@utdallas.edu</email>--><xref ref-type="aff" rid="AFF1">1</xref><xref ref-type="aff" rid="AFF5">5</xref><xref ref-type="corresp" rid="COR2"/></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-7506-3466</contrib-id><name><surname>Lin</surname><given-names>Wei</given-names></name><!--<email>weilin.baylor@gmail.com</email>--><xref ref-type="aff" rid="AFF6">6</xref><xref ref-type="aff" rid="AFF4">4</xref><xref ref-type="corresp" rid="COR1"/></contrib></contrib-group><aff id="AFF1"><label>1</label>University of Texas at Dallas. Department of Molecular and Cell Biology, Richardson, TX, USA</aff><aff id="AFF2"><label>2</label>Xiamen University, Department of Chemical Biology, Xiamen, Fujian, China</aff><aff id="AFF3"><label>3</label>National Engineering Research Center for Miniaturized Detection System, Northwest University, Xi&#x02019;an, Shaanxi, China</aff><aff id="AFF4"><label>4</label>Translational Genomics Research Institute, Molecular Medicine Division, Phoenix, AZ, USA</aff><aff id="AFF5"><label>5</label>MOE Key Laboratory of Bioinformatics; Bioinformatics Division, Center for Synthetic &#x00026; Systems Biology, BNRist and School of Medicine; Tsinghua University, Beijing, China</aff><aff id="AFF6"><label>6</label>Hunan Provincial Key Lab of Emergency and Critical Care, Hunan People&#x02019;s Hospital, Changsha, Hunan, China</aff><author-notes><corresp id="COR1">To whom correspondence should be addressed. Tel: +1 240 491 7613; Email: <email>weilin.baylor@gmail.com</email></corresp><corresp id="COR2">Correspondence may also be addressed to Michael Q. Zhang. Email: <email>michael.zhang@utdallas.edu</email></corresp><fn id="FN1"><p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p></fn></author-notes><pub-date pub-type="ppub"><day>07</day><month>5</month><year>2019</year></pub-date><pub-date pub-type="epub" iso-8601-date="2019-02-25"><day>25</day><month>2</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>25</day><month>2</month><year>2019</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>47</volume><issue>8</issue><fpage>e48</fpage><lpage>e48</lpage><history><date date-type="accepted"><day>12</day><month>2</month><year>2019</year></date><date date-type="rev-recd"><day>31</day><month>1</month><year>2019</year></date><date date-type="received"><day>31</day><month>12</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement><copyright-year>2019</copyright-year><license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:href="gkz116.pdf"/><abstract><title>Abstract</title><p>Characterization of individual cell types is fundamental to the study of multicellular samples. Single-cell RNAseq techniques, which allow high-throughput expression profiling of individual cells, have significantly advanced our ability of this task. Currently, most of the scRNA-seq data analyses are commenced with unsupervised clustering. Clusters are often assigned to different cell types based on the enriched canonical markers. However, this process is inefficient and arbitrary. In this study, we present a technical framework of training the expandable supervised-classifier in order to reveal the single-cell identities as soon as the single-cell expression profile is input. Using multiple scRNA-seq datasets we demonstrate the superior accuracy, robustness, compatibility and expandability of this new solution compared to the traditional methods. We use two examples of the model upgrade to demonstrate how the projected evolution of the cell-type classifier is realized.</p></abstract><funding-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">High-level Talent Gathering Program in Hunan Province, China</named-content></funding-source><award-id>2018RS3107</award-id></award-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">NIH</named-content><named-content content-type="funder-identifier">10.13039/100000002</named-content></funding-source><award-id>GM084198</award-id><award-id>MH109665</award-id></award-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">NSFC</named-content><named-content content-type="funder-identifier">10.13039/501100001809</named-content></funding-source><award-id>31671384</award-id><award-id>81890990</award-id></award-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">Stand Up To Cancer-Cancer Research UK-Lustgarten Foundation Pancreatic Cancer Dream Team Research</named-content></funding-source><award-id>SU2C-AACR-DT-20-16</award-id></award-group></funding-group><counts><page-count count="12"/></counts></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>INTRODUCTION</title><p>Recent advances in single-cell RNA-seq (scRNA-seq) techniques make it possible to profile the RNA transcript abundance in a single cell, which enables us to reveal its identity. The mainstream scRNA-seq analytical methods utilize dimensional reduction (DR) and unsupervised clustering (UC) algorithms to initiate the analyses. UC provides the mathematical aggregation based on some cell grouping measures and DR facilitates the data visualization (DV) of the clustering result by &#x02018;projection&#x02019;. The putative subpopulations of cell types are thus identified with the enriched canonical signature signals. Nonetheless, this canonical workflow has its limitations. First, the cell types were not actually characterized by single-cell but by cluster. For each cell type in the sample, it always requires a certain number in order to form a discernable cluster. Second, the layout of cells by DR and the resultant clustering are model- and parameter-dependent. For example, the different distance/similarity metrics could result in different clustering effects (<xref rid="B1" ref-type="bibr">1&#x02013;7</xref>). Kiselev <italic>et&#x000a0;al.</italic> also have addressed the challenge of choosing optimal parameters and try to use a consensus matrix of multiple clustering results to optimize the final solution (<xref rid="B8" ref-type="bibr">8</xref>). Moreover, the cell-type assignment of these clusters highly relies on the investigator's familiarity with its signature molecules. Without sufficient background knowledge, the cell type, especially the rare types in a sample will be hard to identify, even though it could play critical roles. In this study, we aim to develop a new workflow that bypasses the clustering step and directly assign the cell type to each individual cell with less hassle on model selection or cluster interpretation.</p><p>Supervised classifier (SC) has been widely used in the automatic image classification (<xref rid="B9" ref-type="bibr">9&#x02013;11</xref>). Ramo <italic>et&#x000a0;al.</italic> developed CellClassifier based on the pixel intensities of cell imaging (<xref rid="B12" ref-type="bibr">12</xref>). However, using only morphological information is inadequate to find a definite answer because the identity of a single cell is mostly defined by its functional molecules rather than by how it looks. The genome-wide mRNA profiling provides more than enough information to discern its identity. SC3 method includes Support Vector Machine (SVM), a supervised learning component, which makes it a hybrid solution of UC and SC (<xref rid="B8" ref-type="bibr">8</xref>). Even though, the use of SVM is based on the cluster ID of the current dataset rather than the global learning of the features of the meaningful cell types. The cell-type classification somewhat resembles the image recognition in terms of high-dimensional data transformation and classification. Using a globally trained SC model, the user may easily solve the cell-type classification problem in one single step. Some typical challenges in scRNA-seq analyses, such as, the signal dropouts are like the dead pixels of images, won&#x02019;t necessarily impede from recognizing them. All these facts make SC model not only a potential solution for cell-type classification but also an efficient and robust one.</p><p>In order to train the model and characterize cell types in a more efficient fashion at the user end, we hereby propose a non-linear SC model to predict cell types. The outperformance of the non-linear algorithm such as tSNE in the scRNA-seq feature space has suggested the non-linearity of the cell-type classification problem and the potential of non-linear classifier models such as SVM and Artificial Neural-Network (ANN). Unlike SC3 using the cells of the current study for local supervised training using SVM, we incorporate the total Mouse-Cell-Atlas (MCA) datasets (<xref rid="B13" ref-type="bibr">13</xref>) and other large-scale annotated single-cell datasets for the global training of the ANN model. Moreover, using the strategy of online learning, the ANN model can continuously optimize the performance and adapt itself to the prediction tasks in a specific sample context using the training dataset generated from the similar background. By increasing the output nodes and applying the online learning and the transfer learning, we are able to efficiently expand the cell-type catalog for a broader scope of characterization task. These are the extra benefits of the ANN as one of the SC options. In this paper, we extensively examine the utility, the reliability, the compatibility and the expandability of the SuperCT framework and demonstrate with a few explicit examples on how to characterize cell types and gain unprecedented insights of cell biology.</p></sec><sec sec-type="materials|methods" id="SEC2"><title>MATERIALS AND METHODS</title><sec id="SEC2-1"><title>Implementation of the SuperCT artificial neural network</title><p>The artificial neural-network structures and the learning algorithms are implemented using Keras API. We design a fully connected ANN model for the cell-type classification. The inputs are the binary signals of 16&#x000a0;013 genes that are homologous between human and mouse. We include these homologous genes to adapt the model to the application of both human and mouse study in this paper. To enhance the compatibility across different scRNA-seq platforms, we convert the digital expression values to the binary values, which means the genes are either present or absent in the cells. As seen in most of the flow-cytometry analyses, the present/absent of the signature gene provides adequate information to discern most of the known cell types. Therefore, it is believed that the dominant cell-type information is preserved after the binary transformation. Also, the binary signal input is compatible across most of the Unique-Molecular-Index-based (UMI) scRNA-seq platforms with the robust performance of the cell-type classification.</p><p>The input layer is connected to a hidden dense layer with 200 neurons and the first layer is fully connected to the next 100 neurons, respectively, using ReLU (Rectified Linear Unit) activation functions. Two random neuron dropouts (dropout rate at 0.4) occur after each layer in order to control over-fitting. The number of the output nodes corresponds to the number of the cell types in the catalog, which is 30+1 for v1m/v1h and 37+1 for v2m respectively. As the sample sizes of the different cell types vary from hundreds to tens of thousands in MCA dataset, to avoid the under-representation of the small-sample-size cell types in the calculation of the accuracy function, we include the class-weight based on the sample size of each type in the model training. The loss function is defined as categorical cross-entropy.</p></sec><sec id="SEC2-2"><title>Organization and preprocessing of the training dataset</title><p>There are three versions of SuperCT discussed in this paper, v1m (&#x02018;m&#x02019; stands for mouse), v1h (&#x02018;h' stands for human cells) and v2m, which are adapt to the different application scenarios. We firstly select a total of 176 675 cells in the 30 categories of known cell types defined in mouse cell atlas project (MCA). These 30 cell types have more than 1000 counts in MCA. We then selected 4227 cells (4.2k-new-type-cells) in the seven categories of known cell types other than the 30 types in MCA. These seven cell types have &#x0003e;500 counts in MCA. We also synthesized 8923 scRNA-seq profiles (9k-synthetic-cells) by shuffling the randomly selected MCA scRNA-seq profiles. Total 189,825 labeled single-cell expression profiles (referred as the 190k training dataset) were used for the training of SuperCT v1m and v2m. To test the robustness of the model expansion from v1m to v2m, the variable training labels of the two versions are described as follow. Other than the 9k-synthetic-cells that are always assigned to &#x02018;unknown&#x02019; category, the 4.2k-new-type-cells were assigned to the &#x02018;unknown&#x02019; category in v1m but assigned to seven specific types in v2m. We are wondering whether the extra seven types could be learned from the &#x02018;unknown&#x02019; category in the new training. Other than the abovementioned MCA and synthesized cells, 8976 additional peripheral blood mononuclear cells (PBMCs, 9k-immune-cells) from 10&#x000d7;&#x000a0;Genomics public database are included for SuperCT v1h training. In order to make a fair comparison, the 4.2k-new-type-cells were still assigned to the unknown category in v1h because v1h is considered as the optimization of v1m.</p></sec><sec id="SEC2-3"><title>Initial training and continual learning of the models</title><p>For the SuperCT v1m, we use the batch learning of the entire 190k MCA data. We applied SGD (Stochastic Gradient Descent) by dividing training data into mini-batches of size 1024. 20% of training dataset was set aside for the training validation. Numbers of training epochs were manually determined based on the gap between the training and validation error to control over-fitting (early stopping).</p><p>In the two upgrades from v1m to v1h and v1m to v2m, we took the v1m parameters to initiate the online learning. We also took the mini-batches of 1024 from the new training data and update the model parameters. In order to alleviate the &#x02018;Catastrophic Forgetting&#x02019;, we designed a &#x02018;review training&#x02019; mechanism to &#x02018;refresh&#x02019; the memory of the previous learning in the v1m. Randomly selected 4000 cells from the previous training dataset are fed again for the model training after each epoch of learning by the new training dataset.</p></sec><sec id="SEC2-4"><title>10-fold cross-validation over the training datasets and the model</title><p>To evaluate the overall performance based on the total training dataset (190K MCA and 9K human immune cells), we performed 10-fold validation test. The v1m, v1h and v2m datasets are randomly divided into 10 equal fractions. Nine of them are used to perform training and one of them is held out for testing. The 10 concordance values will show the robustness of the model and the reliability of the training datasets.</p></sec><sec id="SEC2-5"><title>Transfer learning in the model expansion</title><p>In the training of the new cell types using MCA dataset, we freeze the first hidden layer (200 nodes) and only update the weights of the second layers and the output layer. This learning strategy will retain the transformed features residing in the hidden layer in previous training and use them for the characterization of more cell types.</p></sec><sec id="SEC2-6"><title>Testing datasets from the third party</title><p>The first testing dataset is based on the similar study as MCA, which was performed by the Tabula Muris Consortium (TMC) (<xref rid="B14" ref-type="bibr">14</xref>). We used the single-cell expression profiles from 12 tissues generated on the 10xGenomics Chromium platform in order to test the overall performance of the models trained by MCA cells. The MCA and TMC cell types are defined by two different groups of investigators. To make a fair comparison, we first identified and selected the TMC cell types that are corresponding to the 37 known cell types defined in SuperCT (see the mapping in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). The TMC cell types whose MCA-corresponding type not confirmed are excluded for now. We have total 25.5k cells in this test.</p><p>The second testing dataset was from cord blood mononuclear cells (CBMC, total 8005 cells). Stoeckius <italic>et&#x000a0;al.</italic> used a unique CITE-seq technique that allows to interrogate the single-cell transcriptome and surface proteins at the same time (<xref rid="B15" ref-type="bibr">15</xref>). The cell identities revealed by CITE-seq technique are validated by both RNA and surface protein signals.</p><p>The third testing dataset is obtained from an E18 mouse brain 9k cells generated on the 10&#x000d7; Genomics platform (<xref rid="B16" ref-type="bibr">16</xref>). This dataset will cover some new cell types that are defined only in the upgraded model. We use this dataset to test the robustness of the expansion of cell-type catalog.</p><p>The fourth testing dataset was a 2.8k-tumor-tissue-associated-cells dataset obtained from a malignant pancreatic tumor tissue that was extracted from a genetically modified mouse (the KPC model)(17) generated on the Chromium platform. The study of the third dataset represents a typical scenario in which researchers seek to extensively interrogate a heterogeneous tissue sample using the scRNA-seq technique.</p></sec><sec id="SEC2-7"><title>scRNA-seq dataset generated from mouse pancreatic tumor tissue</title><p>Freshly harvested tumors from KPC (LSL-KrasG12D/+; LSL-Trp53R172H/+; Pdx-1-Cre) mice were subjected to mechanical and enzymatic dissociation using a Miltenyi gentleMACS Tissue Dissociator to obtain single cells. The 10xGenomics Chromium Single Cell 3&#x02032; Solution was employed for capture, amplification and labeling of mRNA from single cells and for scRNA-seq library preparation. Sequencing of libraries was performed on an Illumina HiSeq 2500 system. Sequencing data (fastq files) was input into the CellRanger pipeline to align reads and generate gene-cell digital expression matrices.</p></sec><sec id="SEC2-8"><title>Unsupervised clustering, dimensional reduction, and data visualization</title><p>Most of the UC, DR and DV in this paper are accomplished by a widely used scRNA-seq analytical suite, Seurat (<xref rid="B17" ref-type="bibr">17</xref>,<xref rid="B18" ref-type="bibr">18</xref>). The Seurat objects are generated for each dataset with their digital expression matrices as input. The PCA is performed by Seurat RunPCA function. The tSNE coordinates are calculated using Seurat RunTSNE function. The putative clusters are defined by Seurat FindClusters function using the top 10 principle components and other default parameters. The prediction result is loaded to the Seurat metadata in order to be shown in reference to the tSNE layout.</p></sec><sec id="SEC2-9"><title>Top signature genes for each cell type ranked by information gain</title><p>In order to calculate and rank the information entropy gain, the following equations are used.
<disp-formula id="M1"><label>(1)</label><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}Gain\ (Type,\ gene) &#x00026;=&#x00026; \ Entropy(Type) \nonumber\\ &#x00026;&#x00026;- Entropy(Type,\ Gene)\end{eqnarray*}\end{document}</tex-math></disp-formula><disp-formula id="M2"><label>(2)</label><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*}Entropy\ (type) = - \mathop \sum \limits_i {p_i} \cdot \log \left( {{p_i}} \right)\end{equation*}\end{document}</tex-math></disp-formula><disp-formula id="M3"><label>(3)</label><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}Entropy\ (Type,Gene) = \ - \sum\limits_i {({p_i} \cdot \sum\limits_j {{p_{ij}} \cdot \log ({p_{ij}})} )}\nonumber\\ \end{eqnarray*}\end{document}</tex-math></disp-formula></p><p>The binary values of each gene over the binary values as a certain type for the total cells are utilized to make a contingency table in order to calculate the <italic>p</italic> in Equations (<xref ref-type="disp-formula" rid="M2">2</xref>) and (<xref ref-type="disp-formula" rid="M3">3</xref>). Whereas pi denotes the prior probability of cell belonging to the cell type <italic>i</italic>; <italic>p</italic><sub><italic>ij</italic></sub> denotes the probability of cell belonging to the cell type <italic>i</italic> (yes or no) when gene signal is in <italic>j</italic> status (present or absent). The top 50 genes are ranked based on the value of information gain (Equation <xref ref-type="disp-formula" rid="M1">1</xref>) in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref> for each type.</p></sec><sec id="SEC2-10"><title>Search of genes that correlate to the tumor progression</title><p>The epithelial tumor cells are characterized from the scRNA-seq data of the mouse PDAC tumor tissues using SuperCT v2m. These cells&#x02019; digital expression profiles were pulled out as the input to calculate the pseudo-time ordering using Monocle2. The pseudo-time values of each cell and the gene expression value for that cell were used to fit a linear model using an R function &#x02018;lm&#x02019;. The <italic>p</italic> value of the coefficient of each linear model is used to determine whether the gene expression correlates with the tumor progression by time.</p></sec></sec><sec id="SEC3"><title>RESULT</title><sec id="SEC3-1"><title>Overview of SuperCT model structure, datasets, training strategies and usage</title><p>The schematic workflow of SuperCT framework is shown in Figure <xref ref-type="fig" rid="F1">1A</xref>. The detailed structure of the fully connected ANNs for SuperCT is described in the Materials and Methods. The training datasets were selected from MCA project (&#x0223c;190k cells) and peripheral blood mononuclear cells (PBMCs, &#x0223c;9k cells). More details of the training data organization are given in the Materials and Methods and&#x000a0;<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>. Other than the training dataset, in order to further validate the utility of SuperCT classifier in assigning cell types, we tested the performances using three independent datasets (<xref rid="B14" ref-type="bibr">14</xref>,<xref rid="B19" ref-type="bibr">19</xref>). More detailed descriptions of these datasets are given in the Materials and Methods. The overall concordance measure is defined to assess the reliability of the prediction. More precisely, concordance means whether the SuperCT predictions agree with the manual cluster annotations in the literature, which were based on the enriched canonical marker of the entire cluster of a certain sample or the entire cellular sample sorted by the canonical markers from the specific tissue.</p><fig id="F1" orientation="portrait" position="float"><label>Figure 1.</label><caption><p>Overview of SuperCT framework and the high concordance between the original MCA cell-type annotations and the SuperCT predictions. (<bold>A</bold>) The workflow of SuperCT training, prediction and upgrade. (<bold>B</bold>) The two upgrades that lead to the optimized or expanded SuperCT classifier. (<bold>C</bold>) The overview of TMC data original labels in comparison with SuperCT v2m predictions.</p></caption><graphic xlink:href="gkz116fig1"/></fig><p>There are three versions of SuperCT classifier discussed in this paper, v1m, v2m and v1h. v1m and v1h both have 30 &#x02018;known&#x02019; and one &#x02018;unknown&#x02019; cell type in their catalogs. v2m has 37 &#x02018;known&#x02019; and one &#x02018;unknown&#x02019; type. &#x02018;m&#x02019; stands for mouse and &#x02018;h&#x02019; stands for human, which indicates on what species the model works better. Version number increase stands for the upgrade of the cell-type catalog. Figure <xref ref-type="fig" rid="F1">1B</xref> illustrates the two upgrade protocols that underlie the typical evolution of SuperCT model. v1m is considered as the initial model trained from a large training dataset possibly with some error or insufficiency. In the v1m-to-v1h upgrade, we aim to test whether the online parameter optimization using additional training dataset from the similar background will make the classifier perform better in the target sample. In the v1m-to-v2m upgrade, we aim to demonstrate the robust expansion of the capability to predict more cell types with little sacrifice on the concordance over the predictions of other cell types.</p><p>We used another mouse cell study (TMC datasets) to validate the overall performance of v2m model (Figure 1C). The outperformance of SuperCT classifier over the prior manual annotation based on UC methods will be compared and discussed in detail in the following result section (Figure <xref ref-type="fig" rid="F2">2</xref>).</p><fig id="F2" orientation="portrait" position="float"><label>Figure 2.</label><caption><p>The outperformance of SuperCT over traditional UC-based methods. (<bold>A</bold>) Discordant cell labels by TMC and by SuperCT v2m predictions in spleen tissue: monocyte/macrophage versus dendritic cell. (<bold>B</bold>) The higher signal of dendritic cell signature genes suggests the SuperCT gives more convincing labels. (<bold>C</bold>) Down-sampling makes the minor cell populations lose the power to form discernable cluster but SuperCT can still characterize the cell type. (<bold>D</bold>) The separated clusters of the same cell types derived from batch difference can still be correctly characterized by SuperCT.</p></caption><graphic xlink:href="gkz116fig2"/></fig><p>Using a 2.3 GHz CPU processor computer, the runtime of SuperCT training on 190k cells is &#x0223c;20 s per epoch. It usually takes less than 10 epochs to achieve convergent and concordant result, which means overall training time is less than 5 minutes. Using the same computational resources, SuperCT is able to characterize &#x0223c;10 000 single-cell expression profiles in &#x0003c;1 min, whose prediction efficiency is far superior to traditional UC-methods that requires a lot of interactive operation and domain knowledge as input.</p></sec><sec id="SEC3-2"><title>The initial, optimized and expanded models of SuperCT</title><p>We carefully examined the v1m validation results in reference to the original MCA cluster annotations using the confusion matrix across the defined cell types. The true cell-type calls go to the diagonal of the matrix. Other than the undefined seven cell types that go to &#x02018;Unknown&#x02019; category, it is found that a few known cell types show lower concordance than the others (see confusion matrix in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1A</xref>). Low concordance suggests the unsatisfactory performance of discerning these specific known types in the v1m training, most of which were difficult to annotate at the first place because of many shared markers. Even though the erroneous labels in MCA will compromise the training effect, it was still difficult to correct the original annotation without additional information to reach the ground truth in such large scale of data as MCA. Besides, in a testing dataset from human PBMC (CITE-seq), we found that v1m prediction result is at low concordance (88.3%), which is yet to improve (Figure <xref ref-type="fig" rid="F3">3A</xref>). Other than the possible erroneous labels in the training dataset, the subtle discrepancy of the molecular signatures of immune cell types between mouse and human may also explain the low performance. Altogether, we believe the online optimization using higher confidence training data is necessary and can tackle the problem. Given the availability of the datasets for a few of these types from another public resource (16), we were able to input more human immune cells from the tissue with higher confidence on the identity of human immune cells (peripheral blood) and thus to enhance the feature learning. This one is called v1m-to-v1h upgrade.</p><fig id="F3" orientation="portrait" position="float"><label>Figure 3.</label><caption><p>The upgraded predictions of CITE-seq human PBMC cells that are confirmed by the marker signals of both surface proteins and RNAs. (<bold>A</bold>) The original cluster labels on the tSNE layout of CITE-seq PBMC cells. (<bold>B</bold>) The predictions by SuperCT v1m. (<bold>C</bold>) The predictions by SuperCT v1h. (<bold>D</bold>) The fractions by the original CITE-seq PBMC cell types. (<bold>E</bold>) The fractions of the SuperCT v1m cell-type predictions. (<bold>F</bold>) The fractions of SuperCT v1h cell-type predictions. (<bold>G</bold>) The signal distributions of the canonical marker genes for the PBMC subpopulations that are concordant to the SuperCT predictions.</p></caption><graphic xlink:href="gkz116fig3"/></fig><p>In the model upgrade, instead of redoing the entire MCA 190k dataset in combination with the new PBMC 9k dataset, we implemented a more efficient &#x02018;online learning&#x02019; strategy in the v1m-to-v1h upgrade. In online learning, &#x02018;Catastrophic Forgetting&#x02019; is a tendency of ANN that the new training could make the model lose the &#x02018;memory&#x02019; of the old training. This issue has been also taken care of using a &#x02018;review training&#x02019; mechanism. The details of both strategies are described in the Materials and Methods. We used the CITE-seq PBMC dataset whose background is similar to the feature enhancement training dataset to assess the outperformance of v1h over v1m whose result is shown in Figure <xref ref-type="fig" rid="F3">3</xref> and explained later.</p><p>In the v1m-to-v2m upgrade, we specifically incorporated the &#x02018;transfer learning&#x02019; strategy, which means some of the model parameters can be re-used in the new categorization tasks of the expanded reference catalog. It is believed such a strategy can improve the training efficiency by transfer knowledge from previous learning tasks (<xref rid="B20" ref-type="bibr">20</xref>). More details of implementation are given in the Materials and Methods. The high concordance (91.4%) between v2m predictions to the original TMC annotation shown in the following results suggests the success of transfer learning in cell-type characterization task.</p><p>The v1m-to-v2m upgrade is nontrivial because it demonstrates how to make the SuperCT characterize more cell types when more cell types of training datasets are available. For the 190k MCA dataset, SuperCT v1m achieves 97.3% (171 677 cells) of concordance to the original labels in the 30 &#x02018;known&#x02019; type category (176 675 cells). SuperCT v2m achieves 96.6% (174 739 cells) of concordance in the 37 &#x02018;known&#x02019; type category (180 888 cells). Although the concordance rate seems a little bit lower in the v2m, total 3,062 more cells&#x02019; identities were accurately revealed (from unknown to specific known type) in the same dataset by the v2m. Both v1m and v2m give 100% concordant result to the MCA cells in the &#x02018;Unknown&#x02019; category. In the meantime, Sankey diagram (Figure <xref ref-type="fig" rid="F4">4A</xref> and&#x000a0;<xref ref-type="fig" rid="F4">C</xref>) shows this upgrade has limited influence on the characterization of other known types of v1m in the third party, which suggest the learning of the new cell types does not make the model &#x02018;confused&#x02019; over the other ones. In conclusion, the v2m does accurately characterize more cell types, thus outperforms v1m.</p><fig id="F4" orientation="portrait" position="float"><label>Figure 4.</label><caption><p>The assessment of the v1m-to-v2m upgrade by comparing the SuperCT predictions of different version in both 190k training dataset and E18 mouse brain dataset. (<bold>A</bold>) The Sankey diagram showing the upgrade of SuperCT v2m (left) labels from SuperCT v1m (right) in 190k training dataset. (<bold>B</bold>) The signal of the signature genes indicating the corresponding cell types of different clusters in E18 brain dataset. (<bold>C</bold>) The Sankey diagram showing the upgrade of SuperCT v2m (left) labels from SuperCT v1m (right) in the 9k E18 brain dataset. Most of the new cell types are from &#x02018;unknown&#x02019; types. Some of the Microglia are from mono/macrophage type and some are from &#x02018;unknown&#x02019; category. (<bold>D</bold>) Unsupervised clusters of 9k E18 brain dataset. (<bold>E</bold>) SuperCT v1m predictions of 9k E18 brain dataset. (<bold>F</bold>) SuperCT v2m predictions of 9k E18 brain dataset.</p></caption><graphic xlink:href="gkz116fig4"/></fig><p>To ensure the robustness of the three versions of SuperCT algorithm and the reliability of the training datasets, we performed 10-fold cross-validations on the training datasets and the average &#x0223c;92% of concordances on the 10% hold-out testing datasets show the satisfactory outcomes (see detailed descriptions in Materials and Methods and in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>).</p><p>To ensure the SuperCT accuracy that is not a result of over-fitting, we use 25,515 TMC cells independent of the training datasets for prediction. The corresponding cell-types in SuperCT v2m for TMC labels are linked and cross-compared in this dataset. Figure <xref ref-type="fig" rid="F1">1C</xref> shows the predictions of SuperCT v2m colored by the cell types, which share the same color-code as original TMC cluster annotation. The overall similar color scheme shows the high concordance. The concordance among the 37 known cell types is as high as 91.4%, which means SuperCT gives the overall accurate predictions. Moreover, the careful examination on the markers of some of these clusters indicates the SuperCT accuracy is even higher because TMC mislabeled some of the cells (result shown in the next section). <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1D</xref> shows the concordance of predictions for each to the 37 types.</p></sec><sec id="SEC3-3"><title>SuperCT solves the limitations of unsupervised clustering methods</title><p>We demonstrate that SuperCT overcomes the three challenges that are commonly seen when unsupervised clustering is performed.</p><p>Challenge A: the unexpected cell type can be easily mislabeled to the similar one due to the lack of familiarity of the specific markers. Figure <xref ref-type="fig" rid="F2">2A</xref> shows some of the TMC macrophage cells in a mouse spleen are labeled as dendritic cells by SuperCT. Figure <xref ref-type="fig" rid="F2">2B</xref> shows the signal distribution of the genes over two cell types predicted by SuperCT, which suggest SuperCT most likely gives the correct answer on them. These dendritic-cell markers were probably not examined by the TMC investigators.</p><p>Challenge B: Small number of cells of a certain type won&#x02019;t be easily characterized by UC. Figure <xref ref-type="fig" rid="F2">2C</xref> shows two putative clusters defined by the default Seurat unsupervised clustering parameters after down-sampling of the same spleen tissue dataset (randomly selected 300 from 6113 cells). We compared the original TMC labels, SuperCT predictions, and the UC result. The tSNE layout shows the distribution of the minor cell type identified in the original dataset (<italic>n</italic> = 6113, shown as Figure <xref ref-type="fig" rid="F2">2A</xref>) cannot form an obvious cluster in the down-sampled dataset (<italic>n</italic> = 300, shown as Figure <xref ref-type="fig" rid="F2">2C</xref>) that makes the minor cell population very hard to discern. Nonetheless, the SuperCT can still accurately characterize the small-population cell types that are concordant to the TMC labels defined before downsizing, no matter how small the cell count is or how the tSNE layout looks like.</p><p>Challenge C: Figure <xref ref-type="fig" rid="F2">2D</xref> shows the tSNE layout of the T cells (originally defined by TMC) extracted from two immune tissues, spleen (sample id: P7_6, <italic>n</italic> = 1353) and bone marrow (sample id: P7_2, <italic>n</italic> = 90). The biological and/or technical variability leads to observable cluster separations in two tissues (Figure <xref ref-type="fig" rid="F2">2D</xref>, left panel). The SuperCT gives 1435 T cells predictions (99.4% concordance) with lease impact of the cluster separation (Figure <xref ref-type="fig" rid="F2">2D</xref>, right panel). Nonetheless, the technical or the biological difference that drives the cluster separation needs to be figured out.</p><p>In summary, the SuperCT prediction is independent of the result of clustering or human interpretation. Neither insufficiency of cells nor batch effect impedes the accurate characterization of the cell types.</p></sec><sec id="SEC3-4"><title>Cell-type-specific signature genes defined by SuperCT</title><p>As we know, each cell type has multiple signature genes that dictate its function and reveal its identity. Although SuperCT did the classification work in a &#x02018;blackbox&#x02019;, we were still able to uncover the signature genes by ranking the information gain of each gene's presence/absence in discerning a cell type from the other types (More details are given in the Materials and Methods). The top 50 genes for each of 37 cell types are shown as examples in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>. These top-rank genes provide the clue to explore the unique molecular features that underlie the v2m 37-cell-type categorization. Some of the top-rank genes, such as CD3D for T cells, CD79A for B cells, KDR for endothelial etc., are very familiar to us, though many others have never been reported previously which provides the new insights into these cell types.</p></sec><sec id="SEC3-5"><title>SuperCT predictions on CITE-seq dataset</title><p>For the CITE-seq CBMC dataset, Figure <xref ref-type="fig" rid="F3">3A</xref>&#x02013;<xref ref-type="fig" rid="F3">C</xref> shows the layout of four predominant clusters, one minor population hidden at the lower corner (classical dendritic cells) and one minor segregated cluster (plasmacytoid dendritic cells). The original paper defined these five cell clusters based on their surface marker signals and the signature RNA signals. Figure <xref ref-type="fig" rid="F3">3B</xref> shows the characterizations by SuperCT v1m. The overall concordance is 88.3%. Figure <xref ref-type="fig" rid="F3">3C</xref> shows the characterizations by SuperCT v1h. The overall concordance is 98.5%. <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1e</xref> gives the details of the concordance of each predicted cell type on v1h. Figure <xref ref-type="fig" rid="F3">3D</xref>&#x02013;<xref ref-type="fig" rid="F3">F</xref> shows the percentage of the annotated cell types. Figure <xref ref-type="fig" rid="F3">3G</xref> shows more details of the marker signal of both surface proteins (top row) and RNA transcripts (bottom row) for the five cell types. The result suggests v1h gives the predictions with higher concordance than v1m in CITE-seq PBMC dataset.</p></sec><sec id="SEC3-6"><title>SuperCT predictions on E18 mouse brain dataset</title><p>In order to specifically validate the expandability of this SuperCT framework, we carefully examined the change of the prediction result before and after the model upgrade in MCA training dataset and E18 mouse brain dataset. For the 190k training dataset, the Sankey diagram, Figure <xref ref-type="fig" rid="F4">4A</xref> shows that the seven new cell types defined by v2m were mainly derived from the &#x02018;unknown&#x02019; types as defined by v1m. In E18 mouse brain dataset, three out of seven additional cell types, (Radial glia, Microglia, and Schwann cells) in v2m which are nervous-system-related were anticipated in the mouse brain tissue. The Sankey diagram for this dataset, shown in Figure <xref ref-type="fig" rid="F4">4C</xref>, provides the details on how the SuperCT v2m have learned the three new cell types from the &#x02018;unknown&#x02019; classes or the similar cell types (microglia versus mono./macrophage) from v1m. This result suggests, by increasing the output nodes of ANN model and including sufficient new training cells, SuperCT is able to predict more specific cell types. Interestingly, v1m made an &#x02018;excusable&#x02019; mistake by taking microglia cells as monocyte/macrophages (Figure <xref ref-type="fig" rid="F4">4A</xref>, <xref ref-type="fig" rid="F4">C</xref> and&#x000a0;<xref ref-type="fig" rid="F4">E</xref>). This &#x02018;mistake&#x02019; can be explained by the similar roles of microglia to the nervous system as the macrophage to the other part of a mammalian body. Figure <xref ref-type="fig" rid="F4">4B</xref> and&#x000a0;<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref> also shows multiple genes, such as colony-stimulating factor receptor (CSF1R) and Fc fragment of IgG receptor (FCGR3A), are shared by mono./macrophage and microglia cells. Figure <xref ref-type="fig" rid="F4">4E</xref> and&#x000a0;<xref ref-type="fig" rid="F4">F</xref> shows the tSNE layout of the predicted cell types by v1m to v2m, suggesting the successful evolution of the model predictions from unknown to specific cell types that gradually uncover the role of the unsupervised cell clusters in the Figure <xref ref-type="fig" rid="F4">4D</xref>.</p></sec><sec id="SEC3-7"><title>SuperCT predictions on the KPC mouse tumor dataset</title><p>At last, we summarize the SuperCT result of a pancreatic ductal adenocarcinoma dataset derived from KPC mouse (mPDAC, dataset #3). Figure <xref ref-type="fig" rid="F5">5A</xref> shows Seurat FindClusters function yielded 12 putative cell clusters while SuperCT characterized total 17 cell types (Figure <xref ref-type="fig" rid="F5">5C</xref>). We were particularly interested in the primary epithelial tumor cells, which had been assigned to &#x02018;Epithelial&#x02019; type by SuperCT v2m (Figures <xref ref-type="fig" rid="F4">4C</xref> and&#x000a0;<xref ref-type="fig" rid="F5">5B</xref>). We then perform the <italic>in silico</italic> &#x02018;sorting&#x02019; of the predicted 1940 epithelial tumor cells. The typical mPDAC markers, e.g. EPCAM, cytokeratin 19, CD133 etc., were indeed enriched in these cells, validating the tumor cell identity (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3</xref>). With the cell identity information brought by SuperCT v2m, we were able to further explore whether any dynamic change of the molecular signals could be observed in the predicted epithelial tumor lineage. The pseudo-temporal analysis was performed on these &#x02018;sorted&#x02019; tumor cells using Monocle 2 method (<xref rid="B21" ref-type="bibr">21</xref>). A tumor progression trajectory was thus derived. The order information of the tumor cells in the inferred trajectory was utilized to perform the regression analysis in order to reveal the relationships between the tumor progression and the gene expression change. <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S5</xref> shows a list of genes that give significant <italic>P</italic>-values for the regression coefficient. (See details in the Materials and Methods). A number of the correlated genes, such as N-cadherin, Twist1, Loxl2 etc., that are involved to the epithelial-mesenchymal-transition (EMT) were identified. (shown in Figure <xref ref-type="fig" rid="F5">5E</xref>) Other than the epithelial tumor population we have extensively discussed as above, the clusters C4+C11, C9+C10 and C12 defined by Seurat FinderClusters function are corresponding to the SuperCT predictions of monocyte/macrophage, stromal and endothelial cells (Figure <xref ref-type="fig" rid="F5">5A</xref> and&#x000a0;<xref ref-type="fig" rid="F5">B</xref>). In here, SuperCT gives explicit interpretation on these clusters.</p><fig id="F5" orientation="portrait" position="float"><label>Figure 5.</label><caption><p>De-convolution of the signal of the constituent populations of mouse pancreatic tumor tissue. (<bold>A</bold>) The unsupervised cell clusters of the mPDAC tissue defined by Seurat FindClusters function. (<bold>B</bold>) The predicted cell types of the mPDAC tissue. The minor types with less than five cells are not shown in color legend. (<bold>C</bold>) The fractions for the cells of the predicted cell types in mPDAC. The epithelial tumor cells in the red box are sorted out for the downstream analyses. (<bold>D</bold>) the pseudo-temporal trajectory of the tumor progression based on sorted tumor cells plotted by Monocle 2. (<bold>E</bold>) The EMT genes display up-regulations and correlate to the tumor progression.</p></caption><graphic xlink:href="gkz116fig5"/></fig></sec><sec id="SEC3-8"><title>Miscellaneous</title><p>In comparison between UC cluster and SC predictions, it is found many of the unsupervised clusters determined by multiple top principal components (distance metric implemented in Seurat) can be explained by SuperCT predictions, which suggests the subpopulations segregated in the high dimensional space could correlate to the previously defined cell types. Even though some of the clusters might need to be further explored (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figures S2</xref>, S3D&#x02013;F, S4A, and B).</p><p>It is also notable, the MCA dataset was generated on the Microwell-seq platform and the 4.2k PBMC dataset was generated on the Chromium scRNA-seq platform (10&#x000d7;&#x000a0;Genomics). Three testing datasets are generated on the platforms of CITE-seq, and Chromium scRNA-seq platforms, respectively. All these platforms produce the typical digital expression matrices based on UMI counts. Moreover, CITE-seq PBMC dataset was generated from human tissue whereas the MCA, E18 brain and mPDAC datasets were generated from mouse tissues. The reliable results suggest the compatibility of SuperCT framework is not only across different scRNA-seq platform but also across different mammalian species, though the online optimization like v1m-to-v1h upgrade would benefit the application of the specific scenario.</p></sec></sec><sec sec-type="discussion" id="SEC4"><title>DISCUSSION</title><p>In this study, using training and independent testing datasets, we have demonstrated the superior performance of the supervised-learning-based classifiers in the characterization of the previously defined cell types in the heterogeneous tissue samples. This is the first scRNA-seq analytical framework that is independent of unsuperversied clustering. With least requirement of the expertise or the bioinformatics skillset from the individual user, the SuperCT classifier delivers accurate cell types information for thousands of single-cells in just a few minutes.</p><p>A classifier with good performance is not built overnight. Neither is it a one-size-fit-all model. It is actually the growing human knowledge that drives the machine learning, which means a continual learning mechanism of this framework should be designed at the very beginning. This is also a big advantage of SuperCT framework over the other existing solutions. The two successful upgrades described in this paper have proved that the online-learning and the transfer-learning algorithm make the model evolution not only possible but also efficient.</p><p>Before the human cell atlas data is generated and released, we don&#x02019;t have the comprehensive training dataset resources to cover too many human cell types. In this study, we have found that the SC model trained from the mouse cell types is also applicable to human cells in most of the predictions. This is not a surprising result because human and mouse do share many homologous genes and they contribute to the similar functional cells with the overall similar molecular signatures. It is believed that a general model trained from a typical mammalian species should be applicable to another mammalian species. This finding will expand the scope of the application when the training data is in short for a certain species. Nonetheless, it is intuitively believed that the cell-type classifier should work better when the training data is from the same background.</p><p>Supervised and unsupervised methods play the complementary roles in the growing findings facilitated by machine learning. The classification results from both methods in the analyses of scRNA-seq data can be the cross-reference to each other. As it has been observed, many of the cell grouping defined by UC can be validated by SC. The cell grouping by SC takes the full advantage of the <italic>a priori</italic> learning that makes the cell type prediction less subjective but more efficient. The UC cell grouping is driven by the current data, whose new information could lead to the new findings. Three possible scenarios in UC and SC comparison should be further explored in order to achieve new findings.&#x000a0;(i) The cells form segregated clusters by a UC method with cluster-specific molecular features but SC characterization may give only one cell-type. (ii) There is an obvious cluster, which may be categorized as &#x02018;unknown&#x02019; by SC. (iii) There is a cell type that is characterized in the tissue that may &#x02018;not make any sense&#x02019;, such as the &#x02018;monocytes&#x02019; were found in mouse brain by SuperCT v1m.</p></sec><sec sec-type="data-availability" id="SEC5"><title>DATA AVAILABILITY</title><p>The web app for different versions of SuperCT can be accessible from the following URL. <ext-link ext-link-type="uri" xlink:href="https://sct.lifegen.com/">https://sct.lifegen.com/</ext-link>. The accession number for the KPC mouse PDAC tumor data shown in this paper is NCBI GEO: GSE126388. Sample Y00029 is what has been used in this paper.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="sup1"><label>Supplementary Data</label><media xlink:href="gkz116_supplemental_files.zip"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ack id="ACK1"><title>ACKNOWLEDGEMENTS</title><p>
<italic>Author Contributions</italic>: P.X. and M.X.G. implement the algorithm. P.X., M.X.G., C.M.W. and W.L. performed the analyses. J.F.Z. designed and built the web-app infrastructure. C.M.W. and P.N. prepared the training and testing datasets. C.Y.Y., D.V.H. and H.Y.H. provided insight and suggestion of the applications. M.Q.Z. provided the insight of the algorithm. P.X., M.Q.Z. and W.L. responded to the feedbacks. W.L. conceived the idea and prepared the manuscript.</p></ack><sec id="SEC6"><title>SUPPLEMENTARY DATA</title><p>
<ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkz116#supplementary-data">Supplementary Data</ext-link> are available at NAR Online.</p></sec><sec id="SEC7"><title>FUNDING</title><p>This work was partly supported by the following funding resources: High-level Talent Gathering Program in Hunan Province, China (2018RS3107), NIH (GM084198,MH109665), NSFC (31671384,81890990), Stand Up To Cancer-Cancer Research UK-Lustgarten Foundation Pancreatic Cancer Dream Team Research Grant (SU2C-AACR-DT-20-16).</p><p>
<italic>Conflict of interest statement</italic>. None declared.</p></sec><ref-list id="REF1"><title>REFERENCES</title><ref id="B1"><label>1.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Risso</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Perraudeau</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Gribkova</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Dudoit</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Vert</surname><given-names>J.P.</given-names></name></person-group>
<article-title>A general and flexible method for signal extraction from single-cell RNA-seq data</article-title>. <source>Nat. Commun.</source><year>2018</year>; <volume>9</volume>:<fpage>284</fpage>.<pub-id pub-id-type="pmid">29348443</pub-id></mixed-citation></ref><ref id="B2"><label>2.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Pierson</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Ramazzotti</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Batzoglou</surname><given-names>S.</given-names></name></person-group>
<article-title>Visualization and analysis of single-cell RNA-seq data by kernel-based similarity learning</article-title>. <source>Nat. Methods</source>. <year>2017</year>; <volume>14</volume>:<fpage>414</fpage>&#x02013;<lpage>416</lpage>.<pub-id pub-id-type="pmid">28263960</pub-id></mixed-citation></ref><ref id="B3"><label>3.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Trapnell</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Cacchiarelli</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Grimsby</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Pokharel</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Morse</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Lennon</surname><given-names>N.J.</given-names></name>, <name name-style="western"><surname>Livak</surname><given-names>K.J.</given-names></name>, <name name-style="western"><surname>Mikkelsen</surname><given-names>T.S.</given-names></name>, <name name-style="western"><surname>Rinn</surname><given-names>J.L.</given-names></name></person-group>
<article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat. Biotechnol.</source><year>2014</year>; <volume>32</volume>:<fpage>381</fpage>&#x02013;<lpage>386</lpage>.<pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation></ref><ref id="B4"><label>4.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Shekhar</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Lapan</surname><given-names>S.W.</given-names></name>, <name name-style="western"><surname>Whitney</surname><given-names>I.E.</given-names></name>, <name name-style="western"><surname>Tran</surname><given-names>N.M.</given-names></name>, <name name-style="western"><surname>Macosko</surname><given-names>E.Z.</given-names></name>, <name name-style="western"><surname>Kowalczyk</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Adiconis</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Levin</surname><given-names>J.Z.</given-names></name>, <name name-style="western"><surname>Nemesh</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Goldman</surname><given-names>M.</given-names></name><etal>et al</etal>.</person-group>
<article-title>Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics</article-title>. <source>Cell</source>. <year>2016</year>; <volume>166</volume>:<fpage>1308</fpage>&#x02013;<lpage>1323</lpage>.<pub-id pub-id-type="pmid">27565351</pub-id></mixed-citation></ref><ref id="B5"><label>5.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Tasic</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Menon</surname><given-names>V.</given-names></name>, <name name-style="western"><surname>Nguyen</surname><given-names>T.N.</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>T.K.</given-names></name>, <name name-style="western"><surname>Jarsky</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Yao</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>Levi</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Gray</surname><given-names>L.T.</given-names></name>, <name name-style="western"><surname>Sorensen</surname><given-names>S.A.</given-names></name>, <name name-style="western"><surname>Dolbeare</surname><given-names>T.</given-names></name><etal>et al</etal>.</person-group>
<article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title>. <source>Nat. Neurosci.</source><year>2016</year>; <volume>19</volume>:<fpage>335</fpage>&#x02013;<lpage>346</lpage>.<pub-id pub-id-type="pmid">26727548</pub-id></mixed-citation></ref><ref id="B6"><label>6.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Zeisel</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Munoz-Manchado</surname><given-names>A.B.</given-names></name>, <name name-style="western"><surname>Codeluppi</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Lonnerberg</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>La&#x000a0;Manno</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Jureus</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Marques</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Munguba</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>He</surname><given-names>L.Q.</given-names></name>, <name name-style="western"><surname>Betsholtz</surname><given-names>C.</given-names></name><etal>et al</etal>.</person-group>
<article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>. <source>Science</source>. <year>2015</year>; <volume>347</volume>:<fpage>1138</fpage>&#x02013;<lpage>1142</lpage>.<pub-id pub-id-type="pmid">25700174</pub-id></mixed-citation></ref><ref id="B7"><label>7.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Yao</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>Mich</surname><given-names>J.K.</given-names></name>, <name name-style="western"><surname>Ku</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Menon</surname><given-names>V.</given-names></name>, <name name-style="western"><surname>Krostag</surname><given-names>A.R.</given-names></name>, <name name-style="western"><surname>Martinez</surname><given-names>R.A.</given-names></name>, <name name-style="western"><surname>Furchtgott</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Mulholland</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Bort</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Fuqua</surname><given-names>M.A.</given-names></name><etal>et al</etal>.</person-group>
<article-title>A Single-Cell roadmap of lineage bifurcation in human ESC models of embryonic brain development</article-title>. <source>Cell Stem Cell</source>. <year>2017</year>; <volume>20</volume>:<fpage>120</fpage>&#x02013;<lpage>134</lpage>.<pub-id pub-id-type="pmid">28094016</pub-id></mixed-citation></ref><ref id="B8"><label>8.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Kiselev</surname><given-names>V.Y.</given-names></name>, <name name-style="western"><surname>Kirschner</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Schaub</surname><given-names>M.T.</given-names></name>, <name name-style="western"><surname>Andrews</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Yiu</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Chandra</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Natarajan</surname><given-names>K.N.</given-names></name>, <name name-style="western"><surname>Reik</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Barahona</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Green</surname><given-names>A.R.</given-names></name><etal>et al</etal>.</person-group>
<article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat. Methods</source>. <year>2017</year>; <volume>14</volume>:<fpage>483</fpage>&#x02013;<lpage>486</lpage>.<pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation></ref><ref id="B9"><label>9.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Soares</surname><given-names>J.V.B.</given-names></name>, <name name-style="western"><surname>Leandro</surname><given-names>J.J.G.</given-names></name>, <name name-style="western"><surname>Cesar</surname><given-names>R.M.</given-names></name>, <name name-style="western"><surname>Jelinek</surname><given-names>H.F.</given-names></name>, <name name-style="western"><surname>Cree</surname><given-names>M.J.</given-names></name></person-group>
<article-title>Retinal vessel segmentation using the 2-D Gabor wavelet and supervised classification</article-title>. <source>IEEE Trans. Med. Imaging</source>. <year>2006</year>; <volume>25</volume>:<fpage>1214</fpage>&#x02013;<lpage>1222</lpage>.<pub-id pub-id-type="pmid">16967806</pub-id></mixed-citation></ref><ref id="B10"><label>10.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Geng</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Zhan</surname><given-names>D.C.</given-names></name>, <name name-style="western"><surname>Zhou</surname><given-names>Z.H.</given-names></name></person-group>
<article-title>Supervised nonlinear dimensionality reduction for visualization and classification</article-title>. <source>IEEE Trans. Syst. Man Cybernet. B</source>. <year>2005</year>; <volume>35</volume>:<fpage>1098</fpage>&#x02013;<lpage>1107</lpage>.</mixed-citation></ref><ref id="B11"><label>11.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Camps-Valls</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Marsheva</surname><given-names>T.V.B.</given-names></name>, <name name-style="western"><surname>Zhou</surname><given-names>D.</given-names></name></person-group>
<article-title>Semi-Supervised Graph-Based hyperspectral image classification</article-title>. <source>IEEE Trans. Geosci. Remote Sens.</source><year>2007</year>; <volume>45</volume>:<fpage>3044</fpage>&#x02013;<lpage>3054</lpage>.</mixed-citation></ref><ref id="B12"><label>12.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Ramo</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Sacher</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Snijder</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Begemann</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Pelkmans</surname><given-names>L.</given-names></name></person-group>
<article-title>CellClassifier: supervised learning of cellular phenotypes</article-title>. <source>Bioinformatics</source>. <year>2009</year>; <volume>25</volume>:<fpage>3028</fpage>&#x02013;<lpage>3030</lpage>.<pub-id pub-id-type="pmid">19729371</pub-id></mixed-citation></ref><ref id="B13"><label>13.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Han</surname><given-names>X.P.</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>R.Y.</given-names></name>, <name name-style="western"><surname>Zhou</surname><given-names>Y.C.</given-names></name>, <name name-style="western"><surname>Fei</surname><given-names>L.J.</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>H.Y.</given-names></name>, <name name-style="western"><surname>Lai</surname><given-names>S.J.</given-names></name>, <name name-style="western"><surname>Saadatpour</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Zhou</surname><given-names>Z.M.</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>H.D.</given-names></name>, <name name-style="western"><surname>Ye</surname><given-names>F.</given-names></name><etal>et al</etal>.</person-group>
<article-title>Mapping the mouse cell atlas by Microwell-Seq</article-title>. <source>Cell</source>. <year>2018</year>; <volume>172</volume>:<fpage>1091</fpage>&#x02013;<lpage>1107</lpage>.<pub-id pub-id-type="pmid">29474909</pub-id></mixed-citation></ref><ref id="B14"><label>14.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Schaum</surname><given-names>N.</given-names></name>, <name name-style="western"><surname>Karkanias</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Neff</surname><given-names>N.F.</given-names></name>, <name name-style="western"><surname>May</surname><given-names>A.P.</given-names></name>, <name name-style="western"><surname>Quake</surname><given-names>S.R.</given-names></name>, <name name-style="western"><surname>Wyss-Coray</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Darmanis</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Batson</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Botvinnik</surname><given-names>O.</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>M.B.</given-names></name><etal>et al</etal>.</person-group>
<article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title>. <source>Nature</source>. <year>2018</year>; <volume>562</volume>:<fpage>367</fpage>&#x02013;<lpage>372</lpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation></ref><ref id="B15"><label>15.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Stoeckius</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Hafemeister</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Stephenson</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Houck-Loomis</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Chattopadhyay</surname><given-names>P.K.</given-names></name>, <name name-style="western"><surname>Swerdlow</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Satija</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Smibert</surname><given-names>P.</given-names></name></person-group>
<article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>. <source>Nat. Methods</source>. <year>2017</year>; <volume>14</volume>:<fpage>865</fpage>&#x02013;<lpage>868</lpage>.<pub-id pub-id-type="pmid">28759029</pub-id></mixed-citation></ref><ref id="B16"><label>16.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Zheng</surname><given-names>G.X.</given-names></name>, <name name-style="western"><surname>Terry</surname><given-names>J.M.</given-names></name>, <name name-style="western"><surname>Belgrader</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Ryvkin</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Bent</surname><given-names>Z.W.</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Ziraldo</surname><given-names>S.B.</given-names></name>, <name name-style="western"><surname>Wheeler</surname><given-names>T.D.</given-names></name>, <name name-style="western"><surname>McDermott</surname><given-names>G.P.</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>J.</given-names></name><etal>et al</etal>.</person-group>
<article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun.</source><year>2017</year>; <volume>8</volume>:<fpage>14049</fpage>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation></ref><ref id="B17"><label>17.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Macosko</surname><given-names>E.Z.</given-names></name>, <name name-style="western"><surname>Basu</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Satija</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Nemesh</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Shekhar</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Goldman</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Tirosh</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Bialas</surname><given-names>A.R.</given-names></name>, <name name-style="western"><surname>Kamitaki</surname><given-names>N.</given-names></name>, <name name-style="western"><surname>Martersteck</surname><given-names>E.M.</given-names></name><etal>et al</etal>.</person-group>
<article-title>Highly parallel Genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source>. <year>2015</year>; <volume>161</volume>:<fpage>1202</fpage>&#x02013;<lpage>1214</lpage>.<pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation></ref><ref id="B18"><label>18.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Butler</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Hoffman</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Smibert</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Papalexi</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Satija</surname><given-names>R.</given-names></name></person-group>
<article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat. Biotechnol.</source><year>2018</year>; <volume>36</volume>:<fpage>411</fpage>&#x02013;<lpage>420</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation></ref><ref id="B19"><label>19.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Olive</surname><given-names>K.P.</given-names></name>, <name name-style="western"><surname>Jacobetz</surname><given-names>M.A.</given-names></name>, <name name-style="western"><surname>Davidson</surname><given-names>C.J.</given-names></name>, <name name-style="western"><surname>Gopinathan</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>McIntyre</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Honess</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Madhu</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Goldgraben</surname><given-names>M.A.</given-names></name>, <name name-style="western"><surname>Caldwell</surname><given-names>M.E.</given-names></name>, <name name-style="western"><surname>Allard</surname><given-names>D.</given-names></name><etal>et al</etal>.</person-group>
<article-title>Inhibition of Hedgehog signaling enhances delivery of chemotherapy in a mouse model of pancreatic cancer</article-title>. <source>Science</source>. <year>2009</year>; <volume>324</volume>:<fpage>1457</fpage>&#x02013;<lpage>1461</lpage>.<pub-id pub-id-type="pmid">19460966</pub-id></mixed-citation></ref><ref id="B20"><label>20.</label><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Thrun</surname><given-names>S.</given-names></name></person-group>
<person-group person-group-type="editor"><name name-style="western"><surname>Touretzky</surname><given-names>DS.</given-names></name>, <name name-style="western"><surname>Mozer</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Hasselmo</surname><given-names>ME</given-names></name></person-group>
<source>Advances in Neural Information Processing Systems 8: Proceedings of the 1995 Conference</source>. <year>1996</year>; <volume>8</volume>:<publisher-loc>Cambridge</publisher-loc><publisher-name>MIT Press</publisher-name><fpage>640</fpage>&#x02013;<lpage>646</lpage>.</mixed-citation></ref><ref id="B21"><label>21.</label><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Qiu</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Mao</surname><given-names>Q.</given-names></name>, <name name-style="western"><surname>Tang</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Chawla</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Pliner</surname><given-names>H.A.</given-names></name>, <name name-style="western"><surname>Trapnell</surname><given-names>C.</given-names></name></person-group>
<article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title>. <source>Nat. Methods</source>. <year>2017</year>; <volume>14</volume>:<fpage>979</fpage>&#x02013;<lpage>982</lpage>.<pub-id pub-id-type="pmid">28825705</pub-id></mixed-citation></ref></ref-list></back></article>