<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nat Commun</journal-id><journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id><journal-title-group><journal-title>Nature Communications</journal-title></journal-title-group><issn pub-type="epub">2041-1723</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6789098</article-id><article-id pub-id-type="publisher-id">12266</article-id><article-id pub-id-type="doi">10.1038/s41467-019-12266-7</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>A systematic evaluation of single cell RNA-seq analysis pipelines</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8415-1695</contrib-id><name><surname>Vieth</surname><given-names>Beate</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4826-1651</contrib-id><name><surname>Parekh</surname><given-names>Swati</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Ziegenhain</surname><given-names>Christoph</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4056-0550</contrib-id><name><surname>Enard</surname><given-names>Wolfgang</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0588-1313</contrib-id><name><surname>Hellmann</surname><given-names>Ines</given-names></name><address><email>hellmann@bio.lmu.de</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 973X</institution-id><institution-id institution-id-type="GRID">grid.5252.0</institution-id><institution>Anthropology and Human Genomics, Department of Biology II, </institution><institution>Ludwig-Maximilians University, </institution></institution-wrap>Munich, Germany </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0373 6590</institution-id><institution-id institution-id-type="GRID">grid.419502.b</institution-id><institution>Max Planck Institute for Biology of Ageing, </institution></institution-wrap>Cologne, Germany </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1937 0626</institution-id><institution-id institution-id-type="GRID">grid.4714.6</institution-id><institution>Department of Cell and Molecular Biology, </institution><institution>Karolinska Institutet, </institution></institution-wrap>SE-171 65, Stockholm, Sweden </aff></contrib-group><pub-date pub-type="epub"><day>11</day><month>10</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>11</day><month>10</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>10</volume><elocation-id>4667</elocation-id><history><date date-type="received"><day>27</day><month>3</month><year>2019</year></date><date date-type="accepted"><day>28</day><month>8</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">The recent rapid spread of single cell RNA sequencing (scRNA-seq) methods has created a large variety of experimental and computational pipelines for which best practices have not yet&#x000a0;been established. Here, we use simulations based on five scRNA-seq library protocols in combination with nine realistic differential expression (DE) setups to systematically evaluate three mapping, four imputation, seven normalisation and four differential expression testing approaches resulting in ~3000 pipelines, allowing us to also assess interactions among pipeline steps. We find that choices of normalisation and library preparation protocols have the biggest impact on scRNA-seq analyses. Specifically, we find that library preparation determines the ability to detect symmetric expression differences, while normalisation dominates pipeline performance in asymmetric DE-setups. Finally, we illustrate the importance of informed choices by showing that a good scRNA-seq pipeline can have the same impact on detecting a biological signal as quadrupling the sample size.</p></abstract><abstract id="Abs2" abstract-type="web-summary"><p id="Par2">There has been a rapid rise in single&#x000a0;cell RNA-seq methods and associated pipelines. Here the authors use simulated data to systematically evaluate the performance of 3000 possible pipelines to derive recommendations for data processing and analysis of different types of scRNA-seq experiments.</p></abstract><kwd-group kwd-group-type="npg-subject"><title>Subject terms</title><kwd>Data processing</kwd><kwd>Transcriptomics</kwd></kwd-group><funding-group><award-group><funding-source><institution>Deutsche Forschungsgemeinschaft (DFG) LMUExcellent Deutsche Forschungsgemeinschaft (DFG) SFB1243 (Subproject A14/A15) Deutsche Forschungsgemeinschaft (DFG) HE 7669/1.1</institution></funding-source></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par3">Many experimental protocols and computational analysis approaches exist for single cell RNA sequencing (scRNA-seq). Furthermore, scRNA-seq analyses can have different goals including differential expression (DE) analysis, clustering of cells, classification of cells and trajectory reconstruction<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. All these goals have the first analysis steps in common in that they require expression counts or normalised counts. Here, we focus on these important first choices made in any scRNA-seq study, using DE-inference as performance read-out. Benchmarking studies exist only separately for each analysis step, which are library preparation protocols<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref></sup>, alignment<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>, annotations<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, count matrix preprocessing<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR8">8</xref></sup> and normalisation<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. However, the impact of the combined choices of the separate analysis steps on overall pipeline performance has not been quantified. In order to achieve a fair and unbiased comparison of computational pipelines, simulations of realistic data sets are necessary. This is because the ground truth of real data is unknown and alternatives, such as concordance analyses are bound to favour similar and not necessarily better methods.</p><p id="Par4">To this end, we integrate popular methods for each analysis step into our simulation framework powsimR<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. As the basis for simulations, powsimR uses raw count matrices to describe the mean-variance relationship of gene expression measures. This includes the variance introduced during the experiment itself as well as extra variance due to the first to computational steps of expression quantification. Adding DE then provides us with detailed performance measures based on how faithfully DE-genes can be recovered.</p><p id="Par5">One main assumption in traditional DE-analysis is that differences in expression are symmetric. This implies that either a small fraction of genes is DE while the expression of the majority of genes remains constant or similar numbers of genes are up- and down-regulated so that the mean total mRNA content does differ between groups<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. This assumption is no longer true when diverse cell types are considered. For example, Zeisel et al.<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> find up to 60% DE genes and differing amounts of total mRNA levels between cell types. This issue of asymmetry is conceptually one of the characteristics that distinguishes single cell from bulk RNA-seq and has not been addressed so far. Therefore, we simulate varying numbers of DE-genes in conjunction with small to large differences in mRNA content including the entire spectrum of possible DE-settings.</p><p id="Par6">Realistic simulations in conjunction with a wide array of scRNA-seq methods, allow us not only to quantify the performance of individual pipeline steps, but also to quantify interdependencies among the steps. Moreover, the relative importance of the various steps to the overall pipeline can be estimated. Hence, our analysis provides sound recommendations regarding the construction of an optimal computational scRNA-seq pipeline for the data at hand.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><sec id="Sec3"><title>scRNA-seq data and simulations</title><p id="Par7">The starting point for our comprehensive pipeline comparison is a representative selection of scRNA-seq library preparation protocols (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1a</xref>). Here, we included one full-length method (Smart-seq2<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>) and four UMI methods<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR14">14</xref>&#x02013;<xref ref-type="bibr" rid="CR16">16</xref></sup>. The UMI strategies encompass two plate-based (SCRB-seq, CEL-seq2) and the most common non-commercial and commercial droplet-based protocols (Drop-seq, 10X Chromium). CEL-seq2 differs from SCRB-seq in that it relies on linear amplification by in vitro transcription, while SCRB-seq relies on PCR amplification using the same strategy as 10X Chromium (see Ziegenhain et al.<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup> for a detailed discussion). We then combine the library preparation protocols with three mapping approaches<sup><xref ref-type="bibr" rid="CR18">18</xref>&#x02013;<xref ref-type="bibr" rid="CR20">20</xref></sup> and three annotation schemes<sup><xref ref-type="bibr" rid="CR21">21</xref>&#x02013;<xref ref-type="bibr" rid="CR23">23</xref></sup> resulting in 45 distinct raw count matrices (see &#x0201c;Methods&#x0201d;). We simulated 27 distinct DE-setups per matrix, each with 20 replicates, resulting in a total of 19,980 simulated data sets (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1b</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>Study Overview. <bold>a</bold> The data sets yielding raw count matrices: We use scRNA-seq data sets<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup> representing 5 popular library preparation protocols. For each data set, we obtain multiple gene count matrices that result from various combinations of alignment methods and annotation schemes (see also Supplementary Figs.&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref> and <xref rid="MOESM1" ref-type="media">2</xref>, and Supplementary Tables&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref> and <xref rid="MOESM1" ref-type="media">2</xref>). <bold>b</bold> The simulation setup: Using powsimR<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> distribution estimates from real count matrices, we simulate the expression of 10,000 genes for two groups with 384 vs 384, 96 vs. 96 and 50 vs. 200 cells, where 5, 20 or 60% of genes are DE between groups. The magnitude of expression change for each gene is drawn from a narrow gamma distribution (<italic>X</italic>&#x02009;~&#x02009;&#x00393;(<italic>&#x003b1;</italic>&#x02009;=&#x02009;1, <italic>&#x003b2;</italic>&#x02009;=&#x02009;2)) and the directions can either be symmetric, asymmetric or completely asymmetric. To introduce slight variation in expression capture, we draw a different size factor for each cell from a narrow normal distribution. <bold>c</bold> The analysis pipeline: The simulated data sets are then analysed using combinations of four count matrix preprocessing, seven normalisation and four DE approaches. The evaluation of these pipelines focuses on the outcome of the confusion matrix and its derivatives (TPR, FDR, pAUC, MCC), deviance in library size estimates (RMSE) and computational run time</p></caption><graphic xlink:href="41467_2019_12266_Fig1_HTML" id="d29e391"/></fig></p></sec><sec id="Sec4"><title>Genome-mapping quantifies gene expression with high accuracy</title><p id="Par8">We first investigated how expression quantification is affected by different alignment methods using our selection of scRNA-seq experiments. For each of the three following strategies we picked one the most popular methods (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">2</xref>): (1) alignment of reads to the genome using splice-aware alignment (STAR<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>), (2) alignment to the transcriptome (BWA<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>) and (3) pseudo-alignment of reads guided by a transcriptome (kallisto<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>).We then combined these with three annotation schemes including two curated schemes (RefSeq<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and Vega<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>) and the more inclusive GENCODE<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">2</xref>).</p><p id="Par9">First, we assessed the performance by the number of reads or UMIs that were aligned and assigned to genes (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2a</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">3</xref>). Alignment rates of reads are comparable across all scRNA-seq protocols. Assignment rates on the other hand show some interaction between mapper and protocol. All mappers, aligned and assigned more reads using GENCODE as compared to RefSeq annotation, whereas the pseudo-aligner kallisto profited most from the more comprehensive annotation of GENCODE and here in particular the 3&#x02019;UMI protocols (Figure <xref rid="Fig2" ref-type="fig">2A</xref>). Generally, STAR in combination with GENCODE aligned (82&#x02013;86%) and assigned (37&#x02013;63%) the most reads, while kallisto assigned consistently the fewest reads (20-40%) (Figure <xref rid="Fig2" ref-type="fig">2D</xref>). BWA assigned an intermediate fraction of reads (22&#x02013;44%), but&#x02014;suspiciously&#x02014;these were distributed across more UMIs. As reads with the same UMI are more likely to originate from the same mRNA molecule and thus the same gene, the average number of genes with which one UMI sequence is associated, can be seen as a measure of false mapping. Indeed, we find that the same UMI is associated with more genes when mapped by BWA than when mapped by STAR (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2b</xref>). This indicates a high false mapping rate, that probably inflates the number of genes that are detected by BWA (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2c</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">4</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>Expression Quantification. <bold>a</bold> Read alignment and assignment rates per library preparation protocol stratified over aligner and annotation. The lighter shade represents the percentage of the total reads that could be aligned and the darker shade the percentage that also was uniquely assigned (see also Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">3</xref>). For comparability, cells were downsampled to 1 million reads/cell, with the exception of 10&#x000d7; Genomics data that were only sequenced to on average 60,000 reads/cell. Hence, these data are farther from saturation and have a higher UMI/read ratio. <bold>b</bold> Number of genes per UMI with &#x0003e;1 reads for BWA and STAR alignment using the SCRB-seq data set and GENCODE annotation. Colours denote number bins of UMIs. <bold>c</bold> Number of genes detected per Library Preparation Protocol stratified over Aligner and Annotation (i.e. at least 10% nonzero expression values) (see also Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">4</xref>). <bold>d</bold> Estimated mean expression, dispersion and gene dropout rates for SCRB-seq and Smart-seq2 data using STAR, BWA or kallisto alignments with GENCODE annotation (see also Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">7</xref>). <bold>e</bold> Mean-dispersion fitting line applying a cubic smoothing spline with 95% variability bands for SCRB-seq and Smart-seq2 data using STAR, BWA or kallisto alignments with GENCODE annotation (see also Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">8</xref>). <bold>f</bold> The effect of quantification choices on the power (TPR) to detect differential expression stratified over library preparation and aligner. The expression of 10,000 detected genes over 768 cells (384 cells per group) were simulated given the observed mean-variance relation per protocol. Five percent of the simulated genes are differentially expressed following a symmetric narrow gamma distribution. Unfiltered counts were normalised using scran. Differential expression was tested using limma-trend (see also Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">9</xref>)</p></caption><graphic xlink:href="41467_2019_12266_Fig2_HTML" id="d29e494"/></fig></p><p id="Par10">This said, it remains to be seen what impact the differences in read or UMI counts obtained through the different alignment strategies and annotations have on the power to detect DE-genes.</p><p id="Par11">As already indicated from the low fraction of assigned reads, kallisto has the lowest mean expression and the highest gene dropout rates (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2d</xref> and Supplementary Figs.&#x000a0;<xref rid="MOESM1" ref-type="media">7</xref> and <xref rid="MOESM1" ref-type="media">8</xref>) and, as expected from a high fraction of falsely mapped reads, BWA has the largest variance. To estimate the impact that these statistics have on the power to detect DE-genes, we use the mean-variance relationship to simulate data sets with DE-genes (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2d, e</xref>). As previously reported<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, UMI protocols have a noticeably higher power than Smart-seq2 (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2f</xref>). Moreover for Smart-seq2, we find that kallisto, especially with RefSeq annotation, performs slightly better than STAR, while for UMI-methods STAR performs better (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2f</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">9</xref>).</p><p id="Par12">In summary, using BWA to map to the transcriptome introduces noise, thus considerably reducing the power to detect DE-genes as compared to genome alignment using STAR or the pseudo-alignment strategy kallisto, but given the lower mapping rate of kallisto STAR with GENCODE is generally preferable.</p></sec><sec id="Sec5"><title>Many asymmetric changes pose a problem without spike-ins</title><p id="Par13">The next step in any RNA-seq analysis is the normalisation of the count matrix. The main idea here is that the resulting size factors correct for differing sequencing depths. In order to improve normalisation, spike-ins as an added standard can help, but are not feasible for all scRNA-seq library preparations. Another avenue to improve normalisation would be to deal with sparsity by imputing missing data prior to normalisation as discussed in the next chapter (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1c</xref>). To begin with, we compare how much the estimated size factors deviate from the truth. As long as there is only a small proportion of DE-genes or if the differences are symmetric, estimated size factors are not too far from the simulated ones and there are no large differences among methods (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3a</xref> and Supplementary Figs.&#x000a0;<xref rid="MOESM1" ref-type="media">10</xref> and <xref rid="MOESM1" ref-type="media">11</xref>). However with increasing asymmetry, size factors deviate more and more and the single cell methods scran<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> and SCnorm<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> perform markedly better than the bulk methods TMM<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, MR<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> and Positive Counts as well as the single cell method Linnorm<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Census<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> is an outlier in that it has a constant deviation of 0.1, which is due to filling in 1 when library sizes could not be calculated.<fig id="Fig3"><label>Fig. 3</label><caption><p>Normalisation choices determines DE-analysis performance, not count preprocessing. The data in panels <bold>a</bold>&#x02013;<bold>c</bold> are based on Smart-seq2 data, all panels are based on two groups of 384 cells, STAR alignment with GENCODE annotation was used for quantification. <bold>a</bold> The root mean squared error (RMSE) of estimated library size factors per normalisation method is plotted for 20% asymmetric DE-genes (see also Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">11</xref>) (Box and whisker plot with centre line&#x02009;=&#x02009;median, bounds of box&#x02009;=&#x02009;25th and 75th percentile, whiskers&#x02009;=&#x02009;1.5 * interquartile range from the lower and upper bounds of the box). <bold>b</bold> The discriminatory ability determined by the partial area under the curve (mean pAUC&#x02009;&#x000b1;&#x02009;s.d.) based on DE testing with limma-trend for normalisation without spike-ins per DE-pattern. The grey ribbon indicates the mean pAUC&#x02009;&#x000b1;&#x02009;s.d. given simulated size factors (see also Supplementary Figs.&#x000a0;<xref rid="MOESM1" ref-type="media">13</xref>&#x02013;<xref rid="MOESM1" ref-type="media">15</xref>). <bold>c</bold> Using spike-ins for normalisation for 60% completely asymmetric DE-genes. <bold>d</bold> Effect of preprocessing the count matrix for 20% asymmetric DE-genes without spike-ins. Counts were either left asis (&#x02018;none&#x02019;), filtered or imputed prior to normalisation. The derived scaling factors were then used for normalisation and DE testing was performed on raw counts using limma-trend (see also Supplementary Figs.&#x000a0;<xref rid="MOESM1" ref-type="media">16</xref>&#x02013;<xref rid="MOESM1" ref-type="media">18</xref>). This procedure was applied to the full count matrix (circle) and to the count matrix downsampled to 10% of its original sequencing depth (triangular). Missing data points are due to failing imputation runs with the sparser data</p></caption><graphic xlink:href="41467_2019_12266_Fig3_HTML" id="d29e611"/></fig></p><p id="Par14">To determine the effect of these deviations on downstream analyses, we evaluated the performance of DE inference using different normalisation methods (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3b</xref> and Supplementary Figs.&#x000a0;<xref rid="MOESM1" ref-type="media">12</xref>&#x02013;<xref rid="MOESM1" ref-type="media">15</xref>). Firstly, the differences in the TPR across normalisation methods are only minor, only Linnorm performed consistently worse (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">13</xref>). In contrast, the ability to control the FDR heavily depends on the normalisation method (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">14</xref>). For small numbers of DE-genes or symmetrically distributed changes, the FDR is well controlled for all methods except Linnorm. However, with an increasing number and asymmetry of DE-genes, only SCnorm and scran keep FDR control, provided that cells are grouped or clustered prior to normalisation. In our most extreme scenario with 60% DE-genes and complete asymmetry, all methods except Census loose FDR control. SCnorm, scran, Positive Counts and MR regain FDR control with spike-ins for 60% completely asymmetric DE-genes (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">14</xref>). Given similar TPR of the methods, this FDR control determines the pAUC (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3b, c</xref>).</p><p id="Par15">Since in real data it is usually unknown what proportion of genes is DE and whether cells contain differing levels of mRNA, we recommend a method that is robust under all tested scenarios. Thus, for most experimental setups scran is a good choice, only for Smart-seq2 data without spike-ins, Census might be a better choice.</p></sec><sec id="Sec6"><title>Imputation has little impact on pipeline performance</title><p id="Par16">If the main reason why normalisation methods perform worse for scRNA-seq than for bulk data is the sparsity of the count matrix, reducing this sparsity by either more stringent filtering or imputation of missing values should remedy the problem<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. Here, we test the impact of frequency filtering and three imputation approaches (DrImpute<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>, scone<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, SAVER<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>) on normalisation performance. Note, that we use the imputation or filtering only to obtain size factor estimates, that are then used together with the raw count matrix for DE-testing.</p><p id="Par17">We find that simple frequency filtering has no effect on normalisation results (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3d</xref>). Performance as measured by pAUC is identical to using raw counts. In contrast, imputation can have an effect on performance and there are large differences among methods. Imputation with DrImpute and scone rarely increased the pAUC and occasionally as in the case of SCRB-seq with MR normalisation, the pAUC even decreased by 100 and 76%, respectively due to worse FDR control relative to using raw counts (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">18</xref>). In contrast, these two imputation methods achieved an appreciable increase in pAUC together with scran normalisation, ~28, 4 and 9% for 10&#x000d7; Genomics, SCRB-seq and Smart-seq2 data, respectively. SAVER on the other hand never made things worse, irrespective of data set and normalisation method but was able to rescue FDR control for MR normalisation of UMI data, even in a completely asymmetric DE-pattern.</p><p id="Par18">These observations suggest that data sets with a high gene dropout rate might benefit more from imputation than data sets with a relatively low gene dropout rate (Supplementary Figs.&#x000a0;<xref rid="MOESM1" ref-type="media">16</xref>&#x02013;<xref rid="MOESM1" ref-type="media">18</xref>). In order to further investigate the effect of imputation on sparse data, we downsampled the Smart-seq2 and SCRB-seq data, which were originally based on 1 million reads/cell, to make them more comparable to the 10X-HGMM data with on average of 60,000 reads/cell. A radical downsampling to 10% of the original sequencing depth decreases the number of detected genes for SCRB-seq by only 1%, suggesting that the original RNA-seq library was sequenced to saturation. In contrast, the Smart-seq2 data were much less saturated at 1 million reads/cell: Downsampling reduced the number of detected genes by 34%. However, the relative effect of imputation on performance remains small. This is probably due to the fact that the main effect of downsampling is a reduction in the detected genes, which also cannot be imputed. Thus, if a good normalisation method is used to begin with (e.g. scran with clustering), the improvement by imputation remains relatively small.</p></sec><sec id="Sec7"><title>Good normalisation removes the need for specialised DE-tools</title><p id="Par19">The final step in our pipeline analysis is the detection of DE-genes. Recently, Soneson et al.<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> benchmarked 36 DE approaches and found that edgeR<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, MAST<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>, limma-trend<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> and even the T-Test performed well. Moreover, they found that for edgeR, it is important to incorporate an estimate of the dropout rate per cell. Therefore, we combine edgeR here with zingeR<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>.</p><p id="Par20">Both edgeR-zingeR and limma-trend in combination with a good normalisation reach similar pAUCs as using the simulated size factors (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>). However, in the case of edgeR-zingeR this performance is achieved by a higher TPR paid while loosing FDR control (see Supplementary Figs.&#x000a0;<xref rid="MOESM1" ref-type="media">19</xref>&#x02013;<xref rid="MOESM1" ref-type="media">21</xref>), even in the case of symmetric DE-settings (Supplementary Figs.&#x000a0;<xref rid="MOESM1" ref-type="media">22</xref>&#x02013;<xref rid="MOESM1" ref-type="media">24</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><p>Evaluation of DE tools. The expression of 10,000 genes over 768 cells (384 cells per group) were simulated given the observed mean-variance relation per protocol. Twenty percent of the simulated genes are differentially expressed following an asymmetric narrow gamma distribution. Unfiltered counts were normalised using simulated library size factors or applying normalisation methods. Differential expression was tested using <italic>T</italic>-Test, limma-trend, MAST or edgeR-zingeR. The discriminatory ability of DE methods is determined by the partial area under the curve (mean pAUC&#x02009;&#x000b1;&#x02009;s.d.) for the TPR-FDR curve (see also Supplementary Figs.&#x000a0;<xref rid="MOESM1" ref-type="media">19</xref>&#x02013;<xref rid="MOESM1" ref-type="media">25</xref>)</p></caption><graphic xlink:href="41467_2019_12266_Fig4_HTML" id="d29e735"/></fig></p><p id="Par21">Nevertheless, we find that DE-analysis performance strongly depends on the normalisation method and on the library preparation method. In combination with the simulated size factors or scran normalisation, even a <italic>T</italic>-Test performs well. Conversely, in combination with MR or SCnorm, the <italic>T</italic>-Test has an increased FDR (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">20</xref>). SCnorms bad performance with a <italic>T</italic>-Test was surprising given SCnorms good performance with limma-trend (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3b</xref>). One explanation could be the relatively large deviation of SCnorm derived size factors (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3a</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">11</xref>) which inflate the expression estimates.</p><p id="Par22">Furthermore, we find that MAST performs consistently worse than the other DE-tools when applied to UMI-based data, but -except in combination with SCnorm- it is doing fine with Smart-seq2 data. Interestingly, Census normalisation in combination with edgeR-zingeR outperformed limma-trend with Smart-seq2 (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">25</xref>).</p><p id="Par23">In concordance with Soneson et al.<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, we found that limma-trend, a DE-tool developed for bulk RNA-seq data showed the most robust performance. Moreover, library preparation and normalisation appeared to have a stronger effect on pipeline performance than the choice of DE-tool.</p></sec><sec id="Sec8"><title>Normalisation is overall the most influential step</title><p id="Par24">Because we tested a nearly exhaustive number of ~3000 possible scRNA-seq pipelines, starting with the choice of library preparation protocol and ending with DE-testing, we can estimate the contribution of each separate step to pipeline performance for our different DE-settings (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1b</xref>). We used a beta regression model to explain the variance in pipeline performance with the choices made at the seven pipeline steps (1) library preparation protocol, (2) spike-in usage, (3) alignment method, (4) annotation scheme, (5) preprocessing of counts, (6) normalisation and (7) DE-tool as explanatory variables. We used the difference in pseudo-<italic>R</italic><sup>2</sup> between the full model including all seven pipeline steps and leave-one-out reduced models to measure the contribution of each separate step to overall performance.</p><p id="Par25">All pipeline choices together (the full model) explain ~50 and ~60% of the variance in performance, for 20 and 60% DE-genes, respectively (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5a</xref>). Choices of preprocessing the count matrix contribute very little (&#x00394;<italic>R</italic><sup>2</sup>&#x02009;&#x02264;&#x02009;1%). The same is true for annotation (&#x00394;<italic>R</italic><sup>2</sup>&#x02009;&#x02264;&#x02009;2%) and aligner choices (&#x00394;<italic>R</italic><sup>2</sup>&#x02009;&#x02264;&#x02009;5%). For aligner and annotation, it is important to note that these are upper bounds, because our simulations do not include differences in gene detection rates (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2c</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><p>Evaluation of analysis pipeline. <bold>a</bold>, <bold>b</bold> The expression of 10000 genes over 768 cells were simulated and 5, 20 or 60% of the genes were differentially expressed following a symmetric or asymmetric narrow gamma distribution. This simulation setup was applied to protocols, alignments, annotations, preprocessing of counts, normalisation and DE tools. For each analysis set, the Matthew Correlation Coefficient (mean MCC&#x02009;&#x000b1;&#x02009;s.d.) was averaged over 20 simulations and rescaled to [0, 1] interval. The MCC was used as a response variable in beta regression models with log-log link function. <bold>a</bold> The contribution of each covariate in the full model (~Protocol&#x02009;+&#x02009;Aligner&#x02009;+&#x02009;Annotation&#x02009;+&#x02009;Preprocessing&#x02009;+&#x02009;Normalisation&#x02009;+&#x02009;DE-Tool). <bold>b</bold> Performance according to sample size, 1 good and 1 naive pipeline (see also Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">26</xref>). <bold>c</bold>&#x02013;<bold>e</bold> The expression of ~1000 human PBMcs profiled with 10&#x000d7; Genomics were processed using the good and naive pipeline. Cell types were identified with SingleR classification using the Blueprint Epigenomics Reference. Cell types are represented in a UMAP, for good <bold>c</bold> and naive <bold>d</bold> pipeline, respectively. True marker genes, i.e., given by the reference, per pairwise comparison of cell types for the good and naive pipeline are given in <bold>e</bold> where genes needed to have a adjusted p-value &#x0003c; 0.1, absolute log2 fold change threshold (&#x0003e;0.1) and expressed in at least 10% of the cells to be considered. <bold>f</bold> Pipeline recommendations for UMI and Smart-seq2 data</p></caption><graphic xlink:href="41467_2019_12266_Fig5_HTML" id="d29e850"/></fig></p><p id="Par26">Surprisingly, the choice of DE-tool only matters for symmetric DE-setups (<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta R_{{\mathrm{DE = 0}}.{\mathrm{2}}}^2 = 15\%$$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DE=0</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">2</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>15</mml:mn><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12266_Article_IEq1.gif"/></alternatives></inline-formula>; <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta R_{{\mathrm{DE = 0}}.{\mathrm{6}}}^2 = 11\%$$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DE=0</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">6</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>11</mml:mn><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12266_Article_IEq2.gif"/></alternatives></inline-formula>), and the choice of library preparation protocol has an even bigger impact on performance for symmetric DE-setups (<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta R_{{\mathrm{Symmetric}}}^2 = 17 - 29\%$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Symmetric</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>17</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mn>29</mml:mn><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12266_Article_IEq3.gif"/></alternatives></inline-formula>) and additionally for 5% asymmetric changes (<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta R_{{\mathrm{5}}\% {\mathrm{Asymmetric}}}^2 = 17\%$$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">5</mml:mi><mml:mi>%</mml:mi><mml:mi mathvariant="normal">Asymmetric</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>17</mml:mn><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12266_Article_IEq4.gif"/></alternatives></inline-formula>). Normalisation choices have overall a large impact in all DE-settings (&#x00394;<italic>R</italic><sup>2</sup>&#x02009;=&#x02009;12&#x02013;38%), where the importance increases with increasing levels of DE-genes and increasing asymmetry. Spike-ins are only necessary if many asymmetric changes are expected and have little or no impact if only 5% of the genes are DE or the changes are symmetric (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5a</xref>). Moreover, for completely asymmetric DE-patterns, the regression model did not converge without normalisation and spike-ins, because their absence or presence alone pushed the MCCs to the extremes.</p><p id="Par27">For the best performing pipeline [SCRB-seq&#x02009;+&#x02009;STAR&#x02009;+&#x02009;GENCODE&#x02009;+&#x02009;SAVER imputation&#x02009;+&#x02009;scran with clustering&#x02009;+&#x02009;limma-trend], using 384 cells per group instead of 96 improves performance only by 6.5&#x02013;8%. Sample size is more important if a naive pipeline is used. For [SCRB-seq&#x02009;+&#x02009;BWA&#x02009;+&#x02009;GENCODE&#x02009;+&#x02009;no count matrix preprocessing&#x02009;+&#x02009;MR&#x02009;+&#x02009;T-Test] the performance gain by increasing sample size is 10&#x02013;12% and even worse, for many asymmetric DE-genes, lower sample sizes occasionally appear to perform better (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5b</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">26</xref>). Next, we tested our pipeline on publicly available 10&#x000d7; Genomics data set containing the expression profiles of approx. 1000 human peripheral mononuclear blood cells (PBMC)<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. First, we classified the cells using SingleR<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> into the celltypes available in the Blueprint Epigenomics Reference<sup><xref ref-type="bibr" rid="CR39">39</xref></sup> distinguishing Monocytes, NK-cells, CD8&#x02009;+&#x02009;T-cells, CD4&#x02009;+&#x02009;T-cells and B-cells (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5c, d</xref>). We applied the previously defined good (STAR&#x02009;+&#x02009;gencode&#x02009;+&#x02009;SAVER imputation&#x02009;+&#x02009;scran with clustering&#x02009;+&#x02009;limma-trend) and naive (BWA&#x02009;+&#x02009;gencode&#x02009;+&#x02009;no preprocessing&#x02009;+&#x02009;MR&#x02009;+&#x02009;<italic>T</italic>-Test) pipeline to identify DE-genes between the cell types. Cross-referencing the identified DE-genes with known differences in marker gene expression<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, we find that the good pipeline always identifies a higher fraction of the marker genes as DE than the naive pipeline (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5e</xref>). Comparing NK-cells and CD8&#x02009;+&#x02009;T-cells, the good pipeline identifies 148 known markers as DE, while the naive pipeline finds only 54. The diminished separation between those two cell-types using the naive pipeline is already visible in the UMAP (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5d</xref>).</p><p id="Par28">In summary, we identify normalisation and library preparation as the most influential choices and the observation that differences in computational steps alone can significantly lower the required sample size nicely illustrates the importance of bioinformatic choices.</p></sec></sec><sec id="Sec9" sec-type="discussion"><title>Discussion</title><p id="Par29">Here we evaluate the performance of complete computational pipelines for the analysis of scRNA-seq data under realistic conditions with large numbers of DE-genes and differences in total mRNA contents between groups (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). Furthermore, our simulations allow us not only to investigate the influence of choices made at each pipeline step separately, but also to estimate the relative importance and interactions between different steps of an entire scRNA-seq analysis pipeline. We implemented all assessed computational methods and more in powsimR, so that users can easily evaluate pipeline performance given their own data and expected DE-settings.</p><p id="Par30">Beginning with the creation of the raw count matrix, we find that transcriptome mapping with BWA<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> appears to recover the largest number of genes. However, many of these are probably due to falsely mapped reads, also increase expression variance which ultimately results in a lower sensitivity (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2c&#x02013;f</xref>). In contrast, the pseudo-alignment method kallisto<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> appears to assign reads precisely, but looses a lot of reads leading to a lower mean expression. Finally, a genome mapping approach using the splice-aware aligner STAR<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> in conjunction with GENCODE annotation recovers the most reads with the highest accuracy (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5f</xref>).</p><p id="Par31">Concerning the preprocessing of the count matrix, we found in concordance with Andrews et al.<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> that in particular for sparse data such as 10X, SAVER<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> imputation before normalisation improves performance, while filtering genes has no effect with our data sets and combinations of normalisation and DE-testing methods.</p><p id="Par32">The choice that had the largest impact on performance throughout all tested DE-settings is the choice of normalisation method. Only for symmetric changes, the choice of library preparation protocol had a slightly larger impact than normalisation. In line with Evans et al. (2018)<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, we found that normalisation performance of bulk methods and also some of the single cell methods declined with asymmetry (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3b</xref>). In particular, for 60% completely asymmetric DE-genes only Census retained FDR control. Unfortunately, Census is not recommended for the use with UMI-counts. Thus, for UMI-counts and 60% completely asymmetric changes, only the use of spike-ins could restore test performance. In the debate about the usefulness of spike-ins<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR41">41</xref></sup>, we land on the pro side: Our simulations clearly show that spike-ins are useful in DE-testing settings with asymmetric changes which is likely to be a common phenomenon in scRNA-seq data. Due to good performance across DE-settings and its speed (Supplementary Figs.&#x000a0;<xref rid="MOESM1" ref-type="media">22</xref> and <xref rid="MOESM1" ref-type="media">27</xref>) we would recommend scran with prior clustering as the best choice for normalisation (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5f</xref>).</p><p id="Par33">The choice in DE-testing method, our final pipeline step had relatively little impact on overall pipeline performance. A good normalisation prior to DE-testing alleviates the need for more complex and thus vulnerable methods, such as for example MASTs hurdle model which implicitly assumes that the CPM values were generated from zero inflated negative binomial count distribution. Indeed, we previously showed that also scRNA-seq data fit a negative binomial distribution rather well and that the previously reported zero-inflation in scRNA-seq data is mainly due to amplification noise which is removed in UMI-data<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Hence, it is not surprising that in concordance with Soneson et al.<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, we find that relatively straight forward DE-testing methods adapted from bulk RNA-seq perform well with scRNA-seq data.</p><p id="Par34">Finally, we want to remark that paying attention to the details in a computational pipeline and in particular to normalisation pays off. The effect of using a good pipeline as compared to a naively compiled one has a similar or even greater effect on the potential to detect a biological signal in scRNA-seq data as an increase in cell numbers from 96 to 384 cells per group (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5b</xref>).</p></sec><sec id="Sec10"><title>Methods</title><sec id="Sec11"><title>Single cell RNA-seq data sets</title><p id="Par35">The starting point for our comprehensive pipeline comparison is the scRNA-seq library preparation (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1a</xref>). In our comparison, we included the gene expression profiles of mouse embryonic stem cells (mESC) as published in Ziegenhain et al.<sup><xref ref-type="bibr" rid="CR2">2</xref></sup> (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>). We selected four data sets for our comparison: Smart-seq2<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> a well-based full-length scRNA-seq protocol, CEL-seq2<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> a well-based 3&#x02032; UMI-protocol using linear amplification, SCRB-seq a well-based 3&#x02032; UMI-protocol with PCR amplification<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR42">42</xref></sup> and Drop-seq<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> a droplet-based 3&#x02032; UMI-protocol. In addition, 92 poly-adenylated synthetic RNA transcripts of known concentration designed by the External RNA Control Consortium (ERCCs)<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> were spiked in for all methods except Drop-seq. All raw cDNA sequencing reads were cut to a length of 45 bases and downsampled to one million cDNA reads per cell (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>).</p><p id="Par36">Finally, we added a 10X Chromium data set sequencing mouse NIH3T3 cells<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>, yielding ~400 good cells with on average ~60,000 reads/cell and another 10X data set analysing ~1000 human peripheral blood mononuclear cells (PBMCs).</p><p id="Par37">These choices of library preparation protocols cover the diversity in current protocols without imposing partiality due to biological differences and technical handling.</p></sec><sec id="Sec12"><title>Gene expression quantification</title><p id="Par38">For genome mapping and quantification of the UMI-data with a splice-aware aligner, we used the zUMIs<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> (v.0.0.3) pipeline with STAR<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> (v.2.5.3a) and the mouse genome (Mus_musculus.GRm38) together with annotation files (gtf) for GENCODE (vM15), Vega (VEGA68) and RefSeq (Release 85) (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">2</xref>). zUMIs is a fast and flexible pipeline for processing scRNA-seq data where cell barcode or UMI reads with low sequence quality reads are filtered out prior to UMI collapsing by sequence identity which yields identical count results as UMI-tools<sup><xref ref-type="bibr" rid="CR44">44</xref>,<xref ref-type="bibr" rid="CR45">45</xref></sup>. For Smart-Seq2 we use the same pipeline settings as in zUMIs, simply omitting the UMI collapsing step (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">3</xref>).</p><p id="Par39">For transcriptome alignment, we downloaded transcriptome fasta files corresponding to the annotations listed above. We used BWA<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> (v0.7.12) to align the scRNA-seq reads to these transcriptomes. We only removed reads that aligned equally well to transcripts of different genes as truly multi-mapped. The remaining reads were tallied up per gene. For UMI data, the reads were collapsed per gene by identity, similar to the strategy recommended in zUMIs.</p><p id="Par40">For kallisto<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> (v0.43.1), a transcriptome-guided pseudo-alignment method, we followed the recommended quantification procedure for scRNA-seq data to yield abundance estimates per equivalence class. To be comparable with other alignment methods, the counts per equivalence class were collapsed per gene. The counts of equivalence classes representing multiple genes were filtered out. For SCRB-seq, CEL-seq2, Drop-seq and 10&#x000d7; Genomics libraries, we chose the UMI-aware quantification option. The ERCC spike-in sequences were appended to the genome or transcriptome sequences for quantification.</p></sec><sec id="Sec13"><title>Simulations</title><p id="Par41">We used powsimR to estimate, simulate and evaluate single cell RNA-seq experiments<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. PowsimR has been independently validated for benchmarking DE-approaches<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and consistently reproduces the mean-variance relationship and dropout rates of genes of scRNA-seq data (see also Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">28</xref>). The gene expression quantification using three different aligners in combination with three annotations per library preparation protocol produced 45 count matrices. These count matrices are the basis for our estimation in powsimR. Genes needed at least one read or UMI count in at least one cell to be considered in the estimation for simulation parameters. Since we<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> and others<sup><xref ref-type="bibr" rid="CR46">46</xref>,<xref ref-type="bibr" rid="CR47">47</xref></sup> have found previously, we assume that UMI counts follow a negative binomial distribution and only Smart-seq2 needs the inclusion of zero-inflation. To simulate spike-in data, we added an implementation of the simulation framework for pure technical variation of spike-ins described in Kim et al.<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> to powsimR. The parameters required for these simulations were estimated from 92 ERCC spike-ins in the SCRB-seq, CEL-seq2 and Smart-seq2 data, respectively<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. To evaluate the effect of differing sequencing depths, we added a new module to powsimR that estimates the degree of PCR amplification for UMI data. This allows the user to downsample a read count matrix by binomial thinning as implemented in edgeR thinCounts()<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> and then to reconstruct the corresponding UMI count matrix base on the estimated PCR amplification rates.</p><p id="Par42">For a detailed evaluation of the pipelines, we simulated two groups of cells for pairwise comparisons with the following three sample size setups: 96 vs. 96, 384 vs. 384 or 50 vs. 200 cells (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1b</xref>). For simplicity, we kept the number of genes that we simulated constant at 10,000. To introduce slight variation in expression capture, we draw a different size factor for each cell from a narrow normal distribution (<italic>X</italic>&#x02009;~&#x02009;<italic>N</italic>(<italic>&#x003bc;</italic>&#x02009;=&#x02009;1, <italic>&#x003c3;</italic>&#x02009;=&#x02009;0.1)) (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1b</xref>). This distribution fits the considered data sets well, irrespective of the applied library preparation method. Furthermore, the two groups of cells can have 5, 20 or 60% differentially expressed genes. To capture the asymmetry of observed expression differences, we considered three setups of DE-patterns: symmetric (50% up- and 50% downregulated), asymmetric (75% up- and 25% downregulated) or completely asymmetric (100% upregulated). The magnitude of expression change is drawn from a narrow gamma distribution (<italic>X</italic>&#x02009;~&#x02009;&#x00393;(<italic>&#x003b1;</italic>&#x02009;=&#x02009;1, <italic>&#x003b2;</italic>&#x02009;=&#x02009;2)) defining the log2 fold change, which is then added to the sampled mean expression. The combination of these parameters results in a total of 27 DE-setups that were then applied to the parameter estimates from 37 different count matrices to simulate 20 replicates for each setting, producing a total of 19,980 simulated data sets.</p><p id="Par43">These data sets were then analysed by a nearly exhaustive number of combinations of four imputation strategies (scone, SAVER, DrImpute), gene dropout filtering (remove genes with more than 80% zero expression values) together with seven normalisation approaches (TMM, MR, Linnorm, Census, Linnorm, scran, SCnorm) with or without spike-ins, depending on library preparation protocol and method (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1c</xref>). Normalisation factors were then derived as described in Soneson et al.<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and used in conjunction with the raw count matrices for DE-testing using four representative approaches (<italic>T</italic>-Test, limma-trend, edgeR-zingeR, MAST). The resulting p-values were corrected for multiple testing with Benjamini-Hochberg FDR and we applied a threshold level of 10% to define positive test results. All these steps were seamlessly implemented into powsimR (github: <ext-link ext-link-type="uri" xlink:href="https://github.com/bvieth/powsimR">https://github.com/bvieth/powsimR</ext-link>). In total we analysed 2,979 different RNA-seq pipelines.</p></sec><sec id="Sec14"><title>Evaluation metrics</title><p id="Par44">To evaluate the normalisation results, we determined the root mean squared error (RMSE) of a robust linear model using the difference between estimated and simulated library size factors as response variable in rlm() implemented in R-package MASS<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> (v.7.3&#x02013;51.1) (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">10</xref>)<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>.</p><p id="Par45">All other measures are based on the final results of an entire scRNA-seq pipeline ending with DE-testing. Knowing the identity of the genes that were simulated to show differing expression levels and the results of the DE-testing, we used a number of metrics related to the confusion matrix tabulating the number of true positives, false positives, true negatives and false negatives. We define the power to detect DE with the TPR (<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{TPR}} = \frac{{{\mathrm{TP}}}}{{{\mathrm{TP + FN}}}}$$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="normal">TPR</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TP+FN</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2019_12266_Article_IEq5.gif"/></alternatives></inline-formula>). The false discovery rate is defined as <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{FDR}} = \frac{{{\mathrm{FP}}}}{{{\mathrm{FP + TP}}}}$$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="normal">FDR</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">FP</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">FP+TP</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2019_12266_Article_IEq6.gif"/></alternatives></inline-formula>. We combine these two measures in a TPR versus FDR curve to quantify the trade-off between true and false discoveries in a genome-wide multiple testing setup as advocated by<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. We then summarise these curves by their partial area under curve (pAUC) of TPR versus observed FDR that still ensures FDR control at the nominal level of 10% (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">11</xref>). This way of calculating the AUC is ideal for data with relatively high true negative rates as the partial integration does not punish methods that are over-conservative, i.e. that stay way below the nominal FDR.</p><p id="Par46">To summarise the whole confusion matrix in one representative value we chose the Matthews Correlation Coefficient (<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{MCC}} = \frac{{{\mathrm{TP}} \ast {\mathrm{TN}} \ -\ {\mathrm{FP}} \ast {\mathrm{FN}}}}{{\sqrt {({\mathrm{TP}}\ +\ {\mathrm{FP}})({\mathrm{TP}}\ +\ {\mathrm{FN}})({\mathrm{TN}}\ +\ {\mathrm{FP}})({\mathrm{TN}}\ +\ {\mathrm{FN}})} }}$$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="normal">MCC</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi><mml:mo>*</mml:mo><mml:mi mathvariant="normal">TN</mml:mi><mml:mspace width="0.33em"/><mml:mo>&#x02212;</mml:mo><mml:mspace width="0.33em"/><mml:mi mathvariant="normal">FP</mml:mi><mml:mo>*</mml:mo><mml:mi mathvariant="normal">FN</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi><mml:mspace width="0.33em"/><mml:mo>+</mml:mo><mml:mspace width="0.33em"/><mml:mi mathvariant="normal">FP</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi><mml:mspace width="0.33em"/><mml:mo>+</mml:mo><mml:mspace width="0.33em"/><mml:mi mathvariant="normal">FN</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">TN</mml:mi><mml:mspace width="0.33em"/><mml:mo>+</mml:mo><mml:mspace width="0.33em"/><mml:mi mathvariant="normal">FP</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">TN</mml:mi><mml:mspace width="0.33em"/><mml:mo>+</mml:mo><mml:mspace width="0.33em"/><mml:mi mathvariant="normal">FN</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2019_12266_Article_IEq7.gif"/></alternatives></inline-formula>), because it is a balanced measure ensuring a reliable comparison of method performance across all DE-settings<sup><xref ref-type="bibr" rid="CR50">50</xref>,<xref ref-type="bibr" rid="CR51">51</xref></sup>. As for the pAUC, we calculated the maximal value of MCC where the cutoff still ensured FDR control at the nominal level of 10%.</p><p id="Par47">To quantify the relative contribution of each step in the analysis pipeline, we used the MCC as a response variable in a beta regression model implemented in R-package betareg (v.3.1&#x02013;1)<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> with each individual pipeline step. Because the MCC assumes the extremes of 0 and 1 in some DE-settings, we applied the recommended transformation, namely <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{MCC}}_{{\mathrm{transformed}}} = \frac{{{\mathrm{MCC}} \ast (n - 1) + 0.5}}{n}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi mathvariant="normal">MCC</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">transformed</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">MCC</mml:mi><mml:mo>*</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2019_12266_Article_IEq8.gif"/></alternatives></inline-formula>, where n is the sample size<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>. The contribution is then given by the difference between the full model pseudo-<italic>R</italic><sup>2</sup> containing all covariates versus a model leaving one step out at a time. This is then scaled to the total variance explained to give relative &#x00394;<italic>R</italic><sup>2</sup> percentages.</p></sec><sec id="Sec15"><title>Reporting summary</title><p id="Par48">Further information on research design is available in the&#x000a0;<xref rid="MOESM2" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p></sec></sec><sec sec-type="supplementary-material"><title>Supplementary information</title><sec id="Sec16"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="41467_2019_12266_MOESM1_ESM.pdf"><caption><p>Supplementary Information</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="41467_2019_12266_MOESM2_ESM.pdf"><caption><p>Reporting Summary</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="41467_2019_12266_MOESM3_ESM.pdf"><caption><p>Peer Review File</p></caption></media></supplementary-material>
</p></sec></sec></body><back><fn-group><fn><p><bold>Peer review information</bold>
<italic>Nature Communications</italic> thanks the anonymous reviewers for their contribution to the peer review of this work. Peer reviewer reports are available.</p></fn><fn><p><bold>Publisher&#x02019;s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><sec><title>Supplementary information</title><p><bold>Supplementary information</bold> is available for this paper at 10.1038/s41467-019-12266-7.</p></sec><ack><title>Acknowledgements</title><p>This work was supported by the Deutsche Forschungsgemeinschaft (DFG) through LMUexcellent, SFB1243 (Subproject A14/A15) and DFG grant HE 7669/1-1. C.Z. is recipient of an EMBO long-term fellowship (ALTF 673-2017).</p></ack><notes notes-type="author-contribution"><title>Author contributions</title><p>B.V. and I.H. conceived the study. B.V. prepared and analysed the scRNA-seq data. B.V. implemented and conducted the simulation and evaluation framework. S.P.&#x000a0;and C.Z. helped in data processing and power simulations. W.E. and I.H. supervised the work and provided guidance in data analysis. B.V., I.H. and W.E. wrote the manuscript. All authors read and approved the final manuscript.</p></notes><notes notes-type="data-availability"><title>Data availability</title><p>Any relevant data are available from the authors upon reasonable request. The scRNA-seq data used in this manuscript are all publicly available, and they are summarised in Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>. The SCRB-seq, Smart-seq2, Drop-seq, CEL-seq2 data are available at the Gene Expression Omnibus (GEO) under accession code GSE75790. The HGMM and PBMC data sets are available at 10x Genomics&#x02019;s official website (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link>). The data produced by the analysis in this manuscript is freely available from the following zenodo data repository (10.5281/zenodo.3364466).</p></notes><notes notes-type="data-availability"><title>Code availability</title><p>The software and code used are summarised in Supplementary Tables&#x000a0;<xref rid="MOESM1" ref-type="media">3</xref> and <xref rid="MOESM1" ref-type="media">4</xref>. A compendium containing processing scripts and detailed instructions to reproduce the analysis for this manuscript is freely available from the following GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/bvieth/scRNA-seq-pipelines">https://github.com/bvieth/scRNA-seq-pipelines</ext-link>).</p></notes><notes notes-type="COI-statement"><title>Competing interests</title><p id="Par49">The authors declare no competing interests.</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagner</surname><given-names>A</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name></person-group><article-title>Revealing the vectors of cellular identity with single-cell genomics</article-title><source>Nat. Biotechnol.</source><year>2016</year><volume>34</volume><fpage>1145</fpage><lpage>1160</lpage><pub-id pub-id-type="doi">10.1038/nbt.3711</pub-id><pub-id pub-id-type="pmid">27824854</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ziegenhain</surname><given-names>C</given-names></name><etal/></person-group><article-title>Comparative analysis of Single-Cell RNA sequencing methods</article-title><source>Mol. Cell</source><year>2017</year><volume>65</volume><fpage>631</fpage><lpage>643</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2017.01.023</pub-id><pub-id pub-id-type="pmid">28212749</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Svensson</surname><given-names>V</given-names></name><etal/></person-group><article-title>Power analysis of single-cell RNA-sequencing experiments</article-title><source>Nat. Methods</source><year>2017</year><volume>14</volume><fpage>381</fpage><lpage>387</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4220</pub-id><pub-id pub-id-type="pmid">28263961</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baruzzo</surname><given-names>G</given-names></name><etal/></person-group><article-title>Simulation-based comprehensive benchmarking of RNA-seq aligners</article-title><source>Nat. Methods</source><year>2017</year><volume>14</volume><fpage>135</fpage><lpage>139</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4106</pub-id><pub-id pub-id-type="pmid">27941783</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>DC</given-names></name><name><surname>Yao</surname><given-names>J</given-names></name><name><surname>Ho</surname><given-names>KS</given-names></name><name><surname>Lambowitz</surname><given-names>AM</given-names></name><name><surname>Wilke</surname><given-names>CO</given-names></name></person-group><article-title>Limitations of alignment-free tools in total RNA-seq quantification</article-title><source>BMC Genomics</source><year>2018</year><volume>19</volume><fpage>510</fpage><lpage>524</lpage><pub-id pub-id-type="doi">10.1186/s12864-018-4869-5</pub-id><pub-id pub-id-type="pmid">29969991</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>S</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name></person-group><article-title>A comprehensive evaluation of ensembl, RefSeq, and UCSC annotations in the context of RNA-seq read mapping and gene quantification</article-title><source>BMC Genomics</source><year>2015</year><volume>16</volume><fpage>97</fpage><pub-id pub-id-type="doi">10.1186/s12864-015-1308-8</pub-id><pub-id pub-id-type="pmid">25765860</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andrews</surname><given-names>TS</given-names></name><name><surname>Hemberg</surname><given-names>M</given-names></name></person-group><article-title>False signals induced by single-cell imputation</article-title><source>F1000Res.</source><year>2018</year><volume>7</volume><fpage>1740</fpage><lpage>1776</lpage><pub-id pub-id-type="doi">10.12688/f1000research.16613.1</pub-id><pub-id pub-id-type="pmid">30906525</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="other">Zhang, L. &#x00026; Zhang, S. Comparison of computational methods for imputing single-cell RNA-sequencing data. <italic>IEEE/ACM Trans. Comput. Biol. Bioinform</italic>. 10.1109/TCBB.2018.2848633&#x000a0;(2018).</mixed-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vallejos</surname><given-names>CA</given-names></name><name><surname>Risso</surname><given-names>D</given-names></name><name><surname>Scialdone</surname><given-names>A</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>Normalizing single-cell RNA sequencing data: challenges and opportunities</article-title><source>Nat. Methods</source><year>2017</year><volume>14</volume><fpage>565</fpage><lpage>571</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4292</pub-id><pub-id pub-id-type="pmid">28504683</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vieth</surname><given-names>B</given-names></name><name><surname>Ziegenhain</surname><given-names>C</given-names></name><name><surname>Parekh</surname><given-names>S</given-names></name><name><surname>Enard</surname><given-names>W</given-names></name><name><surname>Hellmann</surname><given-names>I</given-names></name></person-group><article-title>powsimr: power analysis for bulk and single cell RNA-seq experiments</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><fpage>3486</fpage><lpage>3488</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btx435</pub-id><pub-id pub-id-type="pmid">29036287</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evans</surname><given-names>C</given-names></name><name><surname>Hardin</surname><given-names>J</given-names></name><name><surname>Stoebel</surname><given-names>DM</given-names></name></person-group><article-title>Selecting between-sample RNA-Seq normalization methods from the perspective of their assumptions</article-title><source>Brief. Bioinform.</source><year>2018</year><volume>19</volume><fpage>776</fpage><lpage>792</lpage><pub-id pub-id-type="doi">10.1093/bib/bbx008</pub-id><pub-id pub-id-type="pmid">28334202</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeisel</surname><given-names>A</given-names></name><etal/></person-group><article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title><source>Science</source><year>2015</year><volume>347</volume><fpage>1138</fpage><lpage>1142</lpage><pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id><pub-id pub-id-type="pmid">25700174</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Picelli</surname><given-names>S</given-names></name><etal/></person-group><article-title>Full-length RNA-seq from single cells using smart-seq2</article-title><source>Nat. Protoc.</source><year>2014</year><volume>9</volume><fpage>171</fpage><lpage>181</lpage><pub-id pub-id-type="doi">10.1038/nprot.2014.006</pub-id><pub-id pub-id-type="pmid">24385147</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macosko</surname><given-names>EZ</given-names></name><etal/></person-group><article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title><source>Cell</source><year>2015</year><volume>161</volume><fpage>1202</fpage><lpage>1214</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id><pub-id pub-id-type="pmid">26000488</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hashimshony</surname><given-names>T</given-names></name><name><surname>Wagner</surname><given-names>F</given-names></name><name><surname>Sher</surname><given-names>N</given-names></name><name><surname>Yanai</surname><given-names>I</given-names></name></person-group><article-title>CEL-Seq: single-cell RNA-Seq by multiplexed linear amplification</article-title><source>Cell Rep.</source><year>2012</year><volume>2</volume><fpage>666</fpage><lpage>673</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2012.08.003</pub-id><pub-id pub-id-type="pmid">22939981</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>GXY</given-names></name><etal/></person-group><article-title>Massively parallel digital transcriptional profiling of single cells</article-title><source>Nat. Commun.</source><year>2017</year><volume>8</volume><fpage>14049</fpage><lpage>14051</lpage><pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id><pub-id pub-id-type="pmid">28091601</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ziegenhain</surname><given-names>C</given-names></name><name><surname>Vieth</surname><given-names>B</given-names></name><name><surname>Parekh</surname><given-names>S</given-names></name><name><surname>Hellmann</surname><given-names>I</given-names></name><name><surname>Enard</surname><given-names>W</given-names></name></person-group><article-title>Quantitative single-cell transcriptomics</article-title><source>Brief. Funct. Genomics</source><year>2018</year><volume>17</volume><fpage>220</fpage><lpage>232</lpage><pub-id pub-id-type="doi">10.1093/bfgp/ely009</pub-id><pub-id pub-id-type="pmid">29579145</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dobin</surname><given-names>A</given-names></name><etal/></person-group><article-title>STAR: ultrafast universal RNA-seq aligner</article-title><source>Bioinformatics</source><year>2013</year><volume>29</volume><fpage>15</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id><pub-id pub-id-type="pmid">23104886</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>1754</fpage><lpage>1760</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id><pub-id pub-id-type="pmid">19451168</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="other">Bray, N. L., Pimentel, H., Melsted, P. &#x00026; Pachter, L. kallisto. <ext-link ext-link-type="uri" xlink:href="https://github.com/pachterlab/kallisto/tree/v0.43.1">https://github.com/pachterlab/kallisto/tree/v0.43.1</ext-link> (2017).</mixed-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O&#x02019;Leary</surname><given-names>NA</given-names></name><etal/></person-group><article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title><source>Nucleic Acids Res.</source><year>2016</year><volume>44</volume><fpage>D733</fpage><lpage>D745</lpage><pub-id pub-id-type="doi">10.1093/nar/gkv1189</pub-id><pub-id pub-id-type="pmid">26553804</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frankish</surname><given-names>A</given-names></name><etal/></person-group><article-title>GENCODE reference annotation for the human and mouse genomes</article-title><source>Nucleic Acids Res.</source><year>2019</year><volume>47</volume><fpage>D766</fpage><lpage>D773</lpage><pub-id pub-id-type="doi">10.1093/nar/gky955</pub-id><pub-id pub-id-type="pmid">30357393</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilming</surname><given-names>LG</given-names></name><etal/></person-group><article-title>The vertebrate genome annotation (vega) database</article-title><source>Nucleic Acids Res.</source><year>2008</year><volume>36</volume><fpage>D753</fpage><lpage>D760</lpage><pub-id pub-id-type="doi">10.1093/nar/gkm987</pub-id><pub-id pub-id-type="pmid">18003653</pub-id></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bray</surname><given-names>NL</given-names></name><name><surname>Pimentel</surname><given-names>H</given-names></name><name><surname>Melsted</surname><given-names>P</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name></person-group><article-title>Near-optimal probabilistic RNA-seq quantification</article-title><source>Nat. Biotechnol.</source><year>2016</year><volume>34</volume><fpage>525</fpage><lpage>527</lpage><pub-id pub-id-type="doi">10.1038/nbt.3519</pub-id><pub-id pub-id-type="pmid">27043002</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lun</surname><given-names>ATL</given-names></name><name><surname>Bach</surname><given-names>K</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title><source>Genome Biol.</source><year>2016</year><volume>17</volume><fpage>75</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1186/s13059-016-0947-7</pub-id><pub-id pub-id-type="pmid">27122128</pub-id></element-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bacher</surname><given-names>R</given-names></name><etal/></person-group><article-title>SCnorm: robust normalization of single-cell RNA-seq data</article-title><source>Nat. Methods</source><year>2017</year><volume>14</volume><fpage>584</fpage><lpage>586</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4263</pub-id><pub-id pub-id-type="pmid">28418000</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>Oshlack</surname><given-names>A</given-names></name></person-group><article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title><source>Genome Biol.</source><year>2010</year><volume>11</volume><fpage>R25</fpage><lpage>R34</lpage><pub-id pub-id-type="doi">10.1186/gb-2010-11-3-r25</pub-id><pub-id pub-id-type="pmid">20196867</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group><article-title>Differential expression analysis for sequence count data</article-title><source>Genome Biol.</source><year>2010</year><volume>11</volume><fpage>R106</fpage><lpage>R118</lpage><pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id><pub-id pub-id-type="pmid">20979621</pub-id></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yip</surname><given-names>SH</given-names></name><name><surname>Wang</surname><given-names>P</given-names></name><name><surname>Kocher</surname><given-names>J-PA</given-names></name><name><surname>Sham</surname><given-names>PC</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name></person-group><article-title>Linnorm: improved statistical analysis for single cell RNA-seq expression data</article-title><source>Nucleic Acids Res.</source><year>2017</year><volume>45</volume><fpage>e179</fpage><lpage>e191</lpage><pub-id pub-id-type="doi">10.1093/nar/gkx828</pub-id><pub-id pub-id-type="pmid">28981748</pub-id></element-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X</given-names></name><etal/></person-group><article-title>Single-cell mRNA quantification and differential analysis with census</article-title><source>Nat. Methods</source><year>2017</year><volume>14</volume><fpage>309</fpage><lpage>315</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4150</pub-id><pub-id pub-id-type="pmid">28114287</pub-id></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group><article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title><source>Nat. Methods</source><year>2018</year><volume>15</volume><fpage>255</fpage><lpage>261</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4612</pub-id><pub-id pub-id-type="pmid">29481549</pub-id></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gong</surname><given-names>W</given-names></name><name><surname>Kwak</surname><given-names>I-Y</given-names></name><name><surname>Pota</surname><given-names>P</given-names></name><name><surname>Koyano-Nakagawa</surname><given-names>N</given-names></name><name><surname>Garry</surname><given-names>DJ</given-names></name></person-group><article-title>DrImpute: imputing dropout events in single cell RNA sequencing data</article-title><source>BMC Bioinforma.</source><year>2018</year><volume>19</volume><fpage>220</fpage><lpage>230</lpage><pub-id pub-id-type="doi">10.1186/s12859-018-2226-y</pub-id></element-citation></ref><ref id="CR33"><label>33.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cole</surname><given-names>MB</given-names></name><etal/></person-group><article-title>Performance assessment and selection of normalization procedures for Single-Cell RNA-Seq</article-title><source>Cell Syst.</source><year>2019</year><volume>8</volume><fpage>315</fpage><lpage>328</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2019.03.010</pub-id><pub-id pub-id-type="pmid">31022373</pub-id></element-citation></ref><ref id="CR34"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>M</given-names></name><etal/></person-group><article-title>SAVER: gene expression recovery for single-cell RNA sequencing</article-title><source>Nat. Methods</source><year>2018</year><volume>15</volume><fpage>539</fpage><lpage>542</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0033-z</pub-id><pub-id pub-id-type="pmid">29941873</pub-id></element-citation></ref><ref id="CR35"><label>35.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finak</surname><given-names>G</given-names></name><etal/></person-group><article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title><source>Genome Biol.</source><year>2015</year><volume>16</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1186/s13059-015-0844-5</pub-id><pub-id pub-id-type="pmid">25583448</pub-id></element-citation></ref><ref id="CR36"><label>36.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Law</surname><given-names>CW</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>voom: Precision weights unlock linear model analysis tools for RNA-seq read counts</article-title><source>Genome Biol.</source><year>2014</year><volume>15</volume><fpage>R29</fpage><lpage>R46</lpage><pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r29</pub-id><pub-id pub-id-type="pmid">24485249</pub-id></element-citation></ref><ref id="CR37"><label>37.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van den Berge</surname><given-names>K</given-names></name><etal/></person-group><article-title>Observation weights unlock bulk RNA-seq tools for zero inflation and single-cell applications</article-title><source>Genome Biol.</source><year>2018</year><volume>19</volume><fpage>24</fpage><lpage>41</lpage><pub-id pub-id-type="doi">10.1186/s13059-018-1406-4</pub-id><pub-id pub-id-type="pmid">29478411</pub-id></element-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aran</surname><given-names>D</given-names></name><etal/></person-group><article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title><source>Nat. Immunol.</source><year>2019</year><volume>20</volume><fpage>163</fpage><lpage>172</lpage><pub-id pub-id-type="doi">10.1038/s41590-018-0276-y</pub-id><pub-id pub-id-type="pmid">30643263</pub-id></element-citation></ref><ref id="CR39"><label>39.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stunnenberg</surname><given-names>HG</given-names></name><collab>International Human Epigenome Consortium</collab><name><surname>Hirst</surname><given-names>M</given-names></name></person-group><article-title>The international human epigenome consortium: a blueprint for scientific collaboration and discovery</article-title><source>Cell</source><year>2016</year><volume>167</volume><fpage>1145</fpage><lpage>1149</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.11.007</pub-id><pub-id pub-id-type="pmid">27863232</pub-id></element-citation></ref><ref id="CR40"><label>40.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andrews</surname><given-names>TS</given-names></name><name><surname>Hemberg</surname><given-names>M</given-names></name></person-group><article-title>Identifying cell populations with scRNASeq</article-title><source>Mol. Asp. Med.</source><year>2018</year><volume>59</volume><fpage>114</fpage><lpage>122</lpage><pub-id pub-id-type="doi">10.1016/j.mam.2017.07.002</pub-id></element-citation></ref><ref id="CR41"><label>41.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Risso</surname><given-names>D</given-names></name><name><surname>Schwartz</surname><given-names>K</given-names></name><name><surname>Sherlock</surname><given-names>G</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name></person-group><article-title>GC-content normalization for RNA-Seq data</article-title><source>BMC Bioinforma.</source><year>2011</year><volume>12</volume><fpage>480</fpage><lpage>497</lpage><pub-id pub-id-type="doi">10.1186/1471-2105-12-480</pub-id></element-citation></ref><ref id="CR42"><label>42.</label><mixed-citation publication-type="other">Soumillon, M., Cacchiarelli, D., Semrau, S., van Oudenaarden, A. &#x00026; Mikkelsen, T. S. Characterization of directed differentiation by high-throughput single-cell RNA-Seq. Preprint at 10.1101/003236v1 (2014).</mixed-citation></ref><ref id="CR43"><label>43.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>L</given-names></name><etal/></person-group><article-title>Synthetic spike-in standards for RNA-seq experiments</article-title><source>Genome Res.</source><year>2011</year><volume>21</volume><fpage>1543</fpage><lpage>1551</lpage><pub-id pub-id-type="doi">10.1101/gr.121095.111</pub-id><pub-id pub-id-type="pmid">21816910</pub-id></element-citation></ref><ref id="CR44"><label>44.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parekh</surname><given-names>S</given-names></name><name><surname>Ziegenhain</surname><given-names>C</given-names></name><name><surname>Vieth</surname><given-names>B</given-names></name><name><surname>Enard</surname><given-names>W</given-names></name><name><surname>Hellmann</surname><given-names>I</given-names></name></person-group><article-title>zUMIs - a fast and flexible pipeline to process RNA sequencing data with UMIs</article-title><source>Gigascience</source><year>2018</year><volume>7</volume><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1093/gigascience/giy059</pub-id></element-citation></ref><ref id="CR45"><label>45.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>T</given-names></name><name><surname>Heger</surname><given-names>A</given-names></name><name><surname>Sudbery</surname><given-names>I</given-names></name></person-group><article-title>UMI-tools: modeling sequencing errors in unique molecular identifiers to improve quantification accuracy</article-title><source>Genome Res.</source><year>2017</year><volume>27</volume><fpage>491</fpage><lpage>499</lpage><pub-id pub-id-type="doi">10.1101/gr.209601.116</pub-id><pub-id pub-id-type="pmid">28100584</pub-id></element-citation></ref><ref id="CR46"><label>46.</label><mixed-citation publication-type="other">Amrhein, L., Harsha, K. &#x00026;Fuchs, C. A mechanistic model for the negative binomial distribution of single-cell mRNA counts (2019).</mixed-citation></ref><ref id="CR47"><label>47.</label><mixed-citation publication-type="other">Svensson, V. Droplet scRNA-seq is not zero-inflated (2019).</mixed-citation></ref><ref id="CR48"><label>48.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>JK</given-names></name><name><surname>Kolodziejczyk</surname><given-names>AA</given-names></name><name><surname>Illicic</surname><given-names>T</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>Characterizing noise structure in single-cell RNA-seq distinguishes genuine from technical stochastic allelic expression</article-title><source>Nat. Commun.</source><year>2015</year><volume>6</volume><fpage>8687</fpage><lpage>8695</lpage><pub-id pub-id-type="doi">10.1038/ncomms9687</pub-id><pub-id pub-id-type="pmid">26489834</pub-id></element-citation></ref><ref id="CR49"><label>49.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Venables</surname><given-names>WN</given-names></name><name><surname>Ripley</surname><given-names>BD</given-names></name></person-group><source>Modern Applied Statistics with S</source><year>2002</year><edition>fourth edn</edition><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name></element-citation></ref><ref id="CR50"><label>50.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group><article-title>iCOBRA: open, reproducible, standardized and live method benchmarking</article-title><source>Nat. Methods</source><year>2016</year><volume>13</volume><fpage>283</fpage><pub-id pub-id-type="doi">10.1038/nmeth.3805</pub-id><pub-id pub-id-type="pmid">27027585</pub-id></element-citation></ref><ref id="CR51"><label>51.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boughorbel</surname><given-names>S</given-names></name><name><surname>Jarray</surname><given-names>F</given-names></name><name><surname>El-Anbari</surname><given-names>M</given-names></name></person-group><article-title>Optimal classifier for imbalanced data using matthews correlation coefficient metric</article-title><source>PLoS ONE</source><year>2017</year><volume>12</volume><fpage>e0177678</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0177678</pub-id><pub-id pub-id-type="pmid">28574989</pub-id></element-citation></ref><ref id="CR52"><label>52.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cribari-Neto</surname><given-names>F</given-names></name><name><surname>Zeileis</surname><given-names>A</given-names></name></person-group><article-title>Beta regression in R</article-title><source>J. Stat. Softw.</source><year>2010</year><volume>34</volume><fpage>1</fpage><lpage>24</lpage><pub-id pub-id-type="doi">10.18637/jss.v034.i02</pub-id></element-citation></ref><ref id="CR53"><label>53.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smithson</surname><given-names>M</given-names></name><name><surname>Verkuilen</surname><given-names>J</given-names></name></person-group><article-title>A better lemon squeezer? maximum-likelihood regression with beta-distributed dependent variables</article-title><source>Psychol. Methods</source><year>2006</year><volume>11</volume><fpage>54</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1037/1082-989X.11.1.54</pub-id><pub-id pub-id-type="pmid">16594767</pub-id></element-citation></ref></ref-list></back></article>